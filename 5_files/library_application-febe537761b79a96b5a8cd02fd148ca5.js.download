function AssetFetcher(t) {
 t = t || {};
 var e = "", o = "";
 this.maskit = t.maskit || !1;
 this.noodle = photoOrg.Util.guid();
 this.type = t.type || "GET";
 this.url = t.url || "";
 this.params = t.params || {};
 this.callback = t.callback || "";
 this.errorCallback = t.errorCallback || "";
 this.context = t.context || "";
 this.async = void 0 != t.async ? t.async :!0;
 this.needRefreshAccessToken = void 0 != t.needRefreshAccessToken ? t.needRefreshAccessToken :!0;
 this.showErrorLayer = t.showErrorLayer;
 this.dataTypeXml = t.dataTypeXml || "JSON";
 this.isAuthorizationRequired = t.isAuthorizationRequired;
 this.iterationCount = 0;
 this.corsProxyUrl = "/corsproxy";
 this.doAjax = function() {
  if (-1 == document.location.href.indexOf("/share") && -1 == this.url.indexOf("/getUserInfo") && -1 == this.url.indexOf("/getOauthInfo") && !photoOrg.oauthFetcher.checkOauthAvailable()) {
   photoOrg.Util.getLoginRedirectUrl();
   return !1;
  }
  var t = !1;
  -1 != this.url.indexOf("dateIndex") && (t = !0);
  var i = this, s = this.context;
  $.support.cors = !0;
  s && (s.noodle = this.noodle);
  photoOrg.oauthFetcher.checkAndGetRefreshToken(this.noodle);
  var r = {
   beforeSend:function() {
    e = new Date().getTime();
    s && (s.requestDetails = r);
   },
   complete:function() {
    o = new Date().getTime();
    i.callback || console.log("missed callback here? .. Need to debug");
    photoOrg.Util.calculateMetrics(o, e, i.url, i.type, "", i.callback, i.noodle, "200");
   },
   url:this.url,
   type:this.type,
   dataType:this.dataTypeXml,
   async:this.async,
   cache:!1,
   headers:{
    GSID:photoOrg.oauthFetcher.getGsid(),
    Noodle:this.noodle
   }
  };
  if (this.isAuthorizationRequired !== !1) {
   var n = photoOrg.oauthFetcher.getOa2(), a = n && n.trim() && "undefined" != n && "(null)" != n;
   if (!a) {
    photoOrg.jsAjaxErrorLogger('"AssetFetcher..invalid oa2 value" oa2="' + n + '", Noodle="' + i.noodle + '", iterationCount="' + i.iterationCount, i.url);
    photoOrg.Util.getLoginRedirectUrl();
    return;
   }
   r.headers.Authorization = "OAuth " + n;
   (-1 != i.url.indexOf(gon.staticContent.pict_service) || -1 != i.url.indexOf(gon.staticContent.discUploadEndpoint)) && (r.headers.access_token = "OAuth " + n);
  }
  "POST" != this.type.toUpperCase() && "DELETE" != this.type.toUpperCase() || "text" == this.dataTypeXml || -1 != this.url.indexOf(this.corsProxyUrl) || $.extend(!0, r.headers, {
   "Content-Type":"application/json"
  });
  $.extend(!0, r, i.params);
  var l = photoOrg.photoLib.cache[i.url];
  if (t && l) {
   console.log("AssetFetcher Ajax Success response (from cache):");
   l.context || (l.context = s);
   i.callback(l.data, l.context, l.url, l.type, i.context);
  } else $.ajax(r).done(function(e, o) {
   photoOrg.Util.moveToUnauthorizatonPage(e, o, i);
   t && (photoOrg.photoLib.cache[i.url] = {
    data:e,
    context:i.context,
    url:i.url,
    type:i.type
   });
   i.callback(e, s, i.url, i.type, i);
  }).fail(function(t, e, o) {
   var n = t.status.toString();
   console.log("AssetFetcher : In falied Ajax block : status_code=" + n + " Noodle=" + i.noodle + " responseText : " + t.responseText + " error thrown : " + o);
   try {
    if (0 == n && t.responseText && t.responseText.error) {
     n = t.responseText.error;
     n = parseInt(n);
    }
    var a = {};
    $.extend(!0, a, r);
    var l = {};
    l = t.responseText;
    a = photoOrg.Util.maskpII(a);
    a = JSON.stringify(a);
    l = photoOrg.Util.maskpII(l);
    l = JSON.stringify(l);
    "401" == n ? photoOrg.jsWarningLogger('"API call Failed", httpStatusCode="' + n + '", errorCode="InvalidOauth2Token", Noodle="' + i.noodle + '", iterationCount="' + i.iterationCount + '", errorThrown="' + o + '"', i.url, "", "", !0) :"0" == n ? photoOrg.jsWarningLogger('"API call Failed", httpStatusCode="' + n + '", errorCode="HTTPStatus-0", Noodle="' + i.noodle + '", iterationCount="' + i.iterationCount + '", errorThrown="' + o + '"', i.url, "", "", !0) :photoOrg.jsAjaxErrorLogger('"API call Failed", Noodle="' + i.noodle + '", iterationCount="' + i.iterationCount + '", requestDetails="' + a + '", responseDetails="' + l + '", errorThrown="' + o + '"', i.url, t);
   } catch (c) {
    console.log("Exception in asset_fetcher : " + c);
    photoOrg.jsErrorLogger('"Exception while logging Asset Fetcher error log :' + c + '", errorCode="LIBRARY:doAjax"');
   }
   if (i.isAuthorizationRequired !== !1) if (0 == i.iterationCount && 401 == n && i.needRefreshAccessToken) {
    photoOrg.jsInfoLogger('"AssetFetcher : Authentication failed so calling refresh token" status_code="' + n + '" Noodle="' + i.noodle + '"', i.url);
    photoOrg.oauthFetcher.fetchToken(i.noodle, $.proxy(i.doAjax, i), !0, !1);
    i.iterationCount = 1;
   } else if (0 != i.iterationCount || 0 != n) if (1 != i.iterationCount || 0 != n) try {
    i.errorCallback(t, s, e, o, i.noodle);
    i.showErrorLayer && i.showErrorOverlay(i.noodle);
   } catch (h) {
    console.log("AssetFetcher : Exception in Ajax call Noodle=" + i.noodle + " error : " + h + " responseText : " + t.responseText);
    var a = {};
    $.extend(!0, a, r);
    var l = {};
    l = t.responseText;
    a = photoOrg.Util.maskpII(a);
    a = JSON.stringify(a);
    l = photoOrg.Util.maskpII(l);
    l = JSON.stringify(a);
    photoOrg.jsAjaxErrorLogger('"AssetFetcher : Exception in Ajax call",Error="' + h + '" ,Noodle="' + i.noodle + '", requestDetails="' + a + '", responseDetails="' + l + '"', i.url, t);
   } else {
    var d = {
     url:encodeURI(i.url),
     type:i.type
    };
    void 0 != i.params.data && (d.data = i.params.data);
    i.params.data = d;
    if (photoOrg.photoLib && photoOrg.photoLib.config && photoOrg.photoLib.config.loadAsPhotoPicker) {
     i.params.dataType = "jsonp";
     i.params.jsonpCallback = "handlePHOResponse";
    }
    photoOrg.jsWarningLogger("AssetFetcher : Triggering CorsProxy Call for url : " + i.url + ", status_code=" + n + " Noodle=" + i.noodle, i.corsProxyUrl, "", "", !0);
    i.iterationCount++;
    i.type = "POST";
    i.url = photoOrg.Util.getLibraryServiceHost() + i.corsProxyUrl;
    i.params = i.params;
    i.callback = i.callback;
    i.errorCallback = i.errorCallback;
    i.context = i.context;
    i.doAjax();
   } else setTimeout(function() {
    i.doAjax();
    i.iterationCount = 1;
   }, 150); else i.errorCallback(t, s, e, o, i.noodle);
  });
 }, this.showErrorOverlay = function(t) {
  try {
   $(".globalError_noodle").text(t);
   $("#globalError").foundation("reveal", "open");
  } catch (e) {
   console.log("error in showErrorOverlay..." + e);
  }
 }, this.fetchAssets = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "asset/imageList?" + e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:fetchAssets" err_desc="' + r + '" err_stack="' + r.stack + '", errorCode="LIBRARY:fetchAssets"');
  }
 }, this.fetchAssetsByIds = function(t, e, o, i) {
  try {
   this.url = gon.staticContent.pict_service + "asset/assetsFromIds?ids=" + t;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (s) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:fetchAssetsByIds" err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 };
 this.fetchClusters = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "asset/dateIndex?" + e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:fetchClusters" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getMoreClusters = function(t, e, o, i, s, r) {
  try {
   this.url = gon.staticContent.pict_service + "asset/dateIndex/cluster/" + o + "?" + e;
   this.callback = i;
   this.errorCallback = s;
   this.context = r;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getMoreClusters" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.fetchMonthlyAlbums = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "collection/monthIndex?" + e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:fetchMonthlyAlbums" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getOauthInfo = function(t, e, o) {
  try {
   this.url = t;
   this.callback = e;
   this.errorCallback = o;
   this.doAjax();
  } catch (i) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getOauthInfo" err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 };
 this.getSingleAlbumInfo = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "collection/" + e.albumId + "/assets?" + e.urlparam;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getSingleAlbumInfo" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getSharedSingleAlbumInfo = function(t, e, o, i, s) {
  try {
   t = gon.staticContent.pict_service + "social/detail/story/" + e.albumId + "/a/" + e.ownerAccountId + "/dc/" + e.dataCenter;
   t += -1 !== t.indexOf("?") ? "&assetType=" + e.assetType :"?assetType=" + e.assetType;
   e.sortOrderParam && (t += "&" + e.sortOrderParam);
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getSharedSingleAlbumInfo" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getUnsharedSingleAlbum = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "collection/" + e.albumId;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getUnsharedSingleAlbum" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.deleteSinglePict = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   this.type = "DELETE";
   this.url = gon.staticContent.pict_service + "asset/" + e.pict_id;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:deleteSinglePict" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.removeSinglePictFromCollection = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var t = gon.staticContent.pict_service + "collection/" + e.albumId + "/asset/" + e.pict_id;
   this.type = "DELETE";
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:removeSinglePictFromCollection" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getAlbumInfoByToken = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "social/public/" + e.token;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getAlbumInfoByToken" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.downloadMultiplePicts = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var r = {
    data:$.toJSON(e.data)
   };
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "asset/multiPhotoDownload";
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:downloadMultiplePicts" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.deleteMultiplePicts = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var r = {
    data:$.toJSON(e.data)
   };
   this.type = "DELETE";
   this.url = gon.staticContent.pict_service + "asset/deleteMultipleAssets";
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:deleteMultiplePicts" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.updateAsset = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "asset/" + e.pict_id + "/favorite?favorite=" + e.isFavourite;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:updateAsset" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.createAlbum = function(t, e, o, i, s) {
  try {
   var r = {
    data:$.toJSON(e.data),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "POST";
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:createAlbum" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.addOrMoveToExistingAlbum = function(t, e, o, i, s) {
  try {
   var r = {
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "PUT";
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:addOrMoveToExistingAlbum" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.getProjects = function(t, e, o, i, s) {
  try {
   var r = t;
   if (!(t && t.length > 0)) {
    r = gon.staticContent.projectServiceUrl + "/project?filter=saved&" + e.param;
    gon.staticContent.sourceGroup && gon.staticContent.sourceGroup.length > 0 && (r += "&sourceGroup=" + gon.staticContent.sourceGroup);
    gon.staticContent.websiteName.indexOf("greens") && (r += (-1 != r.indexOf("?") ? "&" :"?") + "excludeTypes=archive");
   }
   this.url = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getProjects" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.getProjectsCount = function(t, e, o, i, s) {
  try {
   var r = gon.staticContent.projectServiceUrl + "/project/count";
   gon.staticContent.sourceGroup && gon.staticContent.sourceGroup.length > 0 && (r += "?sourceGroup=" + gon.staticContent.sourceGroup);
   gon.staticContent.websiteName.indexOf("greens") && (r += (-1 != r.indexOf("?") ? "&" :"?") + "excludeTypes=archive");
   this.url = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getProjectsCount" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.deleteProject = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   this.type = "DELETE";
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:deleteProject" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.imageRotate = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var t = gon.staticContent.pict_service + "asset/" + e.pict_id + "/imageedit?rf=" + e.direction + "&defaultSize=";
   t += void 0 != e.height && e.height.length > 0 ? e.height + ",200" :"200";
   params = {};
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:imageRotate" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getAlbumsData = function(t, e, o, i, s) {
  try {
   this.responseReturned = !1;
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getAlbumsData" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.getAuthorizedUrl = function(t, e, o, i) {
  try {
   var s = {
    dataType:"jsonp",
    jsonpCallback:"handlePHOResponse"
   };
   s.data = {
    oauthToken:i.authToken
   };
   this.url = t;
   this.params = s;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getAuthorizedURl" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.getFltk = function(t, e, o, i) {
  try {
   this.url = t;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (s) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getFltk" err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 }, this.getSelfAlbumNames = function(t, e, o, i) {
  try {
   var s = {
    dataType:"jsonp",
    jsonpCallback:"handlePHOResponse"
   };
   this.url = t;
   this.params = s;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getSelfAlbumNames" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.getContactsAlbumNames = function(t, e, o, i) {
  try {
   var s = {
    dataType:"jsonp",
    jsonpCallback:"handlePHOResponse"
   };
   s.data = {
    flot:i.flot,
    flots:i.flots
   };
   this.url = t;
   this.params = s;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getContactsAlbumNames" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.createStory = function(t, e, o, i, s) {
  try {
   var t = gon.staticContent.pict_service + "collection", r = {
    data:$.toJSON(e.data),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "PUT";
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:createStory" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.getSelfIngestionPhotos = function(t, e, o, i, s) {
  try {
   var r = {
    dataType:"jsonp",
    jsonpCallback:"handlePHOResponse"
   };
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.maskit = !0;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getSelfIngestionPhotos" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.getIngestionUserFallowrs = function(t, e, o, i, s) {
  try {
   var r = {
    dataType:"jsonp",
    jsonpCallback:"handlePHOResponse"
   };
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.maskit = !0;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getIngestionUseFallowrs" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 }, this.deleteAlbum = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   this.type = "DELETE";
   this.url = t;
   this.params = e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:deleteAlbum" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.updateAlbum = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var t = gon.staticContent.pict_service + "collection", r = {
    data:$.toJSON(e.data),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "POST";
   this.url = t;
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.maskit = !0;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:updateAlbum" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.getAssetInfo = function(t, e, o, i, s) {
  try {
   var t = gon.staticContent.pict_service + "asset/" + e.id;
   e.arefId && (t += "?assetRefUrl=" + e.arefId);
   this.url = t;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getAssetInfo" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.rearrangeAlbum = function(t, e, o, i, s) {
  try {
   var r = {
    data:$.toJSON(e.data),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "collection/reArrangeImages/";
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:rearrangeAlbum" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.multiReArrangeAlbum = function(t, e, o, i, s) {
  try {
   var r = {
    data:$.toJSON(e.assetIds),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "collection/" + e.albumId + "/rearrange";
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:multirearrangeAlbum" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.getBulkDownloadHash = function(t, e, o, i) {
  try {
   var s = {
    data:t
   };
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "asset/multiPhotoDownload";
   this.params = s;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:multirearrangeAlbum" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.updateAssetInfo = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   var r = {
    data:$.toJSON(e.data),
    headers:{
     "content-type":"application/json"
    }
   };
   this.type = "POST";
   this.url = gon.staticContent.pict_service + "asset";
   this.params = r;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:updateAssetInfo" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.getUserInfo = function(t, e, o, i, s) {
  try {
   this.url = t;
   this.params = e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.async = void 0 != e.async ? e.async :!0;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getUserInfo" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getAssetInfoUsingIds = function(t, e, o, i, s, r) {
  try {
   this.type = t;
   this.url = e;
   this.params = o;
   this.callback = i;
   this.errorCallback = s;
   this.context = r;
   this.doAjax();
  } catch (n) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getAssetInfoUsingIds" err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 };
 this.makeGrantCall = function(t, e, o, i) {
  try {
   var s = {};
   s.data = t;
   this.type = "POST";
   this.url = gon.staticContent.library_url + "/corsproxy";
   this.params = s;
   this.maskit = !0;
   this.callback = e;
   this.errorCallback = o;
   this.context = i;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:makeGrantCall" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.getImageListCount = function(t, e, o) {
  try {
   this.url = gon.staticContent.pict_service + "asset/imageList?count=Y";
   this.callback = t;
   this.errorCallback = e;
   this.context = o;
   this.doAjax();
  } catch (i) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getImageListCount" err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 };
 this.getChangedModelAfterImageEdit = function(t, e, o, i, s, r) {
  try {
   var n = {};
   if ("POST" == t || "DELETE" == t) {
    n.data = $.toJSON(o);
    n.headers = {
     "content-type":"application/json"
    };
   }
   this.type = t;
   this.url = e;
   this.params = n;
   this.callback = i;
   this.errorCallback = s;
   this.context = r;
   this.doAjax();
  } catch (a) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:getChangedModelAfterImageEdit" err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 };
 this.updateImageEditInformation = function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.cache = {};
   this.url = t;
   this.params = e;
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:updateImageEditInformation" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.updateAlbumDate = function(t, e, o, i, s) {
  try {
   this.url = gon.staticContent.pict_service + "collection/" + e.abumId + "/createDateMillis/" + e.newDate;
   this.params = e;
   this.callback = o;
   this.errorCallback = i;
   this.type = "POST";
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:updateAlbumDate" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 };
 this.makeGlobalSessionCallForPrints = function(t, e, o, i, s) {
  try {
   this.url = t;
   this.params = e.data;
   this.callback = o;
   this.errorCallback = i;
   this.type = "POST";
   this.context = s;
   this.doAjax();
  } catch (r) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:makeGlobalSessionCallForPrints" err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.imageEdit = function(t, e, o, i, s, r) {
  try {
   var n = gon.staticContent.pict_service + "asset/" + e + "/multiimageedit/" + t, a = {};
   a.data = $.toJSON(o);
   a.headers = {
    "content-type":"application/json"
   };
   this.params = a;
   this.url = n;
   this.type = "POST";
   this.callback = i;
   this.errorCallback = s;
   this.context = r;
   this.doAjax();
  } catch (l) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:imageEdit" err_desc="' + l + '" err_stack="' + l.stack + '"');
  }
 };
 this.imageEditSaveAs = function(t, e, o, i, s, r) {
  try {
   var n = gon.staticContent.pict_service + "asset/" + e + "/multiedit/saveas?collectionId=" + t, a = {};
   a.data = $.toJSON(o);
   a.headers = {
    "content-type":"application/json"
   };
   this.params = a;
   this.url = n;
   this.type = "POST";
   this.callback = i;
   this.errorCallback = s;
   this.context = r;
   this.doAjax();
  } catch (l) {
   photoOrg.jsWarningLogger('"PROJECTS:AssetFetcher:imageEditSaveAs" err_desc="' + l + '" err_stack="' + l.stack + '"');
  }
 };
 this.updateCollectionTag = function(t, e, o, i, s) {
  try {
   var r = gon.staticContent.pict_service + "collection/" + t + "/addTags", n = {};
   n.data = $.toJSON(e);
   n.headers = {
    "content-type":"application/json"
   };
   this.params = n;
   this.url = r;
   this.type = "POST";
   this.callback = o;
   this.errorCallback = i;
   this.context = s;
   this.doAjax();
  } catch (a) {
   photoOrg.jsWarningLogger('"LIBRARY:AssetFetcher:updateCollectionTag" err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 };
}

function isAndroid() {
 var t = navigator.userAgent.toLowerCase(), e = t.match(/(android)/);
 return !!e;
}

function showingFlickrOverlay(t, e) {
 console.log("Called...showingFlickrOverlay");
 console.log("invoking flickr overlay by child window");
 eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_OVERLAY, {
  isflickr:!0,
  flot:t,
  flots:e
 });
}

function showingInstagramOverlay(t) {
 gon.instagram = {};
 window.instagramKeys = $.parseJSON(t);
 gon.instagram = $.parseJSON(t);
 eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_OVERLAY, {
  isinstagram:!0
 });
}

function handlePHOResponse() {}

function getRedirect_url(t) {
 var e = gon.staticContent.library_static_url;
 gon.staticContent.static_supported ? t && "ingestion" == t ? e = gon.staticContent.end_point_ingestion.replace("/ingestion", "") :t && "uploader" == t && (e = gon.staticContent.end_point_uploader.replace("/uploader", "")) :e = gon.staticContent.library_url;
 -1 == e.indexOf(window.location.hostname) && (e = replaceUrl(e));
 return e;
}

function replaceUrl(t) {
 var e = t.split("/"), o = window.location.hostname, i = window.location.protocol;
 if (i != e[0] || o != e[2]) {
  photoOrg.jsWarningLogger('"Uploader/Ingestion hostname/protocol doesn\'t match with the library hostname/protocol", currentHost="' + i + "//" + o + '", redirectUrl="' + t + '" ');
  e[0] = window.location.protocol;
  e[2] = window.location.hostname;
  t = e.join("/");
 }
 return t;
}

function libraryInit() {
 photoOrg.Util.init();
 photoOrg.Util.overrideGonValues();
 photoOrg.Util.getSelectedAlbums();
 photoOrg.Util.settingSelectedPics();
 var t = JST["templates/common/library/sub_header/sub_header"]();
 $("#sub_header_container").append(t);
 var e = JST["templates/common/library/sub_header/dropdowns"]();
 $("#sub_header_container").after(e);
 photoOrg.storePicsInLocalStorage = !0;
 if (photoOrg.preloadAPIErrorLogStr) {
  var o = JSON.parse(photoOrg.preloadAPIErrorLogStr), i = photoOrg.Util.guid();
  "401" != o.statusCode ? photoOrg.jsAjaxErrorLogger('"' + o.description + '", Noodle="' + i + '"', o.url, JSON.parse(o.response)) :photoOrg.jsWarningLogger('"' + o.description + '", httpStatusCode="401", errorCode="InvalidOauth2Token", Noodle="' + i + '"', o.url);
 }
 var s = photoOrg.Util.getBrowserSessionCookie("GSID");
 void 0 == $.jStorage.get(gon.staticContent.account_id + "_" + s + "dont_show_conformation") ? $.jStorage.set(gon.staticContent.account_id + "_" + s + "dont_show_conformation", !1) :$("#printsDontShow").prop("checked", $.jStorage.get(gon.staticContent.account_id + "_" + s + "dont_show_conformation"));
 photoOrg.oauthFetcher.checkOauthAvailable() || photoOrg.Util.getLoginRedirectUrl();
 var r = function() {
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && eventBus.trigger(eventBus.CUSTOM_EVENT_WINDOW_RESIZE, {
   resized:!0
  });
  eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_DETAILVIEW_RESIZE, {});
  $(".addphotos-dropdown").css({
   "max-width":""
  });
 };
 $(window).on("resize.globalResize", r);
 document.title = window.translations.photo_library;
 photoOrg.photoLib.init();
 $("#library #right-well").on("scrollstop", {
  latency:500
 }, function() {
  photoOrg.photoLib.onScrollLoadPics();
 });
 try {
  photoOrg.Util.setDateFormat();
  photoOrg.Util.initOverrideMoment();
 } catch (n) {}
 photoOrg.photoLib.showClusterView = !0;
 photoOrg.photoLib.showAlbumClusterView = !0;
 $(".mobile-cluster-wrapper").add(".cluster-dropdown-button").css("display", "inline-block");
 photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW || photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums ? photoOrg.photoLib.Util.albumsViewController = new photoOrg.albumsViewController() :(photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.CLUSTER_VIEW || photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos) && (photoOrg.photoLib.Util.clustersViewController = new photoOrg.clustersViewController());
 photoOrg.libraryAndStoriesTabView = new photoOrg.LibraryAndStoriesTabView({
  el:".photo-Org "
 });
 "true" == photoOrg.Util.getURLParameter("upl") && setTimeout(photoOrg.libraryAndStoriesTabView.attachPhotos(), 1e3);
 photoOrg.makeActionView = new photoOrg.MakeActionView({
  el:"#librayHeader"
 });
 photoOrg.photoLib.attachUploadListener();
 gon.staticContent.pict_ids = [];
 try {
  null != $.jStorage.get("selectedPics") && (gon.staticContent.pict_ids = $.jStorage.get("selectedPics"));
 } catch (n) {}
 photoOrg.photoLib.config.loadAsPhotoPicker || (photoOrg.libraryAppRouter = new photoOrg.LibraryAppRouter());
 photoOrg.projectTrayView = new photoOrg.SelectionTrayView();
 $(".project-selection-tray").css("display", "block");
 $(".pic-well").css("display", "none");
 $(".project-tray-mobile").css("display", "none");
 $(".selection-tray-mobile").css("display", "block");
 $(".mobile-footer").removeClass("hide");
 photoOrg.shareHandlerView = new photoOrg.ShareHandlerView();
 Backbone.emulateHTTP = !0;
 Backbone.emulateJSON = !0;
 photoOrg.mobileOverlay = new photoOrg.MobileOverlay({
  el:$("#mobile-overlay")
 });
 photoOrg.productConfirmationModal = new photoOrg.ProductConfirmationModal({});
 photoOrg.reArrangeFailConfirmation = new photoOrg.ReArrangeFailConfirmation({});
 photoOrg.photoLib.Util.isTouchDevice() && (photoOrg.mobileActionsMenu = new photoOrg.MobileActionsMenu({
  el:$("#mobile-actions-menu")
 }));
 photoOrg.photoLib.config.loadAsPhotoPicker || 0 != $("#upl_conf_id").length || photoOrg.photoLib.getConfirmation();
 window.onpagehide || "onpagehide" in window ? window.addEventListener("pagehide", function() {
  photoOrg.Util.onLibraryBeforeUnload();
 }, !1) :window.addEventListener("beforeunload", function() {
  photoOrg.Util.onLibraryBeforeUnload();
 }, !1);
 photoOrg.photoLib.setDropdownEvetns();
 var a = photoOrg.photoLib.setUploadDeviceSpecification();
 $(".device_text").text(a[0]);
 $(".mycomputer_link").addClass(a[1]);
 $(".mydevice_img").addClass(a[1]);
 $(document).foundation();
}

function success(t) {
 libraryInit();
 Backbone.history.start();
 t.globalInfo.tracking && (gon.staticContent.campaignName = t.globalInfo.tracking.campaign);
 set_library_omniture();
 $(window).trigger("USER_INFO_LOADED");
}

function updateGonFromStoreObject() {
 try {
  if ("undefined" != typeof store) {
   gon.staticContent.user_Type = store.userType;
   gon.staticContent.regType = store.regType;
   gon.staticContent.campaignName = store.campaignName;
  }
 } catch (t) {
  photoOrg.jsWarningLogger('"LIBRARY:library_assets: updateGonFromStoreObject", errorCode="LIBRARY:Library", err_desc="' + t + '" err_stack="' + t.stack + '"');
 }
}

function set_library_omniture() {
 var t = {
  pageName:"MY Photos",
  siteServiceName:"Library",
  primaryCategory:"My Photos",
  loginState:"YES",
  accountId:gon.staticContent.account_id,
  userType:gon.staticContent.user_Type,
  regType:gon.staticContent.regType
 };
 t.userInfo = {
  profile:{
   profileInfo:{
    loginState:"YES",
    userAccount:gon.staticContent.account_id,
    customerStatus:"",
    userType:gon.staticContent.user_Type,
    regType:gon.staticContent.regType,
    returnUser:""
   }
  }
 };
 photoOrg.omniture = new Omniture(t);
}

function error() {
 console.error("Error while getting global session data");
 libraryInit();
 Backbone.history.start();
}

function libraryInitialization() {
 photoOrg.showRotateIcons = !0;
 photoOrg.geoLocationCount = 0;
 if (photoOrg.oauthFetcher.checkOauthAvailable()) {
  var t = document.getElementById("refreshed");
  if (t && "no" == t.value) {
   t.value = "yes";
   photoOrg.photoLib.tryCount = 0;
   photoOrg.photoLib.retryLimit = 3;
   try {
    updateGonFromStoreObject();
    libraryInit();
    Backbone.history.start();
    set_library_omniture();
   } catch (t) {
    photoOrg.jsErrorLogger('"LIBRARY:library_assets: libraryInitialization", , errorCode="LIBRARY:LIBRARY", err_desc="' + t + '" err_stack="' + t.stack + '"');
   }
  } else if (t) {
   t.value = "no";
   location.reload();
  }
 } else photoOrg.Util.getLoginRedirectUrl();
}

function photoPickerInit() {
 if (!photoOrg.oauthInfo || photoOrg.oauthInfo.oa2 || photoOrg.oauthInfo.GSID) photoOrg.isRequestSentForOauthInfo = !0; else if ($.cookie("oa2")) {
  photoOrg.oauthInfo.oa2 = $.cookie("oa2");
  photoOrg.oauthInfo.GSID = $.cookie("GSID");
  photoOrg.isRequestSentForOauthInfo = !0;
 } else {
  photoOrg.isRequestSentForOauthInfo = !0;
  var t = gon.staticContent.library_url + "/getOauthInfo", e = function(t) {
   t.oauthInfo && (photoOrg.oauthInfo = t.oauthInfo);
  }, o = function() {
   try {
    photoOrg.jsWarningLogger('"Got unauthorized response in the photopicker getOauhtInfo call: response:' + photoOrg.Util.getFormattedMessage($.toJSON(response)) + "'");
   } catch (t) {}
  };
  $.ajax({
   url:t,
   dataType:"json",
   type:"GET",
   async:!1,
   success:$.proxy(e, this),
   error:$.proxy(o, this)
  });
 }
 var i = JST["templates/common/library/sub_header/sub_header"]();
 $("#sub_header_container").append(i);
 var s = JST["templates/common/library/sub_header/dropdowns"]();
 $("#sub_header_container").after(s);
 $(document).foundation();
 photoOrg.Util.init();
 photoOrg.Util.initOverrideMoment();
 photoOrg.photoLib.init();
 photoOrg.libraryAndStoriesTabView = new photoOrg.LibraryAndStoriesTabView({
  el:".photo-Org "
 });
 $("#" + photoOrg.photoLib.config.divId).css({
  padding:0
 });
 $("#sub_header_container .albums").removeClass("selected");
 $("#sub_header_container .photo_videos").addClass("selected");
 var r = r || {};
 if (!r.load) {
  r.load = function() {};
  $(".actionContainer .select_count .select_count_sec").hide();
  $(".photo-Org .picker-done-button").addClass("disable-greybtn");
 }
 var n = photoOrg.photoLib.config.pickerHeight;
 if ("NAN" !== n) {
  $("#scrollControll").height(n - $("#librayHeader").height());
  $("#scrollControll").css("overflow", "auto");
 }
 $(".photo-Org .close").show();
 photoOrg.makeActionView = getMakeactionView();
 photoOrg.projectTrayView = void 0;
 var a = function() {
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && eventBus.trigger(eventBus.CUSTOM_EVENT_WINDOW_RESIZE, {
   resized:!0
  });
  eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_DETAILVIEW_RESIZE, {});
  $(".addphotos-dropdown").css({
   "max-width":""
  });
 };
 $(window).on("resize.globalResize", a);
 photoOrg.photoLib.showClusterView = !0;
 photoOrg.photoLib.showAlbumClusterView = !0;
 $(".mobile-cluster-wrapper").add(".cluster-dropdown-button").css("display", "inline-block");
 photoOrg.photoLib.Util.clustersViewController = new photoOrg.clustersViewController();
 photoOrg.photoLib.Util.albumsViewController = new photoOrg.albumsViewController();
 photoOrg.photoLib.attachUploadListener();
 $("#library #right-well").on("scrollstop", {
  latency:500
 }, function() {
  photoOrg.photoLib.onScrollLoadPics();
 });
 try {
  photoOrg.photoLib.setDropdownEvetns();
  photoOrg.photoLib.changePickerHeaderPrints();
  var l = photoOrg.photoLib.setUploadDeviceSpecification();
  $(".device_text").text(l[0]);
  $(".mycomputer_link").addClass(l[1]);
  $(".mydevice_img").addClass(l[1]);
 } catch (c) {
  console.log("photoPickerInit :: " + c);
 }
 photoOrg.photoLib.config.isGuestFlow && photoOrg.photoLib.mrbPickerFlow();
 try {
  var h = $.jStorage.get(gon.staticContent.account_id + "_state");
  if (h) {
   photoOrg.photoLib.Util.historyState = h;
   h.pg == photoOrg.constants.CLUSTER_VIEW ? photoOrg.makeActionView.handleClusterView() :h.pg == photoOrg.constants.ALBUMS_VIEW || h.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || h.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW || h.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW ? photoOrg.makeActionView.handleAlbumsView(h.pg) :(h.pg == photoOrg.constants.SINGLE_ALBUM_VIEW || h.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || h.pg == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || h.pg == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) && photoOrg.makeActionView.handleSingleAlbumView();
  } else gon.staticContent.picker_default_to_albums ? photoOrg.makeActionView.handleAlbumsView() :photoOrg.makeActionView.handleClusterView();
 } catch (c) {
  photoOrg.jsErrorLogger('"LIBRARY:library_assets: photoPickerInit", , errorCode="LIBRARY:PICKER", err_desc="' + c + '" err_stack="' + c.stack + '"');
 }
}

function getMakeactionView() {
 return new photoOrg.MakeActionView({
  el:".libHeaderContainer"
 });
}

var photoOrg = photoOrg || {};

photoOrg.pict = Backbone.Model.extend({
 defaults:{}
});

photoOrg.pictCollection = Backbone.Collection.extend({
 model:photoOrg.pict
});

photoOrg.selectedAssets = Backbone.Collection.extend({
 model:photoOrg.pict
});

photoOrg.sortedAssets = {};

photoOrg.shareModelResponseFormat = {
 prepareMockAssetObject:function(t, e, o) {
  var i = {
   createDate:"null",
   updateDate:"null",
   version:4,
   markedForDelete:!1,
   dataCenter:e.dc,
   ownerAccountId:t.ownerId || t[0].ownerAccountId,
   userTags:[ {
    value:"",
    key:"fileName"
   }, {
    value:t[1].assetIdList[o].caption,
    key:"caption"
   } ],
   currentImageInfo:{
    currentWidth:t.width,
    currentHeight:t.height
   },
   systemTags:[ {
    value:"",
    key:"uploadTypeCode"
   }, {
    value:"",
    key:"displayOrder"
   }, {
    value:"",
    key:"journalDeveloper"
   } ],
   exifTags:[],
   assetType:"PICTURE",
   files:[ {
    fileType:"HIRES",
    url:t.thumbnailEncryption,
    width:t.width,
    height:t.height,
    size:t.size
   }, {
    fileType:"THUMBNAIL",
    url:t.thumbnailEncryption
   } ],
   parentCollectionReferences:[ {
    ownerAccountId:t.ownerId,
    collectionId:e.albumId
   } ],
   faces:[],
   dateTaken:0,
   mangledHrUrl:"is=RKKtr%253AxxrYz%253DKAmDZHKrfr%253D-DgjfDUXxWPxm7rr-w7xRzpHr_eaelxAGPPlJ7g-Qage-J%253Dlo-AelA-J%253D7eDeQ0%253DePafVtB//ar=1/pe/of=49",
   id:""
  };
  i.createDate = t[1].createDate;
  i.updateDate = t[1].updateDate;
  t = t[1].assetIdList[o];
  i.id = t.assetId;
  i.assetType = t.assetType;
  i.parentCollectionReferences[0].ownerAccountId = t.ownerId;
  i.parentCollectionReferences[0].collectionId = e.albumId;
  i.files[0].url = photoOrg.Util.getThumbnailURL(t.thumbnailEncryption);
  i.files[0].width = i.files[1].width = t.width;
  i.files[0].height = i.files[1].height = t.height;
  i.files[0].size = i.files[1].size = t.size;
  i.files[1].url = t.thumbnailEncryption;
  return i;
 }
};

Collection = Backbone.Collection.extend({
 getAtrributeValues:function(t) {
  var e = new Array();
  this.each(function(o) {
   e.push(o[t]);
  });
  return e;
 },
 getObjectByAttributeValue:function(t, e) {
  for (var o = 0; o < this.length; o++) {
   var i = this.at(o);
   if (i[t] == e) return i;
  }
  return null;
 },
 getJsonArray:function() {
  var t = [];
  this.each(function(e) {
   t.push(e.toJson());
  });
  return t;
 },
 getHeightsFromSizes:function(t) {
  var e = [];
  for (var o in t) e.push(t[o].id.split("x")[0]);
  return e;
 },
 isGreaterThan:function(t, e) {
  var o = this.getHeightsFromSizes(t), i = !1;
  if (o.length > 0) for (var s in o) o[s] >= e && (i = !0);
  return i;
 }
});

var photoOrg = photoOrg || {};

photoOrg.AlbumFetcher = {
 minAsset:1e3,
 pages:[],
 expandedPages:{},
 minAlbumsPerPage:25,
 clusterPadding:2,
 totalAlbumCount:0,
 processedClusters:0,
 processedClustersMap:{},
 sortOrder:"descending",
 preloadFirstClustersAlbums:!0,
 timeZoneOffset:-1 * new Date().getTimezoneOffset(),
 setupPages:function(t) {
  this.pages = [];
  if (photoOrg.makePreMonthIndexCall) {
   console.log("album_fetcher...preloadAllClusters");
   this.preloadAllClusters = !1;
   if (photoOrg.albumsClustersInfo) {
    console.log("setupPages - if");
    this.onSetupPages(photoOrg.albumsClustersInfo, t);
   } else {
    console.log("setupPages - else");
    photoOrg.albumCallback = t;
    photoOrg.myAlbumCallbackHandler = this.onSetupPages.bind(this);
   }
  } else {
   var e = "limit=0&minCollection=0&timezoneOffset=" + this.timeZoneOffset;
   this.sortOrder = $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder");
   this.sortCriteria = $.jStorage.get(gon.staticContent.account_id + "_av_sortCriteria");
   this.sortCriteria && "updateDate" == this.sortCriteria ? e += "&searchCriteria=" + this.sortCriteria :this.sortOrder && (e += "&sortOrder=" + this.sortOrder);
   var o = new AssetFetcher();
   o.fetchMonthlyAlbums("", e, $.proxy(this.onSetupPages, this), $.proxy(this.onError, this), t);
  }
 },
 allClustersFailureCallback:function(t) {
  this.pages = [];
  photoOrg.preloadAlbums = !1;
  var e = "limit=0&minCollection=0&timezoneOffset=" + photoOrg.AlbumFetcher.timeZoneOffset;
  this.sortCriteria ? e += "&searchCriteria=" + this.sortCriteria :this.sortOrder && (e += "&sortOrder=" + this.sortOrder);
  var o = new AssetFetcher();
  o.fetchMonthlyAlbums("", e, $.proxy(this.onSetupPages, this), $.proxy(this.onError, this), t);
 },
 changeSortCriteria:function(t, e) {
  photoOrg.changeSort = !0;
  photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.makeActionView.handleAlbumsView(void 0, e, t) :this.updateUrl(t, e);
 },
 updateUrl:function(t, e) {
  var o = photoOrg.photoLib.Util.historyState;
  t && (o.so = t);
  e && (o.sc = e);
  photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.Util.appendHashtoURL(o);
 },
 setupPagesData:function(t) {
  this.totalAlbumCount = 0;
  {
   var e = 0, o = [], i = 0, s = _.size(t) - 1, r = 0, n = 0, a = this;
   Object.keys(t);
  }
  photoOrg.minCollectionPerPage && (this.minAlbumsPerPage = photoOrg.minCollectionPerPage);
  _.each(t, function(t, l) {
   var c = parseInt(t.collectionCount, 10);
   a.totalAlbumCount += c;
   e += c;
   if (this.pages.length > 0 && r == s) if (c > this.minAlbumsPerPage) {
    i += o.length;
    e = c;
    o = [];
    n++;
    o.push({
     date:l,
     totalAlbums:c,
     pageNo:n
    });
   } else {
    o.push({
     date:l,
     totalAlbums:c,
     pageNo:n
    });
    this.pages[n] = {
     skip:i,
     limit:o.length,
     clusters:o
    };
   } else o.push({
    date:l,
    totalAlbums:c,
    pageNo:n
   });
   if (photoOrg.currentMonth && l == photoOrg.currentMonth) {
    photoOrg.photoLib.Util.albumsViewController.currentPage = n;
    photoOrg.currentMonth = "";
   }
   if (e > this.minAlbumsPerPage || r >= s) {
    var h = o.length;
    this.pages.push({
     skip:i,
     limit:h,
     clusters:o
    });
    if (r + 1 != s) {
     i += h;
     e = 0;
     o = [];
     n++;
    }
   }
   r++;
  }, this);
 },
 onSetupPages:function(t, e) {
  try {
   t = JSON.parse(t);
  } catch (o) {}
  var i = t.entityMap;
  photoOrg.albumFetcherObj.setupPagesData(i);
  e(photoOrg.albumFetcherObj.pages);
 },
 getClusterPage:function(t, e) {
  photoOrg.albumView.responseReturned = !1;
  if (photoOrg.albumsInfo && this.preloadFirstClustersAlbums) {
   this.preloadFirstClustersAlbums = !1;
   e(photoOrg.albumsInfo);
  } else this.getPageClusters(t, e);
 },
 getPageClusters:function(t, e) {
  var o = this.pages[t];
  o ? this.getClusters(o.skip, o.limit, function(t) {
   if (t) {
    photoOrg.albumsInfo = t;
    e(t);
   } else {
    alert("empty album info");
    photoOrg.albumsInfo = null;
   }
  }) :console.log("No page data for index: ", t);
 },
 getClusters:function(t, e, o, i) {
  var s = "&projection=createDate,assetType,files,faces,ownerAccountId,parentCollectionReferences,assetIdList,userTags,firstAssetId,updateDate,systemTags", r = "skip=" + t + "&limit=" + e + "&minCollection=" + this.minAsset + "&timezoneOffset=" + this.timeZoneOffset + s, n = $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder"), a = $.jStorage.get(gon.staticContent.account_id + "_av_sortCriteria");
  if (a && "updateDate" == a) {
   this.sortCriteria = a;
   r += "&searchCriteria=" + this.sortCriteria;
  } else if (n) {
   this.sortOrder = n;
   r += "&sortOrder=" + this.sortOrder;
  }
  photoOrg.photoLib.updateAlbumFilter(n, a);
  photoOrg.photoLib.config.loadAsPhotoPicker && (s = "&projection=createDate,assetType,files,faces,ownerAccountId,dateTaken,systemTags,assetIdList,firstAssetId,updateDate,userTags");
  var l = new AssetFetcher();
  l.fetchMonthlyAlbums("", r, o, $.proxy(this.onError, this), i);
 },
 onError:function(t) {
  console.log("Error making clusters request: ", t);
 }
};

metrics_ary = [];

metrics_hsh = {};

var photoOrg = photoOrg || {};

photoOrg.ClusterFetcher = {
 minAsset:10,
 pages:[],
 expandedPages:{},
 assetsPerPage:100,
 clusterPadding:2,
 expandedClusterPadding:10,
 totalAssetCount:0,
 processedClusters:0,
 processedClustersMap:{},
 sortCriteria:"createDate",
 preloadFirstClustersAssets:!0,
 preloadAllClusters:!0,
 timeZoneOffset:-1 * new Date().getTimezoneOffset(),
 setupPages:function(t) {
  this.pages = [];
  this.expandedPages = {};
  var e = photoOrg.photoLib.Util.historyState, o = $.jStorage.get(gon.staticContent.account_id + "_" + e.pg + "_sortCriteria");
  o && (this.sortCriteria = o);
  this.updateDropdownSelection();
  var i = "&limit=0&minAsset=0&sortCriteria=" + this.sortCriteria + "&timezoneOffset=" + this.timeZoneOffset, s = new AssetFetcher();
  s.fetchClusters("", i, $.proxy(this.onSetupPages, this), $.proxy(this.onError, this), t);
 },
 allClustersFailureCallback:function(t) {
  this.pages = [];
  this.expandedPages = {};
  var e = $.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria");
  e && (this.sortCriteria = e);
  this.updateDropdownSelection();
  var o = "&limit=0&minAsset=0&sortCriteria=" + this.sortCriteria + "&timezoneOffset=" + this.timeZoneOffset, i = this.getAssetFectcher();
  i.fetchClusters("", o, $.proxy(this.onSetupPages, this), $.proxy(this.onError, this), t);
 },
 getAssetFectcher:function() {
  return new AssetFetcher();
 },
 changeSortCriteria:function() {
  $("#choosedSortOption").attr("data-value", this.sortCriteria);
  photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.makeActionView.handleClusterView() :this.updateUrl();
 },
 updateUrl:function() {
  var t = photoOrg.photoLib.Util.historyState;
  t.so = this.sortCriteria;
  photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.Util.appendHashtoURL(t);
 },
 updateDropdownSelection:function() {
  var t = $("#dateSorting");
  t.find("li").removeClass("selected");
  t.find('a[data-value="' + this.sortCriteria + '"]').parent().addClass("selected");
  var e = $(".date-sorting .sort-option");
  e.text("dateTaken" === this.sortCriteria ? window.translations.detail_view.date_taken :window.translations.detail_view.date_added);
 },
 onSetupPages:function(t, e) {
  try {
   t = JSON.parse(t);
  } catch (o) {}
  var i = t.entityMap;
  this.setupPagesData(i);
  this.setupExpandedPagesData(i);
  e(this.pages);
 },
 setupPagesData:function(t) {
  this.totalAssetCount = 0;
  var e = 0, o = [], i = 0, s = _.size(t) - 1, r = 0, n = 0, a = this;
  _.each(t, function(t, l) {
   var c = parseInt(t.assetCount, 10);
   a.totalAssetCount += c;
   var h = Math.min(c, this.minAsset), d = Math.max(c - this.minAsset, 0);
   e += h;
   o.push({
    date:l,
    collapsedAssets:h,
    expanededAssets:d,
    totalAssets:c,
    pageNo:n
   });
   if (e > this.assetsPerPage || r >= s) {
    var p = o.length;
    this.pages.push({
     skip:Math.max(i - this.clusterPadding, 0),
     limit:p + (i > 0 ? this.clusterPadding :0),
     clusters:o
    });
    i += p;
    e = 0;
    o = [];
    n++;
   }
   r++;
  }, this);
 },
 setupExpandedPagesData:function(t) {
  var e = [];
  for (var o in t) {
   var i = t[o];
   i.date = o;
   e.push(i);
  }
  _.each(this.pages, function(t, o) {
   t.clusters.length - 1;
   _.each(t.clusters, function(t, i) {
    if (t.expanededAssets > 0) {
     var s = t.date;
     this.expandedPages[s] = {
      pageNo:o,
      pages:[]
     };
     _.each(this.pages, function(r, n) {
      var a = 0, l = r.skip;
      if (n >= o) {
       if (n === o) {
        var c = i, h = [], d = 0;
        if (c > 0) {
         for (var p = 0; c > p; p++) {
          var u = r.clusters[p];
          d += u.collapsedAssets;
         }
         h.push({
          type:"clusters",
          skip:r.skip,
          limit:c
         });
         l = r.skip + c;
        }
        var g = t.collapsedAssets + t.expanededAssets;
        a = this.assetsPerPage - d;
        var m = Math.max(Math.min(g, a), 2 * this.minAsset);
        h.push({
         type:"cluster",
         skip:0,
         limit:m,
         assetCount:g
        });
        a -= m;
        var f = g - m, _ = 0, b = !1;
        if (f > 0) {
         var v = m, O = 0;
         this.expandedPages[s].pages.push(h);
         a = this.assetsPerPage;
         h = [];
         for (var p = 0; f > p; p++) {
          O++;
          if (O > a || p >= f - 1) {
           h.push({
            type:"cluster",
            skip:Math.max(v - this.expandedClusterPadding, 0),
            limit:O + (v > 0 ? this.expandedClusterPadding :0),
            onNewPage:!0,
            assetCount:g
           });
           this.expandedPages[s].pages.push(h);
           v += O;
           if (O > a) {
            O = 0;
            h = [];
            a = this.assetsPerPage;
           }
           _ += O;
          }
         }
        } else {
         b = !0;
         this.expandedPages[s].pages.push(h);
        }
        a -= _;
        l += 1;
        if (a > 0) {
         b = !1;
         for (var A = 0, w = l, O = 1, p = 0; a > p; p++) {
          var y = e[w];
          if (!y) break;
          var C = parseInt(y.assetCount, 10), S = Math.min(C, this.minAsset);
          A += S;
          p < this.clusterPadding && (a += S);
          if (A >= a || p >= a - 1 || !e[w + 1]) {
           h.push({
            type:"clusters",
            skip:l,
            limit:O
           });
           l += O;
           a = 0;
           break;
          }
          O += 1;
          w += 1;
         }
        }
        clusterCount = 1;
        if (b) {
         h.push({
          type:"clusters",
          skip:l,
          limit:this.clusterPadding
         });
         clusterCount += this.clusterPadding;
         l += this.clusterPadding;
         d = 0;
        }
        for (var p = l; p < e.length; p++) {
         var L = e[p], C = parseInt(L.assetCount, 10), S = Math.min(C, this.minAsset);
         d += S;
         clusterCount++;
         if (d > this.assetsPerPage || p >= e.length - 1) {
          this.expandedPages[s].pages.push([ {
           type:"clusters",
           skip:Math.max(l - this.clusterPadding, 0),
           limit:clusterCount + (l > 0 ? this.clusterPadding :0)
          } ]);
          l += clusterCount;
          d = 0;
          clusterCount = 0;
         }
        }
       }
      } else this.expandedPages[s].pages.push([ {
       type:"clusters",
       skip:r.skip,
       limit:r.limit
      } ]);
     }, this);
    }
   }, this);
  }, this);
 },
 getClusterPage:function(t, e) {
  this.getPageClusters(t, e);
 },
 getPageClusters:function(t, e) {
  var o = this.pages[t];
  o ? this.getClusters(o.skip, o.limit, function(t) {
   t && e(t.entityMap);
  }) :console.log("No page data for index: ", t);
 },
 getClusterExpandedPage:function(t, e, o) {
  for (var i = this.expandedPages[t].pages, s = i[e], r = s.length, n = 0; r > n; n++) {
   var a = s[n], l = a.type, c = {
    requests:r,
    requestType:l,
    onNewPage:a.onNewPage,
    date:t,
    assetCount:a.assetCount,
    skip:a.skip,
    callback:o
   };
   "clusters" === l ? this.getClusters(a.skip, a.limit, $.proxy(function(t, e) {
    this.prepareClusterData(t, e);
   }, this), c) :"cluster" === l ? this.getCluster(a.skip, a.limit, t, $.proxy(function(t, e) {
    this.prepareClusterData(t, e);
   }, this), c) :console.log("Unknown request type for cluster. Type: ", l);
  }
 },
 getClusterDetailView:function(t, e, o) {
  for (var i = this.expandedPages[t].pages, s = i[e], r = s.length, n = 0; r > n; n++) {
   var a = s[n], l = a.type;
   "cluster" === l && this.getClusterForDetailView(a.skip, a.assetCount, t, o);
  }
 },
 getDetailedViewInfo:function(t, e, o) {
  var t = t;
  this.getClusterForDetailView(0, t, e, o);
 },
 prepareClusterData:function(t, e) {
  if ("clusters" === e.requestType) for (var o in t.entityMap) o in this.processedClustersMap || (this.processedClustersMap[o] = t.entityMap[o]); else {
   for (var i = t.entities, s = 0; s < i.length; s++) {
    var r = i[s];
    r.inExpandedCluster = !0;
    r.isLastAsset = !1;
    r.onNewPage = !1;
    s + e.skip >= e.assetCount - 1 && (r.isLastAsset = !0);
    e.onNewPage && (r.onNewPage = !0);
   }
   this.processedClustersMap[e.date] = {
    assetCount:e.assetCount,
    assetList:i
   };
  }
  if (this.processedClusters !== e.requests - 1) this.processedClusters++; else {
   var n = Object.keys(this.processedClustersMap);
   n.sort(function(t, e) {
    return "undefined" == t ? 1 :"undefined" == e ? -1 :moment(e, "YYYY-M-D").diff(moment(t, "YYYY-M-D"));
   });
   for (var a = {}, s = 0; s < n.length; s++) {
    var o = n[s];
    a[o] = this.processedClustersMap[o];
   }
   e.callback(a);
   this.processedClusters = 0;
   this.processedClustersMap = {};
  }
 },
 getClusters:function(t, e, o, i) {
  var s = "&projection=createDate,assetType,files,faces,ownerAccountId,parentCollectionReferences";
  photoOrg.photoLib.config.loadAsPhotoPicker && (s = "&projection=createDate,assetType,files,faces,ownerAccountId,dateTaken,systemTags,userTags");
  var r = "&skip=" + t + "&limit=" + e + "&minAsset=" + this.minAsset + "&sortCriteria=" + this.sortCriteria + "&timezoneOffset=" + this.timeZoneOffset + s, n = new AssetFetcher();
  n.fetchClusters("", r, o, $.proxy(this.onError, this), i);
 },
 getCluster:function(t, e, o, i, s) {
  var r = "&projection=createDate,assetType,files,faces,ownerAccountId,parentCollectionReferences";
  photoOrg.photoLib.config.loadAsPhotoPicker && (r = "&projection=createDate,assetType,files,faces,ownerAccountId,dateTaken,systemTags,");
  var n = "date=" + this.sortCriteria + "&limit=" + e + "&skip=" + t + "&timezoneOffset=" + this.timeZoneOffset + r, a = new AssetFetcher();
  a.getMoreClusters("", n, o, i, $.proxy(this.onError, this), s);
 },
 getClusterForDetailView:function(t, e, o, i, s) {
  var r = "date=" + this.sortCriteria + "&limit=" + e + "&skip=" + t + "&timezoneOffset=" + this.timeZoneOffset, n = new AssetFetcher();
  n.getMoreClusters("", r, o, i, $.proxy(this.onError, this), s);
 },
 onError:function(t) {
  console.log("Error making clusters request: ", t);
 }
};

var photoOrg = photoOrg || {};

photoOrg.startTime = new Date().getTime();

photoOrg.Util = new function() {
 var t = 900;
 this.error_msg = "";
 this.warn_msg = "";
 this.info_msg = "";
 this.err_msg = "";
 this.defaultExperyTime = 126e5;
 this.thumbnailAvailableSizes = [ 200, 350, 480, 640, 960 ];
 this.recentUploadedAlbumId = "";
 this.fromUploadMore = !1;
 this.newUser = !1;
 this.date_format = "MMM YYYY, DD HH:MM A";
 this.isListeningDropDownElement = !1;
 window.jsLogger = {
  invoke:function(t, e, o) {
   self = this;
   self.level = t;
   if (e) {
    self.message = e;
    self.callback = o;
    return jQuery.ajax({
     type:"post",
     beforeSend:function() {},
     data:{
      level:t,
      message:e
     },
     url:photoOrg.Util.getLibraryServiceHost() + "/logger"
    }).done(function() {
     self.callback && self.callback();
    }).fail(function(t) {
     if (self.level && "error" == self.level) {
      console.log("Exception occured while posting error log, responseText: " + t.responseText);
      photoOrg.Util.err_msg += self.message;
     }
     if (self.level && "warn" == self.level) {
      console.log("Exception occured while posting warn log, responseText: " + t.responseText);
      photoOrg.Util.warn_msg += self.message;
     }
     if (self.level && "info" == self.level) {
      console.log("Exception occured while posting info log, responseText: " + t.responseText);
      photoOrg.Util.info_msg += self.message;
     }
    });
   }
  },
  debug:function(t, e) {
   return this.invoke("debug", t, e);
  },
  info:function(t, e) {
   return this.invoke("info", t, e);
  },
  warn:function(t, e) {
   return this.invoke("warn", t, e);
  },
  error:function(t, e) {
   return this.invoke("error", t, e);
  },
  fatal:function(t, e) {
   return this.invoke("fatal", t, e);
  }
 };
 setInterval(function() {
  console.log("Triggered jsLogger Timmer:" + new Date());
  if (photoOrg) {
   photoOrg.Util.warn_msg && jsLogger.warn(photoOrg.Util.warn_msg, function() {
    photoOrg.Util.warn_msg = "";
   });
   photoOrg.Util.info_msg && jsLogger.info(photoOrg.Util.info_msg, function() {
    photoOrg.Util.info_msg = "";
   });
   photoOrg.Util.err_msg && jsLogger.error(photoOrg.Util.err_msg, function() {
    photoOrg.Util.err_msg = "";
   });
  }
 }, 3e5);
 this.adjustHeader = function() {
  var t = $(window).height(), e = $(window).outerWidth(!0), o = $(".global-header").height();
  $(".lib-left-col").addClass("fixed_tray");
  $("#sub_header_container").removeClass("makeFixedDiv_photo_org");
  photoOrg.Util.isGlobalHeaderMobileLayout() && (o = $(".device-global-header .tab-bar").height());
  var i = $("#sub_header_container").outerHeight(!0), s = t;
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   var r = $(".actionContainer").outerHeight(!0), n = r;
   $("#sub_header_container").css("top", r + "px");
   var a = $(".handlePrevNext").outerHeight(!0);
   s = $(window).height() - n - a;
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
    s -= $(".sav_album_capton_row").outerHeight(!0);
    $("#right-well").css({
     "padding-right":"0px"
    });
   } else {
    var l = $(window).width();
    640 >= l && $(".photo-Org #mobAddProject .sendToBuilder").isOnScreen() && (s -= $("#mobAddProject").height());
    $("#right-well").css({
     "padding-right":"15px",
     "padding-left":"30px"
    });
    $("#right-well").append($("#loadingBar"));
   }
  } else var n = o + i;
  if (photoOrg.Util.isMobileLayout()) {
   var c = $(".mobSection").outerHeight(!0);
   0 == c && (c = 50);
   $("#right-well").css("padding-bottom", c + "px");
   $("#selected-asset-container").css("margin-bottom", c + "px");
  }
  void 0 != gon.staticContent.pict_ids && void 0 != photoOrg.photoLib.selectedImages && (null != gon.staticContent.pict_ids && 0 == gon.staticContent.pict_ids.length && null != photoOrg.photoLib.selectedImages && photoOrg.photoLib.selectedImages.length > 0 ? this.selected_count = photoOrg.photoLib.selectedImages.length :null != gon.staticContent.pict_ids && (this.selected_count = gon.staticContent.pict_ids.length));
  if ($(window).width() <= 640 && this.selected_count > 0) {
   var h = 0;
   void 0 != gon.staticContent.pict_ids && void 0 != photoOrg.photoLib.selectedImages && (null != gon.staticContent.pict_ids && null != photoOrg.photoLib.selectedImages && photoOrg.photoLib.selectedImages.length > gon.staticContent.pict_ids.length ? h = photoOrg.photoLib.selectedImages.length :null != gon.staticContent.pict_ids && (h = gon.staticContent.pict_ids.length));
  } else if ("none" == $(".mobile-footer").css("display") && "none" == $(".encourage_user_to_upload_text").css("display")) {
   $(".lib-left-col").css("width", "100px");
   $("#sub_header_container.sub-header-wrapper").css("width", "100%").css("width", "-=" + $(".lib-left-col").width());
   $("#right-well").css("left", $(".lib-left-col").width());
   $(".selection-tray-visible #loadingBar").css("left", $(".lib-left-col").width());
  } else $("#sub_header_container.sub-header-wrapper").css("width", "100%");
  photoOrg.photoLib.projectTrayHeight = s;
  photoOrg.photoLib.estimatedHeaderHeight = n;
  var d = parseInt($("#affix-leftCol").css("marginTop"));
  s -= d;
  $(".sorte-container").length && (s -= $(".sorte-container").outerHeight());
  $("#affix-leftCol").parent().css({
   top:o + "px"
  });
  $("#library,.sorte-container.sub-header-wrapper").css("top", o + "px", "important");
  if (640 >= e) ; else if (photoOrg.photoLib.config.loadAsPhotoPicker) $("#twoWellContainer").width() > 0 && $("#right-well").css("width", $("#twoWellContainer").width() + "px"); else if ($(".lib-left-col").hasClass("hidden")) {
   photoOrg.rearrange_assets_view && !photoOrg.rearrange_assets_view.reArrangeMode ? $(".mobile-footer").addClass("hide") :void 0 == photoOrg.rearrange_assets_view && $(".mobile-footer").addClass("hide");
   $(".albumsGridList").addClass("full");
   $(".pagination-bar-wrapper").addClass("full").removeClass("selected-assets");
  } else if ($("#right-well").hasClass("full")) {
   $(".mobile-footer").removeClass("hide");
   $(".albumsGridList").removeClass("full");
   $(".pagination-bar-wrapper").removeClass("full").addClass("selected-assets");
  }
  photoOrg.photoLib.config.loadAsPhotoPicker && $("#affix-leftCol").css({
   top:$("#assetGrid").offset().top + "px"
  });
  var p = $(".edit-links").outerHeight(!0), u = $(".well-count").outerHeight(!0);
  $("#selected-asset-container").css({
   height:s - p - u + "px",
   padding:"0px"
  });
  if (600 > e) {
   parseInt($("#affix-leftCol").css("top")) || 0;
  }
 };
 this.oauthInfoInit = function() {
  this.init();
 };
 this.init = function() {
  try {
   photoOrg.refreshTokenTime = photoOrg.oauthInfo && photoOrg.oauthInfo.refreshTime ? 1e3 * photoOrg.oauthInfo.refreshTime :gon && gon.staticContent && gon.staticContent.refreshTokenTime && gon.staticContent.refreshTokenTime > 0 ? photoOrg.Util.defaultExperyTime :photoOrg.Util.defaultExperyTime;
  } catch (t) {
   photoOrg.refreshTokenTime = photoOrg.Util.defaultExperyTime;
   photoOrg.jsErrorLogger('"Got an error while caliculation refreshToken time",errorCode="LIBRARY:UTILS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 };
 this.maskpII = function(t) {
  if (t) try {
   "string" == typeof t && (t = JSON.parse(t));
  } catch (e) {
   t = "xxxx";
   return t;
  }
  for (key in t) try {
   if (-1 !== key.toString().toLowerCase().indexOf("name") || -1 !== key.toString().toLowerCase().indexOf("mail") || -1 !== key.toString().indexOf("guid") || "data" == key.toString() && "object" != typeof t[key]) {
    t[key] = "xxxx";
    console.log(key + " , " + t[key]);
   }
   if ("object" == typeof t[key]) {
    t[key] && t[key].data && (t[key] = "xxxx");
    t[key] = this.maskpII(t[key]);
   }
  } catch (e) {
   photoOrg.jsErrorLogger(t);
  }
  return t;
 };
 this.trackLinksAndButtons = function(t, e) {
  if ("walgreens_us" != gon.staticContent.websiteName && 0 != gon.staticContent.s_account) try {
   digitalData.library || (digitalData.library = {});
   photoOrg.photoLib.config.loadAsPhotoPicker && (t = "photo-picker : " + t);
   digitalData.library.featureClickType = t;
   _satellite.track(e);
  } catch (o) {
   console.log(o);
  }
 };
 this.delayTrackOmnitureForPage = function(t) {
  setTimeout(function() {
   if (photoOrg && photoOrg.omniture) photoOrg.omniture.trackOmniturePageName(t); else if (photoOrg && photoOrg.photoLib.config.loadAsPhotoPicker) {
    photoOrg.pickerOmniture || (photoOrg.pickerOmniture = new Omniture());
    photoOrg.pickerOmniture.trackPhotoPickerPageName(t);
   } else console.log("Ominture tracking failed because it was undefined");
  }, 5e3);
 };
 this.getThumbnailDimension = function(t) {
  console.log(t);
  try {
   if (t == photoOrg.Util.thumbnailAvailableSizes[0] || t < photoOrg.Util.thumbnailAvailableSizes[0]) return photoOrg.Util.thumbnailAvailableSizes[0];
   if (t > photoOrg.Util.thumbnailAvailableSizes[photoOrg.Util.thumbnailAvailableSizes.length - 1]) return photoOrg.Util.thumbnailAvailableSizes[photoOrg.Util.thumbnailAvailableSizes.length - 1];
   for (var e = 0; e < photoOrg.Util.thumbnailAvailableSizes.length; e++) {
    if (t == photoOrg.Util.thumbnailAvailableSizes[e]) return photoOrg.Util.thumbnailAvailableSizes[e];
    if (t == photoOrg.Util.thumbnailAvailableSizes[e + 1]) return photoOrg.Util.thumbnailAvailableSizes[e + 1];
    if (t > photoOrg.Util.thumbnailAvailableSizes[e] && t < photoOrg.Util.thumbnailAvailableSizes[e + 1]) return photoOrg.Util.thumbnailAvailableSizes[e + 1];
   }
  } catch (o) {
   return t;
  }
 };
 this.ieBrowser = function() {
  "use strict";
  var t, e, o, i, s;
  e = !1;
  i = {
   "5.5":"5.5",
   "5.6":"6",
   "5.7":"7",
   "5.8":"8",
   "9":"9",
   "10":"10"
  };
  s = new Function("/*@cc_on return @_jscript_version; @*/")();
  if (void 0 !== s) {
   e = !0;
   o = i[s];
  }
  t = {
   isTheBrowser:e,
   actualVersion:o
  };
  return t;
 }();
 this.isIEOld = function() {
  var t, e = -1, o = window.navigator.userAgent, i = o.indexOf("MSIE "), s = o.indexOf("Trident/");
  if (i > 0) e = parseInt(o.substring(i + 5, o.indexOf(".", i)), 10); else if (s > 0) {
   var r = o.indexOf("rv:");
   e = parseInt(o.substring(r + 3, o.indexOf(".", r)), 10);
  }
  return e > -1 ? e :t;
 }();
 this.isIE = function() {
  return "ActiveXObject" in window ? !0 :!1;
 }();
 this.getUrlVars = function() {
  for (var t, e = [], o = window.location.href.slice(window.location.href.indexOf("?") + 1).split("&"), i = 0; i < o.length; i++) {
   t = o[i].split("=");
   e.push(t[0]);
   e[t[0]] = t[1].indexOf("#") ? t[1].substr(0, t[1].indexOf("#")) :t[1];
  }
  return e;
 };
 this.strip = function(t) {
  t = t.replace(/\{|\}|\#|\=|\!|\<|\>|\"|\'|\%|\;|\(|\)|\&/g, "");
  return t;
 };
 this.historyState = {};
 this.resetHistoryState = function() {
  photoOrg.Util.historyState = {};
 };
 this.appendHashtoURL = function(t) {
  var e = "#state=" + encodeURIComponent($.toJSON(t));
  location.hash = e;
 };
 this.isTouchDevice = function() {
  return Modernizr.touch || navigator.msMaxTouchPoints || navigator.MaxTouchPoints ? !0 :!1;
 };
 this.isMobileLayout = function() {
  return $(window).width() <= t;
 };
 this.isCompleteMobileLayout = function() {
  return $(window).width() <= 640 || $(window).height() <= 640;
 };
 this.isGlobalHeaderMobileLayout = function() {
  return $(window).width() < 1024;
 };
 this.getAlbumThumnailSize = function() {
  var t = this.thumbnailAvailableSizes[0], e = $(window).width();
  e > 1024 && 1920 >= e ? t = this.thumbnailAvailableSizes[1] :e > 1920 && (t = this.thumbnailAvailableSizes[2]);
  return t;
 };
 this.getSelectedAlbums = function() {
  photoOrg.photoLib.seletedAlbums = $.jStorage.get(gon.staticContent.account_id + "_selectedAlbums");
  (null == photoOrg.photoLib.seletedAlbums || void 0 == photoOrg.photoLib.seletedAlbums) && (photoOrg.photoLib.seletedAlbums = {});
 };
 this.deleteAndUpdateAlbumInfoInLocalStorage = function(t) {
  if (photoOrg.photoLib.seletedAlbums && null != photoOrg.photoLib.seletedAlbums && void 0 != photoOrg.photoLib.seletedAlbums[t]) {
   delete photoOrg.photoLib.seletedAlbums[t];
   $.jStorage.set(gon.staticContent.account_id + "_selectedAlbums", photoOrg.photoLib.seletedAlbums);
  }
 };
 this.deleteAlbumFromLocalStorage = function(t) {
  t && t.parentCollectionReferences && _.each(t.parentCollectionReferences, function(t) {
   this.deleteAndUpdateAlbumInfoInLocalStorage(t.collectionId);
   photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums && eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_UNSELECT, t.collectionId);
  }, this);
 };
 this.settingSelectedPics = function() {
  photoOrg.photoLib.selectedPicsFromAlb = $.jStorage.get(gon.staticContent.account_id + "_selectedPicsFrmAlb");
  (null == photoOrg.photoLib.selectedPicsFromAlb || void 0 == photoOrg.photoLib.selectedPicsFromAlb) && (photoOrg.photoLib.selectedPicsFromAlb = {});
 };
 this.updateSettingSelectedPics = function() {
  $.jStorage.set(gon.staticContent.account_id + "_selectedPicsFrmAlb", photoOrg.photoLib.selectedPicsFromAlb);
 };
 this.assetSelection = function() {
  photoOrg.photoLib.selectedPicsFromAlb && null != photoOrg.photoLib.selectedPicsFromAlb && $.jStorage.set(gon.staticContent.account_id + "_selectedPics", photoOrg.photoLib.selectedPicsFromAlb);
 };
 this.getCurrentHostName = function() {
  var t = document.location.host;
  "undefined" != typeof photoOrg.photoLib && "undefined" != typeof photoOrg.photoLib.config && "undefined" != typeof photoOrg.photoLib.config.hostName && (t = photoOrg.photoLib.config.hostName);
  "" == t ? t = document.location.protocol + "//" + document.location.host :0 != t.indexOf("http") && (t = document.location.protocol + "//" + t);
  return t;
 };
 this.onLibraryBeforeUnload = function() {
  if (photoOrg.geoLocationCount > 0) {
   var t = "GeoLocationMapCount=" + photoOrg.geoLocationCount;
   photoOrg.jsWarningLoggerNoFormat(t);
  }
  0 == photoOrg.photoLib.selectedImages.length ? photoOrg.photoLib.updateCurrentStateToJStorage() :$.jStorage.deleteKey(gon.staticContent.account_id + "_state");
  if (photoOrg.photoLib.needUpdatingGlobalsession) {
   photoOrg.photoLib.updateGlobalSession({
    async:!0
   });
   photoOrg.Util.checkRandom();
  }
  jsLogger.warn(photoOrg.Util.warn_msg);
  jsLogger.info(photoOrg.Util.info_msg);
  jsLogger.error(photoOrg.Util.err_msg);
 }, this.onProjectsBeforeUnload = function() {
  photoOrg.Util.checkRandom();
  jsLogger.warn(photoOrg.Util.warn_msg);
  jsLogger.info(photoOrg.Util.info_msg);
  jsLogger.error(photoOrg.Util.err_msg);
 }, this.prepareStateForRedirect = function() {
  try {
   var t = decodeURIComponent(window.location.hash.substring(window.location.hash.indexOf("=") + 1));
   t = "" != t && t.length > 0 ? $.parseJSON(t) :{};
   t.album_id = photoOrg.uploader.selectedAlbumID;
   !t.album_id && $("input#existingAlbum").is(":checked") && (t.album_id = $("#existing_albums_list").val());
   (!t.album_id || $("input#newAlbum").is(":checked")) && delete t.album_id;
  } catch (e) {
   t = {};
  }
  return Object.keys(t).length > 0 ? "#state=" + encodeURIComponent(JSON.stringify(t)) :"";
 };
 this.redirecttoJpm = function() {
  if (photoOrg.BrowserUtil.isChrome() && navigator.mimeTypes["application/x-pnacl"] && "application/x-pnacl" == navigator.mimeTypes["application/x-pnacl"].type && (void 0 == photoOrg.Util.getUrlParameter("noj") || "true" != photoOrg.Util.getUrlParameter("noj")) && gon.staticContent.isjpm && (void 0 == photoOrg.Util.getUrlParameter("le") || "true" != photoOrg.Util.getUrlParameter("le"))) {
   var t = location.href.replace(/&?chunkOnFailure=([^&]$|[^&]*)/i, "");
   t = t.replace(/&?chrome=([^&]$|[^&]*)/i, "");
   -1 == t.indexOf("clientcomp") && (t = t.split("?")[0] + "?clientcomp=true&" + t.split("?")[1]);
   location.href = t;
  }
 };
 this.removeStorageKeys = function(t) {
  try {
   Object.keys(localStorage).forEach(function(e) {
    e && e.indexOf("library_") > -1 && e.indexOf(t) > -1 && localStorage.removeItem(e);
   });
  } catch (e) {
   var o = "Library:Util::removeStorageKeys : unable to remove storage keys, " + e;
   photoOrg.jsWarningLogger(o);
  }
 };
 this.jpmMetricsCapture = function() {
  if (void 0 != photoOrg.uploader && photoOrg.uploadUtils && photoOrg.uploadUtils.omniture) {
   var t = photoOrg.uploader.uploadViewManager;
   photoOrg.uploadUtils.endUploadTimeCapture();
   if (gon.staticContent.isjpm && photoOrg.uploader.totalSizeBeforeCompression > 0) try {
    var e = photoOrg.uploadUtils, o = e.convertBytesToMB(photoOrg.uploader.totalSizeBeforeCompression), i = e.convertBytesToMB(photoOrg.uploader.totalSizeAfterCompression), s = o - i;
    t.imagesUploaded = t.totalFilesSucceded;
    t.uploadTimeElapsed = e.uploadTimeElapsed;
    var r = photoOrg.uploader.metricsSessionId || photoOrg.uploader.sessionId, n = photoOrg.uploader || uploader, a = '"Jpegmini upload summary" compression=Jpegmini uploaderSessionId=' + r + " context=" + gon.staticContent.context + " accountId=" + gon.staticContent.account_id + " selectedAlbumId=" + n.selectedAlbumID + " totalImageCount=" + (t.preFailedImages + t.totalImageCount) + " totalImagesEligibleForUpload=" + t.totalImageCount + " totalImagesUploaded=" + t.totalFilesSucceded + " totalImagesFailedToUpload=" + (t.postFailedImages + t.sRGBPostFailedImages) + " totalImagesYetToBeUploaded=" + (t.totalImageCount - (t.totalFilesSucceded + t.postFailedImages + t.sRGBPostFailedImages)) + " photosUploadType=HT5 uploadTimeElapsedMS=" + t.uploadTimeElapsed + " totalImagesSizeBeforeCompressionMB=" + o + " totalImagesSizeAfterCompressionMB=" + i + ' totalPercentageOfCompression="' + (s / o * 100).toFixed(2) + '" CompressionTimeInTotalDurationMS=' + n.totalOptimizationTimePerSession + " dedupImages=" + photoOrg.dedupFileCount;
    console.log(a);
    photoOrg.jsInfoLogger(a, "", "", "", !0);
    $.extend(!0, t, gon.staticContent);
    photoOrg.uploadUtils.omniture.sendOmnitureInfo(t, !0);
    photoOrg.Util.triggeredOmniture = !0;
   } catch (l) {
    photoOrg.jsErrorLogger('CommonUtils::onUploadBeforeUnload", errorCode="UPLOADER:JPM"-> issue in onUploadBeforeUnload : ' + l);
   }
  }
 };
 this.chunkMetricsCapture = function() {
  if (void 0 != photoOrg.uploader && photoOrg.uploadUtils && photoOrg.uploadUtils.omniture) {
   var t = photoOrg.uploader.uploadViewManager;
   photoOrg.uploadUtils.endUploadTimeCapture();
   photoOrg.uploadUtils.endChunkUploadTimeCapture();
   try {
    var e = photoOrg.uploadUtils, o = photoOrg.uploader || uploader;
    t.imagesUploaded = t.totalFilesSucceded;
    t.uploadTimeElapsed = e.uploadTimeElapsed;
    t.chunkUploadTimeElapsed = e.chunkUploadTimeElapsed;
    var i = photoOrg.uploader.metricsSessionId || photoOrg.uploader.sessionId, s = '"resumable upload summary", uploaderSessionId=' + i + " context=" + gon.staticContent.context + " accountId=" + gon.staticContent.account_id + " selectedAlbumId=" + o.selectedAlbumID + " totalImageCount=" + (t.preFailedImages + t.totalImageCount) + " totalImagesEligibleForUpload=" + t.totalImageCount + " totalImagesUploaded=" + t.totalFilesSucceded + " totalImagesFailedToUpload=" + (t.postFailedImages + t.sRGBPostFailedImages) + " totalImagesYetToBeUploaded=" + (t.totalImageCount - (t.totalFilesSucceded + t.postFailedImages + t.sRGBPostFailedImages)) + " photosUploadType=HT5 uploadTimeElapsedMS=" + t.uploadTimeElapsed + " totalFilesSizeMB=" + o.totalFilesSize.toFixed(3) + " dedupImages=" + photoOrg.dedupFileCount;
    gon.staticContent.chunkOnFailure && (s += " chunkUploadTimeElapsedMS=" + t.chunkUploadTimeElapsed + " chunkTotalImagesUploaded=" + t.totalChunkFilesSucceded + " chunkTotalImagesFailedToUpload=" + t.totalChunkFilesFailed);
    console.log(s);
    photoOrg.jsInfoLogger(s, "", "", "", !0);
    $.extend(!0, t, gon.staticContent);
    photoOrg.uploadUtils.omniture.sendOmnitureInfo(t, !0);
    photoOrg.Util.triggeredOmniture = !0;
   } catch (r) {
    photoOrg.jsErrorLogger('CommonUtils::onUploadBeforeUnload", errorCode="UPLOADER:CHUNKUPLOAD"-> issue in onUploadBeforeUnload : ' + r);
   }
  }
 };
 this.onUploadBeforeUnload = function() {
  if (!photoOrg.Util.triggeredOmniture) try {
   gon.staticContent.isjpm ? photoOrg.Util.jpmMetricsCapture() :photoOrg.Util.chunkMetricsCapture();
  } catch (t) {
   photoOrg.jsErrorLogger('CommonUtils::onUploadBeforeUnload", errorCode="UPLOADER"-> issue in onUploadBeforeUnload : ' + t);
  }
  jsLogger.error(photoOrg.Util.err_msg);
  jsLogger.warn(photoOrg.Util.warn_msg);
  jsLogger.info(photoOrg.Util.info_msg);
  photoOrg.Util.checkRandom();
 }, this.checkRandom = function() {
  var t = Math.floor(100 * Math.random() + 1), e = 25;
  e >= t && photoOrg.Util.logClientMetrics();
 }, this.logClientMetrics = function() {
  if (!metrics_ary || 0 != metrics_ary.length) {
   var t = void 0 != gon.staticContent.library_url ? gon.staticContent.library_url :"";
   $.ajax({
    url:t + "/log_client_metrics",
    dataType:"json",
    type:"POST",
    async:!1,
    data:{
     metrics_ary:metrics_ary
    },
    success:function() {},
    error:function() {}
   });
  }
 };
 this.s4 = function() {
  return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1);
 };
 this.guid = function() {
  var t = photoOrg.Util;
  return t.s4() + t.s4() + "-" + t.s4() + "-" + t.s4() + "-" + t.s4() + "-" + t.s4() + t.s4() + t.s4();
 };
 this.redirectToStoreErrorPage = function(t) {
  var e = gon.staticContent.store_url + "/error?" + t;
  gon.staticContent.cobrandName && (e += "&cobrandName=" + gon.staticContent.cobrandName);
  window.location.href = e;
 };
 this.calculateMetrics = function(t, e, o, i, s, r, n, a) {
  metrics_hsh.type = i;
  metrics_hsh.url = o;
  metrics_hsh.clientClassName = s;
  metrics_hsh.clientMethodName = r;
  metrics_hsh.headers = "Noodle=" + n;
  metrics_hsh.status = a;
  metrics_hsh.benchmark = (t - e) / 1e3;
  metrics_ary.push(metrics_hsh);
 };
 this.omnitureFirstTrack = !0;
 this.isIpad = function() {
  return null != navigator.userAgent.match(/iPad/i);
 };
 this.isIphone5 = function() {
  function t() {
   var t = window.navigator.userAgent, e = t.indexOf("OS ");
   return t.indexOf("iPhone") > -1 && e > -1 ? window.Number(t.substr(e + 3, 3).replace("_", ".")) :0;
  }
  return t() >= 6 && window.devicePixelRatio >= 2 && 548 == screen.availHeight ? !0 :!1;
 };
 this.isiPhone = function() {
  return -1 != navigator.platform.indexOf("iPhone") || -1 != navigator.platform.indexOf("iPod");
 };
 this.isAndroid = function() {
  var t = navigator.userAgent.toLowerCase(), e = t.indexOf("android") > -1;
  return e;
 };
 this.isIos = function() {
  var t = /iPad|iPhone|iPod|MacIntel/.test(navigator.platform);
  t || (t = /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent) && !window.MSStream || navigator.userAgent.match(/like Mac OS X/i) ? !0 :!1);
  return t;
 };
 this.isPad = function() {
  var t = /iPad|iPhone|iPod/.test(navigator.platform);
  t || (t = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream || !1);
  return t;
 };
 this.getBrowserSessionCookie = function(t) {
  if (!t || "GSID" != t && "oa2" != t) {
   var e = $.cookie(t);
   if (e && e.length > 0 && "undefined" != e) return e;
   for (var o = document.cookie.split(";"), i = 0; i < o.length; i++) {
    var s = o[i].trim();
    if (0 == s.indexOf(t)) {
     e = decodeURIComponent(s.split("=")[1]);
     if (e && e.length > 0 && "undefined" != e) return e;
    }
   }
   "assetNeedMigration" != t && photoOrg.jsWarningLogger('"COMMON UTIS :: getBrowserSessionCookie : ' + t + " is not available, value : " + e + " type : " + typeof t + ' and returning empty "');
   return "";
  }
  return photoOrg.oauthInfo[t] || "";
 };
 this.getAccessToken = function() {
  var t = "";
  t = gon.userInfo && gon.userInfo.access_token && "undefined" != gon.userInfo.access_token ? gon.userInfo.access_token :photoOrg.Util.getBrowserSessionCookie("oa2");
  (!t || t && "undefined" == t) && photoOrg.jsErrorLogger("UPLOAD Flow :Getting Access token Empty, token : " + t + " ,type of token :" + typeof t + '", errorCode="LIBRARY:UPLOADER"');
  return t;
 };
 this.getSubdomain = function() {
  var t = new RegExp("[a-z-0-9]{2,63}.[a-z.]{2,5}$"), e = t.exec(window.location.hostname);
  return e[0];
 };
 this.redirectToLoginPage = function(t, e) {
  if (t) try {
   $.removeCookie("oa2", {
    domain:photoOrg.Util.getSubdomain(),
    path:"/"
   });
  } catch (o) {
   photoOrg.jsErrorLogger("Error: Got an error while removing the oa2 with the path /library" + o);
  }
  e && photoOrg.Util.getLoginRedirectUrl();
 }, this.updateBrowserSessionCookie = function(t, e) {
  try {
   $.removeCookie("oa2", {
    path:"/library"
   });
  } catch (o) {
   photoOrg.jsErrorLogger("Error: Got an error while removing the oa2 with the path /library" + o);
  }
  if ($.cookie(t) != e) {
   console.log("Resetting new oa2 cookie value...old : " + $.cookie("oa2"));
   console.log("Resetting new oa2 cookie value...new : " + e);
   console.log("Got new oa2 cookie so resetting it...");
   $.cookie(t, e, {
    domain:photoOrg.Util.getSubdomain(),
    path:"/"
   });
  }
  try {
   photoOrg.Util.getBrowserSessionCookie("oa2") != e && photoOrg.jsWarningLogger('"CommonUtils : after updating with new token "oa2": is' + photoOrg.Util.getBrowserSessionCookie("oa2") + '&"access_token"' + e);
  } catch (o) {
   photoOrg.jsErrorLogger("Error: Got an error while checking the oa2 equal condition" + o);
  }
 };
 this.getURLParameter = function(t, e) {
  e || (e = window.location.href);
  var o = new RegExp("[?&]" + t + "=([^&#]*)").exec(e);
  return null == o ? null :o[1] || null;
 };
 this.getUrlParamterAfterHash = function(t) {
  var e = window.location.href, o = e.substring(e.lastIndexOf("#") + 1, e.length), i = o.split("&");
  o = i ? i :[ o ];
  for (var s in o) if (s && o[s]) {
   var s = o[s].split("=");
   if (s[0] == t) return s[1];
  }
 };
 this.setHashToGon = function(t) {
  if (void 0 != t) {
   t.accountId && (gon.staticContent.account_id = t.accountId);
   gon.staticContent.user_Type = t.userType;
   gon.staticContent.regType = t.regType;
  }
 };
 this.getLibraryServiceHost = function() {
  return -1 != window.location.host.indexOf(":") ? "http://" + window.location.host :photoOrg.photoLib && void 0 != photoOrg.photoLib.config && void 0 != photoOrg.photoLib.config.hostName && !gon.staticContent ? "" == photoOrg.photoLib.config.hostName ? gon.staticContent.library_url :photoOrg.photoLib.config.hostName :void 0 != gon.staticContent && void 0 != gon.staticContent.library_url ? gon.staticContent.library_url :void 0 != gon.staticContent && void 0 != gon.staticContent.library_url ? gon.staticContent.library_url :"";
 };
 this.isRotated = function() {
  var t = $(window).width(), e = $(window).height();
  if ("potrait" != this.orientationState && e > t) {
   this.orientationState = "potrait";
   console.log(" window resized : potrait, widowWidth: " + t);
   return !0;
  }
  if ("landscape" != this.orientationState && t > e) {
   this.orientationState = "landscape";
   console.log(" window resized : landscape, widowWidth: " + t);
   return !0;
  }
  return !1;
 };
 this.resetOrientationState = function() {
  this.orientationState = "";
 };
 this.getLoginRedirectUrl = function(t, e) {
  try {
   void 0 == t && (t = !1);
   var o = gon.staticContent;
   if ("production" == o.env && t && !photoOrg.photoLib.config.loadAsPhotoPicker) return;
   var i = photoOrg.Util.getBrowserSessionCookie("GSID");
   if (!t) {
    var s = $.jStorage.get(gon.staticContent.account_id + "_" + i + "_IdentifyUserRedirectionStatus"), r = new Date().getTime(), n = 0, a = encodeURIComponent(window.location.href);
    if (s) {
     console.log("IdentifyUserRedirectionStatus - userStatusValue" + s);
     s = s.split("_");
     if (a == s[0]) {
      console.log("IdentifyUserRedirectionStatus - url matched hence incrementing iteration count");
      r = s[1];
      n = s[2];
      n = parseInt(n);
      n += 1;
     }
    }
    if (!(0 == n || 5 > n && new Date().getTime() < r + 3e4)) {
     alert(window.translations.userDirectText);
     $.jStorage.set(gon.staticContent.account_id + "_" + i + "_IdentifyUserRedirectionStatus", "");
     var l = "IdentifyUserRedirectionStatus - Iteration Count : " + n + '", errorCode="LIBRARY:IdentifyUserRedirectionStatus", saved time="' + r + '"';
     console.log(l);
     photoOrg.jsErrorLogger(l);
     return;
    }
    console.log("IdentifyUserRedirectionStatus - Iteration Count : " + n + ", saved time" + r);
    $.jStorage.set(gon.staticContent.account_id + "_" + i + "_IdentifyUserRedirectionStatus", a + "_" + r + "_" + n);
   }
   var c = gon.staticContent.login_url;
   c && -1 == c.indexOf("https:") && (c = c.replace("http:", "https:"));
   var h = document.location.href;
   h && -1 == h.indexOf("http") && (h = "http://" + h);
   if (void 0 != e) {
    var d = document.location.hash;
    h = document.location.href.replace(d, "");
    h += -1 == h.indexOf("?") ? "?" + e :"&" + e;
   }
   c += encodeURIComponent(h);
   window.location.href = c;
  } catch (p) {
   try {
    photoOrg.jsWarningLogger('"Error occur while redirecting page to store login:: method:getLoginRedirectUrl ::Error: ' + p + '"');
   } catch (p) {}
  }
 }, this.checkGsidOa2Cookie = function(t) {
  try {
   var e = !0;
   if ($.cookie("GSID")) {
    var o = $.cookie("oa2");
    if (o && "null" != o && "undefined" != o) return !0;
    e = !1;
   } else e = !1;
   if (0 == e) {
    if (!t) return !1;
    window.location.href = t;
   }
  } catch (i) {
   try {
    photoOrg.jsWarningLogger('"Error occur while checking oa2,GSID exist or not:: method: checkGsidOa2Cookie method ::Error: ' + i + '"');
   } catch (i) {}
  }
 };
 this.getThumbnailURL = function(t, e) {
  if (!t) {
   photoOrg.jsWarningLogger("Asked to prepare thumbnail URL for empty imgUrl input");
   return " ";
  }
  var o = gon.staticContent.thumbnailServiceUrl;
  gon.staticContent.tnl_asset_map && e && (o = gon.staticContent.tnl_asset_map[this.getDigitFromNumber(e, gon.staticContent.tnl_asset_map.length)]);
  var i = o + "thumbnail/", s = t;
  t.indexOf(gon.staticContent.thumbnailServiceUrl) < 0 && t.indexOf(gon.staticContent.library_cdn_host) < 0 ? s = i + t :t.indexOf(gon.staticContent.thumbnailServiceUrl) >= 0 && t.indexOf("thumbnail") < 0 && (s = t.replace("v2", "v2/thumbnail"));
  return s;
 };
 this.getVideoURL = function(t) {
  if (!t) {
   photoOrg.jsWarningLogger("Asked to prepare thumbnail URL for empty imgUrl input");
   return " ";
  }
  var e = gon.staticContent.thumbnailServiceUrl + "video/", o = t;
  t.indexOf(gon.staticContent.thumbnailServiceUrl) < 0 && t.indexOf(gon.staticContent.library_cdn_host) < 0 && (o = e + t);
  return o;
 }, this.getVideoImageUrl = function(t) {
  if (!t) {
   photoOrg.jsWarningLogger("Asked to prepare thumbnail URL for empty imgUrl input");
   return " ";
  }
  var e = gon.staticContent.thumbnailServiceUrl + "thumbnail/", o = t;
  t.indexOf(gon.staticContent.thumbnailServiceUrl) < 0 && t.indexOf(gon.staticContent.library_cdn_host) < 0 && (o = e + t);
  return o;
 }, this.validateEmail = function(t) {
  var e = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return e.test(t);
 };
 this.getTnlURLFromArray = function(t, e) {
  if (!t) {
   photoOrg.jsWarningLogger("Asked to prepare thumbnail URL for empty imgUrl input");
   return " ";
  }
  var o;
  o = gon.staticContent.tnl_asset_map ? gon.staticContent.tnl_asset_map[this.getDigitFromNumber(e, gon.staticContent.tnl_asset_map.length)] :gon.staticContent.thumbnailServiceUrl;
  var i = o + "thumbnail/", s = t;
  t.indexOf(o) < 0 && t.indexOf(gon.staticContent.library_cdn_host) < 0 ? s = i + t :t.indexOf(o) >= 0 && t.indexOf("thumbnail") < 0 && (s = t.replace("v2", "v2/thumbnail"));
  return s;
 };
 this.getDigitFromNumber = function(t, e) {
  try {
   return parseInt(String(t).slice(0, -3)) % e;
  } catch (o) {
   return 0;
  }
 };
 this.getOrientation = function() {
  return $(window).width() > $(window).height() ? "landscape" :"portrait";
 };
 this.isMobileListView = function() {
  var t = !1;
  $(window).width() < 480 && (t = !0);
  return t;
 };
 this.isMobileDevice = function() {
  var t = !1;
  $(window).width() < 640 && (t = !0);
  return t;
 }, this.isDesktopResolution = function() {
  return $(window).width() > 1024;
 }, this.isAlbumMobileView = function() {
  var t = !1;
  $(window).width() <= 480 && (t = !0);
  return t;
 }, this.localStorageSupported = function() {
  try {
   localStorage.setItem("test", "test");
   localStorage.removeItem("test");
   return !0;
  } catch (t) {
   return !1;
  }
 };
 this.moveToUnauthorizatonPage = function(t, e, o) {
  try {
   if (void 0 != t.error && ("Cannot find the refresh token in the session" == t.error || "401" == t.error && !photoOrg.oauthFetcher.checkOauthAvailable())) {
    var i = t;
    try {
     i = JSON.stringify(i);
    } catch (s) {}
    photoOrg.jsWarningLogger('"AssetFetcher : success block but got error response" status_code="200" Noodle="' + o.noodle + '" responseText="' + photoOrg.Util.getFormattedMessage(i) + '"', o.url);
    photoOrg.Util.getLoginRedirectUrl();
   }
  } catch (s) {}
 };
 this.storeOrReplaceDataInBrowserStorage = function(t, e, o, i) {
  if (t) {
   $.jStorage.set(t, e);
   o && $.jStorage.setTTL(t, i);
  } else photoOrg.jsWarningLogger('"LocalStorage update is failed because of invalid key : ' + t + " value : " + e + '"');
 }, this.getStoredDataFromBrowserStorage = function(t) {
  if (t) return $.jStorage.get(t);
  photoOrg.jsWarningLogger('"LocalStorage get is failed because of invalid key : ' + t + '"');
  return void 0;
 };
 this.getFormattedMessage = function(t) {
  t && (t = t.toString().replace(/"/g, ""));
  return t;
 }, this.getModelUrl = function(t) {
  var e = {};
  photoOrg.photoLib.current_state != photoOrg.photoLib.navType.photosAndVideos || photoOrg.photoLib.isSelectedImagesDetailedView ? photoOrg.photoLib.current_state != photoOrg.photoLib.navType.singleAlbum || photoOrg.photoLib.isSelectedImagesDetailedView || (e = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(t)) :e = photoOrg.photoLib.showClusterView ? photoOrg.photoLib.UserAssetsInfo.clusterList.get(t) :photoOrg.photoLib.UserAssetsInfo.assetList.get(t);
  var o = e.get("files")[1].url;
  return o;
 };
 this.getFilterValue = function(t, e, o, i) {
  var s = "", r = "", n = "";
  n = void 0 == i ? photoOrg.Util.getSystemTag(e, "journalCore") :i;
  if (-1 != n.indexOf(t + "=")) {
   var a = n.split("/");
   _.each(a, function(e) {
    -1 != e.indexOf(t + "=") && (-1 != e.indexOf("af") && o ? r += e.split("=")[1] + "," :s = e.split("=")[1]);
   }, this);
  }
  return {
   journalCore:n,
   filter:s,
   alFilter:r
  };
 };
 this.getSystemTag = function(t, e) {
  var o = "";
  _.each(t.get("systemTags"), function(t) {
   t.key == e && (o = t.value);
  }, this);
  return o;
 }, this.isDesktop = function() {
  return $(window).width() > 900 ? !0 :!1;
 };
 this.getAssetInfo = function(t, e) {
  var o = {
   id:t
  }, i = new AssetFetcher(), s = function(t) {
   var o = photoOrg.Util.updateResponseWithExistingModel(t);
   e({
    model:o
   });
  }, r = function() {
   e();
  };
  i.getAssetInfo("", o, s, r, photoOrg.Util);
 }, this.updateResponseWithExistingModel = function(t) {
  var e = t.entities[0], o = {};
  if (void 0 != photoOrg.photoLib.UserAssetsInfo.assetList.get(e.id)) {
   var o = photoOrg.photoLib.UserAssetsInfo.assetList.get(e.id);
   o.set(e);
   photoOrg.photoLib.UserAssetsInfo.assetList.set(o, {
    merge:!0,
    remove:!1
   });
  }
  if (void 0 != photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(e.id)) {
   var o = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(e.id);
   o.set(e);
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.set(o, {
    merge:!0,
    remove:!1
   });
  }
  if (void 0 != photoOrg.photoLib.SelectedAsset.selectedAssets.get(e.id)) {
   var o = photoOrg.photoLib.SelectedAsset.selectedAssets.get(e.id);
   o.set(e);
   photoOrg.photoLib.SelectedAsset.selectedAssets.set(o, {
    merge:!0,
    remove:!1
   });
  }
  if (void 0 != photoOrg.photoLib.UserAssetsInfo.clusterList.get(e.id)) {
   var o = photoOrg.photoLib.UserAssetsInfo.clusterList.get(e.id);
   o.set(e);
   photoOrg.photoLib.UserAssetsInfo.clusterList.set(o, {
    merge:!0,
    remove:!1
   });
  }
  eventBus.trigger(eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE, {
   model:o
  });
  return o;
 }, this.AddNewCopyToCollection = function(t) {
  var e = t.entities[0], o = photoOrg.photoLib.Util.historyState, i = new photoOrg.pict(e);
  if (void 0 != o.pg && -1 !== o.pg.indexOf(photoOrg.constants.CLUSTER_VIEW)) {
   photoOrg.photoLib.UserAssetsInfo.clusterList.set(i, {
    merge:!0,
    remove:!1
   });
   var s = photoOrg.photoLib.UserAssetsInfo.clusterList.indexOf(photoOrg.crop.model);
   photoOrg.photoLib.UserAssetsInfo.clusterList.add(i, {
    at:s + 1
   });
  } else if (void 0 != o.pg && (-1 !== o.pg.indexOf(photoOrg.constants.SINGLE_ALBUM_VIEW) || -1 !== o.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) || -1 !== o.pg.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) || -1 !== o.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW))) {
   var s = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.indexOf(photoOrg.crop.model);
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.add(i, {
    at:s + 1
   });
  }
  return i;
 }, this.setDateFormat = function() {
  try {
   photoOrg.Util.date_format = gon.staticContent.date_format ? gon.staticContent.date_format :"MMM YYYY, DD HH:MM A";
  } catch (t) {
   photoOrg.Util.date_format = "MMM YYYY, DD HH:MM A";
  }
 }, this.initOverrideMoment = function() {
  try {
   var t = {}, e = "en";
   gon.staticContent.locale && gon.staticContent.locale.split("_") > 0 && (e = gon.staticContent.locale.split("_")[0]);
   if (window.translations) {
    var o = window.translations;
    o.monthNames && (t.months = o.monthNames.split(","));
    o.monthNamesShort && (t.monthsShort = o.monthNamesShort.split(","));
    o.dayNames && (t.weekdays = o.dayNames.split(","));
    o.dayNamesMin && (t.weekdaysShort = o.dayNames.split(","));
   }
   moment.locale(e, t);
  } catch (i) {}
 }, this.overrideGonValues = function() {
  try {
   var t = this.getUrlParamsArray();
   t && _.each(t, function(t) {
    var e = t.split("=");
    if (!(e[0].indexOf("x_") < 0)) {
     e[0] = e[0].slice(2);
     if (gon.staticContent && e.length > 1 && void 0 != gon.staticContent[e[0]]) {
      "true" == e[1] && (e[1] = !0);
      "false" == e[1] && (e[1] = !1);
      gon.staticContent[e[0]] = e[1];
     }
    }
   });
  } catch (e) {}
 }, this.getUrlParamsArray = function() {
  var t = decodeURIComponent(window.location.href).split("?");
  if (t) {
   t = t[1].split("#")[0].split("&");
   return t;
  }
  return void 0;
 };
 this.getUrlParameter = function(t) {
  if (!this.sURLVariables) {
   var e = decodeURIComponent(window.location.search.substring(1));
   this.sURLVariables = e.split("&");
  }
  var o, i;
  for (i = 0; i < this.sURLVariables.length; i++) {
   o = this.sURLVariables[i].split("=");
   if (o[0] === t) return void 0 === o[1] ? !0 :o[1];
  }
 };
 this.updateQueryStringParameter = function(t, e, o) {
  var i = t.indexOf("#"), s = t.substr(0, -1 == i ? t.length :i), r = -1 != i ? t.substr(i) :"", n = new RegExp("([?&])" + e + "=.*?(&|$)", "i"), a = -1 !== s.indexOf("?") ? "&" :"?";
  return s.match(n) ? s.replace(n, "$1" + e + "=" + o + "$2") + r :s + a + e + "=" + o + r;
 }, this.strCount = function(t, e) {
  var o = e.length, i = t.length;
  return o > i ? 0 :t.slice(0, o) === e ? 1 + photoOrg.Util.strCount(t.substring(o), e) :photoOrg.Util.strCount(t.substring(1), e);
 };
}();

var photoOrg = photoOrg || {}, httpDescription = {
 "415":"UnsupportedMediaType",
 "504":"Timeout",
 "404":"NotFound",
 "400":"BadRequest",
 "401":"InvalidOauth2Token",
 "403":"Unauthorized",
 "500":"ServerErrorInternal",
 "502":"DependentServiceError",
 "0":"HTTPStatus-0"
};

photoOrg.getEnv = function() {
 var t = "";
 t = "production" == gon.staticContent.env ? "prod" :"staging" == gon.staticContent.env ? "stg" :"beta" == gon.staticContent.env ? "beta" :"qa";
 return t;
};

photoOrg.jsAjaxErrorLogger = function(t, e, o) {
 var i = null, s = "library", r = photoOrg.Util.guid();
 e = e || document.referrer;
 if (o && !$.isEmptyObject(o)) {
  i = void 0 != o.status ? o.status :o.statusCode;
  o.origin && (s = o.origin + ", " + s);
  r = o.errorId || r;
 }
 var n = httpDescription[i], a = photoOrg.getEnv();
 "undefined" == typeof photo_org_host_name && (photo_org_host_name = "");
 var l = 'marker="BUSINESS_ERROR", type="CLIENT", env="' + a + '", httpStatusCode="' + i + '", service="library", origin="' + s + '", errorId="' + r + '", context="' + gon.staticContent.context + '", pageResponseFrom="' + photo_org_host_name + '", GSID="' + photoOrg.Util.getBrowserSessionCookie("GSID") + '", date="' + new Date().toString() + '", pageUrl="' + document.location.href + '", userAgent="' + photoOrg.Util.getFormattedMessage(navigator.userAgent) + '", errorCode="' + n + '", url="' + e + '", description=' + t + "\n";
 console.error(l);
 jsLogger.error(l);
};

photoOrg.jsErrorLogger = function(t) {
 var e = photoOrg.Util.guid();
 "undefined" == typeof photo_org_host_name && (photo_org_host_name = "");
 var o = photoOrg.getEnv(), i = 'marker="BUSINESS_ERROR", type="CLIENT", env="' + o + '", service="library", origin="library", errorId="' + e + '", context="' + gon.staticContent.context + '", pageResponseFrom="' + photo_org_host_name + '", GSID="' + photoOrg.Util.getBrowserSessionCookie("GSID") + '", date="' + new Date().toString() + '", pageUrl="' + document.location.href + '", userAgent="' + photoOrg.Util.getFormattedMessage(navigator.userAgent) + '", Noodle="' + e + '", description=' + t + "\n";
 console.error(i);
 jsLogger.error(i);
};

photoOrg.jsInfoLogger = function(t, e, o, i, s) {
 "undefined" == typeof photo_org_host_name && (photo_org_host_name = "");
 var r = 'marker="LIBRARY_INFO", type="CLIENT", env="' + gon.staticContent.env + '", service="library", origin="library", context="' + gon.staticContent.context + '", pageResponseFrom="' + photo_org_host_name + '", GSID="' + photoOrg.Util.getBrowserSessionCookie("GSID") + '", date="' + new Date().toString() + '", pageUrl="' + document.location.href + '", userAgent="' + photoOrg.Util.getFormattedMessage(navigator.userAgent) + '", url="' + e + '", description="' + t + "\n";
 if (s) {
  jsLogger.info(r);
  console.info(r);
 } else {
  photoOrg.Util.info_msg += r;
  console.info(photoOrg.Util.info_msg);
 }
};

photoOrg.jsWarningLogger = function(t, e, o, i, s) {
 "undefined" == typeof photo_org_host_name && (photo_org_host_name = "");
 var r = photoOrg.Util.getBrowserSessionCookie("GSID") || "", n = photoOrg.Util.getFormattedMessage(navigator.userAgent) || "", a = 'marker="LIBRARY_WARN", type="CLIENT", env="' + gon.staticContent.env + '", service="library", origin="library" context="' + gon.staticContent.context + '", pageResponseFrom="' + photo_org_host_name + '", GSID="' + r + '", date="' + new Date().toString() + '", pageUrl="' + document.location.href + '", userAgent="' + n + '", url="' + e + '", description=' + t + "\n";
 if (s) {
  jsLogger.warn(a);
  console.warn(a);
 } else {
  photoOrg.Util.warn_msg += a;
  console.warn(photoOrg.Util.warn_msg);
 }
};

photoOrg.jsWarningLoggerNoFormat = function(t, e, o, i, s) {
 "undefined" == typeof photo_org_host_name && (photo_org_host_name = "");
 var r = photoOrg.Util.getBrowserSessionCookie("GSID") || "", n = photoOrg.Util.getFormattedMessage(navigator.userAgent) || "", a = 'marker="LIBRARY_WARN_NO_FORMAT", type="CLIENT", env="' + gon.staticContent.env + '",service="library", origin="library" context="' + gon.staticContent.context + '", pageResponseFrom="' + photo_org_host_name + '", GSID="' + r + '", date="' + new Date().toString() + '", pageUrl="' + document.location.href + '", userAgent="' + n + '", url="' + e + '"\n ' + t + "\n";
 if (s) {
  jsLogger.warn(a);
  console.warn(a);
 } else {
  photoOrg.Util.warn_msg += a;
  console.warn(photoOrg.Util.warn_msg);
 }
};

window.onerror = function(t, e, o) {
 try {
  if (e && (-1 != e.indexOf("create.") || -1 != e.indexOf("builder"))) return;
  !e || -1 == e.indexOf(gon.staticContent.library_url) && -1 == e.indexOf(gon.staticContent.library_cdn_host) && -1 == e.indexOf(gon.staticContent.store_url) && -1 == e.indexOf(gon.staticContent.store_cdn_url) ? photoOrg.jsWarningLogger('"window warning is ' + t + '"', e, o) :photoOrg.jsWarningLogger('"This is a window error: ' + t + '", errorCode="LIBRARY:WindowError"', e, o);
 } catch (i) {
  console.log("This is a window onerror log due to :" + i);
 }
};

$.fn.isOnScreen = function() {
 var t = $(window), e = {
  top:t.scrollTop(),
  left:t.scrollLeft()
 };
 e.right = e.left + t.width();
 e.bottom = e.top + t.height();
 var o = this.offset();
 o.right = o.left + this.outerWidth();
 o.bottom = o.top + this.outerHeight();
 return !(e.right < o.left || e.left > o.right || e.bottom < o.top || e.top > o.bottom);
};

photoOrg.BrowserUtil = new function() {
 function t(t) {
  return function() {
   return e(t);
  };
 }
 var e = function() {
  return null !== navigator.userAgent.toLowerCase().match(/chrome|CriOS/i);
 };
 this.isIE = t(/msie/i);
 this.isFF = t(/firefox/i);
 this.isChrome = t(/chrome|CriOS/i);
 this.isIOS = t(/iP(hone|ad|od)/i);
 this.isIPod = t(/iP(hone|od)/i);
 this.isIPad = t(/iPad/i);
 this.isSafari602 = t(/Macintosh.*Mac OS X 10_8.*6\.0\.\d* Safari/i);
 this.isSafari = t(/Macintosh.*Mac OS X * Safari/i);
 this.isAndroid = function(t) {
  return e(t ? RegExp("android.*" + t, "i") :/android/i);
 };
 this.isMobile = function() {
  return this.isIOS() || this.isAndroid();
 };
}();

var photoOrg = photoOrg || {};

photoOrg.constants = {};

photoOrg.constants.CLUSTER_VIEW = "cv";

photoOrg.constants.TIME_LINE_VIEW = "tlv";

photoOrg.constants.PROJECTS_VIEW = "prj";

photoOrg.constants.ALBUMS_VIEW = "av";

photoOrg.constants.SHARED_ALBUM_VIEW = "shareav";

photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW = "swmav";

photoOrg.constants.SINGLE_ALBUM_VIEW = "siav";

photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW = "fsav";

photoOrg.constants.MY_SHARED_ALBUM_VIEW = "msav";

photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW = "mssav";

photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW = "swmsav";

photoOrg.constants.IS_SHARED = "isShared";

photoOrg.constants.CUSTOMSORT = "customsort";

photoOrg.constants.PAGE = "pg";

photoOrg.constants.PAGE_VIEW = "pgvw";

photoOrg.constants.DATA_CENTER = "dc";

photoOrg.constants.OWNER_ACCOUNT_ID = "oid";

photoOrg.constants.ALBUM_ID = "aid";

photoOrg.constants.PVC = "pvc";

photoOrg.constants.GLOBAL_HEADER = "gh";

photoOrg.constants.PAGE_FROM_PUBLIC_SHARE = "ps";

photoOrg.constants.pageNames = {
 cv:"photosPage",
 av:"albumsPage",
 swmav:"albumsPage",
 siav:"singleAlbumDetail",
 shv:"albumsPage",
 msav:"albumsPage",
 fav:"albumsPage"
};

photoOrg.constants.EDIT = {
 CROP:"CROP",
 FILTER:"FILTER",
 ROTATE:"ROTATE",
 ENHANCE:"ENHANCE",
 NONE:"NONE"
};

photoOrg.constants.sortCodes = {
 DTD:"DTD",
 DDS:"DDS",
 DAS:"DAS",
 CDS:"CDS",
 CAS:"CAS",
 UDS:"UDS",
 UAS:"UAS",
 CUP:"CUP"
};

var eventBus = _.extend({}, Backbone.Events);

eventBus.CUSTOM_EVENT_INVOKE_OVERLAY = "InvokeOverlay";

eventBus.CUSTOM_EVENT_CLOSE_CHILD_WINDOW = "closedChildWindow";

eventBus.CUSTOM_EVENT_SCROLLING = "scrolling";

eventBus.CUSTOM_EVENT_ALBUM_SCROLLING = "albumScrolling";

eventBus.CUSTOM_EVENT_ALBUM_RELOAD = "albumsReload";

eventBus.CUSTOM_EVENT_SINGLE_ALBUM_SCROLLING = "singleAlbumScrolling";

eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD = "singleAlbumReload";

eventBus.CUSTOM_EVENT_ALBUM_CLOSE = "albumclose";

eventBus.CUSTOM_EVENT_ALBUMS_CLOSE = "albumbsviewClose";

eventBus.CUSTOM_EVENT_ASSET_SELECTION = "assetClicked";

eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS = "removeSelectedAssets";

eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE = "updateAsset";

eventBus.CUSTOM_EVENT_LIBRARY_SEARCH = "librarySearch";

eventBus.CUSTOM_EVENT_LIBRARY_MEDIA_SORT = "libraryMediaSort";

eventBus.CUSTOM_EVENT_LIBRARY_PROPERTY_SORT = "libraryPropertySort";

eventBus.CUSTOM_EVENT_LIBRARY_SEARCH_SUCCESS = "librarySearchSuccess";

eventBus.CUSTOM_EVENT_LIBRARY_MEDIA_AND_ASSET_SORT = "libraryMediaAssetSort";

eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE = "assetViewsClose";

eventBus.CUSTOM_EVENT_FILTER_RESET = "filterReset";

eventBus.CUSTOM_EVENT_UPDATE_DATE_SLIDER = "updateDateSlider";

eventBus.CUSTOM_EVENT_RESET_DATE_SLIDER = "resetDateSlider";

eventBus.CUSTOM_EVENT_SHOW_ACTION_BAR = "showActionBar";

eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE = "assetGridResize";

eventBus.CUSTOM_EVENT_WINDOW_RESIZE = "windowResize";

eventBus.CUSTOM_EVENT_LIBRARY_DETAILVIEW_RESIZE = "detailViewResize";

eventBus.CUSTOM_EVENT_CLICK_MOBILE_OVERLAY = "clickMobileOverlay";

eventBus.CUSTOM_EVENT_DETAILED_ASSET_SELECT_ICON_CLICKED = "selectUnselectDetailedViewAsset";

eventBus.CUSTOM_EVENT_DETAILVIEW_DE_SELECT_ASSETS = "unselectAssetSelectionTray";

eventBus.CUSTOM_EVENT_ASSET_UNSELECTED = "assetUnSelected";

eventBus.CUSTOM_EVENT_ASSET_SELECTED = "assetSelected";

eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT = "updateAssetSelectionCount";

eventBus.CUSTOM_EVENT_LOAD_USER_ASSETS = "CUSTOM_EVENT_LOAD_USER_ASSETS";

eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_REQUEST = "CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_REQUEST";

eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_SUCEESS = "CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_SUCCESS";

eventBus.CUSTOM_EVENT_UPDATE_SINGLE_ALBUM_COUNT = "updateSingleAlbumCount";

eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW = "shareAlbumFromSlideshow";

eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS = "cancel single album assets";

eventBus.CUSTOM_EVENT_DELETE_SELECTED_MULTI_PICTURE = "DeleteMultiplePictures";

eventBus.CUSTOM_EVENT_SINGLE_ALBUM_CLOSE = "SingleAlbumClose";

eventBus.CUSTOM_EVENT_LOAD_SINGLE_ALBUM_USER_ASSETS = "LoadSingleAlbumAssets";

eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET = "showNextAsset";

eventBus.CUSTOM_EVENT_INVOKE_SORT_FILTER_EVENT = "showNextAsset";

eventBus.CUSTOM_EVENT_SHOW_TIME_LINE_VIEW = "ShowTimelineView";

eventBus.CUSTOM_EVENT_SHOW_ASSET_GRID_VIEW = "ShowAssetGridView";

eventBus.CUSTOM_EVENT_PROJECTS_SCROLLING = "onScrollLoadProjects";

eventBus.CUSTOM_EVENT_PROJECTS_CLOSE = "projectsClose";

eventBus.CUSTOM_EVENT_SUBMIT_IMAGE_DATA = "SubmitImageData";

eventBus.CUSTOM_EVENT_ENABLE_DONE_BUTTON = "EnableDoneButton";

eventBus.CUSTOM_EVENT_DONE_UPLOAD = "DoneUpload";

eventBus.CUSTOM_EVENT_ABORT_FILE_UPLOAD_REQUESTS = "AbortFileUploadRequest";

eventBus.CUSTOM_EVENT_SELECT_INGESTION_CLOSE = "ingestionselettrayclose";

eventBus.CUSTOM_EVENT_SELECT_INGESTION_ASSET = "ingestionSelectAsset";

eventBus.CUSTOM_EVENT_SELECT_ASSET = "selectAsseet";

eventBus.CUSTOM_EVENT_DE_SELECT_ASSET = "deSelectAsseet";

eventBus.CUSTOM_EVENT_DE_SELECT_All_INGESTION_ALBUM = "ingestionDeleteAll";

eventBus.CUSTOM_EVENT_SELECT_All_INGESTION_ALBUM = "ingestionAddAll";

eventBus.CUSTOM_EVENT_INSTAGRAMALBUMS_LOAD = "instagramalbumload";

eventBus.CUSTOM_EVENT_INSTAGRAMALBUM_LOAD = "instagramalbumsload";

eventBus.CUSTOM_EVENT_GOT_NEXT_IMAGES_SET = "GotNextImagesSet";

eventBus.CUSTOM_EVENT_ASSET_SELECT_ALL = "select_asset";

eventBus.CUSTOM_EVENT_DE_SELECT_ASSET_ALL = "de_asset_asset";

eventBus.CUSTOM_EVENT_PREV_SET = "loadPrevAssetsSet";

eventBus.CUSTOM_EVENT_NEXT_SET = "loadNextAssetsSet";

eventBus.CUSTOM_EVENT_PREV_ALBUMS_SET = "loadPrevAlbumsSet";

eventBus.CUSTOM_EVENT_NEXT_ALBUMS_SET = "loadNextAlbumsSet";

eventBus.CUSTOM_EVENT_SELECT_PAGE = "loadselectedAssetPage";

eventBus.CUSTOM_EVENT_PREV_SET_SAV = "loadPrevAssetsSet_sav";

eventBus.CUSTOM_EVENT_NEXT_SET_SAV = "loadNextAssetsSet_sav";

eventBus.CUSTOM_EVENT_SELECT_PAGE_SAV = "loadselectedAssetPage_sav";

eventBus.CUSTOM_EVENT_EMPTY_SINGLE_ALBUM_VIEWW = "resetSingleAlbum";

eventBus.CUSTOM_EVENT_ALBUM_RESET = "albumcrop";

eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER = "eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER";

eventBus.CUSTOM_EVENT_ALBUM_UNSELECT = "eventBus.CUSTOM_EVENT_ALBUM_UNSELECT";

eventBus.CUSTOM_EVENT_ASSET_DELETED = "eventBus.CUSTOM_EVENT_ASSET_DELETED";

eventBus.CUSTOM_EVENT_UPDATE_GRID = "eventBus.CUSTOM_EVENT_UPDATE_GRID";

eventBus.CUSTOM_EVENT_CLUSTER_SORT = "eventBus.CUSTOM_EVENT_CLUSTER_SORT";

eventBus.CUSTOM_EVENT_INVOKE_ENDSESSION_FOR_UPLOADING = "InvokeEndSessionForUploading";

eventBus.CUSTOM_EVENT_SHARE = "share";

eventBus.DELETE_ALBUM = "deleteAlbum";

eventBus.SLIDESHOW = "slideshow";

eventBus.CUSTOM_EVENT_INVOKE_SHOWORHIDEPANEL = "showOrHidePanel";

eventBus.CUSTOM_EVENT_CHECK_SELECTED_ASSETS = "checkSelectedAssetsWithDetailedView";

eventBus.CUSTOM_EVENT_DETAILED_VIEW_PRESENT_IN_TRAY_IMAGES = "detailedViewPresetInTrayImages";

eventBus.CUSTOM_EVENT_ADJUST_DETAILED_VIEW = "detailedViewAdjust";

eventBus.CUSTOM_EVENT_UPDATE_DTVIEW_FILMSTRIP = "updateDetailedViewAndFilmStrip";

eventBus.CUSTOM_EVENT_SLIDESHOW_FROM_DETAILEDVIEW = "slideshowFromDetailedView";

eventBus.CUSTOM_EVENT_UPDATE_DTVIEW_IMAGE = "updateDetialedViewImage";

eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW_ALBUMS_PAGE = "sharealbumFromAlbumsPageSlideshow";

eventBus.CUSTOM_EVENT_LIBRARY_EDIT_RESIZE = "editresize";

eventBus.CHECK_VIDEO_EXISTANCE_IN_TRAY = "checkVideoExistanceInTrayForMobiles";

eventBus.CUSTOM_EVENT_TRIGGER_REARRANGE_MODE = "activateReArrangeMode";

eventBus.CUSTOM_EVENT_REARRANGE_MODE_SCROLLING = "reArrangeModeScrolling";

eventBus.CUSTOM_EVENT_REARRANGE_CANCEL = "reArrangeCancelForMobile";

eventBus.CUSTOM_EVENT_REARRANGE_DONE = "reArrangeDoneForMobile";

eventBus.CUSTOM_EVENT_SELECTED_ASSETS_CLOSE = "eventBus.CUSTOM_EVENT_SELECTED_ASSETS_CLOSE";

eventBus.CUSTOM_ABORT_AJAX_CALLS = "abort_call";

var photoOrg = photoOrg || {};

photoOrg.PhotoLibrary = function() {
 this.refreshGrid = !1;
 this.defaultAlbumName = "";
 this.deSelectAllVisibleImagesClicked = !1;
 this.isSelectAllVisibleImagesClicked = !1;
 this.isTypeProjectTray = !1;
 this.assetNeedMigration = !1;
 this.videos = [];
 this.selectedVideos = [];
 this.selectedImages_tray = [];
 this.isFavorite = !1;
 this.custOrderPrints = !1;
 this.expressProduct = {
  isShowExpressProduct:!1,
  availabilityFinishType:[],
  skuIds:[]
 };
 this.bookProduct = {
  isShowbookProduct:!1,
  availabilityFinishType:[],
  skuIds:[]
 };
 this.htmlEncode = function(t) {
  var e = document.createElement("div");
  e.innerText = e.textContent = t;
  t = e.innerHTML;
  return t;
 };
 this.getUrlVars = function() {
  for (var t, e = [], o = window.location.href.slice(window.location.href.indexOf("?") + 1).split("&"), i = 0; i < o.length; i++) {
   t = o[i].split("=");
   e.push(t[0]);
   e[t[0]] = t[1].indexOf("#") ? t[1].substr(0, t[1].indexOf("#")) :t[1];
  }
  return e;
 };
 this.projectView = void 0;
 this.needUpdatingGlobalsession = !0;
 this.defineCollection = function(t, e, o) {
  return Backbone.Collection.extend({
   model:t,
   url:e,
   parse:o,
   sync:function(t, e, o) {
    var i = this, s = _.extend({
     type:"POST",
     dataType:"jsonp",
     jsonpCallback:"handlePHOResponse",
     url:i.url,
     processData:!0
    }, o);
    return $.ajax(s);
   }
  });
 }, this.flickerInit = function() {
  photoOrg.FlickrImage = Backbone.Model.extend({});
  photoOrg.FlickrImageCollection = this.defineCollection(photoOrg.FlickrImage, photoOrg.Util.getLibraryServiceHost() + "/flickrGetImages", function(t) {
   return t.photo;
  });
 }, this.instagramInit = function() {
  $(".facebook_text").hide();
  $(".flickr_text").hide();
  $(".instagram_text").show();
  $(".common_text").show();
  photoOrg.IngestionUtils.showLoginWindow(photoOrg.Util.getLibraryServiceHost() + "/instagram?hostName=" + getRedirect_url("ingestion"));
 }, this.fbInit = function() {
  !function(t) {
   {
    var e, o = "facebook-jssdk";
    t.getElementsByTagName("script")[0];
   }
   if (!t.getElementById(o)) {
    e = t.createElement("script");
    e.id = o;
    e.async = !0;
    e.src = "//connect.facebook.net/en_US/all.js";
   }
  }(document);
 }, this.init = function() {
  this.rightWell = $("#right-well");
  this.albumJson = {
   "@class":"Collection",
   collectionType:"ALBUM",
   hashAccountId:"<%= ownerAccountId %>",
   systemTags:{
    entries:{
     firstAssetId:{
      assetId:"<%= id%>",
      ownerId:"<%= ownerAccountId%>",
      assetType:"PICTURE"
     }
    }
   },
   userTags:{
    entries:{
     caption:""
    }
   },
   ownerAccountId:"<%= ownerAccountId%>",
   accessLevel:"OWNER",
   assetIdList:[]
  };
  this.collectionStructure = {
   "@class":"Collection",
   collectionType:"ALBUM",
   accessLevel:"OWNER",
   assetIdList:[],
   firstAssetId:{
    assetId:"",
    ownerId:gon.staticContent.account_id + "",
    assetType:"PICTURE"
   },
   dataCenter:gon.staticContent.dc + "",
   ownerAccountId:gon.staticContent.account_id + "",
   userTags:[]
  };
  this.singleAsset = {
   assetId:"<%= id%>",
   ownerId:"<%= ownerAccountId%>",
   assetType:"PICTURE"
  };
  void 0 != gon.staticContent.loadLimit && gon.staticContent.loadLimit > 0 && (this.limit = gon.staticContent.loadLimit);
  void 0 != gon.staticContent.downloadLimit && gon.staticContent.downloadLimit > 0 && (this.downloadLimit = gon.staticContent.downloadLimit);
  gon.staticContent.enable_bulk_download || $("#bulkDownload").css("display", "none");
  this.viewportWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
  this.assetNeedMigration = photoOrg.Util.getBrowserSessionCookie("assetNeedMigration");
  photoOrg.fakeCropOptions = {
   wrapperSelector:null,
   wrapperWidth:75,
   wrapperHeight:75,
   center:!0,
   fill:!0,
   initClass:"photoOrg_fake_init",
   doneEvent:"fakedropdone",
   squareWidth:!0
  };
  if (this.viewportWidth < 600) {
   photoOrg.isDesktop = !0;
   photoOrg.isTabOrMobile = !1;
   photoOrg.pictureSize = 100;
   photoOrg.fakeCropOptions.wrapperWidth = photoOrg.pictureSize;
   photoOrg.fakeCropOptions.wrapperHeight = photoOrg.pictureSize;
  } else if (photoOrg.Util.isMobileLayout()) {
   photoOrg.pictureSize = 150;
   photoOrg.fakeCropOptions.wrapperWidth = photoOrg.pictureSize;
   photoOrg.fakeCropOptions.wrapperHeight = photoOrg.pictureSize;
   photoOrg.isDesktop = !0;
   photoOrg.isTabOrMobile = !1;
  } else if (!photoOrg.Util.isMobileLayout()) {
   photoOrg.pictureSize = 200;
   photoOrg.fakeCropOptions.wrapperWidth = photoOrg.pictureSize;
   photoOrg.fakeCropOptions.wrapperHeight = photoOrg.pictureSize;
   photoOrg.isTabOrMobile = !1;
   photoOrg.isDesktop = !0;
  }
  if (photoOrg.Util.isMobileLayout()) {
   var t = $("#album_assets").innerWidth();
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos) {
    t = $(".main-Container2").innerWidth() - $(".lib-left-col").width();
    this.viewportWidth <= 640 && (t = $(".main-Container2").innerWidth());
   }
   photoOrg.photosPerPage = Math.floor(parseInt(t) / photoOrg.pictureSize);
   if (0 != photoOrg.photosPerPage) {
    photoOrg.calculatedImageMargin = "0";
    var e = Math.floor(parseInt(t) / photoOrg.photosPerPage);
    if (e > photoOrg.pictureSize) photoOrg.calculatedImageMargin = this.viewportWidth <= 600 ? e - photoOrg.fakeCropOptions.wrapperWidth - 2 :e - photoOrg.fakeCropOptions.wrapperWidth - 1; else {
     photoOrg.photosPerPage = photoOrg.photosPerPage - 1;
     var e = Math.floor(parseInt(t) / photoOrg.photosPerPage);
     photoOrg.calculatedImageMargin = e - photoOrg.fakeCropOptions.wrapperWidth - 2;
    }
    photoOrg.calculatedImageMargin <= 0 && (photoOrg.calculatedImageMargin = 2);
    photoOrg.pictureSize = e - photoOrg.calculatedImageMargin;
   }
  }
  photoOrg.photoLib.Util.isTouchDevice() && $("head").append('<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0" />');
 };
 this.prepareMonthWiseAlbumList = function(t, e, o) {
  if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW && !$("#albumManagement").hasClass("open")) return this.prepareMonthWiseClusters(t, o);
  var i = {}, s = t.entities;
  _.each(s, function(t) {
   var o = !1;
   _.each(t.systemTags, function(t) {
    "isFavorite" == t.key && 1 == t.value && (o = !0);
   });
   var s = !1;
   try {
    "OWNER" != t.accessLevel && (s = !0);
   } catch (r) {}
   if (!o && !s || e) {
    var n = new photoOrg.pict(t);
    photoOrg.photoLib.UserAssetsInfo.userAlbums.add(n);
    if (null == t.createDate) var a = new Date(t.updateDate); else var a = new Date(t.createDate);
    var l = a.getMonth() + "_" + a.getFullYear();
    if (l in i) prevAlbumYear === a.getFullYear() && i.hasOwnProperty(l) && i[l].push(t); else {
     prevAlbumYear = a.getFullYear();
     i[l] = [];
     i[l].push(t);
    }
   }
  });
  return i;
 };
 this.prepareMonthWiseClusters = function(t, e) {
  for (var o = {}, i = t.entityMap, s = Object.keys(i).length, r = 0; s > r; r++) {
   var n;
   n = 1 == e ? Object.keys(t.entityMap)[s - (r + 1)] :Object.keys(t.entityMap)[r];
   var a = n.split("-");
   a = a[1] - 1 + "_" + a[0];
   var l = t.entityMap[n].collectionList;
   a in o || (o[a] = []);
   o[a] = o[a].concat(l);
  }
  return o;
 };
 this.loadSingleAlbumView = function(t) {
  var e = photoOrg.photoLib.Util.historyState;
  if (void 0 != e.pg && e.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW) {
   photoOrg.photoLib.Util.resetHistoryState();
   var o = photoOrg.photoLib.Util.historyState;
   o[photoOrg.constants.PAGE_VIEW] = photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   o[photoOrg.constants.ALBUM_ID] = t.id;
   o[photoOrg.constants.OWNER_ACCOUNT_ID] = t.ownerAccountId;
   o[photoOrg.constants.DATA_CENTER] = t.dataCenter;
  } else if (void 0 != e.pg && e.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW) {
   photoOrg.photoLib.Util.resetHistoryState();
   var o = photoOrg.photoLib.Util.historyState;
   o[photoOrg.constants.PAGE_VIEW] = photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW;
   o[photoOrg.constants.ALBUM_ID] = t.id;
   o[photoOrg.constants.OWNER_ACCOUNT_ID] = t.ownerAccountId;
   o[photoOrg.constants.DATA_CENTER] = t.dataCenter;
  } else if (void 0 != e.pg && e.pg == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW || e.pg == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) {
   var o = photoOrg.photoLib.Util.historyState;
   o[photoOrg.constants.PAGE] = photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   o[photoOrg.constants.ALBUM_ID] = t.id;
   o[photoOrg.constants.OWNER_ACCOUNT_ID] = t.ownerId;
   o[photoOrg.constants.DATA_CENTER] = t.dc;
  } else if (void 0 != e.pg && e.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   photoOrg.photoLib.Util.resetHistoryState();
   var o = photoOrg.photoLib.Util.historyState;
   o[photoOrg.constants.PAGE_VIEW] = photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW;
   o[photoOrg.constants.ALBUM_ID] = t.id;
   if (photoOrg.photoLib.isShared) {
    o[photoOrg.constants.IS_SHARED] = photoOrg.photoLib.isShared;
    o[photoOrg.constants.OWNER_ACCOUNT_ID] = t.ownerAccountId;
    o[photoOrg.constants.DATA_CENTER] = t.dataCenter;
   }
  } else {
   photoOrg.photoLib.Util.resetHistoryState();
   var o = photoOrg.photoLib.Util.historyState;
   o[photoOrg.constants.PAGE_VIEW] = photoOrg.constants.SINGLE_ALBUM_VIEW;
   o[photoOrg.constants.ALBUM_ID] = t.id;
   if (photoOrg.photoLib.isShared) {
    o[photoOrg.constants.IS_SHARED] = photoOrg.photoLib.isShared;
    o[photoOrg.constants.OWNER_ACCOUNT_ID] = t.ownerAccountId;
    o[photoOrg.constants.DATA_CENTER] = t.dataCenter;
   }
   t.customSortEnabled && (o[photoOrg.constants.CUSTOMSORT] = t.customSortEnabled);
  }
  photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.photoLib.config.loadAsPhotoPicker && photoOrg.makeActionView.handleSingleAlbumView() :photoOrg.photoLib.Util.appendHashtoURL(o);
 };
 this.getImageUrlFromModel = function(t) {
  var e = null;
  try {
   e = photoOrg.photoLib.getLowORHires(t.get("files")).url;
  } catch (o) {
   e = t.thumbnailEncryption ? gon.staticContent.thumbnailServiceUrl + "thumbnail/" + t.thumbnailEncryption :photoOrg.photoLib.getLowORHires(t.files).url;
  }
  e.indexOf(gon.staticContent.thumbnailServiceUrl) < 0 && (e = photoOrg.Util.getThumbnailURL(e));
  return e;
 };
 this.getThumbDataFromCollection = function(t, e) {
  var o = "", i = "", s = t.firstAssetId, r = e || photoOrg.Util.thumbnailAvailableSizes[0];
  if (void 0 != s && void 0 != s.thumbnailEncryption) {
   var n = s.thumbnailEncryption;
   n += n.indexOf("?") > 0 ? "&" :"?";
   i = s.assetId;
   var a;
   a = gon.staticContent.tnl_asset_map ? gon.staticContent.tnl_asset_map[photoOrg.Util.getDigitFromNumber(i, gon.staticContent.tnl_asset_map.length)] :gon.staticContent.thumbnailServiceUrl;
   o = a + "thumbnail/" + n + "height=" + r;
  } else if (void 0 != t.assetIdList && t.assetIdList.length > 0) {
   var l = t.assetIdList[0];
   if (void 0 != l && void 0 != l.thumbnailEncryption) {
    var n = l.thumbnailEncryption;
    n += n.indexOf("?") > 0 ? "&" :"?";
    o = gon.staticContent.thumbnailServiceUrl + "thumbnail/" + n + "height=" + r;
    i = l.assetId;
   }
  }
  ("" == o || o.length <= 0) && photoOrg.jsWarningLogger("cover picture thumbnail url is not available in either first asset id or first asset of assetIdList in UA response");
  return {
   thumb:o,
   aId:i
  };
 };
 this.getThumbnailDataFromAssetsCollection = function(t, e) {
  var o = "", i = t.models[0].id, s = e || photoOrg.Util.thumbnailAvailableSizes[0];
  if (void 0 != i && void 0 != i.thumbnailEncryption) {
   var r = i.thumbnailEncryption;
   r += r.indexOf("?") > 0 ? "&" :"?";
   o = gon.staticContent.thumbnailServiceUrl + "thumbnail/" + r + "height=" + s;
   aId = i.assetId;
  } else if (void 0 != t.assetIdList && t.assetIdList.length > 0) {
   var n = t.assetIdList[0];
   if (void 0 != n && void 0 != n.thumbnailEncryption) {
    var r = n.thumbnailEncryption;
    r += r.indexOf("?") > 0 ? "&" :"?";
    o = gon.staticContent.thumbnailServiceUrl + "thumbnail/" + r + "height=" + s;
    aId = n.assetId;
   }
  }
  ("" == o || o.length <= 0) && photoOrg.jsWarningLogger("cover picture thumbnail url is not available in either first asset id or first asset of assetIdList in UA response");
  return {
   thumb:o,
   aId:aId
  };
 };
 this.createDateRange = function(t) {
  var e = t[0], o = e.ib.date.time, i = t[t.length - 1].ib.date.time, s = e.ib.date.yesteday + o;
  o != i && (s = s + " - " + i);
  return s;
 };
 this.determineRelativeDate = function(t) {
  var e = moment(t.dateTaken || t.createDate), o = moment().startOf("day");
  t.ib = {
   date:{
    yesteday:"",
    time:e.format("h:mm a"),
    day:e.format("DD"),
    month:e.format("MMMM"),
    year:e.format("YYYY")
   }
  };
  var i = moment(t.createDate);
  if (0 === o.diff(i.startOf("day"), "days")) return "Recently Added";
  var s = moment().startOf("week");
  if (e.isAfter(s)) {
   var r = o.diff(e.startOf("day"), "days"), n = e.format("dddd");
   if (1 === r) {
    t.ib.date.yesteday = n + " ";
    return "Yesterday";
   }
   return n;
  }
  return e.format("MMMM DD, YYYY");
 };
 this.sortAssets = function(t) {
  var e = t.length;
  if (!(0 >= e)) {
   t.sort(function(t, e) {
    var o = t.dateTaken || t.createDate, i = e.dateTaken || e.createDate;
    return i > o ? 1 :o > i ? -1 :0;
   });
   for (var o = {}, i = 0; e > i; i++) {
    var s = t[i], r = this.determineRelativeDate(s);
    r in o ? o[r].unshift(s) :o[r] = [ s ];
   }
   if ("Recently Added" in o) {
    var n = o["Recently Added"];
    n.sort(function(t, e) {
     return t.createDate < e.createDate ? 1 :t.createDate > e.createDate ? -1 :0;
    });
   }
   photoOrg.sortedAssets = o;
  }
 };
 this.showProjectspage = function() {
  $(".uploadImagesTextLibraryDiv").hide();
  var t = photoOrg.photoLib.Util.historyState;
  t[photoOrg.constants.PAGE] = photoOrg.constants.PROJECTS_VIEW;
  photoOrg.photoLib.Util.appendHashtoURL(t);
  $(".libContainer #pfluidGrid , .filterContiner , #loadingBar").hide();
  $(".projectContainer").show();
  void 0 == this.projectView ? this.projectView = new photoOrg.Projects({
   el:".projectContainer"
  }) :photoOrg.photoLib.current_state = photoOrg.photoLib.navType.PROJECTS;
 };
 this.showLibraryPage = function() {};
 this.showAndHideUploadTextDiv = function(t) {
  if (void 0 != t && "show" == t && 0 == photoOrg.AlbumFetcher.totalAlbumCount) {
   "none" == $("#libText").css("display") ? $(".encourage_user_to_upload_text").css("margin-top", "0px") :$(".encourage_user_to_upload_text").css("margin-top", "50px");
   $(".encourage_user_to_upload_text").show();
   $(".lib-left-col").addClass("hidden");
   $("#right-well").addClass("full");
   $(".sub-header-wrapper").addClass("full");
   $(".picker-pagination-bar").hide();
   $(".photo-Org .mobSection").hide();
   $(".date-sorting").hide();
   photoOrg.photoLib.SelectedAsset.selectedAssets.models.length < 1 ? $(".photo-Org #affix-leftCol").hide() :$(".photo-Org #affix-leftCol").show();
   if (this.assetNeedMigration) {
    $(".encourage_user_to_upload_text").hide();
    $(".asset_need_migrate_text").show();
   }
  } else if (void 0 != t && "hide" == t) {
   this.assetNeedMigration && $(".asset_need_migrate_text").hide();
   if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".lib-left-col").removeClass("hidden");
    $("#right-well").removeClass("full");
   }
   $(".encourage_user_to_upload_text").hide();
   $(".uploadImagesTextDiv").hide();
   $(".photo-Org .mobSection").show();
   $(".photo-Org #affix-leftCol").show();
  }
 };
 this.showAndHideSharedEmptyMsgDiv = function(t) {
  if (void 0 != t && "show" == t) {
   $(".empty_shared_albums").show();
   $(".empty_shared_albums p").text(photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW ? window.translations.share.share_no_shared_albums_messages :window.translations.share.share_1_0_empty_message);
  } else void 0 != t && "hide" == t && $(".empty_shared_albums").hide();
 };
 this.showOrHideFavAlbumMessage = function(t) {
  if (void 0 != t && "show" == t) {
   $(".empty_shared_albums").show();
   if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
    $(".empty_shared_albums p").text(window.translations.empty_fav_album);
    $(".favemptytxt").show();
    $(".favemptytxt").text(window.translations.empty_fav_album2);
    $("#loadingBar").hide();
   } else if (void 0 != status && "hide" == status) {
    $(".favemptytxt").hide();
    $(".empty_shared_albums").hide();
   }
  }
 };
 this.showServerInternalErrorMsg = function(t) {
  void 0 != t && "show" == t ? $(".photo-Org #serverInternalErrorMsg").show() :void 0 != t && "hide" == t && $(".photo-Org #serverInternalErrorMsg").hide();
 }, this.currentAlbumId = 0;
 this.isNeedToReload = !1;
 this.isUploaded = !1;
 this.navType = {
  photosAndVideos:0,
  albums:1,
  singleAlbum:2,
  STORIES:3,
  PROJECTS:4,
  tray:5
 }, this.comment = function(t, e, o, i) {
  var s = gon.staticContent.pict_service + "social/comment/collection", r = {};
  r.data = $.toJSON(t);
  new AssetFetcher({
   type:"POST",
   url:s,
   params:r,
   callback:e,
   errorCallback:o,
   context:i
  }).doAjax();
 }, this.deleteComment = function(t, e, o, i, s) {
  var r = gon.staticContent.pict_service + "social/comment/collection/" + s, n = {};
  n.data = $.toJSON(t);
  new AssetFetcher({
   type:"DELETE",
   url:r,
   params:n,
   callback:e,
   errorCallback:o,
   context:i
  }).doAjax();
 }, this.like = function(t, e, o, i) {
  var s = {
   data:$.toJSON(t)
  };
  s.headers = {
   "Content-Type":"application/json"
  };
  var r = gon.staticContent.pict_service + "social/like/collection";
  new AssetFetcher({
   type:"POST",
   url:r,
   params:s,
   callback:e,
   errorCallback:o,
   context:i
  }).doAjax();
 }, this.unlike = function(t, e, o, i) {
  var s = {
   data:$.toJSON(t)
  };
  s.headers = {
   "Content-Type":"application/json"
  };
  var r = gon.staticContent.pict_service + "social/like/collection";
  new AssetFetcher({
   type:"DELETE",
   url:r,
   params:s,
   callback:e,
   errorCallback:o,
   context:i
  }).doAjax();
 }, this.accessType = {
  guest:"guest",
  share2:"share2.O",
  share1:"share1.O",
  owned:"owned",
  myshared:"myshared",
  favalbs:"favalbs"
 };
 this._getBrowserSessionCookie = function(t) {
  for (var e = document.cookie.split(";"), o = 0; o < e.length; o++) {
   var i = e[o].trim();
   if (0 == i.indexOf(t)) return decodeURIComponent(i.split("=")[1]);
  }
  return "";
 }, this.openUploader = function(t) {
  var e = "/ingestion?type=instagram&for=gh";
  "fb" == t ? e = "/ingestion?type=facebook&for=gh" :"fr" == t && (e = "/ingestion?type=flickr&for=gh");
  window.open(e, "uploadphotos", "resizable=no,width=751,height=534,scrollbars=yes,status=yes,titlebar=yes,top=NaNNaN");
 }, this.current_state = this.navType.photosAndVideos;
 this.Util = this.Util || {};
 this.Util.historyState = {};
 this.Util.resetHistoryState = function() {
  photoOrg.photoLib.Util.historyState = {};
 };
 this.Util.componentView = null;
 this.Util.appendHashtoURL = function(t) {
  var e = "#state=" + encodeURIComponent($.toJSON(t));
  console.log("appendHashtoURL:", e, t);
  location.hash = e;
 };
 this.oauthInfo = {};
 this.limit = 25;
 this.locale = "";
 this.isTotalAssetsLoaded = !1;
 this.isTotalClustersLoaded = !1;
 this.showClusterView = !1;
 this.isSingleAlbumAssetsLoaded = !1;
 this.isTotalAlbumsLoaded = !1;
 this.selectedImages = [];
 this.selectedAlbumAssets = [];
 this.cache = {};
 this.Util.updateConfig = function(t, e) {
  e.config.pictDetailView = t.pictDetailView;
  e.config.showStoryView = t.showStoryView;
  e.config.showFacesView = t.showFacesView;
  e.config.showVideos = t.showVideos;
  e.config.dndEnabled = t.dndEnabled;
  e.defaultSelected = t.preSelectedPics;
  e.config.loadAsPhotoPicker = t.loadAsPhotoPicker;
  e.config.hostName = t.hostName;
  e.config.callbackObj = t.callbackObj;
  e.config.instructionalContent = t.instructionalContent;
  e.config.buttonText = t.buttonText;
  e.config.showAddtoProject = t.showAddtoProject;
  e.config.pickerHeight = t.pickerHeight;
  e.config.divId = t.divId;
  e.config.cobrand = t.cobrand;
  e.config.productCategory = t.productCategory;
  e.config.isGuestFlow = t.isGuestFlow;
  photoOrg.oauthInfo = {
   oa2:t.oa2,
   GSID:t.gsid,
   refreshTime:t.expireTime
  };
  try {
   photoOrg.startTime = _dataManager.getUserContext().token_refreshed_time;
  } catch (o) {
   photoOrg.startTime = new Date().getTime();
  }
 };
 this.Util.getAssetFetcher = function() {
  return new AssetFetcher();
 };
 this.Util.isTouchDevice = function() {
  return Modernizr.touch || navigator.msMaxTouchPoints || navigator.MaxTouchPoints;
 };
 this.Util.deleteSelectedAlbums = function() {
  photoOrg.currentAlbum.deleteAlbum();
 };
 this.Library = {};
 this.Library.FilterInfo = {
  searchFilter:{
   searchFilterInfo:"",
   searchCount:0,
   getSearchFilters:function() {
    return this.searchFilterInfo;
   },
   setSearchFilters:function(t) {
    return this.searchFilterInfo = t;
   },
   resetSearchFilter:function() {
    this.searchFilterInfo = "";
   },
   getSearchCount:function() {
    return this.searchCount;
   },
   setSearchCount:function(t) {
    this.searchCount = t;
   }
  },
  dateFilter:{
   dateStart:"",
   dateEnd:"",
   getDateFilter:function() {
    return {
     dateStart:this.dateStart,
     dateEnd:this.dateEnd
    };
   },
   setDateFilter:function(t, e) {
    this.dateStart = t;
    this.dateEnd = e;
   },
   resetdateFilter:function() {
    this.dateStart = "";
    this.dateEnd = "";
   }
  },
  defaultDate:{
   boundMinDate:new Date(2011, 0, 1),
   boundMaxDate:new Date(2013, 11, 31),
   defaultValuesMinDate:new Date(2011, 0, 1),
   defaultValuesMaxDate:new Date(2013, 11, 31),
   getDefaultDate:function() {
    return {
     boundMinDate:this.boundMinDate,
     boundMaxDate:this.boundMaxDate,
     defaultValuesMinDate:this.defaultValuesMinDate,
     defaultValuesMaxDate:this.defaultValuesMaxDate
    };
   },
   setDefaultDate:function(t) {
    this.boundMinDate = t.boundMinDate;
    this.boundMaxDate = t.boundMaxDate;
    this.defaultValuesMinDate = t.defaultValuesMinDate;
    this.defaultValuesMaxDate = t.defaultValuesMaxDate;
   }
  },
  peopleFilter:{
   bulkPictInfoList:[],
   addPictInfo:function(t) {
    this.bulkPictInfoList.push(t);
   },
   getBulkPicList:function() {
    return this.bulkPictInfoList;
   },
   resetBulkPicList:function() {
    this.bulkPictInfoList = [];
   }
  },
  sortWord:"",
  selectFilter:{
   mediaFilter:"photos_&_videos",
   assetFilter:"by_date",
   setCriteria:function(t, e) {
    this.mediaFilter = t;
    this.assetFilter = e;
   },
   getCriteria:function() {
    return {
     mediaFilter:this.mediaFilter,
     assetFilter:this.assetFilter
    };
   },
   resetToDefaultCriteria:function() {
    this.mediaFilter = "photos_&_videos";
    this.assetFilter = "by_date";
   }
  },
  resetAllFilter:function() {
   this.searchFilter.resetSearchFilter();
   this.dateFilter.resetdateFilter();
   this.peopleFilter.resetBulkPicList();
   this.selectFilter.resetToDefaultCriteria();
  }
 };
 this.albumModelList = new Object();
 this.SelectedAsset = {};
 this.SelectedAsset.selectedAssets = void 0 != photoOrg.selectedAssets ? new photoOrg.selectedAssets() :"";
 this.albumAssets = {};
 this.ResponseAssets = Backbone.Collection.extend({
  model:photoOrg.pict
 });
 this.albumAssets.responseAssets = new this.ResponseAssets();
 this.UserAssetsInfo = {};
 this.UserAssetsInfo.assetList = new userAssets();
 this.UserAssetsInfo.assetsCount = 0;
 this.UserAssetsInfo.assetViewsMap = {};
 this.UserAssetsInfo.singleAlbumsAssets = new userAssets();
 this.UserAssetsInfo.userAlbums = new userAssets();
 this.UserAssetsInfo.clusterList = new userAssets();
 this.defaultSelected = [];
 this.config = {};
 this.config.showStoryView = !0;
 this.config.showFacesView = !0;
 this.config.pictDetailView = !0;
 this.config.dndEnabled = !0;
 this.config.showVideos = !0;
 this.config.loadAsPhotoPicker = !1;
 this.config.hostName = "";
 this.config.instructionalContent = "";
 this.config.buttonText = "";
 this.showMetaData = !1;
 this.singleAlbumAssetRotated = !1;
 this.showSelectIcon = !1;
 this.areSharedPhotosSelected = "";
 this.selectedShareAssestsCount = 0;
 this.areOwnedPhotosSelected = "";
 this.onScrollLoadPics = function() {
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos || (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums ? eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, {}) :photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum || photoOrg.photoLib.current_state == photoOrg.photoLib.navType.PROJECTS && eventBus.trigger(eventBus.CUSTOM_EVENT_PROJECTS_SCROLLING, {}));
 };
 this.getValueFromArray = function(t, e) {
  if (void 0 != t && void 0 != e) for (var o = 0; o < t.length; o++) {
   var i = t[o];
   if (i.fileType == e) return i;
  }
 };
 this.getValue = function(t, e) {
  if (void 0 != t && void 0 != e) for (var o = 0; o < t.length; o++) {
   var i = t[o];
   if (i.key == e) return photoOrg.Util.strip(i.value && i.value.toString() || "");
  }
  return "";
 };
 this.getIndex = function(t, e) {
  if (void 0 != t && void 0 != e) for (var o = 0; o < t.length; o++) {
   var i = t[o];
   if (i.key == e) return o;
  }
 };
 this.getLowORHires = function(t) {
  var e = this.getValueFromArray(t, "THUMBNAIL");
  if (null == e || void 0 == e) {
   e = this.getValueFromArray(t, "LOWRES");
   (null == e || void 0 == e) && (e = this.getValueFromArray(t, "HIRES"));
  }
  void 0 == e && (e = {
   url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"
  });
  return e;
 };
 this.getHiresORThumbnail = function(t) {
  var e = this.getValueFromArray(t, "HIRES");
  (null == e || void 0 == e) && (e = this.getValueFromArray(t, "THUMBNAIL"));
  void 0 == e && (e = {
   url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"
  });
  return e;
 };
 this.clickOnUploaderOrIngestion = function(t) {
  t && "uploader" == t ? $(".mycomputer_link").click() :t && "fbk" == t ? $(".facebook_link").click() :t && "instagram" == t ? $(".instagram_link").click() :t && "flickr" == t && $(".flickr_access").click();
 };
 this.checkLoginForUploader = function(t) {
  photoOrg.oauthFetcher.checkOauthAvailable() || photoOrg.Util.getLoginRedirectUrl(!1, "isuplader=true&type=" + t);
 };
 this.getThumbOrHigher = function(t) {
  function e(t) {
   return null == t || void 0 == t;
  }
  var o = this.getValueFromArray(t, "THUMBNAIL");
  if (e(o)) {
   o = this.getValueFromArray(t, "LOWRES");
   e(o) && (o = this.getValueFromArray(t, "HIRES"));
  }
  return o;
 };
 this.resetGrids = function(t) {
  photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && $(".albums").click();
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums) {
   photoOrg.photoLib.isNeedToReload = !0;
   eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {});
  }
  if (photoOrg.photoLib.navType.photosAndVideos == photoOrg.photoLib.current_state) {
   var e = photoOrg.photoLib.Util.historyState;
   t ? $(".albums").click() :eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
    urlParam:e.so || "dateTaken"
   });
  }
 }, this.getLOWorTHUMBNAIL = function(t) {
  var e = this.getValueFromArray(t, "THUMBNAIL");
  if (null != e || void 0 != e) return e;
  e = this.getValueFromArray(t, "LOWRES");
  void 0 == e && (e = {
   url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"
  });
  return e;
 };
 this.getScrollerEndPoint = function(t) {
  var e = $(t).prop("scrollHeight"), o = $(t).height(), i = e - o, s = $(t).scrollTop();
  return s === i ? !0 :!1;
 };
 this.reloadAssets = function(t, e, o, i, s, r) {
  if (!(isNaN(parseInt(s)) || 0 >= s || isNaN(Number(s)))) {
   !photoOrg.photoLib.config.loadAsPhotoPicker && photoOrg.photoLib.seletedAlbums && photoOrg.Util.deleteAndUpdateAlbumInfoInLocalStorage(i);
   photoOrg.albumIdForAlbumsView = i;
   photoOrg.Util.uploadMoreType = r;
   photoOrg.Util.newUser = !1;
   0 != photoOrg.albumIdForAlbumsView && (photoOrg.Util.recentUploadedAlbumId = photoOrg.albumIdForAlbumsView);
   $(".photo-Org #loadingBar").show();
   t = decodeURIComponent(t);
   e = decodeURIComponent(e);
   if (photoOrg.photoLib.config.loadAsPhotoPicker && void 0 != t && t.split(",").length > 0) {
    gon.staticContent.pict_ids = void 0 != gon.staticContent.pict_ids && null != gon.staticContent.pict_ids && gon.staticContent.pict_ids.length > 0 ? gon.staticContent.pict_ids.concat(t.split(",").map(function(t) {
     return Number(t);
    })) :t.split(",").map(function(t) {
     return Number(t);
    });
    photoOrg.photoLib.config.loadAsPhotoPicker && $(".photo_videos").attr("class").indexOf("selected") < 0;
   }
   photoOrg.photoLib.windowObjectReference = null;
   photoOrg.photoLib.isNeedToReload = !0;
   if (photoOrg.photoLib.navType.photosAndVideos == photoOrg.photoLib.current_state) {
    $(".styled-select").val("createDate");
    if (photoOrg.photoLib.config.loadAsPhotoPicker) {
     try {
      $("#choosedSortOption").attr("data-value", $("#dateSorting .create-date").attr("data-value").trim());
      $("#choosedSortOption").text($("#dateSorting .create-date").text());
     } catch (n) {}
     console.log("reloadAssets--CUSTOM_EVENT_FILTER_RESET");
     eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
      urlParam:"createDate"
     });
    } else {
     var a = photoOrg.photoLib.Util.historyState;
     if ("createDate" != a.so) {
      a.so = "createDate";
      try {
       $("#choosedSortOption").attr("data-value", $("#dateSorting .create-date").attr("data-value").trim());
       $("#choosedSortOption").text($("#dateSorting .create-date").text());
      } catch (n) {}
      photoOrg.photoLib.Util.appendHashtoURL(a);
     } else {
      console.log("reloadAssets--CUSTOM_EVENT_FILTER_RESET");
      eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
       urlParam:"createDate"
      });
     }
    }
   } else if (photoOrg.photoLib.navType.albums == photoOrg.photoLib.current_state) {
    $(".styled-select").val("createDate");
    photoOrg.photoLib.isUploaded = !0;
    if (photoOrg.photoLib.config.loadAsPhotoPicker) this.openOwnedSingleAlbumView(); else {
     var a = photoOrg.photoLib.Util.historyState;
     if ("descending" != a.so) {
      a.so = "descending";
      photoOrg.photoLib.Util.appendHashtoURL(a);
     } else {
      photoOrg.forceReload = !0;
      console.log("Force loading Albums :: after success callback for uploder/ingestion ");
      eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {
       urlParam:"createDate"
      });
     }
    }
   } else if (photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state) {
    photoOrg.photoLib.isUploaded = !0;
    photoOrg.photoLib.config.loadAsPhotoPicker ? o ? this.openOwnedSingleAlbumView() :eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, {
     sortCriteria:"createDate",
     selectedSortOrder:"descending"
    }) :o || eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, {
     sortCriteria:"createDate",
     selectedSortOrder:"descending"
    });
   }
   if (0 != e && "undefined" != e) {
    try {
     s = parseInt(s);
    } catch (l) {
     s = t.split(",").length;
    }
    $(".uploadedPhotosCount").text(window.translations.added_photos_txt_with_count.replace("%{added_pics_count}", s));
    $(".pgConfirmAlbumName").html("<h3>'" + e + "'</h3>");
    $("#ingestion_Modal .ingestionLoadingOverlay").show();
    $("#pgConfirmModel").foundation("reveal", "open");
    $("#pgConfirmModel").on("opened", function() {
     $("#pgConfirmModel .done-button").focus();
    });
   }
  }
 };
 this.openOwnedSingleAlbumView = function() {
  if (photoOrg.albumIdForAlbumsView && 0 != photoOrg.albumIdForAlbumsView) {
   photoOrg.photoLib.isUploaded = !0;
   photoOrg.photoLib.Util.resetHistoryState();
   var t = photoOrg.photoLib.Util.historyState;
   "createDate" != t.so && (t.so = "createDate");
   t[photoOrg.constants.PAGE_VIEW] = photoOrg.constants.SINGLE_ALBUM_VIEW;
   t[photoOrg.constants.ALBUM_ID] = photoOrg.albumIdForAlbumsView;
   $("#album_assets").show();
   photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.makeActionView.handleSingleAlbumView() :photoOrg.photoLib.Util.appendHashtoURL(t);
  } else photoOrg.jsErrorLogger('"Album Id is missing, to open single album view", errorCode="LIBRARY:LibraryUtils"');
 };
 this.windowObjectReference = null;
 this.attachUploadListener = function() {
  var t = function(t) {
   if ("success" == t.originalEvent.data) {
    photoOrg.photoLib.windowObjectReference = null;
    photoOrg.photoLib.isNeedToReload = !0;
    if (photoOrg.photoLib.navType.photosAndVideos == photoOrg.photoLib.current_state) {
     $(".styled-select").val("createDate");
     if (photoOrg.photoLib.config.loadAsPhotoPicker) {
      console.log("reloadAssets--CUSTOM_EVENT_FILTER_RESET");
      eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
       urlParam:"createDate"
      });
     } else {
      var e = photoOrg.photoLib.Util.historyState;
      if ("createDate" != e.so) {
       e.so = "createDate";
       photoOrg.photoLib.Util.appendHashtoURL(e);
      } else {
       console.log("reloadAssets--CUSTOM_EVENT_FILTER_RESET");
       eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
        urlParam:"createDate"
       });
      }
     }
    } else if (photoOrg.photoLib.navType.albums == photoOrg.photoLib.current_state) {
     photoOrg.photoLib.isUploaded = !0;
     if (photoOrg.photoLib.config.loadAsPhotoPicker) eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {
      urlParam:"descending"
     }); else {
      var e = photoOrg.photoLib.Util.historyState;
      if ("descending" != e.so) {
       e.so = "descending";
       photoOrg.photoLib.Util.appendHashtoURL(e);
      } else eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {
       urlParam:"descending"
      });
     }
    } else if (photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state) {
     photoOrg.photoLib.isUploaded = !0;
     $(".photo-Org .photo_videos").click();
    }
   }
   "closedUpload" == t.originalEvent.data && (photoOrg.photoLib.windowObjectReference = null);
  };
  $(window).on("message", t);
 };
 this.onFirstAssetSuccessCallback = function(t) {
  photoOrg.photoLib.albumAssets.responseAssets.add(new photoOrg.pict(t.entities[0]));
  _.each(photoOrg.photoLib.albumAssets.data.entities, function(t) {
   var e = new photoOrg.pict(t);
   photoOrg.photoLib.albumAssets.responseAssets.add(e);
  });
  eventBus.trigger(eventBus.CUSTOM_EVENT_GOT_NEXT_IMAGES_SET, {});
 };
 this.errorNoAssetCallBack = function() {
  console.log("error gettting album pics");
 };
 this.getAlbumPics = function(t, e) {
  function o(o) {
   photoOrg.photoLib.albumAssets.data = o;
   if (0 == t) {
    r = {
     id:$("#section_" + photoOrg.photoLib.albumIdEdit + " .storyImage").attr("id") || ""
    };
    var i = "";
    n.getAssetInfo(i, r, photoOrg.photoLib.onFirstAssetSuccessCallback, photoOrg.photoLib.errorNoAssetCallBack, e);
    n = {};
   } else _.each(photoOrg.photoLib.albumAssets.data.entities, function(t) {
    var e = new photoOrg.pict(t);
    photoOrg.photoLib.albumAssets.responseAssets.add(e);
   });
  }
  function i() {
   console.log("error gettting album pics");
  }
  if (!(0 > t || isNaN(t))) {
   var s = "&limit=" + photoOrg.photoLib.limit + "&skip=" + t + "&sortCriteria=dateTaken", r = {
    album_id:photoOrg.photoLib.albumIdEdit
   };
   r.urlparam = s;
   var n = new AssetFetcher();
   if ("" != photoOrg.photoLib.albumIdEdit) {
    var a = "";
    n.getSingleAlbumInfo(a, r, o, i, e);
   }
  }
 };
 this.getNoOfPagestoDisplay = function(t) {
  return Math.ceil(t / photoOrg.photoLib.limit);
 };
 this.getPageCount = function(t, e) {
  return Math.ceil(t / e);
 };
 this.isVideoAsset = function(t, e) {
  var o = this.getValueFromArray(t, e);
  return null == o || void 0 == o ? !1 :!0;
 };
 this.defaultFileArray = [ {
  fileType:"HIRES",
  url:"/assets/noasset.jpg",
  width:2574,
  height:2574,
  size:0
 }, {
  fileType:"THUMBNAIL",
  url:"/assets/noasset.jpg"
 }, {
  fileType:"OLOWRES",
  url:"/assets/noasset.jpg",
  width:800,
  height:800,
  size:0
 } ];
 this.isValidateAssets = function(t) {
  var e = [];
  _.each(t.entities, function(o) {
   try {
    0 == o.userTags.length && (o.userTags = [ {
     value:"noName.jpg",
     key:"fileName"
    }, {
     value:"noName",
     key:"caption"
    } ]);
    if (o.files.length > 0 && photoOrg.photoLib.isVideoAsset(o.files, "VIDEO")) {
     o.files.push({
      fileType:"HIRES",
      url:gon.staticContent.library_cdn_host + "/assets/noasset-1.jpg",
      width:2574,
      height:2574,
      size:0
     });
     o.files.push({
      fileType:"THUMBNAIL",
      url:gon.staticContent.library_cdn_host + "/assets/noasset-1.jpg"
     });
     o.files.push({
      fileType:"OLOWRES",
      url:gon.staticContent.library_cdn_host + "/assets/noasset-1.jpg",
      width:800,
      height:800,
      size:0
     });
    }
    0 == o.files.length && (o.files = [ {
     fileType:"HIRES",
     url:gon.staticContent.library_cdn_host + "/assets/noasset.jpg",
     width:2574,
     height:2574,
     size:0
    }, {
     fileType:"THUMBNAIL",
     url:gon.staticContent.library_cdn_host + "/assets/noasset.jpg"
    }, {
     fileType:"OLOWRES",
     url:gon.staticContent.library_cdn_host + "/assets/noasset.jpg",
     width:800,
     height:800,
     size:0
    } ]);
    e.push(o);
   } catch (i) {
    console.log(i);
    e = t.entities;
   }
  });
  t.entities = e;
  return t;
 }, this.selectPicts = function(t, e, o) {
  try {
   if (!photoOrg.photoLib.config.loadAsPhotoPicker && !_.contains(photoOrg.photoLib.selectedImages, t) && void 0 != gon.staticContent.pict_ids && null != gon.staticContent.pict_ids && _.contains(gon.staticContent.pict_ids, t)) if (photoOrg.photoLib.current_state != photoOrg.photoLib.navType.singleAlbum) e.clickOnAssetUnSelectIcon(); else {
    var i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(t);
    e.clickOnAssetUnSelectIcon(o, i);
   }
  } catch (s) {
   console.log(s);
  }
 }, this.getPictAssetRefsByIds = function(t) {
  var e = [];
  for (i = 0; i < photoOrg.photoLib.selectedImages.length; i++) {
   var o = photoOrg.photoLib.SelectedAsset.selectedAssets.get(photoOrg.photoLib.selectedImages[i]), s = o.attributes.files || o.attributes.thumbnailEncryption, r = this.getThumbnailUrlFromFiles(s) || o.attributes.thumbnailEncryption;
   if (r) if (t && gon.staticContent.account_id == (o.attributes.ownerAccountId || o.attributes.parentCollectionReferences[0].ownerAccountId + "")) e.push(r.toString()); else {
    if (t) continue;
    e.push(photoOrg.photoLib.selectedImages[i] + "_" + r);
   }
  }
  return e;
 }, this.getSelectedPictAssetRefs = function() {
  return this.getPictAssetRefsByIds(!0);
 }, this.getThumbnailUrlFromFiles = function(t) {
  if (t && !(t && t.length <= 0)) for (var e = 0; e < t.length; e++) if ("THUMBNAIL" == t[e].fileType) return t[e].url;
 }, this.updateCurrentStateToJStorage = function() {
  $.jStorage.set(gon.staticContent.account_id + "_state", photoOrg.photoLib.Util.historyState);
 };
 this.updateGlobalSession = function(t) {
  if ((0 != photoOrg.photoLib.selectedImages.length || !_.isEqual(photoOrg.photoLib.selectedImages, photoOrg.photoLib.original_globalSession_pict_oids) && void 0 != photoOrg.photoLib.original_globalSession_pict_oids) && !photoOrg.photoLib.config.loadAsPhotoPicker && -1 == document.location.href.indexOf("uploader_ui") && -1 == document.location.href.indexOf("uploader") && (null != gon.staticContent.session_update || void 0 != gon.staticContent.session_update) && gon.staticContent.session_update) {
   var e = document.getElementById("refreshed");
   photoOrg.photoLib.selectedAlbumAssets.length > 0 && 1 == photoOrg.photoLib.custOrderPrints && (photoOrg.photoLib.selectedImages = photoOrg.photoLib.selectedAlbumAssets);
   var o = this.getPictAssetRefsByIds() + "";
   photoOrg.Util.removeStorageKeys("picts_from_library_for_" + gon.staticContent.account_id);
   try {
    photoOrg.storePicsInLocalStorage && "undefined" != typeof Storage && this.setPicsToLocalStorage(photoOrg.photoLib.SelectedAsset.selectedAssets, o, !1);
    this.sendThroughGlobalSession(o, t);
   } catch (e) {
    var i = "Library:PhotoLibrary::updateGlobalSession : unable to store in localStorage therefore sending through global session " + e;
    photoOrg.jsWarningLogger(i);
    this.sendThroughGlobalSession(o, t);
   }
   photoOrg.photoLib.selectedImages = photoOrg.photoLib.selectedImages.filter(function(t) {
    return photoOrg.photoLib.videos.indexOf(t) < 0;
   });
   if (void 0 == gon.staticContent.redirectURL || !gon.staticContent.redirectURL) return;
   photoOrg.photoLib.needUpdatingGlobalsession = !1;
   document.location.href = gon.staticContent.redirectURL;
  }
 }, this.sendThroughGlobalSession = function(t, e) {
  var o = gon.staticContent.library_url + "/updateSession", i = photoOrg.Util.getBrowserSessionCookie("GSID"), s = photoOrg.Util.getBrowserSessionCookie("oa2"), r = JSON.stringify(photoOrg.photoLib.selectedImages);
  r = r.replace("[", "").replace("]", "");
  var n = {
   entity:{
    fieldList:{
     field:[ {
      name:"GSID",
      value:i
     }, {
      name:"selected_pict_ids",
      value:r
     }, {
      name:"selected_pict_asset_refs",
      value:t
     } ]
    },
    indexkeyList:[ "GSID" ],
    uuid:i
   }
  }, a = {
   oa2:s,
   gsid:i
  };
  a.data = $.toJSON(n);
  var l = !1;
  void 0 == e || void 0 == e.async || 1 != e.async && 0 != e.async || (l = e.async);
  (null != navigator.userAgent.match(/iPad/i) || null != navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/Macintosh/i)) && (l = !1);
  $.ajax({
   url:o,
   dataType:"json",
   type:"POST",
   async:l,
   data:a,
   success:function() {
    gon.staticContent.pict_ids = photoOrg.photoLib.selectedImages;
    if (void 0 != gon.staticContent.redirectURL && gon.staticContent.redirectURL) {
     photoOrg.photoLib.needUpdatingGlobalsession = !1;
     document.location.href = gon.staticContent.redirectURL;
    }
   },
   error:function() {
    if (void 0 != gon.staticContent.redirectURL && gon.staticContent.redirectURL) {
     photoOrg.photoLib.needUpdatingGlobalsession = !1;
     document.location.href = gon.staticContent.redirectURL;
    }
   }
  });
 }, this.setPicsToLocalStorage = function(t) {
  try {
   var e = t.length || 0, o = "";
   if (t) var i = t.models, s = {
    model_type:"ASSET_DATA",
    model_count:t.length,
    models:i
   };
   o = JSON.stringify(s) || "";
  } catch (r) {
   photoOrg.jsWarningLogger('"Library:PhotoLibrary:setPicsToLocalStorage: Exception in data preparation : ' + r);
  }
  try {
   localStorage.setItem("picts_from_library_for_" + gon.staticContent.account_id, o);
  } catch (r) {
   photoOrg.jsWarningLogger('"Library:PhotoLibrary:setPicsToLocalStorage: Exception in local storage due to ' + r + '", "Assets length is ' + e + '", "modal length is ' + o.length + '"');
  }
 }, this.getAssetInfoUsingIds = function(t, e, o, i) {
  function s(t) {
   console.log(t);
  }
  function r() {}
  i = i.split(",");
  for (var n = 0; n < i.length; n++) i[n] = i[n].substring(i[n].indexOf("_") + 1, i[n].length);
  gon.staticContent.pict_ids = i;
  photoOrg.photoLib.original_globalSession_pict_oids = i;
  var a = {
   AssetReferences:i
  }, l = gon.staticContent.pict_service + "asset/list", c = {
   data:JSON.stringify(a),
   headers:{
    "content-type":"application/json"
   }
  }, h = "POST", d = s;
  void 0 != t && (d = t);
  var p = r();
  void 0 != e && (p = e);
  var u = photoOrg.photoLib;
  void 0 != o && (u = o);
  var g = new AssetFetcher();
  g.getAssetInfoUsingIds(h, l, c, d, p, u);
 };
 this.getAlbumTitle = function(t) {
  for (var e = 0; e < t.userTags.length; e++) if ("caption" == t.userTags[e].key) return t.userTags[e].value;
 };
 this.getAssetUrl = function(t, e) {
  if (t && void 0 != t.files) for (var o = 0; o < t.files.length; o++) {
   var i = t.files[o];
   if (i.fileType == e) return i.url;
  }
 };
 this.showOrHideAlbumCopyMessage = function(t) {
  t ? 1 == $.jStorage.get(photoOrg.Util.getBrowserSessionCookie("GSID")) ? $("#libText").hide() :1 == gon.staticContent.share && $("#libText").show() :$("#libText").hide();
 };
 this.getLikesText = function(t) {
  var e = "";
  if (t && t > 0) {
   e = " " + window.translations.social_network.like_text;
   t > 1 && (e = " " + window.translations.social_network.likes_text);
  }
  return e;
 };
 this.getCommentsText = function(t) {
  var e = "";
  if (t && t > 0) {
   e = " " + window.translations.social_network.comment_text;
   t > 1 && (e = " " + window.translations.social_network.comments_text);
  }
  return e;
 }, this.setDropdownEvetns = function() {
  $(".ib-dropdown-menu").on("opened.fndtn.dropdown", function() {
   var t = $(this).attr("id");
   $('.dropdown-button[data-dropdown="' + t + '"]').addClass("highlight");
  });
  $(".ib-dropdown-menu").on("closed.fndtn.dropdown", function() {
   var t = $(this).attr("id");
   $('.dropdown-button[data-dropdown="' + t + '"]').removeClass("highlight");
  });
 };
 this.changePickerHeaderPrints = function() {
  if (gon.staticContent.enable_show_picker_header) if (photoOrg.photoLib.config.productCategory && "Prints" == photoOrg.photoLib.config.productCategory) {
   var t = window.translations.select_photos_picker;
   $(".pickerHeadingText").html(t);
   $(".addToProjectText").html(window.translations.picker.pickerAddPhotosPrints);
   $(".addToProjectText").addClass("arrowHide");
  } else this.defaultPickerHeader(); else this.defaultPickerHeader();
 };
 this.defaultPickerHeader = function() {
  $(".pickerHeadingText").html(window.translations.select_photos);
  $(".addToProjectText").html(window.translations.add_selected_photos);
  $(".pickerSelectPhotos").show();
  $(".pickerSelectPhotos").html(window.translations.picker_selection_info);
  $(".addToProjectText").removeClass("arrowHide");
  $("#picker-add-to-project").attr("data-dropdown", "pickerAddProjectHelp");
  $("#closeAddProjectHelp").click(function() {
   $("#pickerAddProjectHelp").removeClass("open").css("left", "-99999px");
  });
 };
 this.mrbPickerFlow = function() {
  $("#sub_header_container").hide();
  $(".my_snapfish_account_link").show();
  $(".empty_photos_text").hide();
  $(".mrb_picker_text").show();
  $(".picker_header_mrb").show();
  $(".picker-row").addClass("mrb-scroll");
  gon.staticContent.is_flickr_on ? $(".socialsite_upload_links ul").addClass("medium-block-grid-5").removeClass("medium-block-grid-4") :$(".socialsite_upload_links ul").addClass("medium-block-grid-4").removeClass("medium-block-grid-3");
  $(".login_mrb_link").click(function() {
   photoOrg.photoLib.mrbLoginMethod();
  });
  $(".mrb_my_snapfish_link").click(function() {
   photoOrg.photoLib.mrbLoginMethod();
  });
 };
 this.mrbLoginMethod = function() {
  var t = _dataManager.isGuestAccount() && (!StringUtils.isEmpty(_dataManager.getProjectId()) || _dataManager.getDirtyFlag());
  if (t && photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0) {
   console.log("Product Exists and photos selected-------------");
   var e = photoOrg.photoLib.SelectedAsset.selectedAssets;
   photoOrg.photoLib.config.callbackObj.addToBuilder(e);
   setTimeout(function() {
    console.log("Product Exists and photos selected -------------invoking save button click");
    $("#canvasToolsSave").click();
   }, 1e3);
  } else if (t && photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
   console.log("Product Exists and  no photos selected -------------");
   photoOrg.makeActionView.closePhotoPicker();
   setTimeout(function() {
    console.log("Product Exists and  no photos selected -------------invoking save button click");
    $("#canvasToolsSave").click();
   }, 1e3);
  } else if (!t && photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0) {
   console.log("Product does not Exists and photos selected-------------");
   var e = photoOrg.photoLib.SelectedAsset.selectedAssets;
   photoOrg.photoLib.config.callbackObj.addToBuilder(e);
   setTimeout(function() {
    console.log("Product does not Exists and photos selected-------------invoking save button click");
    $("#canvasToolsSave").click();
   }, 1e3);
  } else if (!t && photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
   console.log("Product does not Exists and  no photos selected -------------");
   if ($(".mrb_my_snapfish_link").is(":visible")) {
    console.log("No project available and photos not selected...so going to login -------------");
    photoOrg.Util.getLoginRedirectUrl(!0);
   } else {
    console.log("Product does not Exists and photos uploaded but not selected, showing confirmation popup -------------");
    photoOrg.Util.getLoginRedirectUrl(!0);
   }
  }
 };
 this.doCollectionAssetRequestAndShowConfirmation = function(t, e, o, i) {
  i || (i = "");
  if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var s = {
   albumId:t,
   urlparam:"&assetType=ALL" + i
  }; else var s = {
   albumId:t,
   urlparam:i
  };
  photoOrg.tobeDeletedAssets = [];
  new AssetFetcher().getSingleAlbumInfo("", s, $.proxy(function(i) {
   if (i) {
    for (var s = i.entities, r = s.length, n = 0; r > n; n++) {
     var a = s[n];
     photoOrg.tobeDeletedAssets.push(a);
    }
    photoOrg.deleteConfirmationModal.show({
     type:photoOrg.ModalTypes.ALBUM,
     albumID:t,
     container_key:e.container_key,
     name:e.caption,
     success:o.deleteSuccessCallback,
     error:o.deleteErrorCallback,
     showDeletePhotoCheckbox:!1,
     obj:o
    });
   }
  }, this));
 };
 this.deselectImagesFromTrayAfterAlbumDelete = function() {
  for (var t = 0; t < photoOrg.tobeDeletedAssets.length; t++) {
   var e = photoOrg.tobeDeletedAssets[t];
   photoOrg.photoLib.config.loadAsPhotoPicker || -1 == $.inArray(e.id, photoOrg.photoLib.selectedImages) || photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(e.id);
   photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, e.id);
   var o = photoOrg.photoLib.SelectedAsset.selectedAssets.get(e.id);
   photoOrg.photoLib.SelectedAsset.selectedAssets.remove(o);
   gon.staticContent.pict_ids = photoOrg.photoLib.selectedImages;
  }
 }, this.getKeyFromDate = function(t) {
  if (t && void 0 != t) {
   var e = t.split("-");
   e[1] = parseInt(e[1]) - 1;
   return e[1] + "_" + e[0];
  }
 }, this.updateAlbumFilter = function(t, e) {
  $(".album-sorting").show();
  $(".favemptytxt").hide();
  if (e && void 0 != photoOrg.photoLib.Util.historyState.pg && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) {
   $(".album-sorting .selected-option").html(window.translations.sub_header.recentlyModified);
   $(".album_discending").removeClass("selected");
   $(".album_ascending").removeClass("selected");
   $(".recently_modified").addClass("selected");
  } else if ("descending" == t) {
   $(".album-sorting .selected-option").html(window.translations.sub_header.newesttooldest);
   $(".album_discending").addClass("selected");
   $(".album_ascending").removeClass("selected");
   $(".recently_modified").removeClass("selected");
  } else if ("ascending" == t) {
   $(".album-sorting .selected-option").html(window.translations.sub_header.oldesttonewest);
   $(".album_ascending").addClass("selected");
   $(".album_discending").removeClass("selected");
   $(".recently_modified").removeClass("selected");
  }
 }, this.getHAndWForImage = function(t) {
  var e, o, i = {
   height:null,
   width:null
  }, e = photoOrg.photoLib.getCurrentHAndW(t);
  if (e && e.height && e.height) return e;
  try {
   o = t.get("files");
   void 0 == o && (o = t.attributes.attributes.files);
  } catch (s) {
   o = t.files;
  }
  e = this.getValueFromArray(o, "HIRES");
  if (e) {
   i.height = e.height;
   i.width = e.width;
  }
  if (!i.height || !i.width) {
   e = {
    url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"
   };
   i.height = 0;
   i.width = 0;
  }
  return i;
 }, this.getCurrentHAndW = function(t) {
  var e, o = {
   height:null,
   width:null
  };
  try {
   e = t.get("currentImageInfo");
  } catch (i) {
   e = t.currentImageInfo;
  }
  if (e) {
   o.height = e.currentHeight;
   o.width = e.currentWidth;
  }
  return o;
 };
 this.showExpressProductAndBuildMap = function() {
  try {
   photoOrg.photoLib.expressProduct.productMap = {};
   gon.staticContent.expressPrintsSkuIds && gon.staticContent.expressPrintsSkuIds.length > 0 && _.each(gon.staticContent.expressPrintsSkuIds, function(t) {
    var e = gon.staticContent[t];
    if (e && e.availabilityMap && e.userPriceInfo && e.userPriceInfo.length > 0 && e.availabilityMap.coBrandCommerce) {
     gon.staticContent.isExpressFeatureOn && (photoOrg.photoLib.expressProduct.isShowExpressProduct = !0);
     var o = {
      skuId:t,
      finishType:e.attributes.finish,
      priceMap:e.userPriceInfo,
      availabilityMap:e.availabilityMap
     }, i = e.attributes.finish;
     "glossy" == i && (photoOrg.photoLib.expressProduct.firstProduct = t);
     photoOrg.photoLib.expressProduct.skuIds.push(t);
     photoOrg.photoLib.expressProduct.availabilityFinishType.push(i);
     photoOrg.photoLib.expressProduct.productMap[t] = o;
     photoOrg.photoLib.expressProduct.productMap[i] = o;
    }
   });
   if (gon.staticContent.isExpressFeatureOn && !photoOrg.photoLib.expressProduct.isShowExpressProduct) {
    var t = "isExpressFeatureOn" + gon.staticContent.isExpressFeatureOn;
    photoOrg.jsWarningLogger('"LIBRARY:LibraryUtils:showExpressProductAndBuildMap", errorCode="LIBRARY:LibraryUtils-Not Showing express prints", err_desc="' + t + '"');
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:LibraryUtils:showExpressProductAndBuildMap", errorCode="LIBRARY:LibraryUtils", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 }, this.getConfirmation = function() {
  try {
   $.ajax({
    url:newConfirmationWidget,
    dataType:"script",
    cache:!0
   }).done(function() {
    console.log("newConfirmationWidget loaded successfully");
    photoOrg.uploadConfirmationLayer = new photoOrg.UploadConfirmationLayer({
     el:$("#pgConfirmModel")
    });
   }).fail(function() {
    console.error("Error while loading new Confirmation Widget...");
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:LibraryUtils:getConfirmation", errorCode="LIBRARY:LibraryUtils", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }, this.showBookProductAndBuildMap = function() {
  try {
   photoOrg.photoLib.bookProduct.productMap = {};
   gon.staticContent.bookSkuIds && gon.staticContent.bookSkuIds.length > 0 && _.each(gon.staticContent.bookSkuIds, function(t) {
    var e = gon.staticContent[t];
    if (e && e.availabilityMap && e.userPriceInfo && e.userPriceInfo.length > 0 && e.availabilityMap.coBrandCommerce) {
     photoOrg.photoLib.bookProduct.isShowbookProduct = !0;
     var o = {
      skuId:t,
      finishType:e.attributes.finish,
      priceMap:e.userPriceInfo,
      availabilityMap:e.availabilityMap
     }, i = e.attributes.finish;
     photoOrg.photoLib.bookProduct.skuIds.push(t);
     photoOrg.photoLib.bookProduct.availabilityFinishType.push(i);
     photoOrg.photoLib.bookProduct.productMap[t] = o;
    }
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:LibraryUtils:showBookProductAndBuildMap", errorCode="LIBRARY:LibraryUtils", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }, this.formatSharedAlbumResponsedata = function(t) {
  var e = {};
  e.entities = [];
  this.assetIdList = t.entities[1].assetIdList;
  for (var o = 0; o < t.entities[1].assetIdList.length; o++) e.entities.push(photoOrg.shareModelResponseFormat.prepareMockAssetObject(t.entities, this, o));
  e.resultCount = t.entities[1].assetIdList.length;
  e.totalEntitiesCount = t.entities[1].assetIdList.length;
  return e;
 }, this.editOperationsInit = function(t) {
  try {
   var e = photoOrg.Util.getURLParameter("needEditOverlay");
   t.doneCallBack = photoOrg.photoLib.editSuccessCallback;
   t.failureCallBack = photoOrg.photoLib.editFailureCallback;
   t.closeEditCallback = photoOrg.photoLib.closeEditCallback;
   t.isSaveJournal = !0;
   t.isEnableEsc = !0;
   t.isHtmlLoaded = !0;
   t.filter = {
    filters:gon.staticContent.library_filters
   };
   if (null != e && e.length > 0) {
    if ($("#edit_model_overlay").length <= 0) {
     var o = JST["templates/common/edit/edit_model_overlay"]();
     $("#library").append(o);
    }
    $("#edit_model_overlay").foundation("reveal", "open");
    t.domId = "#edit_model_overlay .sf-library";
    $("#overlay").css("z-index", "99");
   }
   if (void 0 == photoOrg.editWidgetView) {
    t.website = gon.staticContent.websiteName;
    t.cobrand = gon.staticContent.cobrandName;
    t.locale = gon.staticContent.locale;
    t.libraryCdnUrl = gon.staticContent.library_url;
    new photoOrg.editWidget().init(t);
   } else if (null != e && e.length > 0) {
    $("#edit_model_overlay").unbind("opened");
    $("#edit_model_overlay").bind("opened", function() {
     photoOrg.editWidgetView.init(t);
    });
   } else photoOrg.editWidgetView.init(t);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:library_utils:editOperationsInit", errorCode="LIBRARY:EDIT", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 }, this.editFailureCallback = function() {}, this.editSuccessCallback = function(t, e) {
  try {
   var o = void 0;
   if (e) {
    o = new photoOrg.pict(t.entities[0]);
    var i = new photoOrg.assetView({
     model:o
    });
    photoOrg.photoLib.UserAssetsInfo.assetViewsMap[o.id] = i;
    o = photoOrg.Util.AddNewCopyToCollection(t);
    var s = photoOrg.photoLib.Util.historyState;
    if (void 0 != s.pg && (-1 !== s.pg.indexOf(photoOrg.constants.SINGLE_ALBUM_VIEW) || -1 !== s.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) || -1 !== s.pg.indexOf(photoOrg.constants.SHARED_SINGLE_ALBUM_VIEW) || -1 !== s.pg.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) || -1 !== s.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW))) {
     eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, {});
     photoOrg.photoLib.adjustScreenSAV = !0;
     console.log("triggered single abum view reload");
    }
   } else o = photoOrg.Util.updateResponseWithExistingModel(t);
   photoOrg.photoLib.closeEditCallback(o, e);
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:library_utils:editSuccessCallback", errorCode="LIBRARY:EDIT", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 }, this.closeEditCallback = function(t, e) {
  try {
   $("body").off("click");
   $("#edit_model_overlay").foundation("reveal", "close");
   if ("visible" == $("#detailedViewContainer").css("visibility")) {
    $("#overlay").hide();
    if (photoOrg.editOperationsView && e) {
     photoOrg.photoLib.cache && (photoOrg.photoLib.cache = {});
     if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
      photoOrg.detailedView && (photoOrg.detailedView.selectedAsset = "");
      photoOrg.makeActionView.handleSingleAlbumView();
     } else if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos) {
      $("#loadingBar").show();
      photoOrg.makeActionView.handleClusterView();
     }
    }
   }
   $("body").off("keydown");
   $("body").on("keydown", function(t) {
    photoOrg.detailedView && photoOrg.detailedView.closeDetailedView(t);
   });
   $("#dsktp-save-as-copy-header").hide();
   if ("hidden" == $("#detailedViewContainer").css("visibility")) {
    $("#detailedViewContainer").css("visibility", "visible");
    if (photoOrg.detailedView) {
     if (t && photoOrg.detailedView.model.id == t.id || e) {
      photoOrg.detailedView.model = t;
      photoOrg.detailedView.render();
      photoOrg.detailedView.updateAssetRotated();
     }
     $(".pullbtn").length <= 0 && photoOrg.detailedView.openProjectTray();
    }
    $("#detailedViewContainer").css("visibility", "visible");
   }
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:library_utils:closeEditCallback", errorCode="LIBRARY:EDIT", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 }, this.setUploadDeviceSpecification = function(t) {
  var t = $(window).width();
  if (photoOrg.isUploader) try {
   t = $(window.opener.parent).width();
  } catch (e) {
   photoOrg.jsErrorLogger('"Uploader opened in seperate window, so parent is not available ", errorCode="LIBRARY:LibraryUtils"');
  }
  var o, i;
  if (t >= 1024) if ((photoOrg.Util.isAndroid() || photoOrg.Util.isIos()) && photoOrg.Util.isTouchDevice()) {
   o = window.translations.my_tablet;
   i = "tablet-upload";
  } else o = window.translations.my_computer; else if (1024 >= t && t >= 768) {
   o = window.translations.my_tablet;
   i = "tablet-upload";
  } else {
   o = window.translations.my_phone;
   i = "phone-upload";
  }
  return [ o, i ];
 };
 this.download = function(t, e) {
  var o = document.createElementNS("http://www.w3.org/1999/xhtml", "a");
  e = e || "MyPhotos";
  var i = "download" in o, s = function(t) {
   var e = new MouseEvent("click");
   t.dispatchEvent(e);
  };
  if (i) {
   o.href = t;
   o.download = e;
   s(o);
  } else {
   var r = window.open(t, "_blank");
   r ? photoOrg.Util.isDesktop() ? setTimeout(function() {
    r.close();
   }, 1e4) :alert("Please close the new window/tab once download is completed") :window.location.href = t;
  }
  console.log("Downloaded successfully with URL : " + t);
 };
};

var userAssets = Backbone.Collection.extend({
 model:photoOrg.pict
});

photoOrg.photoLib = new photoOrg.PhotoLibrary();

$.fn.isOnScreen = function() {
 if (this && this.length) {
  var t = $(window), e = {
   top:t.scrollTop(),
   left:t.scrollLeft()
  };
  e.right = e.left + t.width();
  e.bottom = e.top + t.height();
  var o = this.offset();
  o.right = o.left + this.outerWidth();
  o.bottom = o.top + this.outerHeight();
  return !(e.right < o.left || e.left > o.right || e.bottom < o.top || e.top > o.bottom);
 }
};

photoOrg = photoOrg || {};

photoOrg.oauthFetcher = new function() {
 this.isRefreshRequestSent = !1;
 this.timeOut = "";
 this.isSetTimeOut = !1;
 this.callback = function() {};
 this.async = !1;
 this.initiateFetchTokenOnFailure = 0;
 this.getRefreshToken = function(t) {
  this.defaultParams = {
   url:gon.staticContent.library_url + "/refresh_access_token",
   type:"GET",
   dataType:"json",
   async:!1,
   cache:!1,
   force:!1
  };
  this.defaultParams.headers = {
   Authorization:"OAuth " + this.getOa2(),
   access_token:"OAuth " + this.getOa2(),
   GSID:this.getGsid()
  };
  this.defaultParams.async = this.async;
  this.defaultParams.url = this.defaultParams.url + "?force=" + this.force;
  console.log("jquery ajax call for refreshtoken");
  $.ajax(this.defaultParams).done(function(e) {
   photoOrg.oauthFetcher.refreshSuccess(e, t);
  }).fail(function(e) {
   var o = e.responseText || "";
   photoOrg.jsWarningLogger('description = "refresh_access_token failed" , responsetext="' + o + '" , Noodle="' + t + '" ,initiateFetchTokenOnFailure="' + photoOrg.oauthFetcher.initiateFetchTokenOnFailure + '" ', "", "", "", !0);
   photoOrg.refreshTokenTime = 6e4;
   photoOrg.startTime = new Date().getTime();
   photoOrg.oauthFetcher.isRefreshRequestSent = !1;
   photoOrg.oauthFetcher.clearTimeOutForRefreshToken();
   if (photoOrg.oauthFetcher.initiateFetchTokenOnFailure < 3) {
    photoOrg.oauthFetcher.setTimeOutForRefreshToken(t);
    photoOrg.oauthFetcher.initiateFetchTokenOnFailure++;
   }
  });
 };
 this.refreshSuccess = function(t, e) {
  photoOrg.oauthFetcher.initiateFetchTokenOnFailure = 0;
  if (t && void 0 != t.access_token) {
   photoOrg.oauthInfo.oa2 = t.access_token;
   photoOrg.startTime = new Date().getTime();
   photoOrg.jsWarningLogger("RefreshSuccess:: Got new refresh token and token value= " + photoOrg.oauthInfo.oa2 + ', Noodle="' + e + '"', "", "", "", !0);
   try {
    t.access_token_expires_in ? photoOrg.refreshTokenTime = 1e3 * t.access_token_expires_in - 18e5 :photoOrg.jsWarningLogger("access_token_expires_in from refreshToken call" + JSON.stringify(t));
    photoOrg.refreshTokenTime = photoOrg.Util.defaultExperyTime;
   } catch (o) {
    photoOrg.refreshTokenTime = photoOrg.Util.defaultExperyTime;
   }
   photoOrg.oauthFetcher.isRefreshRequestSent = !1;
   photoOrg.oauthFetcher.callback();
  } else {
   photoOrg.jsWarningLogger("RefreshSuccess:: Not get new refresh token and response= " + JSON.stringify(t) + ', Noodle="' + e + '"', "", "", "", !0);
   photoOrg.refreshTokenTime = photoOrg.Util.defaultExperyTime;
   if (t.removeCookie || t.redirectToLogin) {
    photoOrg.Util.redirectToLoginPage(t.removeCookie, t.redirectToLogin);
    return;
   }
   photoOrg.oauthFetcher.isRefreshRequestSent = !1;
   photoOrg.oauthFetcher.callback();
  }
 };
 this.fetchToken = function(t, e, o, i) {
  console.log("fetch token call");
  var s = void 0 == o ? !0 :o, r = void 0 == e ? function() {} :e;
  if (!this.isRefreshRequestSent || o) {
   photoOrg.jsWarningLogger('"Uploader : Refreshing the access token for GSID: ' + photoOrg.Util.getBrowserSessionCookie("GSID") + '", Noodle="' + t + '"', "", "", "", !0);
   this.isRefreshRequestSent = !0;
   this.force = s;
   this.callback = r;
   this.async = i || !1;
   photoOrg.jsWarningLogger("fetchToken:: Before getting new refresh token and old token value= " + photoOrg.oauthInfo.oa2 + ', Noodle="' + t + '"', "", "", "", !0);
   this.isSecondTimeRequest = !1;
   this.getRefreshToken(t);
  }
 };
 this.getOa2 = function() {
  return photoOrg.oauthInfo.oa2;
 };
 this.getGsid = function() {
  return photoOrg.oauthInfo.GSID;
 };
 this.checkAndGetRefreshToken = function(t, e) {
  var o = new Date().getTime() - photoOrg.startTime - photoOrg.refreshTokenTime, i = void 0 == e ? function() {} :e;
  o >= 0 && !this.isRefreshRequestSent && this.fetchToken(t, i);
 };
 this.setTimeOutForRefreshToken = function(t) {
  var e = new Date().getTime() - photoOrg.startTime - photoOrg.refreshTokenTime;
  if (e >= 0) {
   console.log("fetch token in setTimeOutForRefreshToken");
   this.isSetTimeOut = !1;
   this.fetchToken();
  } else {
   console.log("setTimeOUt fired");
   0 > e && (e = -e);
   console.log("fetch tokein time:" + e);
   this.timeOut = setTimeout(function() {
    console.log("refreshing the token");
    photoOrg.oauthFetcher.fetchToken(t);
   }, e);
   this.isSetTimeOut = !0;
   photoOrg.jsWarningLogger("setTimeout fired to trigger the refresh_access_token call in " + e + ' Milli seconds , Noodle="' + t + '"', "", "", "", !0);
   console.log("is settime out" + this.isSetTimeOut + "oauth.isetstimeout" + photoOrg.oauthFetcher.isSetTimeOut);
  }
 };
 this.clearTimeOutForRefreshToken = function() {
  clearTimeout(this.timeOut);
  this.isSetTimeOut = !1;
  console.log("clearTimeout" + this.isSetTimeOut + "oauth.isetstimeout" + photoOrg.oauthFetcher.isSetTimeOut);
 };
 this.checkOauthAvailable = function() {
  function t(t) {
   if (t.oauthInfo) {
    photoOrg.oauthInfo = t.oauthInfo;
    o = !0;
   }
  }
  function e() {}
  var o = !1;
  if (photoOrg.oauthInfo.oa2 && photoOrg.oauthInfo.GSID) o = !0; else {
   console.log("from oauthfetcher");
   $.ajax({
    url:gon.staticContent.library_url + "/getOauthInfo",
    dataType:"json",
    type:"GET",
    async:!1,
    success:$.proxy(t, this),
    error:$.proxy(e, this)
   });
  }
  return o;
 };
}();

var photoOrg = photoOrg || {}, Omniture = function(t) {
 void 0 == t && (t = {});
 try {
  this.pageName = t.pageName;
  this.siteServiceName = t.siteServiceName;
  this.primaryCategory = t.primaryCategory;
  this.loginState = t.loginState;
  this.accountId = t.accountId;
  this.userType = t.userType;
  this.regType = t.regType;
  this.userInfo = t.userInfo;
 } catch (e) {}
 this.content = gon.staticContent;
 this.website = this.content.website || this.content.websiteName;
 this.trackPhotoPickerPageName = function(t) {
  try {
   var e = "";
   void 0 != t.pageName && (e = t.pageName);
   e = -1 !== e.indexOf("My Photos") ? e.replace("My Photos", "PhotoPicker") :"PhotoPicker " + e;
   e = this.content.pagePrefix + e;
   if (window.digitalData) {
    digitalData.page.pageInfo.pageName = e;
    digitalData.event = [];
    digitalData.event[0] = {
     eventInfo:{
      eventName:"pageView"
     }
    };
   }
  } catch (o) {
   photoOrg.jsWarningLogger('"Unable to do omniture call for page name :' + e + " : " + o + '"');
  }
 };
 this.trackOmniturePageName = function(t) {
  function e() {
   "object" == typeof _satellite && _satellite.pageBottom();
   clearInterval(photoOrg.checkSatellite);
  }
  if (0 != gon.staticContent.s_account) {
   var o = this.pageName, i = "";
   gon.staticContent.campaignName && (i = gon.staticContent.campaignName);
   console.log("website = " + this.website);
   try {
    void 0 != t.pageName && (o = t.pageName);
    o = this.content.pagePrefix + o;
    if (window.digitalData) {
     digitalData.page.pageInfo.pageName = o;
     digitalData.event = [];
     digitalData.event[0] = {
      eventInfo:{
       eventName:"pageView"
      }
     };
    } else {
     var s = this.content.pagePrefix.split(":")[0], r = this.content.env.toLowerCase();
     r = "production" == r ? "prod" :"staging" == r ? "stg" :"beta" == r ? "beta" :"qa";
     window.digitalData = {
      page:{
       pageInfo:{
        pageName:o,
        destinationURL:document.URL,
        siteServiceName:this.siteServiceName,
        cobrand:this.content.cobrandName.toLowerCase(),
        siteContext:s.toLowerCase(),
        environment:r
       },
       category:{
        primaryCategory:this.primaryCategory
       },
       attributes:{
        codeVersion:"",
        campaignID:i
       }
      }
     };
     void 0 != this.userInfo && $.extend(window.digitalData, this.userInfo);
     void 0 != t.content && $.extend(window.digitalData, t.content);
     "object" == typeof _satellite ? _satellite.pageBottom() :photoOrg.checkSatellite = setInterval(e, 5e3);
    }
   } catch (n) {
    photoOrg.jsWarningLogger('"Unable to do omniture call for page name :' + o + " : " + n + '"');
   }
  }
 };
 this.trackPage = function() {
  var t = {};
  t.content = {
   uploader:{
    attributes:{
     photosUploaderType:"Computer"
    }
   },
   event:[ {
    eventInfo:{
     eventName:"uploadSessionStart"
    }
   } ]
  };
  this.trackOmniturePageName(t);
 };
 this.sendOmnitureInfo = function(t, e) {
  if (!t.omnitureTracked) {
   try {
    if (t.totalImageCount + t.totalVideoCount <= 0) return;
    if (t.totalImageCount) {
     digitalData.uploader = {
      attributes:{}
     };
     digitalData.uploader.attributes.numPhotosUp = t.totalImageCount;
     digitalData.uploader.attributes.numPhotosForUpload = t.imagesUploaded;
     digitalData.uploader.attributes.photosFailedToUpload = t.postFailedImages + t.sRGBPostFailedImages;
     digitalData.uploader.attributes.photosUploadType = t.type;
     digitalData.uploader.attributes.photosElapsedTime = t.uploadTimeElapsed;
     digitalData.event = [];
     digitalData.event[0] = {
      eventInfo:{
       eventName:"uploadSessionComplete"
      }
     };
     console.log(digitalData);
     if (!e) {
      var o, i, s, r, n, a;
      if ("undefined" != typeof photoOrg.uploader) {
       o = photoOrg.uploader.metricsSessionId || photoOrg.uploader.sessionId;
       i = photoOrg.uploader.selectedAlbumID;
       s = t.totalImageCount + t.preFailedImages;
       r = t.postFailedImages + t.sRGBPostFailedImages;
       n = t.totalImageCount - (t.totalFilesSucceded + t.postFailedImages + t.sRGBPostFailedImages);
       a = "HT5";
      } else {
       o = photoOrg.ingetionSelectionTrayView.sessionId;
       i = photoOrg.ingetionSelectionTrayView.selectedAlbumID;
       s = t.totalImageCount;
       r = t.totalImageCount - t.imagesUploaded;
       n = "N/A";
       a = photoOrg.photoLib.isFacebook ? "FBK" :photoOrg.photoLib.isFlickr ? "FL2" :"IST";
      }
      var l = '"upload summary", uploaderSessionId=' + o + " context=" + gon.staticContent.context + " accountId=" + gon.staticContent.account_id + " selectedAlbumId=" + i + " totalImageCount=" + s + " totalImagesEligibleForUpload=" + t.totalImageCount + " totalImagesUploaded=" + t.imagesUploaded + " totalImagesFailedToUpload=" + r + " totalImagesYetToBeUploaded=" + n + " photosUploadType=" + a + " uploadTimeElapsedMS=" + t.uploadTimeElapsed;
      photoOrg.jsInfoLogger(l, "", "", "", !0);
     }
     try {
      _satellite.track("trackUpload");
     } catch (c) {
      photoOrg.jsErrorLogger('"Omniture 2.0 : error occured while sending the user upload information", errorCode="LIBRARY:OMNITURE", error="' + c + '"');
     }
    }
    t.totalVideoCount > 0 && s_trackVidUpload(t.totalVideoCount, t.videosUploaded, t.totalVideoCount - t.videosUploaded, t.type, t.uploadTimeElapsed);
   } catch (c) {
    photoOrg.jsErrorLogger('"Omniture 2.0 : Unable to track after upload information", errorCode="LIBRARY:OMNITURE", error="' + c + '"');
   }
   t.omnitureTracked = !0;
  }
 };
 this.trackPrivateShareOmnitureEvent = function(t) {
  window.digitalData.share = {
   photo:{
    numPhotosShared:t.numPhotosShared,
    numRecipients:t.numRecipients,
    shareType:t.shareType
   }
  };
  window.digitalData.event[0] = {
   eventInfo:{
    eventName:"albumShare"
   }
  };
  void 0 != this.userInfo && $.extend(window.digitalData, this.userInfo);
  console.log(window.digitalData);
  console.log(JSON.stringify(window.digitalData));
 };
 this.trackPublicShareOmnitureEvent = function(t, e) {
  function o() {
   "object" == typeof _satellite && _satellite.pageBottom();
   clearInterval(photoOrg.checkSatellite);
  }
  "object" == typeof _satellite ? _satellite.pageBottom() :photoOrg.checkSatellite = setInterval(o, 2e3);
  if (e) {
   var i = {
    numPhotosShared:t.numPhotosShared,
    shareType:t.shareType,
    pageName:t.pageName,
    login:"YES",
    accountId:gon.staticContent.account_id,
    userType:gon.staticContent.user_Type,
    regType:gon.staticContent.regType
   };
   this.getPageInfoForPublicShare(i);
  } else {
   var i = {
    numPhotosShared:t.numPhotosShared,
    shareType:t.shareType,
    pageName:t.pageName,
    login:"YES",
    accountId:"GUEST",
    userType:"GUEST",
    regType:"GUEST"
   };
   this.getPageInfoForPublicShare(i);
  }
 };
 this.getPageInfoForPublicShare = function(t) {
  var e = gon.staticContent, o = e.pagePrefix.split(":")[0], i = e.env.toLowerCase();
  i = "production" == i ? "prod" :"staging" == i ? "stg" :"beta" == i ? "beta" :"qa";
  var s = "";
  gon.staticContent.campaignName && (s = gon.staticContent.campaignName);
  window.digitalData = {
   page:{
    pageInfo:{
     pageName:this.content.pagePrefix + t.pageName,
     destinationURL:document.URL,
     siteServiceName:"Library",
     siteContext:o.toLowerCase(),
     environment:i,
     cobrand:e.cobrandName.toLowerCase()
    },
    category:{
     primaryCategory:"My Photos"
    },
    attributes:{
     codeVersion:"",
     campaignID:s
    }
   },
   profile:{
    profileInfo:{
     loginState:t.login,
     userAccount:t.accountId,
     customerStatus:"",
     userType:t.userType,
     regType:t.regType,
     returnUser:""
    }
   }
  };
  window.digitalData.share = {
   photo:{
    numPhotosShared:t.numPhotosShared,
    shareType:t.shareType
   }
  };
  digitalData.event = [];
  window.digitalData.event[0] = {
   eventInfo:{
    eventName:"photoShareOpen"
   }
  };
  console.log(window.digitalData);
  console.log(JSON.stringify(window.digitalData));
 };
}, photoOrg = photoOrg || {};

photoOrg.SelectAlbumView = Backbone.View.extend({
 el:"body",
 fetchedlimit:0,
 limit:50,
 hasFetchedAlbums:!1,
 albumId:"",
 loadingWheel:"",
 initialize:function(t) {
  photoOrg.Util.getUrlParameter("chrome") || photoOrg.Util.getUrlParameter("clientcomp") || "false";
  photoOrg.existingAlbums = {};
  try {
   this.loadingWheel = $(".right-container #loadingBar");
   0 == this.loadingWheel.length && (this.loadingWheel = $(".rt-container #loadingBar"));
  } catch (e) {
   photoOrg.jsErrorLogger("Unable to get loading bar element");
  }
  if (!photoOrg.isIngestion) {
   $(".upload_picker").show();
   $(".upload_picker,.upload_picker .ui-datepicker-trigger").on("click", function() {
    $("input:radio[id=newAlbum]").click();
   });
   this.uploaderDatePicker();
  }
  $("#newalbumname").on("click", function() {
   $("input:radio[id=newAlbum]").click();
   !photoOrg.isIngestion;
   try {
    photoOrg.isUploader && photoOrg.uploader.uploadViewManager.render(!0);
   } catch (t) {}
  });
  $("input:radio[id=newAlbum]").click();
  t && this.setDefaultAlbumName();
  var o = decodeURIComponent(photoOrg.Util.getUrlParamterAfterHash("state")) || "", i = "";
  if (o && "undefined" != o) {
   var s = $.parseJSON(o);
   s.album_id && (i = s.album_id.toString().split("_")[0]);
  }
  if (t && "undefined" != t.albumId && void 0 != t.albumId && "" != t.albumId && t.toString().length > 0 || i || gon.staticContent.initialAlbumId) {
   this.albumId = t.albumId || i || gon.staticContent.initialAlbumId;
   this.highlightExistingAlbum();
  } else try {
   !photoOrg.isIngestion;
   photoOrg.isUploader && photoOrg.uploader.uploadViewManager.render(!0);
  } catch (e) {}
 },
 events:{
  "change #existing_albums_list":"showMoreAlbums",
  "change #existingAlbum":"highlightExistingAlbum",
  "click #choose_album_link":"highlightExistingAlbum",
  "click input:radio[id=newAlbum]":"highlightNewAlbum",
  "blur .album_input":"onAlbumNameBlurred"
 },
 reInitialize:function() {
  this.fetchedlimit = 0;
  this.hasFetchedAlbums = !1;
  photoOrg.existingAlbums = {};
  $("input:radio[id=newAlbum]").click();
  this.setDefaultAlbumName();
  $("#no_albums_txt").hide();
  $("#existing_albums_list").show();
  this.loadingWheel.show();
  this.showAlbums();
 },
 onAlbumNameBlurred:function() {
  var t = $(".album_input"), e = photoOrg.Util.strip(t.val());
  console.log("Album Name to be set : " + e);
  e || this.setDefaultAlbumName();
  console.log("Album Name considered :: " + t.val());
 },
 formatDatePart:function(t) {
  10 > t && (t = "0" + t);
  return t;
 },
 setDefaultAlbumName:function() {
  console.log("setting DefaultAlbumName");
  var t = window.translations.album_selection.new_album_name + " ", e = photoOrg.Util.getURLParameter("type", null);
  if (e) {
   "facebook" == e ? t = window.translations.social_network.Facebook + " " :"flickr" == e ? t = window.translations.social_network.Flickr + " " :"instagram" == e && (t = window.translations.social_network.Instagram + " ");
   this.ingestionType = e;
  }
  -1 != t.indexOf("missing") && (t = " ");
  t += moment().format(gon.staticContent.date_format);
  this.albumName = t;
  $("#newalbumname").attr("defaultName", this.albumName);
  $("#newalbumname").val(this.albumName);
  gon.staticContent.defaultAlbumDate = "";
  gon.staticContent.defaultAlbumIndex = "";
  if (gon.staticContent.account_id) {
   var o = gon.staticContent.accounts_service + "/v1/account/" + gon.staticContent.account_id + "/globalInfo";
   new AssetFetcher({
    type:"GET",
    async:!0,
    url:o,
    callback:$.proxy(this.onSuccessGetAlbumName, this),
    errorCallback:$.proxy(this.onErrorGetAlbumName, this),
    context:this,
    showErrorLayer:!1
   }).doAjax();
  }
 },
 onSuccessGetAlbumName:function(t) {
  function e(t) {
   console.log("sCallback:" + t);
   t.entities.length <= 0 && (gon.staticContent.initialAlbumId = "");
   _.each(t.entities, function(t) {
    var e = photoOrg.photoLib.getLOWorTHUMBNAIL(t.files), o = photoOrg.photoLib.getValue(t.systemTags, "md5sum");
    o && (photoOrg.uploader.uploadedImageMap[o] = {
     thumbnailInfo:e,
     id:t.id
    });
   });
   photoOrg.uploader.albumWiseImageMap = {};
   photoOrg.uploader.albumWiseImageMap[gon.staticContent.initialAlbumId] = photoOrg.uploader.uploadedImageMap;
  }
  function o(t, e, o, i, s) {
   gon.staticContent.initialAlbumId = "";
   photoOrg.jsWarningLogger('"SelectAlbumView:onErrorGetAlbumName: Error in getting account globalInfo response ",  errorCode="LIBRARY:SelectAlbum", statusCode="' + t.status + '" responseText="' + t.responseText + '" textStatus="' + o + '" errorThrown="' + i + '" Noodle="' + s + '"');
  }
  var i = moment().format(gon.staticContent.date_format);
  if (photoOrg.isIngestion) {
   var s = this.ingestionType;
   console.log("ingestion from : " + s);
   gon.staticContent.uploadType = s;
   var r = s.charAt(0).toUpperCase() + s.slice(1);
   gon.staticContent.defaultAlbumDate = i;
   gon.staticContent.defaultNewAlbum = window.translations.social_network[r] + " " + i;
   console.log("Setting the defaultDate");
   if (t && t.metadata && t.metadata[s + "_defaultAlbumName"] && t.metadata[s + "_defaultAlbumName"].date.length > 0) {
    var n = t.metadata[s + "_defaultAlbumName"].date.trim();
    if (n == i) {
     gon.staticContent.defaultNewAlbum = window.translations.social_network[r] + " " + n;
     if (t.metadata[s + "_defaultAlbumName"] && t.metadata[s + "_defaultAlbumName"].index > 0) {
      var a = t.metadata[s + "_defaultAlbumName"].index.trim();
      a = parseInt(a) + 1;
      gon.staticContent.defaultNewAlbum = gon.staticContent.defaultNewAlbum + "-" + a;
      gon.staticContent.defaultAlbumIndex = a;
      console.log("Increasing the index");
     } else {
      gon.staticContent.defaultNewAlbum = gon.staticContent.defaultNewAlbum + "-1";
      gon.staticContent.defaultAlbumIndex = 1;
      console.log("for 2nd ingested album");
     }
    }
    $("#newalbumname").attr("defaultName", gon.staticContent.defaultNewAlbum);
    $("#newalbumname").val(gon.staticContent.defaultNewAlbum);
   }
  } else {
   gon.staticContent.defaultAlbumDate = i;
   gon.staticContent.defaultNewAlbum = window.translations.album_selection.new_album_name + " " + i;
   console.log("Setting the defaultDate");
   if (t && t.metadata) {
    if (t.metadata.upload_defaultAlbumName && t.metadata.upload_defaultAlbumName.date.length > 0) {
     var n = t.metadata.upload_defaultAlbumName.date.trim();
     if (n == i) {
      gon.staticContent.defaultNewAlbum = window.translations.album_selection.new_album_name + " " + n;
      if (t.metadata.upload_defaultAlbumName && t.metadata.upload_defaultAlbumName.index > 0) {
       var a = t.metadata.upload_defaultAlbumName.index.trim();
       a = parseInt(a) + 1;
       gon.staticContent.defaultNewAlbum = gon.staticContent.defaultNewAlbum + "-" + a;
       gon.staticContent.defaultAlbumIndex = a;
       console.log("Increasing the index");
      } else {
       gon.staticContent.defaultNewAlbum = gon.staticContent.defaultNewAlbum + "-1";
       gon.staticContent.defaultAlbumIndex = 1;
       console.log("for 2nd uploaded album");
      }
     }
     $("#newalbumname").attr("defaultName", gon.staticContent.defaultNewAlbum);
     $("#newalbumname").val(gon.staticContent.defaultNewAlbum);
    }
    if (photoOrg.isUploader && t.metadata.lastUnsuccessfulAlbum) {
     var l = t.metadata.lastUnsuccessfulAlbum;
     if (!gon.staticContent.dedup) return;
     gon.staticContent.initialAlbumId = photoOrg.uploader.lastUnsuccessfulAlbum = "" + l;
     this.albumId = gon.staticContent.initialAlbumId || this.albumId;
     this.highlightExistingAlbum();
     var c = gon.staticContent.pict_service + "collection/" + l + "/assets?&assetType=ALL&limit=1000&skip=0&sortCriteria=dateTaken&sortOrder=ascending&projection=md5,files", h = h;
     photoOrg.isUploader && gon.staticContent.isjpm && (h = photoOrg.uploader);
     var d = new AssetFetcher({
      type:"GET",
      url:c,
      async:!1,
      params:{},
      callback:e,
      errorCallback:o,
      context:h
     });
     d.doAjax();
    }
   }
  }
 },
 onErrorGetAlbumName:function(t) {
  photoOrg.jsWarningLogger('"SelectAlbumView:onErrorGetAlbumName: Error in getting account globalInfo response ", errorCode="LIBRARY:SelectAlbum", responseText="' + t + '" ');
  console.log("Error in getting default album name before upload");
  $("#newalbumname").attr("defaultName", this.albumName);
  $("#newalbumname").val(this.albumName);
 },
 highlightNewAlbum:function() {
  var t = $(window).height();
  photoOrg.isIngestion || photoOrg.isUploader || this.uploaderDatePicker();
  if (480 == t && $("#existing_albums_list").is(":hidden")) {
   var e = $(".images-container").height();
   $(".images-container").height(e + $("#existing_albums_list").outerHeight(!0));
   $("#init-view").css("top", "38");
   $("#upload_preferences .user_preferences_link").css("margin", "0px 5px 5px 0");
  }
 },
 highlightExistingAlbum:function() {
  $("#choose_album_link").hide();
  photoOrg.isUploader && photoOrg.uploader.getuploadedImageMapForAlbum && photoOrg.uploader.getuploadedImageMapForAlbum();
  try {
   photoOrg.isUploader && photoOrg.uploader.uploadViewManager.render(!0);
  } catch (t) {}
  if (!($("#existing_albums_list").children().length > 1)) {
   $("#existing_albums_list").hide();
   $("#existingAlbum").prop("checked", !0);
   var e = $(":selected", $("#existing_albums_list")).attr("id");
   if (void 0 == e) this.loadingWheel.show(); else {
    this.loadingWheel.hide();
    $("#existing_albums_list").css("display", "inline-block");
   }
   this.reAdjustingUploaderInitialScreen();
   this.showAlbums();
  }
 },
 showMoreAlbums:function() {
  $("#existingAlbum").is(":checked") || "more_album" == $("#existing_albums_list").val() || "choose album" == $("#existing_albums_list").val() || $("input:radio[id=existingAlbum]").click();
  if ("more_album" == $("#existing_albums_list").val()) {
   this.loadingWheel.show();
   $("#existing_albums_list").hide();
   this.showAlbums();
  }
 },
 showAlbums:function() {
  if (this.hasFetchedAlbums) this.loadingWheel.hide(); else {
   $("#choose_album_link").hide();
   var t = new AssetFetcher(), e = "";
   e = gon.staticContent.pict_service;
   var o = e + "collection/list?sortOrder=descending&collectionShown=owned&skip=" + this.fetchedlimit + "&limit=" + this.limit + "&projection=ownerAccountId,,userTags,systemTags";
   t.getAlbumsData(o, {}, this.albumsFetched, this.errorLoadingAlbums, this);
   this.fetchedlimit = this.fetchedlimit + this.limit;
  }
 },
 albumsFetched:function(t, e) {
  t && t.entities && t.entities.length < e.limit && (e.hasFetchedAlbums = !0);
  var o = $("#existing_albums_list");
  if (t) {
   o.hide();
   if (0 == t.entities.length && o.children().length <= 0) {
    e.loadingWheel.hide();
    $("#newAlbum").click();
    $("#no_albums_txt").css("display", "inline-block");
    $("#existingAlbum").attr("disabled", !0);
    return;
   }
   if (0 == t.entities.length && o.children().length > 0) {
    $("#existing_albums_list").show();
    $("#existing_albums_list option[value='more_album']").remove();
    if (o.children().length <= 0) {
     $("#newAlbum").click();
     $("#no_albums_txt").show();
    }
    e.loadingWheel.hide();
    return;
   }
   for (var i in t.entities) {
    var s = t.entities[i], r = !1;
    for (var i in s.systemTags) "isFavorite" == s.systemTags[i].key && 1 == s.systemTags[i].value && (r = !0);
    var n = !1;
    try {
     "OWNER" != s.accessLevel && (n = !0);
    } catch (a) {}
    if (!r && !n) {
     var l = "", c = "";
     if (s.userTags.length > 0) {
      l = photoOrg.Util.strip(photoOrg.photoLib.getAlbumTitle(s));
      c = l;
      if (c.length > 23) {
       c = c.substring(0, 22);
       c += "...";
      }
     }
     var h = "<option id='" + s.id + "' value='" + s.id + "' title='" + l + "' >" + c + "</option>";
     if (photoOrg.isUploader) o.append(h); else if (s.id != photoOrg.selectedAlbumId) o.append(h); else if (1 == t.entities.length) {
      $("#existing_albums_list").hide();
      $("#no_albums_txt").css("display", "inline-block");
     }
     photoOrg.existingAlbums[s.id] = [];
     photoOrg.existingAlbums[s.id].push(s);
    }
   }
   $("#existing_albums_list option[value='more_album']").remove();
   if (t.entities && t.entities.length >= e.limit) {
    var d = "";
    d = window.translations ? window.translations.upload_new.add_more_albums :$("#more_translation_text").text();
    var h = "<option value='more_album'>" + d + "</option>";
    o.append(h);
   }
   o.css("visibility", "visible");
   e.loadingWheel.hide();
   if (t.entities.length > 0) {
    e.reAdjustingUploaderInitialScreen();
    o.css("display", "inline-block");
   }
  }
  if (photoOrg.isUploader && photoOrg.uploader.isAlbumIdAvailable && photoOrg.uploader.selectedAlbumID) {
   if (0 == $("#existing_albums_list option[value='" + photoOrg.uploader.selectedAlbumID + "']").length) {
    e.loadingWheel.show();
    e.showAlbums();
    return;
   }
   $("#existing_albums_list option[value='" + photoOrg.uploader.selectedAlbumID + "']").prop("selected", !0);
   photoOrg.uploader.isAlbumIdAvailable = !1;
  } else if (e.albumId) {
   photoOrg.photoLib.ingestionAlbumId = e.albumId;
   if (0 == $("#existing_albums_list option[value='" + e.albumId.split("_")[0] + "']").length) {
    e.loadingWheel.show();
    e.showAlbums();
    return;
   }
   $("#existing_albums_list option[value='" + e.albumId.split("_")[0] + "']").prop("selected", !0);
   e.albumId = "";
  }
  (photoOrg.isIngestion || photoOrg.isUploader) && $("#existingAlbum").click();
 },
 reAdjustingUploaderInitialScreen:function() {
  var t = $(window).height();
  if (480 >= t) {
   var e = $(".images-container").height();
   $(".images-container").height(e - $("#existing_albums_list").outerHeight(!0));
   $("#init-view").css("top", "18");
   $("#upload_preferences .user_preferences_link").css("margin", "0px");
  }
 },
 errorLoadingAlbums:function() {
  console.log("unable to load albums");
 },
 uploaderDatePicker:function() {
  var t = new Date();
  console.log("this is UDP");
  $(".uploader_datepicker").val(moment().format(gon.staticContent.date_format));
  $(".uploader_datepicker").datepicker({
   dateFormat:gon.staticContent.picker_date_format,
   showOn:"button",
   maxDate:new Date(t.getFullYear(), t.getMonth() + 1, 0, 23, 59, 59),
   monthNamesShort:window.translations.monthNamesShort.split(","),
   monthNames:window.translations.monthNames.split(","),
   dayNames:window.translations.dayNames.split(","),
   dayNamesMin:window.translations.dayNamesMin.split(",")
  });
  var e = $(".ui-datepicker-trigger");
  e.attr("tabindex", "23");
  e.addClass("select_cal_icon");
  e.on("keypress", function(t) {
   13 == t.keyCode && $(".ui-datepicker-trigger .select_cal_icon").click();
  });
  e.click(function() {
   $("input:radio[id=newAlbum]").click();
  });
 }
});

var backBoneTrigger = Backbone.Events.trigger;

Backbone.Events.trigger = function(t) {
 var e = Array.prototype.slice.call(arguments, 1);
 try {
  backBoneTrigger.call(this, t, e[0], e[1], e[2], e[3], e[4]);
 } catch (o) {
  photoOrg.jsErrorLogger('"LIBRARY:Error captured in interceptor : Backbone.Events.trigger ", errorCode="LIBRARY:backBoneTrigger", err_desc="' + o + '" err_stack="' + o.stack + '"');
 }
};

var jQueryDispatch = jQuery.event.dispatch;

jQuery.event.dispatch = function(t) {
 var e = Array.prototype.slice.call(arguments, 1);
 try {
  jQueryDispatch.call(this, t, e[0], e[1], e[2], e[3], e[4], e[5]);
 } catch (o) {
  -1 !== o.stack.toString().indexOf("foundation.min") ? photoOrg.jsWarningLogger('"LIBRARY:Foundation Error captured in interceptor : jQuery.event.dispatch", errorCode="LIBRARY:jQueryDispatch", err_desc="' + o + '" err_stack="' + o.stack + '"') :photoOrg.jsErrorLogger('"LIBRARY:Error captured in interceptor : jQuery.event.dispatch", errorCode="LIBRARY:jQueryDispatch", err_desc="' + o + '" err_stack="' + o.stack + '"');
 }
};

var jQueryTrigger = jQuery.event.trigger;

jQuery.event.trigger = function(t, e, o, i) {
 try {
  jQueryTrigger.call(this, t, e, o, i);
 } catch (s) {
  photoOrg.jsErrorLogger('"LIBRARY:Error captured in interceptor : jQuery.event.trigger ", errorCode="LIBRARY:jQueryTrigger", err_desc="' + s + '" err_stack="' + s.stack + '"');
 }
};

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/album_view/album-calendar-year"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li id="', year, '-cluster">\n    <a class="JumpTo"data-index="', page, '" data-date="', date, '">', year, "</a>\n    <ul></ul>\n</li>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/album_view/album-options"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push("");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/album_view/album-thumbnail"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<li class="album-thumbnail ');
   current && __p.push("current");
   __p.push('" data-album-name="', albumName, '"  data-album-caption="', caption, '" data-album-hero_image="', albumImgUrl, '" data-album-id="', albumId, '" data-create-date="', createDate, '" data-photos-count="', count, '" data-dc="', dc, '"   data-album-owner-id="', albumOwnerId, '" data-isShared="', isShared, '">\n  <figure style="background-image: url(', albumImgUrl, ')"></figure>\n  <p>', albumName, "</p>\n  <p>", caption, '</p>\n  <div class="border"></div>\n</li>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/album_view/album_options"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<ul id="drop1" class="f-dropdown" data-dropdown-content>\n    <li class="libshareic" title="', window.translations.share_album, '" style="display: none"> ', window.translations.share_album, '</li>\n    <li class="slideShow"> ', window.translations.slideshow, ' </li>\n    <li class="delete-album"> ', window.translations.delete_album_txt, " </li>\n</ul>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/album_view/albums-grid-view"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li id="', key, '" class=\'asset-group\'>\n  <div class="monthbar">\n    <div class="left">\n        <h2>', date, "<small>", year, '</small></h2>\n    </div>\n    <div class="right">\n        <div class="view-all pill-border">', ("" + window.translations.albumManagement.view_all).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</div>\n    </div>\n  </div>\n  <ul class='album-wrapper'>\n</li>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/add_to_album/move_copy_overlay"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('\n<div id="albumManagement" class="photo-Org reveal-modal hide-new-album-wrapper" data-reveal>\n\n\n\n    <div class="management-header">\n        <h2 class="album-management-header">', ("" + window.translations.albumManagement.add_5_photos_to).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</h2>\n    </div>\n    <div class="close-button"></div>\n\n\n    <div class="clear"></div>\n    <div id="do-share">\n        <div class="saving_options choose_newExistingAlbum">\n\n\n            <p id="AddToAlbumNote" style="display: none;margin-bottom:10px;"></p>\n\n            <div class="info_text">\n                <h3>', ("" + window.translations.copy_info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</h3>\n            </div>\n\n            <div class="small-12 medium-12 selected newexistingalbum clearfix">\n                <div class="columns lt-container" >\n                    <input type="radio" name="viewToggle" id="newAlbum" tabindex="10" checked value="newAlbum">\n                    <label id="newAlb" for="newAlbum" tabindex="15"><span class="album-label">', ("" + window.translations.make_new_album).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span></label>\n\n                    <div class="options_album_name">\n                        <div class="album_nameinp">\n                            <label class="lttext">', ("" + window.translations.album_name).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</label>\n                            <input type="text" class=\'inputbox album_input\' id="newalbumname" name="newalbumname" tabindex="20" value="" maxlength="30"/>\n                        </div>\n\n                        <div class="upload_picker" style="display: none">\n                            <label id="uploader_datepicker_label" for="uploader_datepicker" tabindex="21" class="lttext">', ("" + window.translations.album_selection.album_date).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</label>\n                            <input type="text" class="uploader_datepicker inputbox album_input" id="popdatepicker" readonly="true" onfocus="this.blur()"/>\n                        </div>\n\n                    </div>\n                </div>\n\n                <div class="columns rt-container" >\n                    <input type="radio" id="existingAlbum" name="viewToggle" tabindex="25" value="existingAlbum">\n                    <label id="existingAlb" for="existingAlbum" tabindex="30"><span id="album-text" class="album-label">', ("" + window.translations.add_to_an_existing_album).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span></label>\n\n                    <!--albums names start-->\n                    <div class="select-holder">\n                        <select id="existing_albums_list" tabindex="35">\n                        </select>\n                    </div>\n                    <!--albums names end-->\n                    <span id="no_albums_txt" tabindex="40">', ("" + window.translations.album_selection.no_albums).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n\n                    <!--loading img start-->\n                        <span id="loadingBar" class="text-center photo-Org" style="display: none">\n                            <span class="icon-po-spin5 animate-spin" ></span>\n                        </span>\n                    <!--loading img end-->\n\n                    <br/>\n                </div>\n\n            </div>\n\n\n        </div>\n\n\n\n        <div class="management-footer">\n            <ul>\n                <li class="pill add-album-button"><a href="javascript:void(0)">', ("" + window.translations.done).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a></li>\n                <li class="pill-border cancel-add-album-button"><a href="javascript:void(0)">', ("" + window.translations.social_network.cancel).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a></li>\n            </ul>\n        </div>\n    </div>\n    <div class="spinner">\n        <span class="icon-po-spin5 animate-spin"></span>\n    </div>\n\n\n    <div id="AddToAlbumNoteForShare" style="display: none;">\n        <p>\n            ', ("" + window.translations["action_container.add_to_album_only_share_note"]).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '\n        </p>\n        <ul>\n            <li class="pill"><a href="javascript:void(0)" class="cancel-button">', ("" + window.translations.close).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</a></li>\n        </ul>\n    </div>\n\n\n</div>\n\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/cluster-calendar-month"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li class="month-cluster" data-index="', page, '" data-date="', date, '">\n  <span>', month, "</span>\n</li>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/cluster-calendar-year"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li id="', year, '-cluster">\n  <a>', year, "</a>\n  <ul></ul>\n</li>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/cluster-date-view"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("");
   if (!onNewPage) {
    __p.push('\n  <div class="monthbar clusterdate">\n    <div class="left">\n      <h2>');
    day ? __p.push("", day, "") :__p.push("", window.translations.no_date, "");
    __p.push("</h2><h3>", full_date, "</h3>\n        ");
    if (photoOrg.photoLib.config.loadAsPhotoPicker) {
     __p.push('\n      <ul class="pill-buttons">\n        <li>\n          <div class="select-all-wrapper">\n              <figure class="select-all ib-checkmark checkmark-gray select-all', gridNotation, '"></figure>\n              <span>', window.translations.social_network.select_all, "</span>\n\n              <span> (", assets, " ");
     assets > 1 ? __p.push("", window.translations.photos, "") :__p.push("", window.translations.photo, "");
     __p.push(')</span>\n          </div>\n\n        </li>\n        <li>\n            <div class="view-more view-all-button disable-button">\n                <span>', window.translations.albumManagement.view_all, "</span>\n            </div>\n        </li>\n      </ul>\n     ");
    } else {
     __p.push('\n        <div class="photoscount">', assets, " ");
     assets > 1 ? __p.push("", window.translations.photos, "") :__p.push("", window.translations.photo, "");
     __p.push('</div>\n        <ul class="pill-buttons">\n        <li>\n          <div class="view-more view-all-button disable-button">\n            <span class="large-screen-only">', window.translations.albumManagement.view_all, '</span>\n            <span class="mobile-screen-only">', window.translations.albumManagement.view_all, '</span>\n          </div>\n        </li>\n        <li>\n          <div class="select-all-wrapper">\n             <figure class="select-all ib-checkmark checkmark-gray select-all', gridNotation, '"></figure>\n             <span class="large-screen-only">', window.translations.social_network.select_all, '</span>\n             <span class="mobile-screen-only">', window.translations.social_network.select_all, "</span>\n          </div>\n        </li>\n          ");
     show && __p.push('\n        <li>\n            <div class="order-prints-btn" title="', window.translations.expressprints_tip, '">\n                <figure class="select-all ib-checkmark checkmark-gray select-all', gridNotation, '"></figure>\n                <span class="large-screen-only">', window.translations.printall, '</span>\n                <span class="mobile-screen-only">', window.translations["expressprints-mob"], "</span>\n            </div>\n        </li>\n          ");
     __p.push("\n      </ul>\n     ");
    }
    __p.push("\n    </div>\n  </div>\n");
   }
   __p.push('\n<div id="pg', date, '" class="collage clearfix timeline-grid" >\n</div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/cluster-expand-button"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("");
   disabled || __p.push('\n  <div class="view-more-small view-all-button disable-button">\n    <span class="large-screen-only">', window.translations.albumManagement.view_all, '</span>\n    <span class="mobile-screen-only">', window.translations.action_container.all_txt, "</span>\n  </div>\n");
   __p.push("\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/cluster-template"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push("<div id='cluster_", date, '\' class="asset-group"></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/cluster_view/single-cluster-head"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div id="savAssetOperationsArea" class="sub-header-wrapper">\n  <div class="left-subheader-wrapper">\n    <ul class="rectangle">\n      <li class="close">', window.translations.all_clusters, '<span></span></li>\n    </ul>\n  </div>\n</div>\n<div class="scroll_sav_grid">\n  <div class="album-detail-hero">\n    <figure class="hero-image" style="background-image: url(', cover_photo_url, ');"></figure>\n    <div class="overlay"></div>\n    <div class="album-info">\n      <textarea class="caption" rows="1" maxlength="30" placeholder="Add a title for this album">', caption, '</textarea>\n    </div>\n    <div class="select-all-wrapper">\n      <figure class="select-all ib-checkmark"></figure>\n      <span>', assets, '</span>\n    </div>\n  </div>\n  <div id="single_album_grid" class="collage"></div>\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/album-page-view"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div id="browseAlbums">\n  <div class="spinner">\n    <span class="icon-po-spin5 animate-spin"></span>\n  </div>\n  <div class="album-pagination previous">\n    <figure></figure>\n  </div>\n  <div class="album-pagination next">\n    <figure></figure>\n  </div>\n  <ul class="albums-container"></ul>\n</div>\n\n<div class="sav-wrap"></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/album_error"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("");
   photoOrg.photoLib.config.loadAsPhotoPicker ? __p.push('\n<div class="uploadImagesTextDiv uploadImagesTextPickerDiv">', window.translations.picker.assetsNotFoundTextForPicker, "</div>\n") :__p.push('\n<div class="row errorDiv" style="display:none">\n    <div class="small-6 small-offset-3 columns" style="background-color:#FFFFFF;">\n        <p class="text-center" style="font-size:1.75rem;margin: 0; padding:10px 0;">', window.translations.Error.unexpected_from_snappy, '</p>\n        <div style=" background-color: #F8F8F8; margin:10px" class="row">\n            <p class="text-center" style="font-size:1.3rem"><strong>', window.translations.Error.assetscantLoadText, '</strong></p>\n            <p class="text-center" style="font-size: 1.2rem;padding:5px">', window.translations.Error.unable_to_fetch, ".</br> ", window.translations.Error.Oh_dont_worry_they, '.</p>\n        </div>\n    </div>\n</div>\n<div class="row uploadImagesTextDiv uploadImagesTextLibraryDiv">\n    <div class="small-6 small-offset-3 columns" style="background-color:#FFFFFF">\n        <p class="firstPchild">', window.translations.getting_started, '</p>\n        <div style=" background-color: #F8F8F8; margin:10px" class="row">\n            <p class="secondPchild"><strong>', window.translations.Add_photos, '</strong></p>\n            <p class="thirdPchild">', window.translations.not_yet_uploaded_any_photos, ". <br>", window.translations.to_upload_photos, '.</p>\n        </div>\n    </div>\n</div>\n<div class="row singleAlbumUploadImagesTextDiv uploadImagesTextLibraryDiv">\n    <div class="small-6 small-offset-3 columns" style="background-color:#FFFFFF">\n        <p class="firstPchild">', window.translations.action_container.empty_album, '</p>\n        <div style=" background-color: #F8F8F8; margin:10px" class="row">\n            <p class="thirdPchild">', window.translations.action_container.noPhotosInAlbum, "</p>\n        </div>\n    </div>\n</div>\n");
   __p.push("\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/cloned-asset"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div id="clonedAsset" style=\'height:', height, "px'>\n    <img class=\"clonedImg\" style='height:", height, "px' src=\"", tnlUrl, '" name="', id, '" id="img_', id, '" />\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/desktop-product-links-share"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="desktop-product-links">\n    <ul>\n        ');
   _.each(gon.staticContent.product_details_share.products, function(t) {
    __p.push('\n        <li>\n            <a class="product-links-share" href="javascript:void(0)" type ="', t.name, '" id="', t.name, '">\n                <figure class="', t.name, '"></figure>\n                <span>', window.translations.action_container["make_" + t.i18n_text_key], "</span>\n            </a>\n        </li>\n        ");
   });
   __p.push("\n    </ul>\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/mobile-product-links-share"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="mobile-product-links">\n    <ul>\n        ');
   _.each(gon.staticContent.mobile_product_details_share.products, function(t) {
    __p.push('\n        <li>\n            <a class="product-links-share" href="javascript:void(0)" type ="', t.name, '" id="', t.name, '">\n                <figure class="', t.name, '"></figure>\n                <span>', window.translations.action_container["make_" + t.i18n_text_key], "</span>\n            </a>\n        </li>\n        ");
   });
   __p.push("\n    </ul>\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/single_album_view/single-album-caption"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("");
   if (!isPicker) {
    __p.push('\n\n<!-- hide when it is public shared album -->\n<div id="savAssetOperationsArea" class="sub-header-wrapper">\n  ');
    accessType != photoOrg.photoLib.accessType.guest && __p.push('\n    <div class="left-subheader-wrapper">\n      <ul class="savback">\n        <li class="close">', ("" + window.translations.detail_view.back_sav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</li>\n      </ul>\n    </div>\n\n    <div class="right-subheader-wrapper">\n        <ul class="upload dropdown-button browsealbumbtn">\n            <li class="browse-albums" id ="browsAlbumsId">', ("" + window.translations.social_network.browse_albums).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n        </ul>\n    </div>\n\n  ");
    __p.push("\n</div>\n");
   }
   __p.push('\n\n\n<div class="scroll_sav_grid">\n\n    ');
   if (isPicker) {
    __p.push('\n\n        <!--navigation section start-->\n        <div class="columns saview_topbar">\n            <div  id="savAssetOperationsArea" >\n                <div class="close left">', ("" + window.translations.detail_view.all_albums).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</div>\n            </div>\n        ");
    ownedAlbumView && __p.push('\n            <div class="right-subheader-wrapper right">\n                <ul id="addPhotosSection" class="upload rectangle shadow dropdown-button" data-dropdown="hover10">\n                    <li>\n                        ', ("" + window.translations.social_network.upload_photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "\n                    </li>\n                </ul>\n            </div>\n            ");
    __p.push('\n\n            <div class="clearfix topbardevider"></div>\n        </div>\n       <!--navigation section end-->\n\n       <!--album related details start-->\n        <div class="columns">\n            <div class="album-info left">\n                <span class="caption" maxlength="30" ');
    accessType == photoOrg.photoLib.accessType.owned || sharedByMe || __p.push(" disabled=true ");
    __p.push(' placeholder="', ("" + window.translations.album_selection.add_a_title).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">', caption, '</span>\n                <p class="count">', assets, '</p>\n                <!--<textarea class="description" rows="3"  ');
    accessType == photoOrg.photoLib.accessType.owned || sharedByMe ? __p.push(' placeholder="', ("" + window.translations.albumManagement.add_a_short_desc).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '" ') :__p.push(" disabled=true ");
    __p.push(">", album_description, '</textarea>-->\n            </div>\n\n            <div class="select-all-wrapper album-hero-button left">\n                <figure class="select-all ib-checkmark checkmark-gray"></figure>\n                <span class="large-screen-only">', ("" + window.translations.social_network.select_all).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n            </div>\n\n            <div class="clearfix captionclose"></div>\n        </div>\n\n    <div class="sort_single_album_sec right-align">\n        ');
    hideSortOrder || __p.push('\n        <ul class="rectangle shadow single dropdown-button single-album-sorting" data-dropdown="singleAlbumsort">\n            <li>\n                          <span class="txtopt">\n                              <span class="sort-option hide-for-small-only selected-option">something</span>\n                              <span class="sorttxt">', ("" + window.translations.sort_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                          </span>\n            </li>\n        </ul>\n        ");
    __p.push("\n    </div>\n\n       <!--album related details end-->\n\n     ");
   } else {
    __p.push('\n\n          <div class="album-detail-hero sav-hero-img">\n            <figure class="hero-image" calculatedHeight=\'', imageHeight, "' style=\"background-image: url('", cover_photo_url, '\');"></figure>\n            <div class="overlay"></div>\n            <div class="edit_hero_image" style="position:absolute;left:0;top:150px;z-index:999999999;background-color:red;display:', editHeroImage, '">Edit image</div>\n            <div class="album-info">\n                ');
    if (accessType != photoOrg.photoLib.accessType.guest) {
     __p.push("\n                    ");
     hideLikeButton || __p.push('\n                    <div class="album-hero-button hero-like-button album-like-button likes-tab">\n                        <span class="likeic"></span>\n                              <span class="lkcounttext">\n                                <span class="lkcount">', likesCount, '</span>\n                                <span class="lktext"> ', likesText, '</span>\n                              </span>\n                    </div>\n\n                    <div class="album-hero-button hero-comment-button album-comment-button comment-tab">\n                        <span class="comment-ic"></span>\n                                  <span class="commentsCountText">\n                                    <span class="commentsCount">', commentsCount, '</span>\n                                    <span class="commentsText"> ', commentsText, " </span>\n                                  </span>\n                    </div>\n\n\n                    ");
     __p.push("\n\n                ");
    }
    __p.push('\n\n              <textarea class="caption ');
    (accessType == photoOrg.photoLib.accessType.owned || sharedByMe) && __p.push(" caphover ");
    __p.push(' " maxlength="30" ');
    accessType == photoOrg.photoLib.accessType.owned || sharedByMe || __p.push(" disabled=true ");
    __p.push(' placeholder="', ("" + window.translations.album_selection.add_a_title).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">', caption, '</textarea>\n              <div class="count">\n                <div class="cols">\n                    <span class="left">\n                    ', assets, '\n                    </span>\n                    <textarea id="datepicker_textArea" maxlength="11"');
    photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.SINGLE_ALBUM_VIEW && photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && __p.push(' disabled="true" ');
    __p.push('   readonly="true">', createDate, '</textarea><input style="display: none" type="text" id="datepicker" readonly="true" placeholder="', createDate, '">\n                </div>\n              </div>\n\n              <textarea class="description ');
    (accessType == photoOrg.photoLib.accessType.owned || sharedByMe) && __p.push(" caphover ");
    __p.push('" maxlength="150"  ');
    accessType == photoOrg.photoLib.accessType.owned || sharedByMe ? __p.push(' placeholder="', ("" + window.translations.albumManagement.add_a_short_desc).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '" ') :__p.push(" disabled=true ");
    __p.push(">", album_description, '</textarea>\n\n              <!--\n              <#% if (photosCount >= 3 && !photoOrg.photoLib.config.loadAsPhotoPicker) { %#>\n\n                <div class="start-slideshow">\n                    <div class="play"></div>\n                    <div class="cta">Slideshow</div>\n                </div>\n\n              <#% } %#>\n              -->\n            </div>\n          </div>\n\n          <div class="album-detail-hero stickyicons">\n\n              <div class="album-left-buttons">\n\n                  <figure class="hero-image" calculatedHeight=\'', imageHeight, "' style=\"background-image: url('", cover_photo_url, '\');"></figure>\n                  <div class="overlay"></div>\n\n                  <div class="album-hero-button scroll-back-btn" style="display:none">\n                      <span class="backicon"></span>\n                      <span class="back-on-scroll">', ("" + window.translations.detail_view.back_sav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n\n                  ");
    accessType != photoOrg.photoLib.accessType.guest && __p.push('\n                      <div class="select-all-wrapper album-hero-button">\n                          <figure class="select-all ib-checkmark"></figure>\n                          <span>', ("" + window.translations.social_network.select_all).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                      </div>\n                  ");
    __p.push("\n\n                  ");
    if (ownedAlbumView && !isFavoriteAlbum) {
     __p.push("\n                  ");
     (gon.staticContent.customsort || "true" == photoOrg.Util.getURLParameter("customsort")) && __p.push('\n                  <div class="album-hero-button" id="customSort">\n                      <figure class="custsortic"></figure>\n                      <span>', ("" + window.translations.action_container.reArrange).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n\n                  ");
     __p.push("\n                  ");
    }
    __p.push("\n\n                  ");
    photosCount >= 3 && !photoOrg.photoLib.config.loadAsPhotoPicker && accessType != photoOrg.photoLib.accessType.guest && __p.push('\n                  <div class="album-hero-button start-slideshow">\n                      <div class="play">\n                          <span class="play-icon"><!--<svg><use xlink:href="#svg-play-button"></use></svg>--></span>\n                      </div>\n                      <span class="cta">', ("" + window.translations.action_container.slideshowtxt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n                  ");
    __p.push('\n\n\n                  <div class="album-hero-button">\n                      <!--\n                      <#% if (shared) { %#>\n                      <span class="share-name">\n                          <#% if (sharedByMe) { %#>\n                          With <#%= sharedWithName %#> <#% if (friendsCount > 1) { %#>+ <#%= friendsCount - 1 %#><#% } %#>\n                          <#% } else { %#>\n                          By <#%= ownerName %#>\n                          <#% } %#>\n                      </span>\n                      <#% } %#>\n                      -->\n                      ');
    (accessType == photoOrg.photoLib.accessType.owned || sharedByMe) && __p.push('\n                      <!-- if (shared) { -->\n                      <!--   <div class="manage-sharing-button album-hero-button share-button">\n                          <figure class="icon"><svg><use xlink:href="#svg-gear-icon"></use></svg></figure>\n                          <span>Manage</span> <span class="large-screen-only">Sharing</span>\n                        </div> -->\n                      <!-- } else { -->\n                      <div class="share-album-button share-button" style="display:none">\n                          <figure class="shareic"></figure>\n                          <span>', ("" + window.translations.share_txt_sav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                      </div>\n                      <!-- }  -->\n                      ");
    __p.push("\n                  </div>\n                  ");
    (accessType == photoOrg.photoLib.accessType.owned || sharedByMe) && __p.push('\n                  <div id="sav-delete-album-button" class="album-hero-button share-button sav-delete-album-button">\n                      <figure class="shareic"></figure>\n                      <span>', ("" + window.translations.albums_option.delete_album).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n                  ");
    __p.push("\n\n                  ");
    hideUploadButton || __p.push('\n                  <div id="addPhotosSection" class="hero-image-add-photos album-hero-button" data-dropdown="hover10">\n                      <figure class="uploadic"></figure>\n                      <span class="uptxt abc">', ("" + window.translations.social_network.upload_photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                      <span class="uptxtmob">', ("" + window.translations.Start_upload).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n                  ");
    __p.push("\n\n\n                  ");
    accessType != photoOrg.photoLib.accessType.guest && __p.push('\n                  <div id="moreicons" class="hero-image-add-photos album-hero-button" data-dropdown="hovermore">\n                      <figure class="moreic"></figure>\n                      <span class="moretxt">', ("" + window.translations.action_container.More).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                  </div>\n                  ");
    __p.push('\n\n\n              </div>\n\n              <div class="sort_single_album_sec">\n\n                  ');
    if (gon.staticContent.public_share_landing_login_text && !photoOrg.oauthFetcher.checkOauthAvailable()) {
     __p.push('\n                    <div class="signin-msg">\n                        <p class="share_login_link"><a href="#">', ("" + window.translations.action_container.sign_in_join).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</a>", ("" + window.translations.action_container.sign_in_extra).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</p>\n                    </div>\n\n                  ");
     gon.staticContent.public_share_landing_promo_layer && __p.push('\n                      <div id="site_promo" class="join-sec">\n\n                        <div class="title info_click">\n                            <div class="arrow">\n                                <span></span>\n                            </div>\n                            ', ("" + window.translations.action_container.promo_head_info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '\n                        </div>\n                        <div class="row">\n                            <div class="small-12 medium-8 large-6 medium-centered columns join_description">\n                                ', ("" + window.translations.action_container.promo_description).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '\n                            </div>\n                        </div>\n                      <div class="public-share-product-links"></div>\n\n                            <div class="join_site_share share_login_link">', ("" + window.translations.action_container.join_site).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</div>\n                      </div>\n                  ");
     __p.push("\n\n                  ");
    }
    __p.push("\n\n                  ");
    hideSortOrder || __p.push('\n                  <ul class="rectangle shadow single dropdown-button single-album-sorting" data-dropdown="singleAlbumsort">\n                      <li>\n                          <span class="txtopt">\n                              <span class="sort-option hide-for-small-only selected-option">something</span>\n                              <span class="sorttxt">', ("" + window.translations.sort_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                          </span>\n                      </li>\n                  </ul>\n                  ");
    __p.push("\n\n                  ");
    if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
     __p.push("\n\n                      ");
     gon.staticContent.isExpressFeatureOn && photoOrg.photoLib.expressProduct.isShowExpressProduct ? __p.push('\n                      <div class="expresec">\n                          <span class="newtxt">', window.translations.new_txt, '</span>\n                          <a class="expressprints-menu" data-dropdown="expressprints">\n                              <figure></figure>\n                              <span class="txtopt">', window.translations.express_prints_sav, '</span>\n                          </a>\n                          <div id="expressprints" class="expressprints f-dropdown ib-dropdown-menu" data-dropdown-content>\n                              <a class="headbar" href="javascript:void(0)">\n                                  <figure></figure>\n                                  <span class="txtopt">', window.translations.express_prints_sav, '</span>\n                              </a>\n                              <div class="dynamic-express-info">\n\n                              </div>\n                          </div>\n                          <a class="expressprints-menu-mob" data-reveal-id="expressprints-mob">\n                              <figure></figure>\n                              <span class="txtopt">', window.translations.express_prints_sav_mob, '</span>\n                          </a>\n\n\n                          <div id="expressprints-mob" class="expressprints reveal-modal" data-reveal data-options="close_on_background_click:false;multiple_opened=true">\n                              <div class="confirmation-body">\n                                  <div class="close-reveal-modal"></div>\n                                  <div class="confirmation-header">\n                                      <h2>', window.translations.express_prints_sav, '</h2>\n                                  </div>\n                                  <div class="confirmation-wrapper">\n                                      <div class="dynamic-express-info">\n\n                                      </div>\n                                  </div>\n                              </div>\n\n\n                          </div>\n\n\n                      </div>\n                      ') :__p.push('\n                          <div class="album-hero-button orderPrints" title="', ("" + window.translations.printprints_tip).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                              <!-- <figure class="shareic"></figure>  -->\n                              <span class="title show-for-medium-up">', ("" + window.translations.expressprints).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                              <span class="title hide-for-medium-up">', ("" + window.translations["expressprints-mob"]).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                          </div>\n                      ");
     __p.push("\n\n\n                  ");
    }
    __p.push("\n\n\n\n              </div>\n\n          </div>\n\n    ");
   }
   __p.push('\n\n\n\n\n\n    <div  class="reArrange-buttons" id="reArrange-sec" style="display: none">\n     <span class="title">', ("" + window.translations.rearrange_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n     <a id="reArrangeCancel" class="cancelbtn showdesk">', ("" + window.translations.cancel).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a>\n     <a id="reArrangeDone" class="donebtn showdesk">', ("" + window.translations.done).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a>\n    </div>\n    <div id="single_album_grid" class="collage sortable"></div>\n</div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/asset-container"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<figure class="left-nav"></figure>\n<figure class="right-nav"></figure>\n  <div id="detailedAsset">\n    <div id="assetArea">\n\n        <div id="assetOperationsArea" class="sub-header-wrapper">\n\n             <div class="photo-detail-subheader">\n\n                <div class="left-subheader-wrapper">\n                  <ul class="left pdv-back">\n                    <li class="close single">', ("" + window.translations.detail_view.back).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</li>\n                  </ul>\n\n                  <!--<div class="selection-thumbnail">\n                  </div>-->\n\n                  <!--<div class="thumnail-image"></div>-->\n\n                  <div class="printmessage" style="display: none">\n                      <p><b>', ("" + window.translations.action_container.please_select_photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</b></p>\n                      <p>", ("" + window.translations.action_container.you_can_select).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</p>\n                      <div class="text-center">\n                          <a href="javascript:void(0)" class="gotitbtn">', ("" + window.translations.action_container.got_it).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</a>\n                      </div>\n                  </div>\n\n                </div>\n\n                ");
   if (accessType != photoOrg.photoLib.accessType.guest) {
    __p.push('\n\n                      <div class="middle-subheader-wrapper">\n                          ');
    "PICTURE" == assetType && __p.push('\n                          <div class="right-icons-holder">\n                              <ul class="shadow active-dark">\n                                  <li id="dtViewSlideshow" style="display: none">\n                                      <span class="playicon"></span>\n                                      <span class="text">', ("" + window.translations.action_container.slideshowtxt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                                  </li>\n                                  <li id="dtViewCaptions" class="dtViewCaptions">\n                                      <span class="playicon"></span>\n                                      <span class="text non-touch">', ("" + window.translations.action_container.caption_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                              </ul>\n                          </div>\n                          ");
    __p.push("\n\n                          ");
    if (accessType == photoOrg.photoLib.accessType.owned || owned) {
     __p.push('\n                          <div class="right-icons-holder show-in-mobile ');
     "VIDEO" != assetType && __p.push(" deviderline ");
     __p.push('">\n                              <ul class="shadow active-dark only-dk">\n                                  ');
     if ("VIDEO" != assetType) {
      __p.push("\n                                  ");
      show_edit || __p.push('\n                                  <li sqatid="rotateleft" class="detail-rotate-left" title="', ("" + window.translations.action_container.rotate_left).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.rotate_left).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                                  </li>\n                                  <li sqatid="rotateright" class="detail-rotate-right" title="', ("" + window.translations.action_container.rotate_right).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.rotate_right).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                                  ");
      __p.push("\n                                  ");
     }
     __p.push("\n\n                                  ");
     if ("VIDEO" != assetType) {
      __p.push("\n                                  ");
      show_edit && __p.push('\n                                  <li class="detail-edit editOptions" title="', ("" + window.translations.action_container.edit_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.edit_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                                  ");
      __p.push("\n                                  ");
     }
     __p.push("\n\n\n                                  ");
     (accessType == photoOrg.photoLib.accessType.owned || sharedBYMe) && __p.push('\n                                  <li class="detail-favorite favImag" title="', ("" + window.translations.action_container.add_to_favorites).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.add_to_favorites).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                                  ");
     __p.push('\n\n                                  <li class="download detail-download" tabindex="1" title="', ("" + window.translations.action_container.Download).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '"><a style="visibility: hidden" href="#"  id="imgDownload"></a>\n                                      <span class="text">', ("" + window.translations.action_container.Download).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                                  </li>\n\n                                  <li class="detail-info" title="', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n\n                                  ");
     isFavorite || __p.push('\n                                  <li class="detail-delete" title="', ("" + window.translations.action_container.delete_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.delete_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                                  ");
     __p.push("\n\n                                  ");
     if (gon.staticContent.dtView_icons) {
      __p.push("\n                                  ");
      if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && accessType == photoOrg.photoLib.accessType.owned || moreOptionCluster) {
       __p.push('\n\n                                  <li id="dtView_options" class="detail_options">\n                                      <span class="text" id="dtView_options_span">', ("" + window.translations.action_container.More).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n\n                                      <div id="dtView_options_menu" class="f-dropdown" style="display: none">\n                                          ');
       "VIDEO" != assetType && __p.push('\n                                          <div class="dtView-rotate-cw">\n                                              <span>', ("" + window.translations.albums_option.rotate_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                          </div>\n                                          ");
       __p.push("\n                                          ");
       if (isShowCopyAndMove) {
        __p.push("\n                                          ");
        photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || photoOrg.photoLib.isFavorite || __p.push('\n                                          <div class="dtView-move">\n                                              <span>', ("" + window.translations.asset_option.move_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                                          </div>\n                                          <div class="dtView-copy">\n                                              <span>', ("" + window.translations.asset_option.copy_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                          </div>\n                                          ");
        __p.push("\n                                          ");
       }
       __p.push("\n                                          ");
       isAlbumCoverPic || __p.push('\n                                          <div class="dtView-mk-alb-cvr">\n                                              <span>', ("" + window.translations.albums_option.make_album_cover).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                          </div>\n                                          ");
       __p.push("\n                                      </div>\n                                  </li>\n\n                                  ");
      }
      __p.push("\n                                  ");
     }
     __p.push('\n                              </ul>\n\n\n\n                          </div>\n\n                          <div class="right-icons-holder small-right">\n                              <ul class="active-dark info-mobile">\n                                  <li class="detail-info" title="', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                      <span class="text">', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                                  </li>\n                              </ul>\n                          </div>\n                          ");
    } else __p.push('\n                          <ul class="rectangle shadow active-dark" style="display:none" >\n                              <li class="detail-favorite favImag favImgLarge"  title="', ("" + window.translations.action_container.add_to_favorites).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '"><span class="text">', ("" + window.translations.action_container.add_to_favorites).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span></li>\n                              <li class="detail-info" title="', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">\n                                  <span class="text">', ("" + window.translations.action_container.info).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                              </li>\n                          </ul>\n                          ");
    __p.push("\n\n\n                      </div>\n\n                ");
   }
   __p.push('\n\n\n\n             </div>\n       </div>\n\n        <div id="assetContainer" class="row containerHeight columns" style="text-align:center;">\n            <div style="position: absolute; width: 100%; top: 25%; left: 0px; ">\n                <div>\n                    <div id="videoContainer"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n   </div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/asset-grid-view"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('  <div class="monthbar monthbar_', assetsYear, "_", assetMonth, '">\n    <div class="left">\n      <h2>', monthInText, " ", yearText, '</h2>\n      <div class="select-all-wrapper">\n        <figure class="select-all ib-checkmark checkmark-gray select-all', gridNotation, '"></figure>\n        <span class="large-screen-only">', ("" + window.translations.social_network.select_all).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n      </div>\n      <h5><span class="asset-count"></span> ', ("" + window.translations.social_network["heading-blue"].photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</h5>\n    </div>\n    <div class="right">\n      <div class="view-all pill-border">', ("" + window.translations.action_container.view_all).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</div>\n    </div>\n  </div>\n<div id="pg', assetsYear, "_", assetMonth, '" class="collage clearfix timeline-grid" ></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/asset-options-menu"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="asset-options-menu ');
   singleAlbum && __p.push("single-album-menu");
   __p.push(" ");
   upward && __p.push("upward-menu");
   __p.push('">\n  <ul class="ib-dropdown-menu">\n    ');
   if (albumsList) __p.push('\n        <!-- <li class="select-all-photos">', ("" + window.translations.albums_option.select_all_photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</li> -->\n        <li class="delete-photo">', ("" + window.translations.albums_option.delete_album).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n    "); else {
    __p.push("\n        ");
    if ("VIDEO" != assetType) {
     __p.push('\n            <li class="rotate_cw">', ("" + window.translations.albums_option.rotate_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n            ");
     photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.CLUSTER_VIEW && __p.push('\n                <li class="edit_photo_cv">', ("" + window.translations.albums_option.edit_photo_sav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n            ");
     __p.push("\n        ");
    }
    __p.push("\n        ");
    if (isShowCopyAndMove && !photoOrg.photoLib.isFavorite) {
     __p.push("\n            ");
     "VIDEO" != assetType && __p.push('\n                <li class="edit_photo_sav">', ("" + window.translations.albums_option.edit_photo_sav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n            ");
     __p.push('\n            <li class="asset_copy" >', ("" + window.translations.asset_option.copy_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</li>\n            <li class="asset_move" >', ("" + window.translations.asset_option.move_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n        ");
    }
    __p.push("\n        ");
    isAlbumCover || __p.push('\n            <li class="make-album-cover">', ("" + window.translations.albums_option.make_album_cover).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n        ");
    __p.push("\n        ");
    isFavorite || __p.push('\n            <li class="delete-photo">', ("" + window.translations.albums_option.delete_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</li>\n        ");
    __p.push("\n    ");
   }
   __p.push("\n  </ul>\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/asset"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div id="detailedViewImgDiv" class="selectable-asset" style="height: ', assetHeight, "px; width: ", assetWidth, "px; margin-top: ", marginTop, 'px;">\n    <div class="selection-border click-on-asset"></div>\n    <textarea title="', dtView_caption, '" id="dtViewCaption"  tabindex="5" style="overflow-y:auto" class="assetcaption_span dtViewCaptionTxtArea caphover" maxlength="248">', dtView_caption, '</textarea>\n\n    <!-- <div class="video-cover"><div class="th-video-ic"></div></div> -->\n    <!-- show when album is owned album -->\n    ');
   if (accessType != photoOrg.photoLib.accessType.guest) {
    __p.push('\n    <div class="selection-hitbox selection-toggle-trigger" tabindex="10">\n      <figure class="ib-checkmark"></figure>\n    </div>\n    <img class="detailedViewImg selection-toggle-trigger"  calculatedHeight="', dimension_value, '" src="', imgSrc, "", dimension, "=", dimension_value, '"/>\n    ');
    (accessType == photoOrg.photoLib.accessType.owned || void 0 == accessType) && __p.push('\n    <ul class="context-menu-buttons">\n        <li class="options"></li>\n    </ul>\n    ');
    __p.push("\n        ");
   } else __p.push('\n         <img class="detailedViewImg" calculatedHeight="', dimension_value, '" src="', imgSrc, "", dimension, "=", dimension_value, '"/>\n     ');
   __p.push('\n</div>\n<div class="spinner">\n    <span class="icon-po-spin5 animate-spin"></span>\n</div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/bottom-thumbnail-navigation"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('\n<div class="photo-detail-bottom">\n    <div class="bottom-thumbnail-navigation">\n        <div class="thumbnail-wrapper">\n            <ul></ul>\n        </div>\n        <div class="thumbnail-navigation-arrows previous-arrow">\n            <figure class="hidden"></figure>\n        </div>\n        <div class="thumbnail-navigation-arrows next-arrow">\n            <figure class="hidden"></figure>\n        </div>\n    </div>\n    <div class="bottom-edit-tools">\n        <div class="pill">\n            <a class="save-edit" href="javascript:void(0)">', ("" + window.translations.save).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a>\n        </div>\n    </div>\n    <!-- show when album is owned album -->\n    <div class="photo-detail-subheader-mobile">\n        <div class="right-icons-holder">\n            <ul class="shadow active-dark">\n                ');
   if (accessType == photoOrg.photoLib.accessType.owned || sharedBYMe) {
    __p.push("\n                ");
    if ("VIDEO" != assetType) {
     __p.push("\n                    ");
     show_edit && __p.push('\n                    <li class="detail-edit editOptions">\n                        <span class="text">', ("" + window.translations.action_container.edit_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                    </li>\n                    ");
     __p.push('\n                    <!-- <li class="detail-edit"></li> -->\n                    ');
     show_edit || __p.push('\n                    <li sqatid="rotateleft" class="detail-rotate-left">\n                        <span class="text">', ("" + window.translations.action_container.rotate_left).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                    </li>\n                    <li sqatid="rotateright" class="detail-rotate-right">\n                        <span class="text">', ("" + window.translations.action_container.rotate_right).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                    </li>\n                    ");
     __p.push("\n                ");
    }
    __p.push('\n\n                <li class="detail-favorite favImag">\n                    <span class="text">', ("" + window.translations.action_container.add_to_favorites).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                </li>\n                ");
   }
   __p.push("\n\n                ");
   "VIDEO" != assetType && __p.push('\n                <li id="dtViewCaptions" class="dtViewCaptions">\n                    <span class="playicon"></span>\n                    <span class="text non-touch">', ("" + window.translations.action_container.caption_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                </li>\n                ");
   __p.push("\n                ");
   if (accessType == photoOrg.photoLib.accessType.owned || sharedBYMe) {
    __p.push("\n                ");
    isFavorite || __p.push('\n                <li class="detail-delete">\n                    <span class="text">', ("" + window.translations.action_container.delete_photo_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                </li>\n                ");
    __p.push("\n                <!--hiding download icon for ios devices-->\n                ");
    if (gon.staticContent.dtView_icons) {
     __p.push("\n\n                ");
     if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && accessType == photoOrg.photoLib.accessType.owned || moreOptionCluster) {
      __p.push('\n                <li id="mob_dtView_options" class="detail_options">\n                    <span class="text" id="mob_dtView_options_span">', ("" + window.translations.action_container.More).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n\n                    <div id="mob_dtView_options_menu" class="f-dropdown drop-top" style="display: none">\n                            ');
      "VIDEO" != assetType && __p.push('\n                            <div class="dtView-rotate-cw">\n                                <span>', ("" + window.translations.albums_option.rotate_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                            </div>\n                            ");
      __p.push("\n                            ");
      if (isShowCopyAndMove) {
       __p.push("\n                            ");
       photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || photoOrg.photoLib.isFavorite || __p.push('\n                            <div class="dtView-move">\n                                <span>', ("" + window.translations.asset_option.move_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</span>\n                            </div>\n                            <div class="dtView-copy">\n                                <span>', ("" + window.translations.asset_option.copy_photo).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                            </div>\n                            ");
       __p.push("\n                            ");
      }
      __p.push("\n                            ");
      isAlbumCoverPic || __p.push('\n                            <div class="dtView-mk-alb-cvr">\n                                <span>', ("" + window.translations.albums_option.make_album_cover).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                            </div>\n                        ");
      __p.push("\n\n\n                        ");
      "VIDEO" != assetType && __p.push('\n                        <div class="download"><a style="visibility: hidden" href="#"  id="imgDownload"></a>\n                            <span>', ("" + window.translations.action_container.Download).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</span>\n                        </div>\n                        ");
      __p.push("\n\n\n                    </div>\n\n                </li>\n                ");
     }
     __p.push("\n\n               \n                ");
    }
    __p.push("\n                ");
   }
   __p.push("\n\n            </ul>\n        </div>\n    </div>\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/common-pict-view"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('\n<div class="selection-border click-on-asset"></div>\n<!-- <div class="th-video-ic"></div> -->\n<!-- hide when album is guest album -->\n');
   isRearrangeMode || accessType != photoOrg.photoLib.accessType.owned && void 0 != accessType || __p.push('\n<ul class="context-menu-buttons">\n    <!-- <li class="expand"></li> -->\n     <!-- hide when it is public shared album -->\n    <li class="options"></li>\n</ul>\n');
   __p.push('\n<div class="arr-padding"></div>\n');
   photoOrg.photoLib.config.loadAsPhotoPicker || "VIDEO" == AssetType || __p.push('\n    <div class="magnifying-icon detail-view-trigger"></div>\n');
   __p.push("\n<!-- hide when album is guest album -->\n");
   if (!isRearrangeMode && accessType != photoOrg.photoLib.accessType.guest) {
    __p.push('\n<div class="selection-hitbox selection-toggle-trigger">\n    ');
    (!photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.config.loadAsPhotoPicker && "PICTURE" == AssetType) && __p.push('\n        <figure class="ib-checkmark"></figure>\n    ');
    __p.push("\n</div>\n");
   }
   __p.push('\n<div id="select_', id, "", idStr, '"></div>\n<img class="assetImg lazy" data-original="', tnlUrl, '" name="', id, '" id="img_', id, "", idStr, '" style = "width:', width, "px; height:", height, 'px" />\n');
   if (!isRearrangeMode && "true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) {
    __p.push("\n  ");
    "VIDEO" == AssetType && __p.push('\n     <div class="th-video-ic"></div>\n  ');
    __p.push("\n");
   }
   __p.push("\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/edit-links"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<ul id="make-action">\n	<li class="products-menu">\n	    <ul class="more-products pill-border">\n        	<li>\n        		<a class="products-button" href="javascript:void(0)">', ("" + window.translations.action_container.start_project).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</a>\n        	</li>\n            <!--\n            <li class="photos_helptxt">\n                <#%- window.translations["action_container"]["bring_your_photos"] %>\n            </li>\n            -->\n            ');
   for (var i = 0; i < gon.staticContent.product_details.products.length; i++) __p.push('\n\n                  <li><a href="javascript:void(0)"  type = "', ("" + gon.staticContent.product_details.products[i].name).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '" class="selectProduct" id="', ("" + gon.staticContent.product_details.products[i].name).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '">', ("" + window.translations.action_container[gon.staticContent.product_details.products[i].i18n_text_key]).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</a></li>\n\n             ");
   __p.push('\n            <!--\n        	<li>\n        		<a href="javascript:void(0)"  class="selectProduct" id="link-to-books"><#%- window.translations["action_container"]["photo_books"] %></a>\n        	</li>\n        	<li>\n        		<a href="javascript:void(0)"  class="selectProduct" id="link-to-cards"><#%- window.translations["action_container"]["cards"] %></a>\n        	</li>\n            <li>\n                <a href="javascript:void(0)"  class="selectProduct" id="link-to-calenders"><#%- window.translations["action_container"]["calenders"] %></a>\n            </li>\n        	<li>\n        		<a href="javascript:void(0)"  class="selectProduct" id="link-to-canvas"><#%- window.translations["action_container"]["canvas_and_decor"] %></a>\n        	</li>\n        	<li>\n                <a href="javascript:void(0)"  class="selectProduct" id="link-to-photo-gifts"><#%- window.translations["action_container"]["photo-gifts"] %></a>\n            </li>\n\n            <li>\n        		<a href="javascript:void(0)" id="link-to-prints"><#%- window.translations["action_container"]["prints"] %></a>\n        	</li>\n            -->\n        </ul>\n	</li>\n	<!--\n    <li>\n		<ul class="more-menu pill-border">\n\n			<li>\n                               <a href="javascript:void(0)" id="link-to-prints" title=" <#%- window.translations["product_details"]["prints_tip"] %> "><#%- window.translations["product_details"]["order_prints"] %></a>\n			</li>\n            -->\n            <!--\n            <li>\n                <a class="more-button" href="javascript:void(0)"><#%- window.translations["action_container"]["photo_actions"] %></a>\n            </li>\n			<li>\n				<a id="edit_album" href=" photoOrg.projectTrayView.saveStory();"><#%- window.translations["action_container"]["add_to_album"] %></a>\n			</li>\n			<li>\n				<a id="clear-from-tray" href=" photoOrg.projectTrayView.clearSelectedAssets()" style="display: none;"><#%- window.translations["action_container"]["add_tags"] %></a>\n			</li>\n			-->\n            <!--\n            <li>\n				<a id="multiShare" href="javascript:void(0)" style="display: none;"><#%- window.translations["action_container"]["share"] %></a>\n			</li>\n			-->\n			<!--\n            <li>\n				<a class="favorite-selected" href="javascript:void(0)" style="display: none;"><#%- window.translations["action_container"]["add_to_favorites"] %></a>\n			</li>\n			<li>\n				<a href="javascript:void(0)" style="display: none;"><#%- window.translations["action_container"]["Download"] %></a>\n			</li>\n			<li>\n				<a id="delete-selected" class="delete-selected" href="photoOrg.projectTrayView.assetDelete()"><#%- window.translations["action_container"]["Delete"] %></a>\n			</li>\n			<li class="clear_selected_assets">\n				<a href="#"><#%- window.translations["editLinks"]["clear_selected"] %></a>\n			</li>\n			<li>\n				<div class="two-column-toggle">\n					<span><#%- window.translations["editLinks"]["show_two_column_view"] %></span>\n					<div class="toggle-button">\n						<figure></figure>\n					</div>\n				</div>\n			</li>\n			-->\n    <!--\n		</ul>\n	</li>\n	-->\n    <!--<li class="tray_moreoptions">\n        <div class="left"><span id="selected-count">0</span><span id="po_photo_txt">  ', ("" + window.translations.photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), ' </span></div>\n        <div class="right"><a id="options_hover_tray" href="javascript:void(0)" style="line-height: 16px" data-dropdown="hoveroptions">', ("" + window.translations.options).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), "</a></div>\n    </li>-->\n</ul>\n\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/fade-div"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div class="fadeDiv"></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/library-album"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<li class="album-item">\n<div class="text-center item-sec-div" id="section_', id, '" sqatud="album_', id, '" version="', version, '" imgCount="', count, '" pageNo="', pageNo, '" presentMonth="', presentMonth, '">\n  <div class="storyImage selectable-asset" id="', aId, '">\n    <div class="album-item-wrapper library-item">\n      <div class="photoOrgStory">\n        <figure style="background-image: url(', albumImgUrl, ')">\n          <img class="size-placeholder" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABdJREFUeNpi/P//PwMyYGJAA4QFAAIMAMaOAwX2faROAAAAAElFTkSuQmCC">\n        </figure>\n      </div>\n\n      <div class="story-description-area">\n        <a href="javascript:void(0)" class="story-anchor" style="-webkit-user-select: none; -webkit-touch-callout: none;">\n          <p class="storyDescription" o_description="', description, '"></p>\n        </a>\n      </div>\n      <!--\n       ');
   accessType == photoOrg.photoLib.accessType.owned && __p.push('\n      <ul class="context-menu-buttons">\n          <li class="options"></li>\n      </ul>\n          ');
   __p.push('\n          -->\n      <div class="selection-border"></div>\n    </div>\n\n      <div class="story-caption-area">\n          <div class="loadSingleAlbumView"></div>\n          <div class="story-txt-bottom">\n          <a href="javascript:void(0)" class="story-anchor" style="-webkit-user-select: none; -webkit-touch-callout: none;">\n              <div>\n                  <p class="storyCaption" o_caption="', o_caption, '">', caption, "</p>\n\n                  ");
   "share2.O" != accessType && __p.push('\n                  <span class="storyDescription">', content, "</span>\n                  ");
   __p.push("\n              </div>\n          </a>\n\n          ");
   if (shared && ownerName) {
    __p.push('\n          <p class="share-info" x="y"');
    sharedByMe && __p.push(' title="', sharedWithAllNames, '" ');
    __p.push(">\n              ");
    if (sharedByMe) {
     __p.push('\n              With <span class="share-name">', sharedWithName, "</span> ");
     friendsCount > 1 && __p.push("+ ", friendsCount - 1, "");
     __p.push("\n              ");
    } else __p.push('\n              By <span class="share-name">', ownerName, "</span>\n              ");
    __p.push('\n             <!-- <#% if (likesCount > 0 && false) { %#>\n             //as per above code , not showing to ther user.So commented it.\n              <span class="break"></span><span class="like-icount"> <a class="like-button"><svg><use xlink:href="#svg-like-button"></use></svg></a> <#%= likesCount %#></span>\n              <#% } %#>-->\n          </p>\n          ');
   }
   __p.push("\n\n          ");
   if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
    __p.push('\n              <ul class="iconspallet" style="display:none">\n                <li class="libprintsic" title="', ("" + window.translations.product_details.order_prints_tip).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '"><span></span></li>\n                <li class="libsettingsic" title="', ("" + window.translations.action_container.tools_txt).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '"><a data-dropdown="drop1" id="album_', id, '" class="newdropdown album', id, '"></a></li>\n                <!--<li class="delete-album" title="<#%- window.translations["delete_album_txt"] %#>"><a class="delete-album" id="delalb_<#%=id%##>">delete</a></li>-->\n                <li class="selectAlbum" id="selectAlbum_', id, '" title="', ("" + window.translations.select_photos).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '"><a class="', id, " ");
    albumSelected && __p.push("alb_selected");
    __p.push('" id="selectAllAblum"></a></li>\n              </ul>\n          ');
   }
   __p.push("\n\n          </div>\n\n      </div>\n  </div>\n</div>\n</li>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/make-something-container"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div class="row makingSomethingView  photo-Org">\n  <div class="small-12">\n    <div class="row" style="margin-bottom:15px">\n      <div id="make-something-caption" class="small-6 columns" style="margin-top:20px">\n        <h2 class="makeSomeThingHeader">', ("" + window.translations.makeSomething.customer_fav).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</h2>\n      </div>\n      <span class="right icon-po-cancel-circled-1 close-reveal-modal close-model" style="color:#BCBCBC"></span>\n    </div>\n    <div class="row">\n      <div id="make-something-products" class="small-6 columns">\n        <ul id="product-details" class="product-details"></ul>\n      </div>\n      <div id="msImagecontainer" class="small-6 columns msImagecontainer hide-for-small-only" style="height:', msImagecontainerHeight, 'px;">\n        <img id="makeSomeThingProductImg" class="makeSomeThingProductImg" src="">\n      </div>\n    </div>\n    <div class="row" style="margin-top:20px">\n      <div class="row" style="height:70px">\n        <div class="small-3 small-offset-2 columns">\n          <button id="cancel" class="button [tiny small large radius round]">', ("" + window.translations.action_container.Cancel).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</button>\n        </div>\n        <div class="small-3 small-offset-2 columns">\n          <button id="make-it" class=" button tiny radius">', ("" + window.translations.makeSomething.start_project).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;"), '</button>\n        </div>\n        <div class="small-2 columns"></div>\n      </div>\n    </div>\n  </div>\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/month-by-year"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push("<div id='", assetsYear, "_", assetMonth, '\' class="asset-group"></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/picker-album"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div class="text-center" id="section_', data.id, '" sqatud="album_', data.id, '" version="', data.version, '" imgCount="', data.assetIdList.length, '">\n  <div class="album-item-wrapper picker-item">\n    <div class="storyImage" id="', data.aId, '">\n      <div class="photoOrgStory">\n        <figure style="background-image: url(', data.albumImgUrl, ')"></figure>\n      </div>\n      <div class="story-caption-area">\n        <a href="javascript:void(0)" class="story-anchor">\n          <p class="storyCaption" o_caption="', data.o_caption, '">', data.caption, '</p>\n          <span class="storyDescription">', data.content, '</span>\n        </a>\n      </div>\n      <div class="story-description-area">\n        <a href="javascript:void(0)" class="story-anchor">\n          <p class="storyDescription" o_description="', data.description, '"></p>\n        </a>\n      </div>\n    </div>\n  </div>\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/pict-view"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="rearrangeLL" style="display: none"></div>\n<div class="selection-border click-on-asset"></div>\n<!-- <div class="th-video-ic"></div> -->\n<!-- hide when album is guest album -->\n');
   (accessType == photoOrg.photoLib.accessType.owned || void 0 == accessType) && __p.push('\n<ul class="context-menu-buttons">\n    <!-- <li class="expand"></li> -->\n     <!-- hide when it is public shared album -->\n    <li class="options"></li>\n</ul>\n');
   __p.push("\n");
   photoOrg.photoLib.config.loadAsPhotoPicker || "VIDEO" == AssetType || __p.push('\n    <div class="magnifying-icon detail-view-trigger"></div>\n');
   __p.push("\n<!-- hide when album is guest album -->\n");
   if (accessType != photoOrg.photoLib.accessType.guest) {
    __p.push('\n<div class="selection-hitbox selection-toggle-trigger">\n    ');
    (!photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.config.loadAsPhotoPicker && "PICTURE" == AssetType) && __p.push('\n        <figure class="ib-checkmark"></figure>\n    ');
    __p.push("\n</div>\n");
   }
   __p.push('\n<div id="select_', id, "", idStr, '"></div>\n<img class="assetImg lazy" data-original="', tnlUrl, '" name="', id, '" id="img_', id, "", idStr, '" style = "width:', width, "px; height:", height, 'px" />\n');
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) {
    __p.push("\n  ");
    "VIDEO" == AssetType && __p.push('\n     <div class="th-video-ic"></div>\n  ');
    __p.push("\n");
   }
   __p.push("\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/product"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li id="', productId, '" style="margin:20px">\n  <span class="ms-icon icon-po-ok-circle-1 left"></span>\n  <span style="display: inline-block; padding-top: 5px;">', productName, "</span>\n</li>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/selected-asset"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<li data-id="', assetID, '" class="pic-box selectable-asset  ');
   isSelected && __p.push(" selected ");
   __p.push('" >\n  <figure style="background-image: url(\'', assetURL, '\');"></figure>\n  <div class="selection-border"></div>\n  <!-- <div class="remove-asset"></div> -->\n</li>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/video-icon"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div class="videoIcon"></div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/time_line_view/video_asset"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div id="detailedViewImgDiv" class="selectable-asset" style="height: ', assetHeight, "px; width: ", assetWidth, "px; margin-top: ", marginTop, 'px;">\n    <div class="selection-border click-on-asset"></div>\n    <textarea  title="', dtView_caption, '" id="dtViewCaption" tabindex="5" style="overflow-y:auto" class="assetcaption_span dtViewCaptionTxtArea caphover" maxlength="248">', dtView_caption, "</textarea>\n    <!-- show when album is owned album -->\n    ");
   if (accessType != photoOrg.photoLib.accessType.guest) {
    __p.push('\n    <div class="selection-hitbox selection-toggle-trigger" tabindex="10">\n      <figure class="ib-checkmark"></figure>\n    </div>\n    <div id="videoEelement">video object </div>\n    ');
    (accessType == photoOrg.photoLib.accessType.owned || void 0 == accessType) && __p.push('\n    <ul class="context-menu-buttons">\n        <li class="options"></li>\n    </ul>\n    ');
    __p.push("\n        ");
   } else __p.push("\n         <div>video object</div>\n     ");
   __p.push('\n</div>\n<div class="spinner">\n    <span class="icon-po-spin5 animate-spin"></span>\n</div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/express_view/express_product"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("\n    ");
   entireAlbum ? __p.push('\n        <div class="all-photos">\n            <div class="select-title">', window.translations.entire_album, '</div>\n            <div class="printprice">\n\n            </div>\n            <div class="tip-txt">', window.translations.exp_prints_tip, "</div>\n        </div>\n    ") :__p.push('\n      <div class="selected-phots">\n            <div class="select-title">', window.translations.order_selected_photos, '</div>\n            <div class="printprice">\n\n            </div>\n          </div>\n    ');
   __p.push('\n\n    <ul class="paper-select">\n\n    </ul>\n    <div class="paper-text"');
   retailers || __p.push('style="display:none" ');
   __p.push(" ><span class='paper-text-finish-type'>", retailers_text, '</span></div>\n    <a href="javascript:void(0)" class="addtocart-btn">', window.translations.add_to_cart, '</a>\n    <div class="custom-text">\n        ', window.translations.select_sizes_crop, '\n        <a class="customize-order-express-prints" href="javascript:void(0)">\n          ', window.translations.customize_order, '\n        </a>\n    </div>\n    <div class="hide-bar">\n        <figure></figure>\n    </div>\n\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/express_view/express_product_price"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<span class="no-prints">', count, '</span>\n<span class="print-text">', window.translations.prints_for, '</span>\n<span class="total-price"></span>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/selected_asset_template"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<li class="selected_lazy asset_selected_', id, '" data-original="', tnlUrl, '" style="background:url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC\') no-repeat 50% 50% transparent;"  >\n    <div class="remove_selected" asset_id="', id, '"></div>\n</li>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/product_creation_confirmation"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<!--skipping videos in product creation text-->\n<div id="productCreationConfirmation" class="productCreationConfirmation reveal-modal" data-reveal>\n    <div class="confirmation-body">\n        <div class="confirmation-wrapper">\n            <p class="text-center">', window.translations.oops_videos_txt, '</p>\n            <p> </p>\n\n            <ul>\n                <li id="ok_btn" class="pill-border"><a href="javascript:void(0)" class="cancel-button">', window.translations.got_it, '</a></li>\n                <li id="close_btn" class="pill-border"><a href="javascript:void(0)" class="cancel-button">', window.translations.close_txt, "</a></li>\n            </ul>\n        </div>\n\n    </div>\n</div>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/rearrange_assets_fail"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<!--re-arrange fail message-->\n<div id="rearrangeFail" class="rearrangeConfirmation reveal-modal" data-reveal>\n    <div class="confirmation-body">\n        <div class="confirmation-wrapper">\n            <p class="text-center">', window.translations.retry_request, '</p>\n            <p> </p>\n\n            <ul>\n                <li id="close_rearrange" class="pill-border"><a href="javascript:void(0)" class="cancel-button">', window.translations.close_txt, '</a></li>\n            </ul>\n        </div>\n        <div class="close-reveal-modal"></div>\n    </div>\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/selected_assets_model"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<!-- start::selected photos overlay -->\n<div id="selected-assets-model"  class="reveal-modal" data-reveal data-options="close_on_background_click:false;multiple_opened=true">\n    <div class="confirmation-body">\n        <div class="confirmation-wrapper">\n\n            <div class="heading-text">\n                <span class="count left"></span>\n                <a class="deselect_all" style="float:right;text-transform: capitalize" href="javascript:void(0)">\n                    ', window.translations.action_container.deselect.toLowerCase(), '\n                </a>\n            </div>\n            <ul class="selected-photos-collage"></ul>\n\n            <!-- <div class="load_selected_assets" >Loading </div>  -->\n\n            <div class="close-reveal-modal"></div>\n        </div>\n    </div>\n</div>\n<div id="newDeselectModal" class="deselect_modal">\n    <div class="modal-content">\n        <p class="heading">', window.translations.action_container.deselect_heading, '</p>\n        <p  id="deselectNoteNew"></p>\n        <span class="close" id="crossmark"></span>\n        <ul>\n            <li id="deselect_button_new" class="pill"><a href="javascript:void(0)" class="deselect-button_new">', window.translations.action_container.deselect, '</a></li>\n            <li id="cancel_deselect_new" class="pill-border"><a href="javascript:void(0)" class="cancel-button_new">', window.translations.action_container.Cancel, "</a></li>\n        </ul>\n\n    </div>\n</div>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/mobile_actions_menu"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div id="mobile-actions-menu">\n    <div class="overlay"></div>\n    <div class="options-list">\n        <ul>\n            <li class="pill  rotate-photo-cw"><a href="javascript:void(0)">', window.translations.albums_option.rotate_photo, '</a></li>\n            <li class="pill  edit-photo"><a href="javascript:void(0)">', window.translations.albums_option.edit_photo_sav, '</a></li>\n            <li class="pill  copy-photo"><a href="javascript:void(0)">', window.translations.asset_option.copy_photo, '</a></li>\n            <li class="pill  move-photo"><a href="javascript:void(0)">', window.translations.asset_option.move_photo, '</a></li>\n            <li class="pill  make-album-cover"><a href="javascript:void(0)">', window.translations.albums_option.make_album_cover, '</a></li>\n            <li class="pill-border delete-photo"><a href="javascript:void(0)">', window.translations.albums_option.delete_photo, '</a></li>\n            <li class="pill-border share-album" style="display:none;"><a href="javascript:void(0)">', window.translations.action_container.Share, "</a></li>\n        </ul>\n    </div>\n</div>\n");
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/sub_header/sub_header"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="subheader-content">\n    <div class="left-subheader-wrapper">\n        <ul class="photo-album-toggle rectangle shadow">\n            ');
   gon.staticContent.enable_cluster && __p.push('\n            <li data-btabname="tlv" class="photo_videos">', window.translations.sub_header.photos, "</li>\n            ");
   __p.push('\n            <li data-btabname="av" class="albums" style="display: none">', window.translations.sub_header.albums, '</li>\n        </ul>\n\n        <ul class="rectangle shadow single dropdown-button album-filtering-menu" style="display:none;" data-dropdown="album-filtering">\n            <li>\n                <span><span class="sort-option hide-for-small-only selected-option" data-value="av">', window.translations.sub_header.my_albums, '</span></span>\n            </li>\n        </ul>\n\n        <ul class="rectangle shadow single dropdown-button cluster-dropdown-button" data-dropdown="jumpToMonth">\n            <li>\n                <span>', window.translations.jump_to, ' <span class="sort-option"></span></span>\n            </li>\n        </ul>\n    </div>\n    <!--         <div class="middle-subheader-wrapper">\n            </div> -->\n    <div class="right-subheader-wrapper">\n        <!-- <ul class="rectangle shadow dropdown-button filter-button">\n          <li>\n            <span>Filter </span>\n            <span class="sort-option">All media</span>\n          </li>\n        </ul> -->\n        <ul class="rectangle shadow single dropdown-button date-sorting" data-dropdown="dateSorting">\n            <li>\n                <span>', window.translations.sub_header.sort_by, ' <span class="sort-option hide-for-small-only" id="choosedSortOption" data-value="createDate">', window.translations.action_container.createDate, '</span></span>\n            </li>\n        </ul>\n\n        <ul class="rectangle shadow single dropdown-button album-sorting" style="" data-dropdown="albumsort">\n            <li>\n                <span><span class="sort-option hide-for-small-only selected-option">', window.translations.sub_header.newesttooldest, '</span></span>\n            </li>\n        </ul>\n\n        <ul id="addPhotosSection" class="upload rectangle shadow single dropdown-button hide-text-small" data-dropdown="hover10">\n            ');
   photoOrg.photoLib.config.loadAsPhotoPicker ? __p.push("\n            <li>", window.translations.social_network.upload_photos, "</li>\n            ") :__p.push("\n            <li>", window.translations.action_container.add_photos, "</li>\n            ");
   __p.push("\n        </ul>\n    </div>\n</div>\n<!--end subheader content-->\n\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/sub_header/dropdowns"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push("\n\n\n\n\n");
   photoOrg.photoLib.config.loadAsPhotoPicker && __p.push('<div class="sf-library">');
   __p.push('\n<div class="sortdropdown photo-Org ');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown" :"library-dropdown");
   __p.push('">\n    <ul id="dateSorting" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n        <li>\n            <a class="create-date" data-value="createDate"  href="javascript:void(0)"> ', window.translations.action_container.createDate, '</a>\n        </li>\n        <li>\n            <a class="date-taken" data-value="dateTaken" href="javascript:void(0)">', window.translations.action_container.dateTaken, '</a>\n        </li>\n    </ul>\n</div>\n\n<div class="sortdropdown photo-Org ');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown" :"library-dropdown");
   __p.push('">\n    <ul id="album-filtering" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n\n        <li data-value="av">\n            <a data-value="av" href="javascript:void(0)">', window.translations.sub_header.my_albums, "</a>\n        </li>\n        ");
   if (gon.staticContent.share) {
    __p.push('\n        <li data-value="swmav">\n            <a data-value="swmav"  href="javascript:void(0)">', window.translations.sub_header.shared_with_me, "</a>\n        </li>\n        ");
    gon.staticContent.show_classic_albums && __p.push('\n        <li data-value="shv">\n            <a data-value="shv"  href="javascript:void(0)">', window.translations.sub_header.shared1O, "</a>\n        </li>\n        ");
    __p.push('\n        <li data-value="msav">\n            <a data-value="msav"  href="javascript:void(0)">', window.translations.sub_header.my_shared, "</a>\n        </li>\n        ");
   }
   __p.push('\n        <li data-value="fsav">\n            <a data-value="fsav"  href="javascript:void(0)">', window.translations.sub_header.favorite_alb, '</a>\n        </li>\n    </ul>\n</div>\n\n<div class="sortdropdown photo-Org ');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown" :"library-dropdown");
   __p.push('">\n    <ul id="albumsort" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n        <li sortOrder="descending" class="selected album_discending">\n            <a href="javascript:void(0)">', window.translations.sub_header.newesttooldest, '</a>\n        </li>\n        <li class="album_ascending" sortOrder="ascending">\n            <a href="javascript:void(0)">', window.translations.sub_header.oldesttonewest, '</a>\n        </li>\n        <li sortCriteria="updateDate" class="recently_modified">\n            <a href="javascript:void(0)">', window.translations.sub_header.recentlyModified, '</a>\n        </li>\n    </ul>\n</div>\n\n<div class="sortdropdown photo-Org ');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown pickersort" :"library-dropdown");
   __p.push('">\n    <ul id="singleAlbumsort" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n        <li class="single_album_ascending selected" sortOrder="ascending">\n            <a href="javascript:void(0)">', window.translations.sub_header.oldesttonewest, '</a>\n        </li>\n        <li class="single_album_descending" sortOrder="descending" >\n            <a href="javascript:void(0)">', window.translations.sub_header.newesttooldest, '</a>\n        </li>\n        <li class="reArrange" sortOrder="customOrder" style="display: none">\n            <a href="javascript:void(0)">', window.translations.sub_header.customSort, '</a>\n        </li>\n    </ul>\n</div>\n\n\n\n<div>\n    <ul id="jumpToMonth" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n    </ul>\n</div>\n<div id="subheaderropdown" class="photo-Org ');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown" :"library-dropdown");
   __p.push('">\n    <ul id="albumsdropdown" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n        <li data-btabname="av" data-value="Albums" class="selected albums_mobile" >\n            <a href="javascript:void(0)">', window.translations.sub_header.albums, "</a>\n        </li>\n        ");
   gon.staticContent.show_classic_albums && __p.push('\n        <li data-btabname="shv" data-value="Friends\' Albums" class="shared_albums_mobile">\n            <a href="javascript:void(0)">', window.translations.sub_header.shared1O, "</a>\n        </li>\n        ");
   __p.push('\n    </ul>\n</div>\n\n<!--dropdown for add photos start-->\n<div class="');
   __p.push(photoOrg.photoLib.config.loadAsPhotoPicker ? "photopicker-dropdown" :"library-dropdown");
   __p.push('">\n    <ul id="hover10" class="f-dropdown ib-dropdown-menu addphotos-dropdown" data-dropdown-content>\n        <li class="device-upload mycomputer_link">\n            <a class="device_text" href="javascript:void(0)" onmouseover >', window.translations.action_container.your_device, '</a>\n        </li>\n        <li class="facebook-upload ingestionMenu facebook_link">\n            <a href="', gon.staticContent.end_point_ingestion, '?type=facebook&for=gh" >', window.translations.social_network.Facebook, '</a>\n        </li>\n        <li class="instagram-upload ingestionMenu instagram_link">\n            <a  href="', gon.staticContent.end_point_ingestion, '?type=instagram&for=gh">', window.translations.social_network.Instagram, "</a>\n        </li>\n        ");
   gon.staticContent.is_flickr_on && __p.push('\n        <li class="flickr-upload ingestionMenu flickr_access">\n            <a href="', gon.staticContent.end_point_ingestion, '?type=flickr&for=gh">', window.translations.social_network.Flickr, "</a>\n        </li>\n        ");
   __p.push('\n    </ul>\n</div>\n<!--dropdown for add photos end-->\n\n<!--dropdown for add photos start-->\n<div class="library-dropdown">\n    <ul id="hovermore" class="f-dropdown ib-dropdown-menu addphotos-dropdown" data-dropdown-content>\n        <li class="sav_customSort" style="display: none">\n            <a id="customSort" href="javascript:void(0)" onclick="photoOrg.rearrange_assets_view.reArrangeInitialise()">', window.translations.action_container.reArrange, '</a>\n        </li>\n        <li class="sav_slideshow" style="display: none">\n            <a class="start-slideshow" href="javascript:void(0)" onclick="photoOrg.savPage.singleAlbumView.openSlideshowView()">', window.translations.action_container.slideshowtxt, '</a>\n        </li>\n        <li class="sav_delAlb" style="display: none">\n            <a id="sav-delete-album-button" class="sav-delete-album-button" href="javascript:void(0)"  onclick="photoOrg.savPage.singleAlbumView.deleteAlbumInSAV()">', window.translations.albums_option.delete_album, "</a>\n        </li>\n    </ul>\n</div>\n<!--dropdown for add photos end-->\n\n\n");
   photoOrg.photoLib.config.loadAsPhotoPicker || __p.push('\n<!-- Start Global Error Overlay-->\n<a href="#" data-reveal-id="globalError"></a>\n<div id="globalError" class="small reveal-modal" data-reveal>\n    <div class="confirmation-body">\n        <div class="confirmation-wrapper">\n            <p>', window.translations.Error.unexpected_from_snappy, '</p>\n            <h4 style="display: inline-block">', window.translations.Error.error_id, '</h4> <p class="globalError_noodle" style="display: inline-block"> </p>\n            <a class="close-reveal-modal" aria-label="Close"></a>\n            <ul>\n                <li class="pill"><a href="javascript:void(0)" onclick="$(\'#globalError\').foundation(\'reveal\',\'close\')" class="done-button" title="', window.translations.navigation.Close, '">', window.translations.navigation.Close, "</a></li>\n            </ul>\n        </div>\n    </div>\n</div>\n<!-- End Global Error Overlay-->\n");
   __p.push('\n\n\n\n\n\n\n\n<!--re-arrange fail message end-->\n\n\n<!-- end::selected photos overlay -->\n\n<!--start::DeselectAll layer opened from selected photos overlay-->\n\n\n<!--end::DeselectAll layer opened from selected photos overlay-->\n\n<div id="pickerAddProjectHelp" class="f-dropdown ib-dropdown-menu" data-dropdown-content>\n    <span>', window.translations.picker_no_photos_text, '</span>\n    <span id="closeAddProjectHelp"></span>\n</div>\n\n<!--tray options icon overlay start-->\n\n<div id="tray-options"  data-reveal data-dropdown-content class="f-dropdown content">\n    <div class="tray-photos-selected">\n        <ul class="trayOptions">\n            <li id="multiShare" class="tray-share">\n                <figure></figure>\n                <span>', window.translations.action_container.tray_share, '</span>\n            </li>\n            <li id="edit_album" class="tray-move">\n                <figure></figure>\n                <span>', window.translations.action_container.tray_move, '</span>\n            </li>\n            <li id="bulkCopy" class="tray-copy">\n                <figure></figure>\n                <span>', window.translations.action_container.tray_copy, '</span>\n            </li>\n            <li id="bulkDownload" class="tray-download">\n                <figure></figure>\n                <span>', window.translations.action_container.tray_download, '</span>\n            </li>\n            <li  id="delete-selected"  class="tray-delete">\n                <figure></figure>\n                <span>', window.translations.action_container.tray_delete, '</span>\n            </li>\n        </ul>\n    </div>\n\n    <div class="trayOptionsEmptyText">', window.translations.action_container.no_photos_selected, '</div>\n    <!--      <div class="close-reveal-modal"></div>-->\n\n\n</div>\n\n<!--end::tray options icon overlay ends-->\n\n<!-- handle navigation prev/next start -->\n<div class="photo-Org pagination-bar-wrapper ');
   photoOrg.photoLib.config.loadAsPhotoPicker && __p.push("picker-pagination-bar");
   __p.push('">\n    <div class="handlePrevNext">\n        <div class="pagination-wrap">\n            <span class="prev"><figure></figure></span>\n            <div class="middle">\n                <label>', window.translations.page, ' </label>\n                <select id="nav_page_options" class="nav_page_options"><option selected>1</option></select>\n            </div>\n            <span class="next"><figure></figure></span>\n        </div>\n    </div>\n</div>\n<!-- handle navigation prev/next end -->\n\n');
   photoOrg.photoLib.config.loadAsPhotoPicker && __p.push("</div>");
   __p.push("\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/no_photos"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="encourage_user_to_upload_text text-center medium-8 large-7 medium-centered large-centered columns" style="display: none">\n    <div class="empty_photos_text">\n        <div class="no_photos_text">', window.translations.no_photos_text, '</div>\n        <div class="upload_photos_text">', window.translations.upload_photos_from, '</div>\n    </div>\n    <div class="mrb_picker_text" style="display: none">\n        <div class="no_photos_text">', window.translations.ready_get_started, '</div>\n        <div class="upload_photos_text">', window.translations.lets_get_photos, '</div>\n    </div>\n    <div class="socialsite_upload_links">\n        ');
   __p.push(gon.staticContent.is_flickr_on ? '\n            <ul class="small-block-grid-2 medium-block-grid-4">\n                ' :'\n        <ul class="small-block-grid-2 medium-block-grid-3">\n            ');
   __p.push('\n\n                <li><a sqatid="mydevice_link" class="mycomputer_link"><div  class="default_snimg mydevice_img"></div><div class="device_text">', window.translations.action_container.your_device, '</div></a></li>\n                <li><a  href="', gon.staticContent.end_point_ingestion, '?type=facebook&for=gh" sqatid="facebook_link" class="facebook_link"><div  class="default_snimg facebook_img"></div><div>', window.translations.social_network.Facebook, '</div></a></li>\n                <li><a  href="', gon.staticContent.end_point_ingestion, '?type=instagram&for=gh" sqatid="instagram_link" class="instagram_link"><div  class="default_snimg instagram_img"></div><div>', window.translations.social_network.Instagram, "</div></a></li>\n                ");
   gon.staticContent.is_flickr_on && __p.push('\n                <li><a  href="', gon.staticContent.end_point_ingestion, '?type=flickr&for=gh" sqatid="flickr_link" class="flickr_access"><div  class="default_snimg flickr_img"></div><div>', window.translations.social_network.Flickr, "</div></a></li>\n                ");
   __p.push('\n                <li class="mrb_my_snapfish_link"><a class="my_snapfish_account_link" style="display: none"><div  class="default_snimg my_snapfish_account_img"><span>', window.translations.my_acct_text, '</span></div><div class="sline">', window.translations.action_container.my_snapfish_account, "</div></a></li>\n            </ul>\n    </div>\n</div>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/common/no_share_fav_albums"] = function(obj) {
  var __p = [];
  with (obj || {}) __p.push('<div class="empty_shared_albums emptymsgtxt" style="display: none">\n    <div class="emptytxtdiv">\n        <p>', window.translations.share.share_1_0_empty_message, ' </p>\n    </div>\n    <div class="favemptytxt" style="display: none"><p></p></div>\n</div>\n');
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/selection_tray/pic_well"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="pic-well" id="affix-innerContainer" style="display: none;">\n    <div class="edit-links edit-links-empty-tray" id="affix-Links"></div>\n    <a id="cls_empty_tray" class="close-empty-tray">x</a>\n        ');
   photoOrg.photoLib.config.loadAsPhotoPicker && __p.push("", window.translations.action_container.select_photos_to_print, "");
   __p.push("</div> -->\n    ", window.translations.action_container.clear_all, '\n\n    <div class="empty-tray-sec">\n        <ul class="more-products pill-border">\n            <li>\n                ', window.translations.action_container.start_project, "\n            </li>\n        </ul>\n        <p>", window.translations.links_options.select_photos_to, '</p>\n    </div>\n\n    <div id="selected-asset-container" >\n        <span class="tray_loading_bar" style="display:none"><span class="icon-po-spin5 animate-spin" ></span></span>\n    </div>\n</div>\n');
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/selection_tray/desktop_tray_options"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="tray-thumbnail-wrapper hide">\n    <div class="selection-thumbnail" data-reveal-id="selected-assets-model"></div>\n    <span class="tray-seltxt">', window.translations.action_container.selected_pic, '</span>\n    <span class="imageCount">0</span>\n    <span class="close_selected_assets"></span>\n</div>\n\n<ul class="tray-links">\n    ');
   _.each(gon.staticContent.product_details.products, function(t) {
    __p.push("\n    ");
    "link-to-calenders" != t.name && __p.push('\n    <li>\n        <a href="javascript:void(0)" type ="', t.name, '" id="', t.name, '">\n            <figure></figure>\n            <span>', window.translations.action_container["make_" + t.i18n_text_key], "</span>\n        </a>\n    </li>\n    ");
    __p.push("\n    ");
   });
   __p.push('\n</ul>\n<ul class="tray-options-ui">\n    <li>\n        <a class="tray-options-menu" data-dropdown="tray-options">\n            <figure></figure>\n            <span>', window.translations.action_container.tray_options, "</span>\n        </a>\n    </li>\n</ul>\n");
  }
  return __p.join("");
 };
}).call(this);

(function() {
 this.JST || (this.JST = {});
 this.JST["templates/common/library/selection_tray/mobile_tray_options"] = function(obj) {
  var __p = [];
  with (obj || {}) {
   __p.push('<div class="some selection-tray-mobile" style="overflow-y: auto;display: none;">\n    <div class="mobile-selection-tray">\n        <div class="selection-thumbnail-wrapper hide">\n            <div class="selection-thumbnail" data-reveal-id="selected-assets-model"></div>\n            <span class="imageCount">0</span>\n            <span class="close_selected_assets"><a></a></span>\n        </div>\n        <ul class="tray-options-ui">\n            <li>\n                <a class="tray-options-menu" data-dropdown="tray-options">\n                    <figure></figure>\n                    <span>', window.translations.action_container.tray_options, '</span>\n                </a>\n            </li>\n        </ul>\n    </div>\n    <div id="selection-productList">\n        <div id="leftScroll"></div>\n\n        <ul class="tray-links">\n            ');
   _.each(gon.staticContent.product_details.products, function(t) {
    __p.push("\n            ");
    "link-to-calenders" != t.name && __p.push('\n            <li>\n                <a href="javascript:void(0)" class="', t.i18n_text_key, '" type ="', t.name, '" id="', t.name, '">\n                    <figure></figure>\n                    <span>', window.translations.action_container["make_" + t.i18n_text_key], "</span>\n                </a>\n            </li>\n            ");
    __p.push("\n            ");
   });
   __p.push('\n        </ul>\n        <div id="rightScroll"></div>\n    </div>\n\n</div>\n\n\n<div id="mobile-reArrange" style="display: none">\n    <div class="reArrange-buttons" id="reArrange-sec">\n        <a class="donebtn ra-disable" id="reArrangeDone">', window.translations.done, '</a>\n        <a class="cancelbtn" id="reArrangeCancel">', window.translations.cancel, "</a>\n    </div>\n</div>\n\n");
  }
  return __p.join("");
 };
}).call(this);

var photoOrg = photoOrg || {};

photoOrg.LibraryAppRouter = Backbone.Router.extend({
 routes:{
  "":"handleState",
  "state=:state":"handleState",
  "siav/aid=:albumId/cn=:caption":"handleSingleAlbumState",
  "*page":"handleState"
 },
 processState:function(t) {
  if ("object" != typeof t) try {
   t = $.parseJSON(t);
  } catch (e) {
   t = t.replace(/'/g, '"');
   t = $.parseJSON(t);
  }
  photoOrg.photoLib.Util.resetHistoryState();
  photoOrg.photoLib.Util.historyState = _.defaults(t, photoOrg.photoLib.Util.historyState);
 },
 getAlbumFetcher:function() {
  return new AssetFetcher();
 },
 handleState:function(t) {
  t = t || {};
  this.processState(t);
  var e = (photoOrg.Util.getURLParameter("token"), photoOrg.photoLib.Util.historyState), o = (void 0 == e.pgvw || "" == e.pgvw, 
  (void 0 == e.pg || "" == e.pg) && void 0 == e.pgvw);
  if (o && void 0 == e.pgvw) {
   e[photoOrg.constants.PAGE] = photoOrg.constants.ALBUMS_VIEW;
   "av" == gon.staticContent.default_page_view ? photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.ALBUMS_VIEW) :photoOrg.makeActionView.handleClusterView();
  } else if (void 0 != e.pg && -1 !== e.pg.indexOf(photoOrg.constants.CLUSTER_VIEW)) photoOrg.makeActionView.handleClusterView(); else if (void 0 != e.pg && e.pg == photoOrg.constants.ALBUMS_VIEW && void 0 == e.aid) {
   photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.ALBUMS_VIEW, photoOrg.photoLib.Util.historyState.sc, photoOrg.photoLib.Util.historyState.so);
   $("#albumsdropdown").removeAttr("style");
  } else if (void 0 != e.pg && e.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && void 0 == e.aid) {
   console.log("fav album view");
   photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW);
   $("#albumsdropdown").removeAttr("style");
  } else if (void 0 != e.pgvw && e.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   console.log("fav album view");
   photoOrg.makeActionView.handleSingleAlbumView();
   $("#albumsdropdown").removeAttr("style");
  } else if (void 0 != e.pgvw && -1 !== e.pgvw.indexOf(photoOrg.constants.SINGLE_ALBUM_VIEW) && parseInt(e.aid) > 0) {
   delete photoOrg.photoLib.Util.historyState.pg;
   photoOrg.makeActionView.handleSingleAlbumView();
  } else if (void 0 != e.pg && -1 !== e.pg.indexOf(photoOrg.constants.PROJECTS_VIEW)) this.handleProjects(); else if (void 0 != e.pg && e.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW && void 0 == e.aid) photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.MY_SHARED_ALBUM_VIEW); else if (void 0 != e.pgvw && e.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW && parseInt(e.aid) > 0) {
   delete photoOrg.photoLib.Util.historyState.pg;
   photoOrg.makeActionView.handleSingleAlbumView();
  } else if (void 0 != e.pgvw && e.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && parseInt(e.aid) > 0) {
   delete photoOrg.photoLib.Util.historyState.pg;
   photoOrg.makeActionView.handleSingleAlbumView();
  } else if (void 0 != e.pg && e.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW && void 0 == e.aid) {
   delete photoOrg.photoLib.Util.historyState.pg;
   photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW);
  }
 },
 handleSingleAlbumState:function(t, e, o) {
  this.processState(o);
  var i = photoOrg.photoLib.Util.historyState;
  i.pgvw = photoOrg.constants.SINGLE_ALBUM_VIEW;
  i.aid = t;
  i.cn = e;
  photoOrg.makeActionView.handleSingleAlbumView();
 },
 handleProjects:function() {
  photoOrg.photoLib.showProjectspage();
 }
});

photoOrg = photoOrg || {};

var photoOrg = photoOrg || {};

photoOrg.SelectionTrayView = Backbone.View.extend({
 selected_count:0,
 shareType:"MULTI_ASSET_SHARE",
 traypics:"",
 mobileProjectTray:null,
 reloadTimer:null,
 adjustGridTimer:null,
 trayTimer:null,
 isTouch:!1,
 limit:15,
 isAssetsAddingOnscroll:!0,
 imageAvailable:null,
 frnd_assets_count:0,
 initialize:function() {
  try {
   console.log("Selection tray initialize...");
   if (0 == $("#affix-innerContainer").length) {
    var t = JST["templates/common/library/selection_tray/pic_well"]();
    $("#affix-leftCol").append(t);
   }
   if (!photoOrg.photoLib.config.loadAsPhotoPicker && 0 == $(".mobile-footer .tray-links").length) {
    var e = JST["templates/common/library/selection_tray/mobile_tray_options"]();
    $(".mobile-footer").append(e);
   }
   if (0 == $(".project-selection-tray .tray-links").length) {
    var o = JST["templates/common/library/selection_tray/desktop_tray_options"]();
    $(".project-selection-tray").append(o);
   }
   $(document).on("closed", "[data-reveal]", function() {
    $(".tray-options-menu").removeClass("bulk-selected");
   });
   eventBus.on(eventBus.CUSTOM_EVENT_SELECT_ASSET, this.addAssetToTray, this);
   eventBus.on(eventBus.CUSTOM_EVENT_DE_SELECT_ASSET, this.removeAssetToTray, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE, this.updateTrayAssetView, this);
   eventBus.on(eventBus.CUSTOM_EVENT_DETAILED_VIEW_PRESENT_IN_TRAY_IMAGES, this.imageAvailability, this);
   eventBus.on(eventBus.CHECK_VIDEO_EXISTANCE_IN_TRAY, this.checkVideoExistance, this);
   var i = this;
   $(window).resize(function() {
    i.isTrayEmpty();
   });
   if (photoOrg.photoLib.config.loadAsPhotoPicker) $("#affix-Links").append('<div id="make-action"></div>'); else {
    t = JST["templates/common/library/time_line_view/edit-links"]();
    $("#affix-Links").append(t);
    $("#options_hover_tray").foundation();
   }
   photoOrg.photoLib.Util.isTouchDevice() && (this.isTouch = !0);
   photoOrg.Util.settingSelectedPics();
   this.mobileProjectTray = new photoOrg.SelectionTrayViewMobile();
   this.addInitialAssetsToTray();
   console.log("selected pics length..." + photoOrg.photoLib.selectedImages.length);
   photoOrg.photoLib.selectedAssetsTray = new photoOrg.SelectedAssetsTrayView();
   photoOrg.photoLib.trayOptions = new photoOrg.TrayoptionsView({
    parentObj:this
   });
   $("#selected-assets-model").unbind("opened");
   $("#selected-assets-model").unbind("closed");
   $("#selected-assets-model").bind("closed", function() {
    photoOrg.photoLib.selectedAssetsTray.close();
   });
   $("#selected-assets-model").bind("opened", function() {
    photoOrg.photoLib.selectedAssetsTray.alignSelectedAssetsOverlay();
    photoOrg.photoLib.selectedAssetsTray.render();
   });
   $("#leftScroll").hide();
   if ($(window).width() > 900) {
    $("#tray-options").unbind("opened");
    $("#tray-options").bind("opened", function() {
     $("#tray-options").css("margin-top", -$("#tray-options").innerHeight());
    });
   }
   photoOrg.Util.isDesktopResolution() || $("#bulkDownload").hide();
   $(".sf-library #library .lib-left-col").css("height", "100%").css("height", "-=" + $(".global-header").innerHeight() + "px");
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 el:"#affix-leftCol",
 events:{
  "click #delete-selected":"assetDelete",
  "click .close_selected_assets":"openDeselectPopup",
  "click #multiShare":"multiAssetShare",
  "click #edit_album":"moveToAlbum",
  "click #bulkCopy":"saveStory",
  "click #bulkDownload":"multiDownload",
  "click #link-to-books":"checkVideoExistance",
  "click #link-to-cards":"checkVideoExistance",
  "click #link-to-canvas":"checkVideoExistance",
  "click #link-to-photo-gifts":"checkVideoExistance",
  "click #link-to-prints":"checkVideoExistance",
  "click #link-to-calenders":"checkVideoExistance",
  "click #options_hover_tray":"checkFriendsAssets",
  "click .tray-options-menu":"trayOptionsIcon"
 },
 hideBulkOptionsTray:function() {
  console.log("Hiding BulkOptions dropdown...");
  $("#tray-options").css("left", "-99999px");
  $("#tray-options").removeClass("open");
 },
 trayOptionsIcon:function() {
  console.log("Checking bulk photos selected or not");
  this.checkFriendsAssets();
  $(".tray-options-menu").hasClass("bulk-selected") || $(".tray-options-menu").addClass("bulk-selected");
  if (photoOrg.photoLib.selectedImages.length <= 0) {
   console.log("No selected Assets");
   $(".trayOptionsEmptyText").show();
   $(".trayOptions").hide();
   $("#tray-options").addClass("tray-no-photos");
  } else {
   $(".trayOptionsEmptyText").hide();
   $("#tray-options").removeClass("tray-no-photos");
   $(".trayOptions").show();
  }
 },
 checkFriendsAssets:function() {
  try {
   console.log("Checking selected photos are of Friend's photos or not");
   this.frnd_assets_count = 0;
   photoOrg.photoLib.trayOwnedImages = [];
   var t = gon.staticContent.account_id;
   t = parseInt(t);
   _.each(photoOrg.photoLib.SelectedAsset.selectedAssets.models, function(e) {
    t == (e.attributes.ownerAccountId || e.attributes.parentCollectionReferences[0].ownerAccountId) ? photoOrg.photoLib.trayOwnedImages.push(e) :this.frnd_assets_count += 1;
   }, this);
   if (photoOrg.photoLib.SelectedAsset.selectedAssets.length == this.frnd_assets_count) {
    console.log("All Friends photos selected");
    $("#shareThroughTray").hide();
    $("#multiShare").hide();
    $(".mobile_share").hide();
   } else {
    $("#multiShare").show();
    $("#shareThroughTray").show();
    $(".mobile_share").show();
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:checkFriendsAssets", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 moveToAlbum:function(t) {
  try {
   console.log("selection tray - moveToAlbum method");
   var e = !0;
   photoOrg.forceReload = !0;
   this.hideBulkOptionsTray();
   this.removeOptionsIconClass();
   this.saveStory(e, !1);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:moveToAlbum" err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 navigateToProductPage:function() {
  console.log("Navigated to Product page");
  this.decideProductPage();
 },
 closeLayer:function() {
  try {
   $(".productCreationConfirmation").foundation("reveal", "close");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:closeLayer", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 checkVideoExistance:function(t) {
  try {
   this.productType = t.currentTarget.getAttribute("type");
   for (var e = [], o = 0; o < photoOrg.photoLib.SelectedAsset.selectedAssets.length; o++) {
    console.log(photoOrg.photoLib.SelectedAsset.selectedAssets.models[o].attributes.assetType);
    "VIDEO" == photoOrg.photoLib.SelectedAsset.selectedAssets.models[o].attributes.assetType ? e.push(photoOrg.photoLib.SelectedAsset.selectedAssets.models[o].attributes.id) :"PICTURE" == photoOrg.photoLib.SelectedAsset.selectedAssets.models[o].attributes.assetType && photoOrg.photoLib.selectedImages_tray.push(photoOrg.photoLib.SelectedAsset.selectedAssets.models[o].attributes.id);
   }
   if (_.isEqual(photoOrg.photoLib.selectedImages, e) && 0 != photoOrg.photoLib.selectedImages) {
    $(".productCreationConfirmation").foundation("reveal", "open");
    $("#close_btn").show();
    $("#ok_btn").hide();
   } else if (e.length >= 1) {
    photoOrg.productConfirmationModal.callBack = $.proxy(this.decideProductPage, this);
    $(".productCreationConfirmation").foundation("reveal", "open");
    $("#close_btn").hide();
    $("#ok_btn").show();
   } else this.decideProductPage(this.productType);
  } catch (t) {
   photoOrg.jsWarningLogger('"LIBRARY:selection_tray_view:checkVideoExistance", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 decideProductPage:function(t) {
  console.log("Deciding Navigation to specified product page...");
  (void 0 == this.productType || null == this.productType) && photoOrg.jsErrorLogger("some error occured!!" + this);
  (void 0 == t || null == t) && (t = this.productType);
  if ("link-to-books" == t) this.navigateToBooks("link-to-books"); else if ("link-to-cards" == t) this.navigateToCards("link-to-cards"); else if ("link-to-canvas" == t) this.navigateToCanvas("link-to-canvas"); else if ("link-to-photo-gifts" == t) this.navigateToPhotogifts("link-to-photo-gifts"); else if ("link-to-calenders" == t) this.navigateToCalenders("link-to-calenders"); else if ("link-to-prints" == t) {
   photoOrg.Util.trackLinksAndButtons("ProductTray_Prints", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   photoOrg.makeActionView.prints();
  }
 },
 imageAvailability:function(t) {
  try {
   this.imageAvailable = t.imageAvailable;
   console.log(t);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:imageAvailability", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 addInitialAssetsToTray:function() {
  try {
   console.log("Adding Initial Assets to Tray...");
   if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
    {
     photoOrg.Util.getBrowserSessionCookie("GSID");
    }
    if ("undefined" != typeof Storage && localStorage.getItem("picts_from_library_for_" + gon.staticContent.account_id)) {
     var t = JSON.parse(localStorage.getItem("picts_from_library_for_" + gon.staticContent.account_id)).models;
     if (void 0 != t && null != t && t.length > 0) {
      pitids = [];
      for (var e = 0; e < t.length; e++) pitids[e] = t[e].id;
      gon.staticContent.pict_ids = pitids;
      photoOrg.photoLib.original_globalSession_pict_oids = pitids;
      this.addAssetsToTray(t, this);
     }
    }
    $("#po_photo_txt").text(photoOrg.photoLib.SelectedAsset.selectedAssets.length > 1 ? window.translations.photos :window.translations.photo);
   }
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:addInitialAssetsToTray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 errorCallback:function(t) {
  console.log("Error requesting initial assets", t);
 },
 navigateToBooks:function(t) {
  console.log("Selection tray - navigateToBooks method");
  photoOrg.Util.trackLinksAndButtons("ProductTray_PhotoBooks", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  gon.staticContent.product_uri = this.getProductUrl(t);
  this.checkStoreEndPoint();
 },
 navigateToCards:function(t) {
  console.log("Selection tray - navigateToCards method");
  photoOrg.Util.trackLinksAndButtons("ProductTray_Cards", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  gon.staticContent.product_uri = this.getProductUrl(t);
  this.checkStoreEndPoint();
 },
 navigateToCanvas:function(t) {
  console.log("Selection tray - navigateToCanvas method");
  photoOrg.Util.trackLinksAndButtons("ProductTray_CanvasDecor", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  gon.staticContent.product_uri = this.getProductUrl(t);
  this.checkStoreEndPoint();
 },
 navigateToPhotogifts:function(t) {
  console.log("Selection tray - navigateToPhotogifts method");
  photoOrg.Util.trackLinksAndButtons("ProductTray_PhotoGifts", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  gon.staticContent.product_uri = this.getProductUrl(t);
  this.checkStoreEndPoint();
 },
 navigateToCalenders:function(t) {
  console.log("Selection tray - navigateToCalenders method");
  photoOrg.Util.trackLinksAndButtons("ProductTray_Calendars", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  gon.staticContent.product_uri = this.getProductUrl(t);
  this.checkStoreEndPoint();
 },
 getProductUrl:function(t) {
  for (var e = 0; e < gon.staticContent.product_details.products.length; e++) {
   var o = gon.staticContent.product_details.products[e];
   if (o.name.toString() == t) return o.url;
  }
 },
 navigateToPrints:function() {
  photoOrg.makeActionView.prints();
 },
 checkStoreEndPoint:function() {
  gon.staticContent.redirectURL = gon.staticContent.store_url + gon.staticContent.product_uri;
  console.log(gon.staticContent.redirectURL);
  0 == photoOrg.photoLib.selectedImages.length ? document.location.href = gon.staticContent.redirectURL :photoOrg.photoLib.updateGlobalSession();
 },
 isTrayEmpty:function() {
  try {
   this.trayTimer && clearTimeout(this.trayTimer);
   this.trayTimer = setTimeout($.proxy(function() {
    this.selected_count > 0 ? this.showTray() :this.hideTray();
    this.render();
   }, this), 10);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:isTrayEmpty", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 hideTray:function() {
  console.log("Hiding the selection tray");
  if (!$(".tray-thumbnail-wrapper").hasClass("hide") || !$(".mobile-selection-tray .selection-thumbnail-wrapper").hasClass("hide") && !photoOrg.photoLib.config.loadAsPhotoPicker) {
   $("#library").removeClass("selection-tray-visible");
   $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
   $(".albumsGridList").addClass("full");
   $(".pagination-bar-wrapper").addClass("full").removeClass("selected-assets");
   $(".tray-thumbnail-wrapper").addClass("hide");
   setTimeout(function() {
    eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
   }, 200);
  }
 },
 showTray:function() {
  console.log("Showing the selection tray");
  if (($(".tray-thumbnail-wrapper").hasClass("hide") || $(".mobile-selection-tray .selection-thumbnail-wrapper").hasClass("hide")) && !photoOrg.photoLib.config.loadAsPhotoPicker) {
   $("#library").addClass("selection-tray-visible");
   $(".tray-thumbnail-wrapper").removeClass("hide");
   $(".mobile-selection-tray .selection-thumbnail-wrapper").removeClass("hide");
   $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("show");
   $(".mobile-footer").removeClass("hide");
   $("#selection-productList").show();
   $(".pagination-bar-wrapper").removeClass("full").addClass("selected-assets");
   $(".mobile-selection-tray").removeClass("hide");
   setTimeout(function() {
    eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
   }, 200);
  }
 },
 openDeselectPopup:function() {
  console.log("Opening Deselect Popup");
  $("#deselectConfirmation").hide();
  photoOrg.deselectConfirmationModal.show({
   type:photoOrg.ModalTypes.ASSET,
   assetID:this.selectedAssetsIds
  });
 },
 clearSelectedAssets:function() {
  try {
   console.log("Clearing Selected Assets...");
   if ($(window).width() > 900) $("#hoveroptions").css("left", "-99999px"); else {
    $(".more-menu-mobile").hide();
    $(".more-menu-mobile").removeClass("expand");
    $("#mobile-overlay").hide();
   }
   $(".selectAlbum span a").removeClass("alb_selected");
   photoOrg.Util.trackLinksAndButtons("TrayOptions_ClearPhotoFromTray", "photosPage");
   photoOrg.photoLib.hideEmptyTray = !0;
   this.hideTray();
   eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, {
    clear:!0
   });
   eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, {
    clear:!0
   });
   eventBus.trigger(eventBus.CUSTOM_EVENT_CHECK_SELECTED_ASSETS, {
    trayImageIds:photoOrg.photoLib.selectedImages
   });
   gon.staticContent.pict_ids = _.difference(gon.staticContent.pict_ids, photoOrg.photoLib.selectedImages);
   photoOrg.photoLib.selectedImages.length = 0;
   photoOrg.photoLib.SelectedAsset.selectedAssets.reset();
   photoOrg.photoLib.selectedAlbumAssets = [];
   $(".pic-box").remove();
   this.selected_count = 0;
   $(".collage div").hasClass("selected") && $(".collage div").removeClass("selected");
   $(".monthbar figure").hasClass("checkmark-blue") && $(".monthbar figure").removeClass("checkmark-blue");
   $(".select-all-wrapper").hasClass("selected") && $(".select-all-wrapper").removeClass("selected");
   $(".select-all-wrapper figure").hasClass("checkmark-blue") && $(".select-all-wrapper figure").removeClass("checkmark-blue");
   $("#selected-count").text(0);
   $("#assetOperationsArea .close span").text(0);
   $(".imageCount").text(0);
   this.imageAvailable && $("#sub_header_container").css("z-index", 90);
   if (0 == photoOrg.photoLib.selectedImages.length) {
    $(".dtview-menu").addClass("dtview-disable");
    photoOrg.photoLib.isSelectedImagesDetailedView = !1;
   }
   photoOrg.photoLib.isTypeProjectTray && $(".left .close").click();
   photoOrg.photoLib.seletedAlbums = {};
   $.jStorage.set(gon.staticContent.account_id + "_selectedAlbums", photoOrg.photoLib.seletedAlbums);
   eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_DTVIEW_FILMSTRIP);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:clearSelectedAssets", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 render:function() {
  photoOrg.Util.adjustHeader();
  console.log("selection tray view render called");
 },
 determineMobileTrayThumbnail:function() {
  var t = photoOrg.photoLib.SelectedAsset.selectedAssets.length;
  if (t) {
   var e, o = photoOrg.photoLib.SelectedAsset.selectedAssets.at(t - 1);
   if (void 0 == o.get("files")) e = photoOrg.Util.getThumbnailURL(o.attributes.thumbnailEncryption); else var e = photoOrg.Util.getThumbnailURL(photoOrg.photoLib.getLOWorTHUMBNAIL(o.get("files")).url);
   e += "?height=200";
   $(".selection-thumbnail").html("<div style='height: 100%;position: relative;background-size:cover;width: 100%;background-image: url(" + e + ");'></div>");
  }
 },
 addAssetToTray:function(t) {
  console.log("Adding asset to tray...");
  try {
   if (null == t.model || void 0 == t.model) return;
   var e = t.model.toJSON(), o = e.id;
   photoOrg.photoLib.SelectedAsset.selectedAssets.add(t.model);
   var i = photoOrg.photoLib.getLowORHires(t.model.get("files")).url;
   if (void 0 == t.model.get("files") && photoOrg.photoLib.albumSelected) var i = t.model.attributes.thumbnailEncryption; else var i = photoOrg.photoLib.getLowORHires(t.model.attributes.thumbnailEncryption).url;
   i += i.indexOf("?") > 0 ? "&" :"?";
   {
    photoOrg.Util.getThumbnailURL(i + "height=200");
   }
   $("#make-action").show();
   this.isTouch && $(".remove-asset").css({
    opacity:1
   });
   $("#selected-count").empty();
   this.selected_count = photoOrg.photoLib.selectedImages.length;
   $(".mobile-selection-tray .imageCount").text(this.selected_count);
   $(".project-selection-tray .imageCount").text(this.selected_count);
   $("#selected-count").append(this.selected_count);
   "VIDEO" == e.assetType && $("#image_" + o + " .th-video-ic").show();
   this.determineMobileTrayThumbnail();
   this.isTrayEmpty();
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:addAssetToTray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 updateTrayAssetView:function(t) {
  try {
   console.log("Updating tray asset view if any action performed same asset");
   var e = (t.model.get("id"), photoOrg.photoLib.getLowORHires(t.model.get("files")).url);
   e += e.indexOf("?") > 0 ? "&" :"?";
   var o = photoOrg.Util.getThumbnailURL(e + "height=200");
   console.log("Updated image source=" + o);
   this.determineMobileTrayThumbnail();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:updateTrayAssetView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 addAssetsToTray:function(t, e) {
  console.log("Adding assets to tray...");
  if (!("undefined" == typeof t || t.length <= 0)) {
   this.showTray && this.showTray();
   _.each(t, function(t) {
    photoOrg.photoLib.SelectedAsset.selectedAssets.add(new photoOrg.pict(t));
    var o = t.id;
    if (1 == $("#" + o).length) {
     e.selected_count = photoOrg.photoLib.selectedImages.length;
     $(".mobile-selection-tray .imageCount").text(e.selected_count);
     $(".project-selection-tray .imageCount").text(this.selected_count);
    } else {
     var i = photoOrg.photoLib.getLowORHires(t.files).url;
     i += i.indexOf("?") > 0 ? "&" :"?";
     var s = photoOrg.Util.getThumbnailURL(i + "height=200");
     $("#make-action").show();
     $(".selection-thumbnail").empty();
     $(".selection-thumbnail").append("<img src='" + s + "'/>");
     photoOrg.photoLib.selectedImages.push(o);
     "VIDEO" == t.assetType && $("#image_" + o + " .th-video-ic").show();
     photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
     e.isTouch && $(".remove-asset").css({
      opacity:1
     });
    }
   }, e);
   this.determineMobileTrayThumbnail();
   $(".photo-Org .remove-asset img").show();
   $("#selected-count").empty();
   this.selected_count = photoOrg.photoLib.selectedImages.length;
   $(".mobile-selection-tray .imageCount").text(this.selected_count);
   $(".project-selection-tray .imageCount").text(this.selected_count);
   $("#selected-count").append(this.selected_count);
   this.isTrayEmpty();
  }
 },
 removeAssetFromTray:function(t) {
  console.log("Removing asset from tray...");
  $("#selected-asset-container").find($("#image_" + t)).remove();
  $("#selected-count").empty();
  this.selected_count = photoOrg.photoLib.selectedImages.length - 1;
  photoOrg.photoLib.SelectedAsset.selectedAssets.remove(t);
  $("#selected-count").append(this.selected_count);
  $(".mobile-selection-tray .imageCount").text(this.selected_count);
  $(".project-selection-tray .imageCount").text(this.selected_count);
  this.determineMobileTrayThumbnail();
  this.isTrayEmpty();
 },
 removeAssetToTray:function(t) {
  try {
   if (void 0 == t.model && isNaN(t) || null == t.model && isNaN(t)) return;
   var e = "";
   if (isNaN(t)) var o = t.model.toJSON(), e = o.id; else e = t;
   $("#selected-count").empty();
   this.selected_count = photoOrg.photoLib.selectedImages.length;
   $("#selected-count").append(this.selected_count);
   $(".mobile-selection-tray .imageCount").text(this.selected_count);
   $(".project-selection-tray .imageCount").text(this.selected_count);
   this.determineMobileTrayThumbnail();
   this.isTrayEmpty();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:removeAssetToTray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 removeOptionsIconClass:function() {
  $(".tray-options-menu").removeClass("bulk-selected");
 },
 assetDelete:function() {
  try {
   console.log("Asset Delete.....");
   photoOrg.Util.trackLinksAndButtons("TrayOptions_DeletePhotos", "photosPage");
   this.hideBulkOptionsTray();
   this.removeOptionsIconClass();
   self = this;
   $("#shareDeletNote").hide();
   this.selectedAssetsIds = this.getSelectedIDs(self);
   photoOrg.Util.deletefromProjectTray = !1;
   photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && (photoOrg.Util.deletefromProjectTray = !0);
   1 == photoOrg.photoLib.areOwnedPhotosSelected ? photoOrg.deleteConfirmationModal.show({
    type:photoOrg.ModalTypes.MULTI_ASSETS,
    assetIDs:this.selectedAssetsIds,
    success:$.proxy(this.deleteSuccessCallback, this),
    error:$.proxy(this.deleteErrorCallback, this),
    showDeletePhotoCheckbox:!1
   }) :photoOrg.deleteConfirmationModal.showShareDeleteMessage({
    type:photoOrg.ModalTypes.MULTI_ASSETS,
    assetIDs:this.selectedAssetsIds,
    success:$.proxy(this.deleteSuccessCallback, this),
    error:$.proxy(this.deleteErrorCallback, this)
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:assetDelete", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getSelectedIDs:function() {
  console.log("getting selected Id's...");
  var t = [], e = photoOrg.photoLib.SelectedAsset.selectedAssets;
  photoOrg.photoLib.areSharedPhotosSelected = !1;
  photoOrg.photoLib.areOwnedPhotosSelected = !1;
  photoOrg.photoLib.selectedShareAssestsCount = 0;
  ("" == gon.staticContent.account_id || void 0 == gon.staticContent.account_id) && photoOrg.jsWarningLogger('"Account Id is mandatory Filed" accountId ="' + gon.staticContent.account_id + '"', this.url);
  _.each(e.models, function(e) {
   if (gon.staticContent.account_id != (e.attributes.ownerAccountId || e.attributes.parentCollectionReferences[0].ownerAccountId + "")) {
    photoOrg.photoLib.areSharedPhotosSelected = !0;
    photoOrg.photoLib.selectedShareAssestsCount = photoOrg.photoLib.selectedShareAssestsCount + 1;
   } else photoOrg.photoLib.areOwnedPhotosSelected = !0;
   t.push("" + e.id);
  });
  t = _.uniq(t);
  return t;
 },
 deleteSuccessCallback:function() {
  photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_SINGLE_ALBUM_COUNT, {});
  $(".imageCount").text(0);
  $(".firstImageSection").hide();
  $("#photoOrgDeleteConfirmation").foundation("reveal", "close");
  10001 != $(".lib-left-col").css("z-index");
  this.clearSelectedAssets();
  this.imageAvailable && $(document).find(".close").click();
  photoOrg.photoLib.UserAssetsInfo.assetList && $.each(this.selectedAssetsIds, function(t, e) {
   photoOrg.photoLib.UserAssetsInfo.assetList.remove(e);
  });
  photoOrg.photoLib.SelectedAsset.selectedAssets.reset();
  photoOrg.photoLib.selectedImages = [];
  this.selected_count = 0;
  $("#make-action").hide();
  $("#selected-count").empty();
  $("#selected-count").append(this.selected_count);
  $(".pic-box").remove();
  eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, {});
  photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && (photoOrg.photoLib.isNeedToReload = !0);
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums) {
   photoOrg.photoLib.isNeedToReload = !0;
   console.log("Force loading Albums :: after deleteSuccessCallback ");
   photoOrg.forceReload = !0;
   eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {});
  }
  eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, {});
  if (photoOrg.photoLib.navType.photosAndVideos == photoOrg.photoLib.current_state) {
   photoOrg.photoLib.isBulkDelete = !0;
   {
    photoOrg.photoLib.Util.historyState;
   }
   photoOrg.photoLib.Util.clustersViewController.setupPages();
  }
  photoOrg.photoLib.selectedPicsFromAlb = {};
  photoOrg.Util.updateSettingSelectedPics();
 },
 deleteErrorCallback:function(t) {
  console.log("Error deleting selected assets: ", t.error);
 },
 saveStory:function(t) {
  try {
   console.log("Selection tray - saveStory method");
   photoOrg.forceReload = !0;
   this.hideBulkOptionsTray();
   this.removeOptionsIconClass();
   var e = "TrayOptions_AddPhotoToAlbum";
   t && (e = "TrayOptions_MovePhotoToAlbum");
   photoOrg.Util.trackLinksAndButtons(e, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   var o = JST["templates/common/library/add_to_album/move_copy_overlay"]();
   0 == $(".move_copy_overlay").find("#albumManagement").length && $(".move_copy_overlay").append(o);
   photoOrg.selectedAlbumId = "";
   photoOrg.albumManagement || (photoOrg.albumManagement = this.getAlbumManagement());
   photoOrg.albumManagement.show(t || !1);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:saveStory", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 getAlbumManagement:function() {
  return new photoOrg.AlbumManagement({
   el:$("#albumManagement")
  });
 },
 multiDownload:function() {
  try {
   console.log("Multi Pict's Downloading......");
   photoOrg.Util.trackLinksAndButtons("TrayOptions_DownloadPhotos", "photosPage");
   this.hideBulkOptionsTray();
   this.removeOptionsIconClass();
   self = this;
   $("#shareDownloadNote").hide();
   this.selectedAssetsIds = this.getSelectedIDs(self);
   var t = photoOrg.photoLib.getSelectedPictAssetRefs();
   1 == photoOrg.photoLib.areOwnedPhotosSelected ? photoOrg.downloadConfirmationModal.show({
    assetRefs:t
   }) :photoOrg.downloadConfirmationModal.showShareDownloadMessage({
    assetRefs:t
   });
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:multiDownload", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 multiAssetShare:function() {
  console.log("Multiple Photos shared...");
  photoOrg.Util.trackLinksAndButtons("TrayOptions_ShareThesePhotos", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  try {
   if ($(window).width() > 900) $("#hoveroptions").css("left", "-99999px"); else {
    $(".more-menu-mobile").hide();
    $(".more-menu-mobile").removeClass("expand");
    $("#mobile-overlay").hide();
   }
   this.hideBulkOptionsTray();
   this.removeOptionsIconClass();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:multiAssetShare", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
  var e = Backbone.Collection.extend({}), o = new e();
  _.each(photoOrg.photoLib.SelectedAsset.selectedAssets.models, function(t) {
   void 0 == t.attributes.ownerAccountId && void 0 == t.attributes.parentCollectionReferences[0].ownerAccountId || parseInt(gon.staticContent.account_id) != (parseInt(t.attributes.ownerAccountId) || parseInt(t.attributes.parentCollectionReferences[0].ownerAccountId)) || o.push(t);
  });
  eventBus.trigger(eventBus.CUSTOM_EVENT_SHARE, {
   shareType:this.shareType,
   friendsAssetCount:this.frnd_assets_count,
   fromTray:!0,
   shareData:{
    assetsCollection:o
   }
  });
 }
});

photoOrg.SelectionTrayViewMobile = Backbone.View.extend({
 el:".mobile-footer",
 events:{
  "click .close_selected_assets":"clearAllPics",
  "click .prints":"mobileTray",
  "click .photo_books":"mobileTray",
  "click .cards":"mobileTray",
  "click .calenders":"mobileTray",
  "click .canvas_and_decor":"mobileTray",
  "click .photo-gifts":"mobileTray",
  "click #reArrangeDone":"reArrangeDone",
  "click #reArrangeCancel":"reArrangeCancel",
  "click .tray-options-menu":"mobileTrayOptionsIcon",
  "click #rightScroll":"rightScroll",
  "click #leftScroll":"leftScroll"
 },
 initialize:function() {
  eventBus.on(eventBus.CUSTOM_EVENT_CLICK_MOBILE_OVERLAY, this.moreMenuClose, this);
  this.mobileTrayScroll = $(".selection-tray-mobile");
  $(window).resize(function() {
   photoOrg.projectTrayView && photoOrg.projectTrayView.mobileProjectTray.hideOrshowArrowIcons();
  });
  $(".more-button-mobile").on("click", function() {
   photoOrg.projectTrayView && photoOrg.projectTrayView.checkFriendsAssets();
  });
  $("#leftScroll").hide();
  $(".mobile-footer .mobile-selection-tray").prepend('<span class="first-element-footer"></span>');
  $(".mobile-footer .tray-links").append('<li><span class="product-last-child"></span></li>');
  var t = _.throttle($.proxy(this.hideOrshowArrowIcons, this), 400);
  $(this.mobileTrayScroll).scroll(t);
 },
 rightScroll:function() {
  this.mobileTrayScroll.animate({
   scrollLeft:$(".selection-tray-mobile").width()
  }, 800);
 },
 leftScroll:function() {
  photoOrg.photoLib.selectedImages.length > 0 ? this.mobileTrayScroll.animate({
   scrollLeft:0
  }, 600) :this.mobileTrayScroll.animate({
   scrollLeft:0
  }, 400);
 },
 hideOrshowArrowIcons:function() {
  $(".mobile-footer span.first-element-footer").isOnScreen() ? $("#leftScroll").hide() :$("#leftScroll").show();
  $(".mobile-footer span.product-last-child").isOnScreen() ? $("#rightScroll").hide() :$("#rightScroll").show();
 },
 mobileTrayOptionsIcon:function() {
  photoOrg.projectTrayView && photoOrg.projectTrayView.trayOptionsIcon();
 },
 mobileTray:function(t) {
  photoOrg.projectTrayView.checkVideoExistance(t);
 },
 moreMenuClose:function(t, e) {
  $(t).removeClass("expand");
  $(t).slideUp(150);
  $(e).addClass("pill").removeClass("pill-border");
  photoOrg.mobileOverlay.hide();
 },
 saveStory:function() {
  this.moreMenuClose(".more-menu-mobile", ".more-button-mobile");
  photoOrg.projectTrayView.saveStory();
 },
 multiDownload:function() {
  this.moreMenuClose(".more-menu-mobile", ".more-button-mobile");
  photoOrg.projectTrayView.multiDownload();
 },
 assetDelete:function() {
  this.moreMenuClose(".more-menu-mobile", ".more-button-mobile");
  photoOrg.projectTrayView.assetDelete();
 },
 clearAllPics:function(t) {
  photoOrg.projectTrayView.openDeselectPopup(t);
 }
});

photoOrg.ProductConfirmationModal = Backbone.View.extend({
 callBack:void 0,
 closeCallBack:void 0,
 events:{},
 initialize:function() {
  try {
   var t = JST["templates/common/library/common/product_creation_confirmation"]();
   $("#library").append(t);
   this.$el = $(".productCreationConfirmation");
   this.delegateEvents(_.extend(this.events, {
    "click #ok_btn":"navigateToProductPage_mtray",
    "click #close_btn":"closeLayer"
   }));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 closeLayer:function() {
  try {
   if ($(window).width() > 900) $("#hoveroptions").css("left", "-99999px"); else {
    $(".more-menu-mobile").hide();
    $(".more-menu-mobile").removeClass("expand");
    $("#mobile-overlay").hide();
   }
   this.callBack = void 0;
   if (this.closeCallBack) {
    this.closeCallBack();
    this.closeCallBack = void 0;
   }
  } catch (t) {}
  $(".productCreationConfirmation").foundation("reveal", "close");
 },
 navigateToProductPage_mtray:function() {
  $(".productCreationConfirmation").foundation("reveal", "close");
  try {
   if ($(window).width() > 900) $("#hoveroptions").css("left", "-99999px"); else {
    $(".more-menu-mobile").hide();
    $(".more-menu-mobile").removeClass("expand");
    $("#mobile-overlay").hide();
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:selection_tray_view:navigateToProductPage_mtray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
  if (this.callBack) {
   this.callBack();
   this.callBack = void 0;
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.SelectedAssetsTrayView = Backbone.View.extend({
 limit:100,
 startIndex:0,
 currentIndex:0,
 isDomeReady:!0,
 events:{},
 initialize:function() {
  var t = JST["templates/common/library/common/selected_assets_model"]();
  $("#library").append(t);
  console.log("Selected assets tray view initialize...");
  this.$el = $("#selected-assets-model");
  this.delegateEvents(_.extend(this.events, {
   "click .remove_selected":"removeAsset",
   "click .deselect_all":"deselectAll"
  }));
  this.assetsUl = $(".selected-photos-collage"), this.loadingDom = $(".load_selected_assets"), 
  this.countDom = $("#selected-assets-model .count"), $("#crossmark").click(function() {
   $("#newDeselectModal").css("display", "none");
  });
  $("#deselect_button_new").click(function() {
   $("#newDeselectModal").css("display", "none");
   $("#selected-assets-model").foundation("reveal", "close");
   photoOrg.projectTrayView && photoOrg.projectTrayView.clearSelectedAssets();
   $(".selectAlbum a").removeClass("alb_selected");
  });
  $("#cancel_deselect_new").click(function() {
   $("#newDeselectModal").css("display", "none");
  });
  eventBus.on(eventBus.CUSTOM_EVENT_SELECTED_ASSETS_CLOSE, this.closeRevealModelOverlay, this);
 },
 close:function() {
  this.currentIndex = this.startIndex;
  this.assetsUl.empty();
  $(window).off("orientationchange");
 },
 render:function() {
  try {
   console.log("selected assets tray render...");
   $(window).off("orientationchange");
   $(window).on("orientationchange", function() {
    photoOrg.photoLib.selectedAssetsTray.alignSelectedAssetsOverlay();
   });
   var t = photoOrg.photoLib.SelectedAsset.selectedAssets.toJSON();
   t = t.reverse();
   this.isDomeReady = !0;
   this.updateSelectedAssetsCount();
   this.assetsUl.off("scroll", this.onScroll);
   if (t.length <= this.limit) {
    this.currentIndex;
    this.buildSelectedTray(t);
    this.showOrHideSpinningWheel();
   } else {
    this.assetsUl.on("scroll", this.onScroll);
    this.loadSetOfAssets();
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:SelectedAssetsTrayView:render", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 alignSelectedAssetsOverlay:function() {
  if (photoOrg.Util.isMobileLayout()) {
   this.$el.css("top", "");
   this.$el.addClass("mobile-selected-assets-model");
  } else {
   this.$el.css("top", $(".project-selection-tray .tray-links").offset().top);
   this.$el.removeClass("mobile-selected-assets-model");
  }
 },
 onScroll:function() {
  $(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight && photoOrg.photoLib.selectedAssetsTray.loadSetOfAssets();
 },
 loadSetOfAssets:function() {
  try {
   console.log("Loaded set of Assets...");
   var t = photoOrg.photoLib.SelectedAsset.selectedAssets.toJSON();
   t = t.reverse();
   if (this.currentIndex < t.length && this.isDomeReady) {
    this.isDomeReady = !1;
    t = t.slice(this.currentIndex, this.currentIndex + this.limit);
    this.currentIndex = this.currentIndex + this.limit;
    this.buildSelectedTray(t);
   }
   this.showOrHideSpinningWheel();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:SelectedAssetsTrayView:loadSetOfAssets", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 showOrHideSpinningWheel:function() {
  this.currentIndex == this.startIndex || this.currentIndex >= photoOrg.photoLib.SelectedAsset.selectedAssets.models.length ? this.loadingDom.hide() :this.loadingDom.show();
 },
 buildSelectedTray:function(t) {
  try {
   console.log("Building DOM.....");
   _.each(t, function(t) {
    var e = t.id, o = photoOrg.photoLib.getLowORHires(t.files).url;
    o += o.indexOf("?") > 0 ? "&" :"?";
    var i = photoOrg.Util.getThumbnailURL(o + "height=200"), s = JST["templates/common/library/common/selected_asset_template"]({
     id:e,
     tnlUrl:i
    });
    this.assetsUl.append(s);
   }, this);
   this.isDomeReady = !0;
   $(".selected-photos-collage .selected_lazy").lazyload({
    effect:"fadeIn",
    container:this.assetsUl
   });
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:SelectedAssetsTrayView:buildSelectedTray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 removeAsset:function(t) {
  try {
   console.log("Removing asset....");
   var e = $(t.currentTarget).attr("asset_id");
   if (e) {
    e = parseInt(e);
    photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, e);
    photoOrg.photoLib.selectedAlbumAssets = _.without(photoOrg.photoLib.selectedAlbumAssets, e);
    $(".asset_selected_" + e).remove();
    var o = photoOrg.photoLib.SelectedAsset.selectedAssets.get(e);
    if (void 0 != o) {
     photoOrg.photoLib.SelectedAsset.selectedAssets.remove(o);
     photoOrg.Util.deleteAlbumFromLocalStorage(o.toJSON());
     eventBus.trigger(eventBus.CUSTOM_EVENT_DETAILED_ASSET_SELECT_ICON_CLICKED, {
      model:o,
      isSelected:!1
     });
    }
    eventBus.trigger(eventBus.CUSTOM_EVENT_DE_SELECT_ASSET, e);
    $(".detailedViewContainer").is(":visible") && eventBus.trigger(eventBus.CUSTOM_EVENT_DETAILVIEW_DE_SELECT_ASSETS, e);
    0 == this.assetsUl.children().length && $(photoOrg.photoLib.selectedAssetsTray.el).foundation("reveal", "close");
    $(".selected-photos-collage .selected_lazy").lazyload({
     effect:"fadeIn",
     container:this.assetsUl
    });
   }
   this.updateSelectedAssetsCount();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:removeAsset:buildSelectedTray", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 updateSelectedAssetsCount:function() {
  try {
   var t = "";
   if (1 == photoOrg.photoLib.SelectedAsset.selectedAssets.length) t = window.translations.picker.photo_selected; else {
    var e = window.translations.picker.photos_selected;
    t = e.replace("{0}", photoOrg.photoLib.SelectedAsset.selectedAssets.length);
   }
   this.countDom.text(t);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:SelectedAssetsTrayView:updateSelectedAssetsCount", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 closeRevealModelOverlay:function() {
  $(photoOrg.photoLib.selectedAssetsTray.el).foundation("reveal", "close");
 },
 deselectAll:function() {
  console.log("deselectAll.......");
  $("#newDeselectModal").css("display", "block");
  $("#deselectNoteNew").text(window.translations.action_container.deselect_message.replace("%{photo_count}", photoOrg.photoLib.SelectedAsset.selectedAssets.length));
 }
});

var photoOrg = photoOrg || {};

photoOrg.TrayoptionsView = Backbone.View.extend({
 el:"#tray-options",
 initialize:function(t) {
  this.parentObj = t.parentObj;
  photoOrg.Util.isDesktopResolution() || $("#bulkDownload").hide();
 },
 events:{
  "click #multiShare":"multiAssetShare",
  "click #edit_album":"moveToAlbum",
  "click #bulkCopy":"saveStory",
  "click #bulkDownload":"multiDownload",
  "click #delete-selected":"assetDelete"
 },
 moveToAlbum:function(t) {
  this.parentObj.moveToAlbum(t);
 },
 multiAssetShare:function() {
  this.parentObj.multiAssetShare();
 },
 saveStory:function() {
  this.parentObj.saveStory();
 },
 multiDownload:function() {
  this.parentObj.multiDownload();
 },
 assetDelete:function() {
  this.parentObj.assetDelete();
 },
 multiAssetShare:function() {
  this.parentObj.multiAssetShare();
 }
});

var photoOrg = photoOrg || {};

photoOrg.MakeSomethingView = Backbone.View.extend({
 initialize:function() {
  try {
   _.bind(this.render);
   this.render();
   $(document).on("keydown", this.keydownHandler);
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.render, this);
   this.delegateEvents(_.extend(this.events, {
    "click li":"selectProduct"
   }));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 el:"#photo-Org-makeSomeThingContainer",
 events:{
  "click #cancel":"closeMakeSomethingOverlay",
  "click #make-something-close":"closeMakeSomethingOverlay",
  "click #make-it":"natigateToProductPage"
 },
 render:function() {
  try {
   {
    var t, e = document.getElementById("photo-Org-makeSomeThingContainer"), o = $(window).width();
    $(window).height();
   }
   if (640 >= o) {
    t = "260px";
    e.style.width = t + "px";
   } else {
    t = .6 * o;
    e.style.width = t + "px";
    e.style.marginLeft = -(t / 2) + "px";
   }
   var i = $.toJSON(photoOrg.photoLib.SelectedAsset.selectedAssets), s = $("#getBuilderForm");
   s.find("#selectedPictObjects").val(i);
   var r = 0;
   $("#product-details").empty();
   _.each(gon.staticContent.product_details.products, function(t) {
    var e = t.name, o = {
     productId:e,
     productName:e.replace("_", " ")
    }, i = JST["templates/common/library/time_line_view/product"](o);
    $("#product-details").append(i);
    0 == r && this.selectProduct(new String(e));
    r++;
   }, this);
   $($(".ms-icon")[0]).addClass("ms-checkcolor");
   640 >= o ? $("#make-something-products").removeClass("small-6 columns").addClass("small-12 columns") :$("#make-something-products").removeClass("small-12 columns").addClass("small-6 columns");
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:render", errorCode="LIBRARY:MYPHOTOS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 selectProduct:function(t) {
  try {
   var e;
   if (t instanceof String) e = t; else {
    e = $(t.currentTarget).attr("id");
    t.preventDefault();
    $(".ms-icon").removeClass("ms-checkcolor");
    $($(t.currentTarget).find(".ms-icon")[0]).addClass("ms-checkcolor");
   }
   {
    var o = this.getProductConfig(e), i = $("#makeSomeThingProductImg");
    .76 * $(window).width(), $("#msImagecontainer").height();
   }
   i.attr("src", o.product_img);
   $("#getBuilderForm").attr("action", gon.staticContent.builder_url + o.service_url);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:selectProduct", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 getProductConfig:function(t) {
  var e;
  _.each(gon.staticContent.product_details.products, function(o) {
   o.name != t || (e = o.config);
  });
  return e;
 },
 natigateToProductPage:function() {
  try {
   $("#getBuilderForm").submit();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:natigateToProductPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 toggleMakeSomethingOverlay:function() {
  var t = document.getElementById("makeSomeThingOverlay"), e = document.getElementById("makeSomeThingContainer");
  t.style.opacity = .6;
  if ("block" == t.style.display) {
   t.style.display = "none";
   e.style.display = "none";
  } else {
   t.style.display = "block";
   e.style.display = "block";
  }
 },
 closeMakeSomethingOverlay:function() {
  try {
   $("#photo-Org-makeSomeThingContainer").foundation("reveal", "close");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:closeMakeSomethingOverlay", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 keydownHandler:function(t) {
  try {
   if (27 == t.which) {
    $("#albumOverlay").css("display", "none");
    $("#addToAlbumContainer").css("display", "none");
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:make_something_view:keydownHandler", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.assetView = Backbone.View.extend({
 model:null,
 optionsMenu:null,
 isAlbumCover:!1,
 type:"",
 accessType:"",
 clusterObj:null,
 collectionId:null,
 isReArrange:!1,
 initialize:function(t) {
  try {
   _.bindAll(this, "render");
   this.isAlbumCover = t.isAlbumCover;
   this.gridId = t.gridId;
   this.parentGridView = t.parentGridView;
   this.type = t.type;
   this.collectionId = t.collectionId;
   this.accessType = t.accessType;
   this.assetType = t.model.attributes.assetType;
   this.clusterObj = t.clusterObj;
   this.isReArrange = t.reArrangeMode;
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE, this.close, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, $.proxy(this.updateSelectAllWrapper, this));
   photoOrg.photoLib.Util.isTouchDevice() || this.delegateEvents(_.extend(this.events, {
    mouseout:"mouseOutOnPict",
    mouseover:"mouseOverOnPict"
   }));
   photoOrg.photoLib.config.pictDetailView && !this.isReArrange && this.delegateEvents(_.extend(this.events, {
    "click .expand":"detailView",
    "click .detail-view-trigger":"detailView",
    "click .click-on-asset":"assetSelectionToggle",
    "click .th-video-ic":"detailView"
   }));
   photoOrg.photoLib.config.loadAsPhotoPicker && this.delegateEvents(_.extend(this.events, {
    "click .click-on-asset":"assetSelectionToggle"
   }));
   $(window).width() < 640 && this.handleImageCount();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 events:{
  "click .selection-toggle-trigger":"assetSelectionToggle"
 },
 handleImageCount:function(t) {
  try {
   console.log("handleImageCount event triggered");
   if (void 0 != gon.staticContent.pict_ids && void 0 != photoOrg.photoLib.selectedImages && null != gon.staticContent.pict_ids && null != photoOrg.photoLib.selectedImages) if (gon.staticContent.pict_ids.length > 0 || photoOrg.photoLib.selectedImages.length > 0) {
    $(".imageCount").text(0 == gon.staticContent.pict_ids.length && photoOrg.photoLib.selectedImages.length > 0 ? photoOrg.photoLib.selectedImages.length :gon.staticContent.pict_ids.length);
    $(".firstImageSection").show();
   } else $(".firstImageSection").hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:handleImageCount", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 deletePict:function() {
  console.log("Deleting Picture from cluster");
  var t = this.model.get("userTags") || this.model.userTags, e = photoOrg.photoLib.getValue(t, "caption") || "", o = !1;
  photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && (o = !0);
  photoOrg.deleteConfirmationModal.show({
   type:photoOrg.ModalTypes.ASSET,
   assetID:this.model.id,
   parentCollectionReferences:this.model.attributes.parentCollectionReferences,
   collectionID:this.collectionId,
   name:e,
   success:$.proxy(this.deleteSuccessCallback, this),
   error:$.proxy(this.deleteErrorCallback, this),
   showDeletePhotoCheckbox:o
  });
 },
 deleteSuccessCallback:function() {
  console.log("Deleted the photo from cluster and updated count of cluster");
  photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && void 0 != photoOrg.savPage && photoOrg.savPage.singleAlbumView.photos_count < 3 ? $(".sav_slideshow").hide() :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && void 0 != photoOrg.savPage && photoOrg.savPage.singleAlbumView.photos_count >= 3 && $(".sav_slideshow").show();
  void 0 != this.model && void 0 != this.model.id && photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length >= 0 && photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.remove(this.model.id);
  if (photoOrg.photoLib.selectedImages.length > 0 && -1 != $.inArray(this.model.id, photoOrg.photoLib.selectedImages)) {
   photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(this.model.id);
   photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, this.model.id);
   photoOrg.photoLib.SelectedAsset.selectedAssets.remove(this.model);
  }
  var t = this.$el.closest(".asset-group").find(".photoscount"), e = t.text().replace(/\D/g, ""), o = parseInt(e) - 1;
  o += 1 === o ? " Photo" :" Photos";
  t.text(o);
  this.optionsMenu && this.optionsMenu.destroy();
  var i = !1;
  if (this.clusterObj) {
   var s = this.clusterObj.$el.find(".selectable-asset:last-child"), r = "";
   if (this.$el.find(".view-all-button").length > 0) {
    i = !0;
    r = s.find(".view-all-button");
   }
   this.unbind();
   this.remove();
   if (i) {
    i = !1;
    s = this.clusterObj.$el.find(".selectable-asset:last-child");
    r.on("click", $.proxy(this.clusterObj.onExpandButtonClick, this.clusterObj));
    s.append(r);
   }
  } else {
   this.unbind();
   this.remove();
  }
  photoOrg.photoLib.UserAssetsInfo.assetList.remove(this.model.id);
  delete photoOrg.photoLib.UserAssetsInfo.assetViewsMap[this.model.id];
  eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
 },
 deleteErrorCallback:function(t, e, o, i, s) {
  photoOrg.jsErrorLogger('"Error deleting asset" errorThrown="' + i + '" textStatus="' + photoOrg.Util.getFormattedMessage(o) + '" Noodle="' + s + '"');
 },
 detailView:function() {
  try {
   console.log("Opening DetailView from cluster");
   photoOrg.Util.trackLinksAndButtons("Magnifying Icon", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   photoOrg.photoLib.isSelectedImagesDetailedView = !1;
   void 0 == photoOrg.photoLib.current_state && (photoOrg.photoLib.current_state = photoOrg.photoLib.navType.singleAlbum);
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
    if (void 0 == this.model.get("id")) {
     this.model.id = this.model.attributes.assetId;
     this.model = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.where({
      assetId:this.model.id
     })[0];
    } else this.model = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(this.model.get("id"));
    {
     photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length, photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.indexOf(this.model);
    }
    $("#detailedViewContainer").empty();
    var t = .7 * $(window).height(), e = {
     modelId:this.model.id,
     detailedViewHeight:t,
     accessType:this.accessType
    }, o = JST["templates/common/library/detail_view/detailed-view-container"](e);
    $("#detailedViewContainer").html(o);
    $("#detailedViewContainer").show();
    $("#detailedViewContainer").css("visibility", "visible");
    photoOrg.detailedView = new photoOrg.DetailedView({
     el:"#detailedView_" + this.model.id,
     model:this.model,
     accessType:this.accessType
    });
   }
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:detailView", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 assetSelectionToggle:function() {
  try {
   console.log("toggling the selection");
   photoOrg.Util.trackLinksAndButtons("Check Mark on Image", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   if (photoOrg.photoLib.config.loadAsPhotoPicker && $(this.el).hasClass("disable")) return;
   this.accessType != photoOrg.photoLib.accessType.guest && ($(this.$el).hasClass("selected") ? this.clickOnAssetSelectIcon() :this.clickOnAssetUnSelectIcon());
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:assetSelectionToggle", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 render:function() {
  try {
   console.log("asset render triggered");
   var t = "", e = {}, o = {
    width:0,
    height:0
   }, i = this.model.get("files");
   e.pict_height = photoOrg.pictureSize;
   e.id = this.model.get("id");
   e.thumbnailParam = "height=200";
   e.imgUrl = "";
   e.AssetType = this.model.attributes.assetType;
   i && i.length > 0 && (e.imgUrl = photoOrg.Util.getTnlURLFromArray(photoOrg.photoLib.getLOWorTHUMBNAIL(i).url, e.id));
   o = photoOrg.photoLib.getHAndWForImage(this.model);
   if ("VIDEO" == this.model.attributes.assetType) {
    var s = "";
    if (void 0 == this.model.attributes.thumbnailEncryption) {
     i = this.model.get("files");
     if (i && i.length > 0) {
      var r = photoOrg.photoLib.getValueFromArray(i, "THUMBNAIL");
      r && (s = r.url);
     }
    } else s = this.model.attributes.thumbnailEncryption;
    e.imgUrl = photoOrg.Util.getVideoImageUrl(s);
    console.log(e.imgUrl);
   }
   o.width <= 0 && (o.width = 200);
   o.height <= 0 && (o.height = 200);
   e.width = o.width;
   e.height = o.height;
   e.thumbnailParam = "height=200";
   if ("undefined" == typeof e.width || "undefined" == typeof e.height) {
    e.width = 200;
    e.height = 200;
   }
   try {
    o.width - o.height > 2 * parseInt(o.height) && (e.thumbnailParam = "width=" + $("#assetGrid").width());
   } catch (n) {}
   e.idStr = "";
   e.wRh = "width";
   e.accessType = this.accessType;
   photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos ? e.idStr = "po_av" :photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && (e.idStr = "po_sav");
   var a = !1;
   e.tnlUrl = "";
   e.imgUrl && e.imgUrl.length > 0 && (e.tnlUrl = e.imgUrl + "?" + e.thumbnailParam);
   e.reArrangeMode = this.isReArrange;
   t = JST["templates/common/library/time_line_view/pict-view"](e);
   if (-1 != _.indexOf(photoOrg.photoLib.defaultSelected, this.model.get("id"), !1) || -1 != _.indexOf(gon.staticContent.pict_ids, this.model.get("id"), !1) || -1 != _.indexOf(photoOrg.photoLib.selectedImages, this.model.get("id"), !1)) {
    a = !0;
    photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.SelectedAsset.selectedAssets.add(this.model);
   }
   this.el.id = this.model.id + e.idStr;
   var l = "";
   if ("Video" == this.model.get("@class")) {
    l = JST["templates/common/library/time_line_view/video-icon"]();
    t = l + t;
   }
   $(this.el).html(t);
   if (a) {
    $(this.el).addClass("selected");
    photoOrg.photoLib.config.loadAsPhotoPicker && -1 != _.indexOf(photoOrg.photoLib.defaultSelected, this.model.get("id"), !1) && $(this.el).addClass("disable");
   } else $(this.el).removeClass("selected");
   "VIDEO" == this.model.attributes.assetType && photoOrg.photoLib.videos.push(this.model.get("id"));
   if (photoOrg.photoLib.config.loadAsPhotoPicker && "VIDEO" == this.model.attributes.assetType) {
    console.log(this.model.attributes.assetType);
    $(".th-video-ic").show();
    $(this.el).addClass("disable");
    $(this.el).addClass("video");
   }
   $(this.el).addClass("selectable-asset");
   (gon.staticContent.customsort || "true" == photoOrg.Util.getURLParameter("customsort")) && $(this.el).addClass("drag-drop");
   this.isAlbumCover && $(this.el).addClass("album-cover");
   this.assetType = this.model.attributes.assetType;
   contextMenuButtons = $(this.el).find(".context-menu-buttons");
   this.optionsMenu = new photoOrg.AssetOptionsMenu({
    el:contextMenuButtons.find(".options"),
    context:this.$el,
    model:this.model,
    deleteCallback:$.proxy(this.deletePict, this),
    type:this.type,
    isAlbumCover:this.isAlbumCover,
    accessType:this.accessType,
    assetType:this.assetType
   });
   if (!photoOrg.photoLib.Util.isTouchDevice()) {
    var c = this;
    $(this.el).hover(function() {
     c.optionsMenu.hide();
    });
   }
   setTimeout(function() {
    if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) if ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length) {
     $(".select-all-wrapper figure").removeClass("checkmark-blue");
     photoOrg.photoLib.config.loadAsPhotoPicker && $(".select-all-wrapper").removeClass("selected");
    } else {
     $(".select-all-wrapper figure").addClass("checkmark-blue");
     if (photoOrg.photoLib.config.loadAsPhotoPicker) {
      $(".select-all-wrapper figure").removeClass("checkmark-blue");
      $(".select-all-wrapper").addClass("selected");
     }
    }
   }, 0);
   return this;
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:render", errorCode="LIBRARY:MYALBUMS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
  return this;
 },
 clickOnAssetUnSelectIcon:function() {
  console.log("Selecting the asset");
  var t = $(this.$el);
  $(".empty-tray-sec").hide();
  $("#cls_empty_tray").hide();
  photoOrg.photoLib.hideEmptyTray = !0;
  $(".mobile-selection-tray .selection-thumbnail-wrapper").removeClass("hide");
  t.addClass("selected");
  try {
   if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
    photoOrg.photoLib.selectedPicsFromAlb[this.model.id] = photoOrg.photoLib.selectedPicsFromAlb[this.model.id] ? photoOrg.photoLib.selectedPicsFromAlb[this.model.id] + "_" + this.model.attributes.parentCollectionReferences[0].collectionId :this.model.attributes.parentCollectionReferences[0].collectionId + "";
    photoOrg.Util.updateSettingSelectedPics();
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:clickOnAssetUnSelectIcon", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
  $(".remove-asset img").show();
  photoOrg.photoLib.SelectedAsset.selectedAssets.add(this.model);
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   var o = photoOrg.photoLib.SelectedAsset.selectedAssets.length, i = window.translations.picker.photos_selected;
   if (0 != o) {
    $(".actionContainer .select_count .selectedImageCount").text(o > 1 ? i.replace("{0}", o) :window.translations.picker.photo_selected);
    $(".actionContainer .select_count .select_count_sec").show();
    $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
   } else {
    $(".actionContainer .select_count .select_count_sec").hide();
    $(".photo-Org .picker-done-button").addClass("disable-greybtn");
   }
  }
  $("#po_photo_txt").text(photoOrg.photoLib.SelectedAsset.selectedAssets.length > 1 ? window.translations.photos :window.translations.photo);
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) if ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length) {
   $(".select-all-wrapper figure").removeClass("checkmark-blue");
   photoOrg.photoLib.config.loadAsPhotoPicker && $(".select-all-wrapper").removeClass("selected");
  } else {
   $(".select-all-wrapper figure").addClass("checkmark-blue");
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".select-all-wrapper figure").removeClass("checkmark-blue");
    $(".select-all-wrapper").addClass("selected");
   }
  }
  photoOrg.photoLib.selectedImages.push(this.model.id);
  photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
  eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, this.model);
  photoOrg.photoLib.config.loadAsPhotoPicker || eventBus.trigger(eventBus.CUSTOM_EVENT_SELECT_ASSET, {
   model:this.model
  });
  var s = !0;
  this.updateSelectAllWrapper(s, 1);
 },
 updateSelectAllWrapper:function(t, e) {
  try {
   this.parentGridView && this.parentGridView.updateSelectAllWrapper(t, e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:updateSelectAllWrapper", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 clickOnAssetSelectIcon:function() {
  console.log("Deselecting the asset");
  var t, e = $(this.$el);
  e.removeClass("selected");
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && e.removeClass("selected");
  photoOrg.photoLib.SelectedAsset.selectedAssets.remove(this.model);
  try {
   if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
    if (photoOrg.photoLib.selectedPicsFromAlb[this.model.id]) {
     t = photoOrg.photoLib.selectedPicsFromAlb[this.model.id].split("_");
     var o = t.indexOf(this.model.attributes.parentCollectionReferences[0].collectionId + "");
     t.splice(o, 1);
     t = t.join("_");
     photoOrg.photoLib.selectedPicsFromAlb[this.model.id] = t;
     "" == t && delete photoOrg.photoLib.selectedPicsFromAlb[this.model.id];
    }
    photoOrg.Util.updateSettingSelectedPics();
   }
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:clickOnAssetSelectIcon", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   var s = photoOrg.photoLib.SelectedAsset.selectedAssets.length, r = window.translations.picker.photos_selected;
   $(".actionContainer .select_count .selectedImageCount").text(s > 1 ? r.replace("{0}", s) :window.translations.picker.photo_selected);
   if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
    $(".actionContainer .select_count .select_count_sec").hide();
    $(".photo-Org .picker-done-button").addClass("disable-greybtn");
   } else {
    $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
    $(".actionContainer .select_count .select_count_sec").show();
   }
  }
  $("#po_photo_txt").text(photoOrg.photoLib.SelectedAsset.selectedAssets.length > 1 ? window.translations.photos :window.translations.photo);
  photoOrg.Util.deleteAlbumFromLocalStorage(this.model.toJSON());
  photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, this.model.id);
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && !photoOrg.photoLib.deSelectAllVisibleImagesClicked) {
   $("#album_assets .deSelectAllLink").hide();
   $("#album_assets .selectAllLink").show();
  }
  $(".remove-asset img").show();
  var n = !0;
  this.updateSelectAllWrapper(n, -1);
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length ? $(".select-all-wrapper figure").removeClass("checkmark-blue") :$(".select-all-wrapper figure").addClass("checkmark-blue"));
  if (void 0 != gon.staticContent.pict_ids || null != gon.staticContent.pict_ids) {
   gon.staticContent.pict_ids = _.without(gon.staticContent.pict_ids, this.model.id);
   gon.staticContent.pict_ids = _.difference(gon.staticContent.pict_ids, photoOrg.photoLib.selectedImages);
  }
  eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, this.model);
  photoOrg.photoLib.config.loadAsPhotoPicker || eventBus.trigger(eventBus.CUSTOM_EVENT_DE_SELECT_ASSET, {
   model:this.model
  });
 },
 unSelectAsset:function() {
  console.log("Unselecting Asset");
  var t = $(this.$el);
  t.removeClass("selected");
  this.updateSelectAllWrapper();
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length ? $(".select-all-wrapper figure").removeClass("checkmark-blue") :$(".select-all-wrapper figure").addClass("checkmark-blue"));
 },
 mouseOverOnPict:function() {
  try {} catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:mouseOverOnPict", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 mouseOutOnPict:function() {
  try {} catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:mouseOutOnPict", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 close:function() {
  try {
   console.log("removing view object and model");
   $(this.el).off();
   this.optionsMenu && this.optionsMenu.destroy();
   this.unbind();
   this.remove();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_view:close", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 updateAssetView:function(t) {
  console.log("Updating the Asset view");
  this.model = t;
  var e = photoOrg.Util.getThumbnailURL(photoOrg.photoLib.getLOWorTHUMBNAIL(this.model.get("files")).url), o = photoOrg.photoLib.getHAndWForImage(this.model);
  $("#img_" + this.el.id).one("load", function() {
   console.log("Image onload function triggered");
   $("#loadingBar").hide();
  });
  $("#img_" + this.el.id).one("error", function() {
   console.log("Image onerror function triggered");
   $("#loadingBar").hide();
  });
  $("#img_" + this.el.id).attr("src", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC");
  if (photoOrg.isTabOrMobile) ; else if (0 != o.width && 0 != o.height) {
   $("#img_" + this.el.id).data("width", o.width);
   $("#img_" + this.el.id).data("height", o.height);
   $("#img_" + this.el.id).width(o.width);
   $("#img_" + this.el.id).height(o.height);
   $("#" + this.el.id).width(o.width);
   $("#" + this.el.id).height(o.height);
  }
  $("#img_" + this.el.id).attr("src", e);
  setTimeout(function() {
   $("#loadingBar").hide();
  }, 1e4);
  this.clusterObj && this.clusterObj.updateEntity(t);
  photoOrg.isDesktop && $("#" + this.gridId).collagePlus();
 }
});

var photoOrg = photoOrg || {};

photoOrg.CommonAssetView = Backbone.View.extend({
 model:null,
 optionsMenu:null,
 isAlbumCover:!1,
 type:"",
 accessType:"",
 clusterObj:null,
 collectionId:null,
 aldId:"",
 heroImageId:"",
 initialize:function(t) {
  try {
   _commonAssetView = this;
   this.accessType = t.accessType || t.obj.accessType || t.obj.context.accessType;
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE, this.close, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, $.proxy(this.updateSelectAllWrapper, this));
   photoOrg.photoLib.config.pictDetailView && this.delegateEvents(_.extend(this.events, {
    "click .expand":"detailView",
    "click .detail-view-trigger":"detailView",
    "click .click-on-asset":"assetSelectionToggle",
    "click .th-video-ic":"detailView"
   }));
   photoOrg.photoLib.config.loadAsPhotoPicker && this.delegateEvents(_.extend(this.events, {
    "click .click-on-asset":"assetSelectionToggle"
   }));
   if (t.savObj) {
    this.albId = t.savObj.albumId;
    this.heroImageId = t.savObj.firstAssetId;
   }
   photoOrg.Util.settingSelectedPics();
   t && t.savObj && t.savObj.albumId && (this.optionsMenu = new photoOrg.SavAssetOptionsMenu({
    el:this.$el,
    model:{},
    deleteCallback:this.deletePict,
    type:"sav",
    albumId:t.savObj.albumId,
    accessType:this.accessType
   }));
   $(window).width() < 640 && this.handleImageCount();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 events:{
  "click .selection-toggle-trigger":"assetSelectionToggle"
 },
 buildImageDiv:function(t, e, o, i, s) {
  console.log("Building Image Div with any new operations done");
  var r = "", n = document.createElement("div"), a = photoOrg.photoLib.getLOWorTHUMBNAIL(t.get("files")).url, l = !1;
  l = s && t && s == t.id ? !0 :e.indexOf(a) >= 0;
  var c = {
   width:0,
   height:0
  }, h = t.get("files"), d = {};
  d.pict_height = photoOrg.pictureSize;
  d.id = t.get("id");
  d.thumbnailParam = "height=200";
  d.imgUrl = "";
  d.AssetType = t.attributes.assetType;
  d.imgUrl = h && h.length ? photoOrg.Util.getTnlURLFromArray(photoOrg.photoLib.getLOWorTHUMBNAIL(h).url, t.get("id")) :void 0 == t.attributes.thumbnailEncryption ? photoOrg.Util.getThumbnailURL(photoOrg.photoLib.getLOWorTHUMBNAIL(t.attributes.attributes.files).url, t.get("id")) :photoOrg.Util.getThumbnailURL(t.attributes.thumbnailEncryption, t.get("id"));
  c = photoOrg.photoLib.getHAndWForImage(t);
  if ("VIDEO" == t.attributes.assetType) {
   var h = "";
   h = void 0 == t.attributes.thumbnailEncryption ? photoOrg.photoLib.getValueFromArray(t.get("files"), "THUMBNAIL").url :t.attributes.thumbnailEncryption;
   d.imgUrl = photoOrg.Util.getVideoImageUrl(h);
   console.log(d.imgUrl);
  }
  0 == c.width && (c.width = 200);
  0 == c.height && (c.height = 200);
  d.height = 200;
  try {
   d.width = 200 * c.width / c.height;
  } catch (p) {
   d.width = 200;
  }
  d.thumbnailParam = "height=200";
  if ("undefined" == typeof d.width || "undefined" == typeof d.height) {
   d.width = 200;
   d.height = 200;
  }
  try {
   c.width - c.height > 2 * parseInt(c.height) && (d.thumbnailParam = "width=" + ($("#assetGrid").width() || $("#pfluidGrid").width()));
  } catch (p) {}
  d.idStr = "";
  d.wRh = "width";
  d.accessType = o;
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos ? d.idStr = "po_av" :photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && (d.idStr = "po_sav");
  var u = !1;
  d.tnlUrl = "";
  d.imgUrl && d.imgUrl.length > 0 && (d.tnlUrl = d.imgUrl + "?" + d.thumbnailParam);
  d.isRearrangeMode = !1;
  this.accessType != photoOrg.photoLib.accessType.guest && (d.isRearrangeMode = photoOrg.rearrange_assets_view.reArrangeMode);
  n.id = t.id + d.idStr;
  r = JST["templates/common/library/time_line_view/common-pict-view"](d);
  if (-1 != _.indexOf(photoOrg.photoLib.defaultSelected, t.get("id"), !1) || -1 != _.indexOf(gon.staticContent.pict_ids, t.get("id"), !1) || -1 != _.indexOf(photoOrg.photoLib.selectedImages, t.get("id"), !1)) {
   u = !0;
   photoOrg.photoLib.selectedAlbumAssets.push(t.id);
   photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.photoLib.SelectedAsset.selectedAssets.add(t);
  }
  var g = "";
  if ("Video" == t.get("@class")) {
   g = JST["templates/common/library/time_line_view/video-icon"]();
   r = g + r;
  }
  if (l) {
   photoOrg.albumCoverModel = t;
   n.className += " album-cover";
  }
  if (u) {
   n.className += " selected";
   photoOrg.photoLib.config.loadAsPhotoPicker && -1 != _.indexOf(photoOrg.photoLib.defaultSelected, t.get("id"), !1) && (n.className += " disable");
  } else n.className.replace(/selected/g, "");
  if ("VIDEO" == t.attributes.assetType) {
   photoOrg.photoLib.videos.push(t.get("id"));
   photoOrg.photoLib.config.loadAsPhotoPicker && (n.className += " video");
  }
  if (photoOrg.photoLib.config.loadAsPhotoPicker && "VIDEO" == t.attributes.assetType) {
   console.log(t.attributes.assetType);
   $(".th-video-ic").show();
   n.className += " disable";
  }
  n.className += " selectable-asset";
  (gon.staticContent.customsort || "true" == photoOrg.Util.getURLParameter("customsort")) && (n.className += " drag-drop");
  setTimeout(function() {
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) if ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length) {
    $(".select-all-wrapper figure").removeClass("checkmark-blue");
    photoOrg.photoLib.config.loadAsPhotoPicker && $(".select-all-wrapper").removeClass("selected");
   } else {
    $(".select-all-wrapper figure").addClass("checkmark-blue");
    if (photoOrg.photoLib.config.loadAsPhotoPicker) {
     $(".select-all-wrapper figure").removeClass("checkmark-blue");
     $(".select-all-wrapper").addClass("selected");
    }
   }
  }, 0);
  var m = t.attributes.assetType;
  n.innerHTML += r;
  n.getElementsByClassName("options")[0] && (n.getElementsByClassName("options")[0].innerHTML = this.optionsMenu.render(l, m));
  return n;
 },
 detailView:function(t) {
  try {
   console.log("DetailView triggered from single album view");
   if (this.accessType != photoOrg.photoLib.accessType.guest && photoOrg.rearrange_assets_view.reArrangeMode) return;
   photoOrg.Util.trackLinksAndButtons("Magnifying Icon", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   photoOrg.photoLib.isSelectedImagesDetailedView = !1;
   var e = $(t.currentTarget).parent().attr("id").replace(/[^0-9]+/gi, "");
   e || (e = $(i.currentTarget).siblings(".assetImg").attr("id").replace(/[^0-9]+/gi, ""));
   var o = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(e);
   if (!o) {
    var i = "unable to find model object for id : " + e;
    photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:detailView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
    return;
   }
   {
    photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length, photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.indexOf(o);
   }
   $("#detailedViewContainer").empty();
   var s = .7 * $(window).height(), r = {
    modelId:o.id,
    detailedViewHeight:s,
    accessType:this.accessType
   }, n = JST["templates/common/library/detail_view/detailed-view-container"](r);
   $("#detailedViewContainer").html(n);
   $("#detailedViewContainer").show();
   $("#detailedViewContainer").css("visibility", "visible");
   photoOrg.detailedView = new photoOrg.DetailedView({
    el:"#detailedView_" + o.id,
    model:o,
    accessType:this.accessType,
    albId:this.albId,
    heroImageId:this.heroImageId
   });
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:detailView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 mouseOverOnPict:function() {},
 mouseOutOnPict:function() {},
 handleImageCount:function(t) {
  try {
   console.log("Updating the images count in album");
   if (void 0 != gon.staticContent.pict_ids && void 0 != photoOrg.photoLib.selectedImages && null != gon.staticContent.pict_ids && null != photoOrg.photoLib.selectedImages) if (gon.staticContent.pict_ids.length > 0 || photoOrg.photoLib.selectedImages.length > 0) {
    $(".imageCount").text(0 == gon.staticContent.pict_ids.length && photoOrg.photoLib.selectedImages.length > 0 ? photoOrg.photoLib.selectedImages.length :gon.staticContent.pict_ids.length);
    $(".firstImageSection").show();
   } else $(".firstImageSection").hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:handleImageCount", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 deletePict:function(t, e) {
  try {
   console.log("Deleting the picture from single album view");
   var o = $(t).attr("id").replace(/[^0-9]+/gi, ""), i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o);
   _commonAssetView = e;
   _commonAssetView.imgToBeDeleted = t;
   photoOrg.imageModel = i;
   var s = i.get("userTags") || i.userTags, r = photoOrg.photoLib.getValue(s, "caption") || "", n = !1;
   photoOrg.photoLib.navType.singleAlbum == photoOrg.photoLib.current_state && (n = !0);
   photoOrg.deleteConfirmationModal.show({
    type:photoOrg.ModalTypes.ASSET,
    assetID:i.id,
    parentCollectionReferences:i.attributes.parentCollectionReferences,
    collectionID:photoOrg.photoLib.currentAlbumId,
    name:r,
    success:e.deleteSuccessCallback,
    error:e.deleteErrorCallback,
    showDeletePhotoCheckbox:n
   });
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:deletePict", errorCode="LIBRARY:MYPHOTOS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 deleteSuccessCallback:function() {
  console.log("Deleted the image from the album and updated the count as well as it's related text");
  photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && void 0 != photoOrg.savPage && photoOrg.savPage.singleAlbumView.photosCount < 3 && $(".sav_slideshow").hide();
  void 0 != photoOrg.imageModel && void 0 != photoOrg.imageModel.id && photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length >= 0 && photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.remove(photoOrg.imageModel.id);
  if (photoOrg.photoLib.selectedImages.length > 0 && -1 != $.inArray(photoOrg.imageModel.id, photoOrg.photoLib.selectedImages)) {
   photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(photoOrg.imageModel.id);
   photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, photoOrg.imageModel.id);
   photoOrg.photoLib.SelectedAsset.selectedAssets.remove(photoOrg.imageModel);
   photoOrg.photoLib.selectedAlbumAssets = _.without(photoOrg.photoLib.selectedAlbumAssets, photoOrg.imageModel.id);
  }
  var t = _commonAssetView.$el.closest(".asset-group").find(".photoscount"), e = t.text().replace(/\D/g, ""), o = parseInt(e) - 1;
  o += 1 === o ? " Photo" :" Photos";
  t.text(o);
  _commonAssetView.imgToBeDeleted.remove();
  photoOrg.photoLib.UserAssetsInfo.assetList.remove(photoOrg.imageModel.id);
  delete photoOrg.photoLib.UserAssetsInfo.assetViewsMap[photoOrg.imageModel.id];
  eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
 },
 deleteErrorCallback:function(t, e, o, i, s) {
  photoOrg.jsErrorLogger('"Error deleting asset", errorCode="LIBRARY:MYPHOTOS", errorThrown="' + i + '" textStatus="' + photoOrg.Util.getFormattedMessage(o) + '" Noodle="' + s + '"');
 },
 assetSelectionToggle:function(t) {
  try {
   console.log("Toggling the selection in SAV");
   photoOrg.Util.trackLinksAndButtons("Check Mark on Image", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   if (photoOrg.photoLib.config.loadAsPhotoPicker && $(t.currentTarget).parent().hasClass("disable")) return;
   var e = $(t.currentTarget).parent().attr("id").replace(/[^0-9]+/gi, ""), o = $(t.currentTarget).parent(), i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(e);
   this.accessType != photoOrg.photoLib.accessType.guest && ($(o).hasClass("selected") ? this.clickOnAssetSelectIcon(o, i) :this.clickOnAssetUnSelectIcon(o, i));
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:assetSelectionToggle", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 clickOnAssetUnSelectIcon:function(t, e) {
  console.log("Selecting the Asset - SAV");
  $(".empty-tray-sec").hide();
  $("#cls_empty_tray").hide();
  photoOrg.photoLib.hideEmptyTray = !0;
  $(".mobile-selection-tray .selection-thumbnail-wrapper").removeClass("hide");
  if (void 0 != this.albId) {
   var o = this.albId;
   photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && e.get("parentCollectionReferences") && e.get("parentCollectionReferences").length > 0 && (o = e.get("parentCollectionReferences")[0].collectionId);
   photoOrg.photoLib.selectedPicsFromAlb[e.id] = void 0 == photoOrg.photoLib.selectedPicsFromAlb[e.id] ? o + "" :photoOrg.photoLib.selectedPicsFromAlb[e.id] + "_" + o;
  }
  photoOrg.Util.updateSettingSelectedPics();
  t.addClass("selected");
  $(".remove-asset img").show();
  photoOrg.photoLib.selectedAlbumAssets.push(e.id);
  photoOrg.photoLib.SelectedAsset.selectedAssets.add(e);
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   var i = photoOrg.photoLib.SelectedAsset.selectedAssets.length, s = window.translations.picker.photos_selected;
   $(".actionContainer .select_count .selectedImageCount").text(i > 1 ? s.replace("{0}", i) :window.translations.picker.photo_selected);
   if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
    $(".actionContainer .select_count .select_count_sec").hide();
    $(".photo-Org .picker-done-button").addClass("disable-greybtn");
   } else {
    $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
    $(".actionContainer .select_count .select_count_sec").show();
   }
  }
  $("#po_photo_txt").text(photoOrg.photoLib.SelectedAsset.selectedAssets.length > 1 ? window.translations.photos :window.translations.photo);
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) if ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length) {
   null == photoOrg.photoLib.seletedAlbums && (photoOrg.photoLib.seletedAlbums = {});
   photoOrg.Util.deleteAndUpdateAlbumInfoInLocalStorage(photoOrg.photoLib.currentAlbumId);
   $(".select-all-wrapper figure").removeClass("checkmark-blue");
   photoOrg.photoLib.config.loadAsPhotoPicker && $(".select-all-wrapper").removeClass("selected");
  } else {
   $(".select-all-wrapper figure").addClass("checkmark-blue");
   photoOrg.Util.getSelectedAlbums();
   photoOrg.photoLib.seletedAlbums[photoOrg.photoLib.currentAlbumId] = photoOrg.photoLib.albumModelList[photoOrg.photoLib.currentAlbumId];
   $.jStorage.set(gon.staticContent.account_id + "_selectedAlbums", photoOrg.photoLib.seletedAlbums);
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".select-all-wrapper figure").removeClass("checkmark-blue");
    $(".select-all-wrapper").addClass("selected");
   }
  }
  photoOrg.photoLib.selectedImages.push(e.id);
  photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
  eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, e);
  photoOrg.photoLib.config.loadAsPhotoPicker || eventBus.trigger(eventBus.CUSTOM_EVENT_SELECT_ASSET, {
   model:e
  });
  var r = !0;
  this.updateSelectAllWrapper(r, 1);
 },
 updateSelectAllWrapper:function(t, e) {
  try {
   this.parentGridView && this.parentGridView.updateSelectAllWrapper(t, e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:updateSelectAllWrapper", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 clickOnAssetSelectIcon:function(t, e) {
  try {
   console.log("Deselecting the Asset - SAV");
   t.removeClass("selected");
   var o;
   photoOrg.photoLib.SelectedAsset.selectedAssets.remove(e);
   if (e && photoOrg.photoLib.selectedPicsFromAlb[e.id]) {
    o = photoOrg.photoLib.selectedPicsFromAlb[e.id].split("_");
    var i = o.indexOf(this.albId + "");
    o.splice(i, 1);
    o = o.join("_");
    photoOrg.photoLib.selectedPicsFromAlb[e.id] = o;
    "" == o && delete photoOrg.photoLib.selectedPicsFromAlb[e.id];
   }
   photoOrg.Util.updateSettingSelectedPics();
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    var s = photoOrg.photoLib.SelectedAsset.selectedAssets.length, r = window.translations.picker.photos_selected;
    $(".actionContainer .select_count .selectedImageCount").text(s > 1 ? r.replace("{0}", s) :window.translations.picker.photo_selected);
    if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
     $(".actionContainer .select_count .select_count_sec").hide();
     $(".photo-Org .picker-done-button").addClass("disable-greybtn");
    } else {
     $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
     $(".actionContainer .select_count .select_count_sec").show();
    }
   }
   $("#po_photo_txt").text(photoOrg.photoLib.SelectedAsset.selectedAssets.length > 1 ? window.translations.photos :window.translations.photo);
   if (e) {
    photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, e.id);
    photoOrg.photoLib.selectedAlbumAssets = _.without(photoOrg.photoLib.selectedAlbumAssets, e.id);
   }
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && !photoOrg.photoLib.deSelectAllVisibleImagesClicked) {
    $("#album_assets .deSelectAllLink").hide();
    $("#album_assets .selectAllLink").show();
   }
   $(".remove-asset img").show();
   var n = !0;
   this.updateSelectAllWrapper(n, -1);
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) if ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length) {
    $(".select-all-wrapper").removeClass("selected");
    $(".select-all-wrapper figure").removeClass("checkmark-blue");
    null == photoOrg.photoLib.seletedAlbums && (photoOrg.photoLib.seletedAlbums = {});
    photoOrg.Util.deleteAndUpdateAlbumInfoInLocalStorage(photoOrg.photoLib.currentAlbumId);
   } else $(".select-all-wrapper figure").addClass("checkmark-blue");
   if ((void 0 != gon.staticContent.pict_ids || null != gon.staticContent.pict_ids) && e) {
    gon.staticContent.pict_ids = _.without(gon.staticContent.pict_ids, e.id);
    gon.staticContent.pict_ids = _.difference(gon.staticContent.pict_ids, photoOrg.photoLib.selectedImages);
   }
   eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, e);
   photoOrg.photoLib.config.loadAsPhotoPicker || eventBus.trigger(eventBus.CUSTOM_EVENT_DE_SELECT_ASSET, {
    model:e
   });
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:clickOnAssetSelectIcon", errorCode="LIBRARY:MYPHOTOS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 unSelectAsset:function() {
  console.log("Unselecting the Asset - SAV");
  var t = $(this.$el);
  t.removeClass("selected");
  this.updateSelectAllWrapper();
  photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && ($("#single_album_grid").find(".assetImg").length > $("#single_album_grid").find(".selected").length ? $(".select-all-wrapper figure").removeClass("checkmark-blue") :$(".select-all-wrapper figure").addClass("checkmark-blue"));
 },
 close:function() {
  try {
   console.log("removing view object and model - SAV");
   $(this.el).off();
   this.optionsMenu && this.optionsMenu.destroy();
   this.unbind();
   this.remove();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:commom_asset_view:close", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 updateAssetView:function(t) {
  console.log("Updating the Asset - SAV");
  this.model = t;
  var e = photoOrg.Util.getThumbnailURL(photoOrg.photoLib.getLOWorTHUMBNAIL(this.model.get("files")).url), o = photoOrg.photoLib.getHAndWForImage(this.model);
  if (photoOrg.isTabOrMobile) ; else if (0 != o.width && 0 != o.height) {
   $("#img_" + this.el.id).data("width", o.width);
   $("#img_" + this.el.id).data("height", o.height);
   $("#img_" + this.el.id).width(o.width);
   $("#img_" + this.el.id).height(o.height);
   $("#" + this.el.id).width(o.width);
   $("#" + this.el.id).height(o.height);
  }
  $("#img_" + this.el.id).attr("src", e);
  this.clusterObj && this.clusterObj.updateEntity(t);
  photoOrg.isDesktop && $("#" + this.gridId).collagePlus();
 }
});

var photoOrg = photoOrg || {};

photoOrg.LibraryAndStoriesTabView = Backbone.View.extend({
 initialize:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  initialize... ");
   if (0 == $(".encourage_user_to_upload_text").length) {
    var e = JST["templates/common/library/common/no_photos"]();
    photoOrg.photoLib.config.loadAsPhotoPicker ? $(e).insertBefore("#library .sf-library") :$("#library .picker-row").append(e);
   }
   if (0 == $(".empty_shared_albums").length) {
    var o = JST["templates/common/library/common/no_share_fav_albums"]();
    $("#library #pfluidGrid").append(o);
   }
   var i = this;
   this.setElement(t.el);
   $(".upload").off("click");
   $(".upload").on("click", function() {
    photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.SINGLE_ALBUM_VIEW && photoOrg.Util.trackLinksAndButtons("Add Photos", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
    $("#hover10").hasClass("savupload") && $("#hover10").removeClass("savupload");
   });
   eventBus.on(eventBus.CUSTOM_EVENT_INVOKE_OVERLAY, this.invokeOverlay, this);
   $(".facebook_link").on("click", function(t) {
    t.preventDefault();
    photoOrg.photoLib.checkLoginForUploader("fbk");
    if (photoOrg.oauthFetcher.checkOauthAvailable()) {
     $("#hover10").removeClass("savupload");
     $("#addPhotosSection").removeClass("highlight");
     $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
     i.openIngestionInWindow(t);
     gon.staticContent.uploaderType = "FACEBOOK";
    }
   });
   $(".flickr_access").on("click", function(t) {
    t.preventDefault();
    photoOrg.photoLib.checkLoginForUploader("flickr");
    if (photoOrg.oauthFetcher.checkOauthAvailable()) {
     $("#hover10").removeClass("savupload");
     $("#addPhotosSection").removeClass("highlight");
     $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
     i.openIngestionInWindow(t);
     gon.staticContent.uploaderType = "FLICKR";
    }
   });
   $(".instagram_link").on("click", function(t) {
    t.preventDefault();
    photoOrg.photoLib.checkLoginForUploader("instagram");
    if (photoOrg.oauthFetcher.checkOauthAvailable()) {
     $("#hover10").removeClass("savupload");
     $("#addPhotosSection").removeClass("highlight");
     $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
     i.openIngestionInWindow(t);
     gon.staticContent.uploaderType = "INSTAGRAM";
    }
   });
   $("a.library_classic").on("click", function(t) {
    t.preventDefault();
    try {
     photoOrg.Util.delayTrackOmnitureForPage({
      pageName:"Move_to_classic_library"
     });
    } catch (e) {}
    setTimeout(function() {
     window.location.href = "http://" + gon.staticContent.library_classic_url;
    }, 5e3);
   });
   photoOrg.uploadMoreFunction = function() {
    photoOrg.Util.fromUploadMore = !0;
    "facebook" == photoOrg.Util.uploadMoreType || "FaceBook" == gon.staticContent.uploaderType ? $(".facebook_link").click() :"flickr" == photoOrg.Util.uploadMoreType || "Flickr" == gon.staticContent.uploaderType ? $(".flickr_access").click() :"instagram" == photoOrg.Util.uploadMoreType || "Instagram" == gon.staticContent.uploaderType ? $(".instagram_link").click() :$(".mycomputer_link").click();
   };
   $(".uploadMore").on("click", photoOrg.uploadMoreFunction);
   photoOrg.orderPrintsFunction = function() {
    $("#pgConfirmModel").foundation("reveal", "close");
    if (photoOrg.Util.recentUploadedAlbumId) {
     gon.staticContent.session_update = !1;
     var t, e = photoOrg.photoLib.Util.historyState;
     if (e.pg) {
      console.log("my albums");
      t = gon.staticContent.prints_builder_url + "?" + gon.staticContent.prints_sku_4x6 + "&albumId=" + photoOrg.Util.recentUploadedAlbumId;
     }
     window.location.href = t;
    }
   };
   $(".orderPrints").on("click", photoOrg.orderPrintsFunction);
   $(".mycomputer_link").on("click", function() {
    $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
    $("#addPhotosSection").removeClass("highlight");
    photoOrg.photoLib.checkLoginForUploader("uploader");
    if (photoOrg.oauthFetcher.checkOauthAvailable()) {
     photoOrg.libraryAndStoriesTabView.attachPhotos();
     gon.staticContent.uploaderType = "My Device";
    }
   });
   $("body #albumsdropdown li").on("click", this.showPhotoVideosOrAlbums);
   this.showSubNavOrDropdownNav();
   var s = this;
   photoOrg.photoLib.config.loadAsPhotoPicker || $(window).on("resize", function() {
    s.showSubNavOrDropdownNav();
   });
   $("#album-filtering li a").on("click", $.proxy(this.changeAlbumFilter, this));
   $(".album-filtering-menu").on("click", function() {
    photoOrg.selectedAlbumId = "";
   });
   $(".viewPhotos").on("click", function() {
    photoOrg.Util.recentUploadedAlbumId = "";
   });
   $("#closeSuccessPop-Up").on("click", function() {
    photoOrg.Util.recentUploadedAlbumId = "";
   });
   gon.staticContent.enable_cluster && this.delegateEvents(_.extend(this.events, {
    "click .photo-album-toggle .albums":"showPhotoVideosOrAlbums"
   }));
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 events:{
  "click .headerInfo li":"render",
  "click .photo-album-toggle .photo_videos,.photo-album-toggle .shared_albums,.photo-album-toggle .my_shared_albums,.photo-album-toggle .shared_with_me":"showPhotoVideosOrAlbums",
  "click .delete-album":"deletealbum",
  "click .album_ascending":"albumSort",
  "click .album_discending":"albumSort",
  "click .recently_modified":"albumSort",
  "click .slideShow":"slideshow",
  "click .libshareic":"shareAlbum"
 },
 albumSort:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  albumSort start...");
   var e = t.currentTarget;
   t.preventDefault();
   t.stopPropagation();
   var o = $(e).attr("sortOrder"), i = $(e).attr("sortCriteria");
   console.log(o);
   if ("ascending" == o) {
    $(".album_discending").removeClass("selected");
    $(".album_ascending").addClass("selected");
    $(".recently_modified").removeClass("selected");
    $(".album-sorting .selected-option").html(window.translations.sub_header.oldesttonewest);
    photoOrg.Util.trackLinksAndButtons(o, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   } else if ("descending" == o) {
    $(".album_ascending").removeClass("selected");
    $(".album_discending").addClass("selected");
    $(".recently_modified").removeClass("selected");
    $(".album-sorting .selected-option").html(window.translations.sub_header.newesttooldest);
    photoOrg.Util.trackLinksAndButtons(o, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   } else if ("updateDate" == i) {
    $(".album_ascending").removeClass("selected");
    $(".album_discending").removeClass("selected");
    $(".recently_modified").addClass("selected");
    $(".album-sorting .selected-option").html(window.translations.sub_header.recentlyModified);
    photoOrg.Util.trackLinksAndButtons(i, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   }
   $("#albumsort").removeClass("open").css("left", "-9999px");
   eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, {
    sortOrder:o,
    sortCriteria:i
   });
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:albumSort", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 deletealbum:function() {
  try {
   console.log("LibraryAndStoriesTabView -  deletealbum...");
   $("#drop1").hide();
   var t = photoOrg.delAlbId;
   t = t.split("_")[1];
   console.log("album id is..." + t);
   eventBus.trigger(eventBus.DELETE_ALBUM, {
    id:t
   });
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:deletealbum", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 slideshow:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  slideshow...");
   $("#drop1").hide();
   var e = t.currentTarget;
   e = e.getAttribute("id");
   console.log("album id is###" + e);
   e = photoOrg.delAlbId;
   e = e.split("_")[1];
   eventBus.trigger(eventBus.SLIDESHOW, {
    id:e
   });
   console.log("from library ans stories tab view");
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:slideshow", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 shareAlbum:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  shareAlbum...");
   t.stopPropagation();
   $("#drop1").hide();
   var e = t.currentTarget;
   e = e.getAttribute("id");
   console.log("album id is###" + e);
   e = photoOrg.delAlbId;
   e = e.split("_")[1];
   e = parseInt(e);
   photoOrg.Util.trackLinksAndButtons("Albums_ShareIcon", "albumsPage");
   var o = photoOrg.photoLib.albumModelList[e];
   eventBus.trigger(eventBus.CUSTOM_EVENT_SHARE, {
    shareType:"SINGLE_ALBUM_SHARE",
    shareData:{
     albumModel:o
    }
   });
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:share", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 showSubNavOrDropdownNav:function() {
  try {
   if (photoOrg.Util.isMobileDevice()) {
    $(".albums").show();
    $(".shared_albums").hide();
    $("#choosedsubheader").show();
   } else {
    $("#albumsdropdown").hide();
    $(".albums").show();
    $(".shared_albums").show();
    $("#choosedsubheader").hide();
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:showSubNavOrDropdownNav", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 changeAlbumFilter:function(t) {
  try {
   var e = $(t.currentTarget), o = e.data("value");
   if (photoOrg.photoLib.config.loadAsPhotoPicker) photoOrg.makeActionView.handleAlbumsView(o); else {
    photoOrg.photoLib.Util.resetHistoryState();
    var i = photoOrg.photoLib.Util.historyState;
    i[photoOrg.constants.PAGE] = o;
    photoOrg.photoLib.Util.appendHashtoURL(i);
   }
   $("#album-filtering").removeClass("open highlight").css({
    left:"-99999px"
   });
   $(".album-filtering-menu").removeClass("highlight");
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:changeAlbumFilter", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 openIngestionInWindow:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  openIngestionInWindow start...");
   t.preventDefault();
   var e = $(t.currentTarget).find("a").attr("href");
   void 0 == e && (e = $(t.currentTarget).attr("href"));
   "false" == photoOrg.Util.getURLParameter("ak") && (e = e.replace("library-static", "library"));
   var o = {};
   o.ownedassets = photoOrg.photoLib.UserAssetsInfo.assetList && photoOrg.photoLib.UserAssetsInfo.assetList.length > 0 || photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length > 0 || photoOrg.photoLib.UserAssetsInfo.albumListLength > 0 ? !0 :!1;
   gon.staticContent.campaignName && (o.campaignName = gon.staticContent.campaignName);
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
    o.album_id = photoOrg.photoLib.currentAlbumId;
    o = this.addHash(o);
   } else if ((photoOrg.photoLib.navType.albums && photoOrg.Util.recentUploadedAlbumId || "0" == photoOrg.photoLib.navType.photosAndVideos && photoOrg.Util.recentUploadedAlbumId) && photoOrg.Util.fromUploadMore) {
    photoOrg.photoLib.currentAlbumId = photoOrg.Util.recentUploadedAlbumId;
    o.album_id = photoOrg.photoLib.currentAlbumId;
    o = this.addHash(o);
    photoOrg.Util.fromUploadMore = !1;
   } else o = this.addHash(o);
   e += "#state=" + encodeURIComponent($.toJSON(o));
   var i = (window.screen.width - 830) / 2, s = (window.screen.height - 695) / 2, r = 751, n = 534;
   isAndroid() && (n = window.screen.height);
   var a = photoOrg.photoLib.windowObjectReference;
   try {
    a.closed && (a = null);
   } catch (l) {}
   if (null == a) {
    photoOrg.photoLib.windowObjectReference = window.open(e, "uploadphotos", "resizable=no,width=" + r + ",height=" + n + ",scrollbars=yes,status=yes,titlebar=yes,top=" + s + "px,left=" + i + "px");
    isAndroid() && photoOrg.photoLib.windowObjectReference.resizeTo(r, n);
   }
   photoOrg.photoLib.windowObjectReference && photoOrg.photoLib.windowObjectReference.focus();
  } catch (l) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:openIngestionInWindow", errorCode="LIBRARY:MYPHOTOS", err_desc="' + l + '" err_stack="' + l.stack + '"');
  }
 },
 addHash:function(t) {
  t.accountId = gon.staticContent.account_id;
  t.regType = gon.staticContent.regType;
  t.userType = void 0 == gon.staticContent.user_Type ? "" :gon.staticContent.user_Type;
  return t;
 },
 showPhotoVideosOrAlbums:function(t) {
  try {
   console.log("LibraryAndStoriesTabView -  showPhotoVideosOrAlbums start...");
   t.preventDefault;
   var e = $(t.currentTarget);
   photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && $(".photo-album-toggle .albums").removeClass("selected");
   var o = e.attr("data-btabname");
   if (photoOrg.photoLib.showClusterView && o == photoOrg.constants.TIME_LINE_VIEW) {
    o = photoOrg.constants.CLUSTER_VIEW;
    photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
   }
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    if (-1 !== o.indexOf(photoOrg.constants.CLUSTER_VIEW) && $(".photo_videos").hasClass("selected") <= 0) {
     if (1 == photoOrg.photoLib.isUploaded) {
      $("#choosedSortOption").attr("data-value", $("#dateSorting .create-date").attr("data-value").trim());
      $("#choosedSortOption").text($("#dateSorting .create-date").text());
      photoOrg.photoLib.isUploaded = !1;
     }
     photoOrg.makeActionView.handleClusterView();
     this.reloadTimeout && clearTimeout(this.reloadTimeout);
     this.reloadTimeout = setTimeout($.proxy(function() {
      eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
     }, this), 500);
    } else -1 === o.indexOf(photoOrg.constants.ALBUMS_VIEW) || $('.photo-album-toggle li[data-btabname="av"]').hasClass("selected") || photoOrg.makeActionView.handleAlbumsView(photoOrg.constants.ALBUMS_VIEW);
    photoOrg.photoLib.isUploaded = !1;
   } else {
    photoOrg.photoLib.Util.resetHistoryState();
    var i = photoOrg.photoLib.Util.historyState;
    i[photoOrg.constants.PAGE] = o;
    if (o == photoOrg.constants.CLUSTER_VIEW) if (1 == photoOrg.photoLib.isUploaded) {
     i.so = "createDate";
     $("#choosedSortOption").attr("data-value", $("#dateSorting .create-date").attr("data-value").trim());
     $("#choosedSortOption").text($("#dateSorting .create-date").text());
    } else i.so = $(".date-sorting #choosedSortOption").attr("data-value").trim(); else $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder") && (i.so = $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder"));
    photoOrg.photoLib.isUploaded = !1;
    photoOrg.photoLib.Util.appendHashtoURL(i);
   }
   $(".photo-album-toggle li").removeClass("selected");
   if ($.inArray(o, [ photoOrg.constants.ALBUMS_VIEW, photoOrg.constants.MY_SHARED_ALBUM_VIEW, photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW ]) >= 0) {
    $('.photo-album-toggle li[data-btabname="av"]').addClass("selected");
    $(".album-sorting").css("display", "inline-block");
   } else {
    $('.photo-album-toggle li[data-btabname="' + o + '"]').addClass("selected");
    if (o == photoOrg.constants.CLUSTER_VIEW) {
     $('.photo-album-toggle li[data-btabname="tlv"]').addClass("selected");
     $(".album-sorting").hide();
     if (!(photoOrg.Util.newUser || void 0 != photoOrg.photoLib.hideEmptyTray && 0 != photoOrg.photoLib.hideEmptyTray || 0 != photoOrg.photoLib.selectedImages.length || photoOrg.photoLib.config.loadAsPhotoPicker)) {
      $(".lib-left-col").removeClass("hidden");
      $("#right-well").removeClass("full");
      $(".sub-header-wrapper").removeClass("full");
     }
    }
   }
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:showPhotoVideosOrAlbums", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 attachPhotos:function() {
  try {
   console.log("LibraryAndStoriesTabView -  attachPhotos start...");
   if (photoOrg.photoLib.windowObjectReference) {
    try {
     photoOrg.photoLib.windowObjectReference.focus();
    } catch (t) {}
    try {
     if (!photoOrg.photoLib.windowObjectReference.closed) return;
     photoOrg.photoLib.windowObjectReference = null;
    } catch (t) {
     return;
    }
   }
   var e = (window.screen.width - 830) / 2, o = (window.screen.height - 695) / 2, i = this.getHTML5UploaderURL(), s = window.screen.width;
   s = .6 * s;
   var r = window.screen.height;
   r = .7 * r;
   if (null == photoOrg.photoLib.windowObjectReference || "firefox" !== photoOrg.photoLib.browserName && photoOrg.photoLib.windowObjectReference.closed) {
    photoOrg.uploadConfirmationLayer && photoOrg.uploadConfirmationLayer.resetAllValues();
    photoOrg.photoLib.windowObjectReference = location.href.indexOf("uploader_ui") > 0 ? window.open(i, "uploadphotos", "resizable=no,width=" + s + ",height=" + r + ",scrollbars=yes,status=yes,titlebar=yes,top=" + o + "px,left=" + e + "px") :window.open(i, "uploadphotos", "resizable=no,width=" + s + ",height=" + r + ",scrollbars=yes,status=yes,titlebar=yes,top=" + o + "px,left=" + e + "px");
   }
   null != photoOrg.photoLib.windowObjectReference && photoOrg.photoLib.windowObjectReference.focus();
   photoOrg.Util.trackLinksAndButtons("New Album:uploader", "uploaderIngestion");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:attachPhotos", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getHTML5UploaderURL:function() {
  var t = photoOrg.photoLib.Util.historyState;
  if (t && $.inArray(t[photoOrg.constants.PAGE], [ photoOrg.constants.ALBUMS_VIEW, photoOrg.constants.SINGLE_ALBUM_VIEW, photoOrg.constants.CLUSTER_VIEW ]) >= 0) {
   $("#viewphotosbutton").show();
   $("#gotophotosbutton").hide();
  } else {
   $("#viewphotosbutton").hide();
   $("#gotophotosbutton").show();
  }
  gon.staticContent.locale;
  uploaderStateObj = {};
  var e = gon.staticContent.end_point_uploader;
  -1 == e.indexOf(window.location.hostname) && -1 == location.href.indexOf("create") && (e = replaceUrl(e));
  var o = e || window.location.protocol + "//" + window.location.hostname + (window.location.port ? ":" + window.location.port :"");
  o += "?";
  uploaderStateObj.ownedassets = photoOrg.photoLib.UserAssetsInfo.assetList && photoOrg.photoLib.UserAssetsInfo.assetList.length > 0 || photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length > 0 || photoOrg.photoLib.UserAssetsInfo.albumListLength > 0 ? !0 :!1;
  gon.staticContent.campaignName && (uploaderStateObj.campaignName = gon.staticContent.campaignName);
  var i = {};
  void 0 !== navigator.mimeTypes["application/x-pnacl"] && (gon.staticContent.isjpm || window.uploaderJpegMini) && (i.clientcomp = !0);
  (gon.staticContent.dedup || window.uploaderDedup) && (i.dedup = !0);
  (gon.staticContent.chunkOnFailure || window.uploaderChunk) && (i.chunkOnFailure = !0);
  gon.staticContent.chunkByDefault && (i.chunkByDefault = !0);
  if (-1 != window.location.href.indexOf("/library") || -1 != window.location.href.indexOf("/photos")) {
   var s = getRedirect_url("uploader");
   i.extrd = encodeURIComponent(s + "/getUploadConfirmation?isUploader=true");
  } else -1 != window.location.href.indexOf("create") && (i.extrd = encodeURIComponent(gon.staticContent.builder_url + "/getUploadConfirmation?isUploader=true"));
  o += "&" + $.param(i);
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && photoOrg.photoLib.currentAlbumId) {
   uploaderStateObj.album_id = photoOrg.photoLib.currentAlbumId + "_" + gon.staticContent.account_id;
   uploaderStateObj = this.addHash(uploaderStateObj);
  } else if ((photoOrg.photoLib.navType.albums && photoOrg.Util.recentUploadedAlbumId || "0" == photoOrg.photoLib.navType.photosAndVideos && photoOrg.Util.recentUploadedAlbumId) && photoOrg.Util.fromUploadMore) {
   photoOrg.photoLib.currentAlbumId = photoOrg.Util.recentUploadedAlbumId;
   uploaderStateObj.album_id = photoOrg.photoLib.currentAlbumId + "_" + gon.staticContent.account_id;
   uploaderStateObj = this.addHash(uploaderStateObj);
   photoOrg.Util.fromUploadMore = !1;
  } else uploaderStateObj = this.addHash(uploaderStateObj);
  o += "#state=" + encodeURIComponent($.toJSON(uploaderStateObj));
  return o;
 },
 getInstagram:function() {
  photoOrg.photoLib.isFlickr = !1;
  photoOrg.photoLib.isFacebook = !1;
  photoOrg.photoLib.isInstagram = !0;
  photoOrg.IngestionUtils.openOverlay();
  photoOrg.photoLib.instagramInit();
 },
 getFacebook:function() {
  photoOrg.IngestionUtils.openOverlay();
  photoOrg.photoLib.isFacebook = !0;
  photoOrg.photoLib.isFlickr = !1;
  photoOrg.photoLib.isInstagram = !1;
  $("#ingestion_Modal").show();
  $(".facebook_text").show();
  $(".instagram_text").hide();
  $(".flickr_text").hide();
  $(".ingestion_template .retry_ing").hide();
  $(".ingestion_template .import_ing").addClass("ingestion_upload_btn_enabled").removeClass("ingestion_upload_btn_disabled");
  $("#continue_link .bluebtn.for_mobile_view").addClass("ingestion_upload_btn_enabled").removeClass("ingestion_upload_btn_disabled");
  $(".ingestion_template .import_ing").css("display", "inline-block");
  photoOrg.ingetionSelectionTrayView.collection.reset();
  photoOrg.ingetionSelectionTrayView.failedImagesCount = 0;
  photoOrg.facebook.init();
 },
 getFlickr:function() {
  photoOrg.IngestionUtils.openOverlay();
  photoOrg.IngestionUtils.getFlickr();
 },
 invokeOverlay:function(t) {
  try {
   photoOrg.IngestionUtils.invokeOverlay(t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:library_and_stories _tab_view:invokeOverlay", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.MakeActionView = Backbone.View.extend({
 windowObjectReference:null,
 albumsView:null,
 saveStory:null,
 clickedResetButton:!1,
 addHeight:!0,
 currentTabName:"",
 initialize:function(t) {
  try {
   console.log("MakeActionView - initialize... ");
   this.setElement(t.el);
   eventBus.on(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, this.updatePictureCount, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, this.updatePictureCount, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, this.updatePictureCount, this);
   eventBus.on(eventBus.CUSTOM_EVENT_INVOKE_SORT_FILTER_EVENT, this.handleMediaAndAssetFilter, this);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:make_action_view:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 events:{
  "click .pickerCancel":"closePhotoPicker"
 },
 prints:function() {
  this.navigateToPrintsPage();
 },
 navigateToPrintsPage:function() {
  console.log("MakeActionView - navigating to prints builder... ");
  void 0 == gon.staticContent.prints_sku_4x6 && (gon.staticContent.prints_sku_4x6 = "sku=CommerceProduct_7182&category=prints&flowFrom=myphotos");
  gon.staticContent.redirectURL = gon.staticContent.prints_builder_url + "?" + gon.staticContent.prints_sku_4x6 + "&flowFrom=myphotos";
  0 == photoOrg.photoLib.selectedImages.length ? document.location.href = gon.staticContent.redirectURL :photoOrg.photoLib.selectedImages.length > 0 && photoOrg.photoLib.updateGlobalSession();
 },
 sendSelectedAssetsToBuilder:function(t) {
  console.log("Sending selected assets to builder...");
  t.preventDefault();
  photoOrg.selectedAlbumId = "";
  var e = photoOrg.photoLib.SelectedAsset.selectedAssets;
  photoOrg.photoLib.config.callbackObj.addToBuilder(e);
  eventBus.off();
  this.undelegateAllResizeEvents();
 },
 undelegateAllResizeEvents:function() {
  $(window).off("resize.globalResize");
  $(window).off("resize.longPressOnResize");
  $(window).off("resize.cvLongPressOnResize");
 },
 closePhotoPicker:function() {
  try {
   photoOrg.selectedAlbumId = "";
   $("#ingestion_Modal").remove();
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE, {});
    photoOrg.photoLib.config.callbackObj.closePhotoPicker();
   }
   photoOrg.photoLib.SelectedAsset.selectedAssets.reset();
   eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, photoOrg.photoLib);
   eventBus.trigger(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, photoOrg.photoLib);
   photoOrg.photoLib.selectedImages = [];
   photoOrg.photoLib.defaultSelected = [];
   eventBus.off();
   this.undelegateAllResizeEvents();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:make_action_view:closePhotoPicker", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 updatePictureCount:function(t) {
  try {
   var e = 0;
   try {
    e = t.SelectedAsset.selectedAssets.length;
   } catch (o) {
    e = photoOrg.photoLib.SelectedAsset.selectedAssets.length;
   }
   if (0 >= e) {
    if (photoOrg.photoLib.config.loadAsPhotoPicker) {
     $(".photo-Org .sendToBuilder > span").css("cursor", "default");
     $(".photo-Org .sendToBuilder").off("click", this.sendSelectedAssetsToBuilder);
    }
    $(".imageCount").text("");
    $(".imageCount").hide();
   } else if (e > 0 && photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".photo-Org .sendToBuilder > span").css("cursor", "pointer");
    $(".photo-Org .sendToBuilder").off("click");
    $(".photo-Org .sendToBuilder").on("click", this.sendSelectedAssetsToBuilder.bind(this));
   }
   photoOrg.photoLib.config.loadAsPhotoPicker && (photoOrg.photoLib.picsLength = e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:make_action_view:updatePictureCount", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 handleMediaAndAssetFilter:function() {
  try {
   var t = decodeURIComponent(photoOrg.photoLib.Util.historyState.so);
   if (t.length > 0) {
    $(".assetsSelection select").val(t);
    photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos ? photoOrg.photoLib.showClusterView ? eventBus.trigger(eventBus.CUSTOM_EVENT_CLUSTER_SORT, {
     urlParam:t
    }) :eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_MEDIA_AND_ASSET_SORT, {
     urlParam:t
    }) :photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, {
     urlParam:t
    });
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:make_action_view:handleMediaAndAssetFilter", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 beforeShowingTimeLineOrAlbums:function() {
  $("#bottomLoadingBar").hide();
  photoOrg.photoLib.Util.historyState;
  $("#sub_header_container .albums").removeClass("selected");
  $("#sub_header_container .photo_videos").removeClass("selected");
  eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_CLOSE, {});
  $("#album_assets").hide();
  $(".photo-Org .singleAlbumUploadImagesTextDiv").hide();
  photoOrg.photoLib.showAndHideUploadTextDiv("hide");
  photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide");
 },
 handleClusterView:function() {
  console.log("MakeActionView - handleClusterView start... ");
  if (photoOrg.photoLib.UserAssetsInfo) {
   photoOrg.photoLib.UserAssetsInfo.assetViewsMap = {};
   photoOrg.photoLib.UserAssetsInfo.assetList = new userAssets();
  }
  $(".cluster-dropdown-button").off("click");
  $(".cluster-dropdown-button").on("click", function() {
   photoOrg.Util.trackLinksAndButtons("jumpToMonth", "photosPage");
  });
  $(".date-sorting").show();
  $(".album-sorting").hide();
  $(".album-filtering-menu").hide();
  photoOrg.photoLib.config.loadAsPhotoPicker && eventBus.trigger(eventBus.CUSTOM_EVENT_NEXT_SET, 1);
  var t = photoOrg.photoLib.Util.historyState;
  t[photoOrg.constants.PAGE] = photoOrg.constants.CLUSTER_VIEW;
  photoOrg.photoLib.current_state = photoOrg.photoLib.navType.photosAndVideos;
  this.beforeShowingTimeLineOrAlbums();
  eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, {});
  $(".albumsGridList").hide();
  var e = $("#sub_header_container");
  e.find(".albums").removeClass("selected");
  e.find(".photo_videos").addClass("selected");
  photoOrg.photoLib.Util.componentView && photoOrg.photoLib.Util.componentView.show();
  photoOrg.photoLib.showClusterView && photoOrg.photoLib.Util.clustersViewController.show();
  if (photoOrg.photoLib.singleAlbumAssetRotated && $("#assetGrid").children().length > 0) {
   eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
   photoOrg.photoLib.singleAlbumAssetRotated = !1;
  }
  (!($("#assetGrid").children().length > 0) || void 0 !== t.so && "" !== t.so && t.so.length > 0) && eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_SORT_FILTER_EVENT, t.so || "createDate");
  t.so && t.so.length > 0 && $("#assetGrid").children().length > 0 && eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_SORT_FILTER_EVENT, photoOrg.photoLib.Util.historyState.so);
  if (photoOrg.photoLib.isNeedToReload) {
   photoOrg.photoLib.isNeedToReload = !1;
   $("#loadingBar").show();
   console.log("makeaction--handleClusterView-CUSTOM_EVENT_FILTER_RESET");
   eventBus.trigger(eventBus.CUSTOM_EVENT_FILTER_RESET, {
    urlParam:$("#choosedSortOption").attr("data-value")
   });
  } else eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
  try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Photos & Videos"
   });
  } catch (o) {}
 },
 handleAlbumsView:function(t, e, o) {
  console.log("MakeActionView - handleAlbumsView start... ");
  if (photoOrg.photoLib.UserAssetsInfo) {
   photoOrg.photoLib.UserAssetsInfo.assetViewsMap = {};
   photoOrg.photoLib.UserAssetsInfo.assetList.reset();
  }
  photoOrg.photoLib.Util.albumsViewController || (photoOrg.photoLib.Util.albumsViewController = new photoOrg.albumsViewController());
  "undefined" == typeof t && (t = photoOrg.constants.ALBUMS_VIEW);
  this.currentTabName = t;
  if (o) {
   $.jStorage.set(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder", o);
   $.jStorage.deleteKey(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria");
  }
  if (e) {
   $.jStorage.set(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria", e);
   $.jStorage.deleteKey(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder");
  }
  var i = photoOrg.photoLib.Util.historyState;
  photoOrg.photoLib.current_state = photoOrg.photoLib.navType.albums;
  this.beforeShowingTimeLineOrAlbums();
  var s = "";
  $(".date-sorting").hide();
  $(".album-filtering-menu").show();
  $(".albumsGridList").show();
  var r = $("#sub_header_container");
  r.find(".albums").addClass("selected");
  r.find(".photo_videos").removeClass("selected");
  $("#album-filtering li").removeClass("selected");
  var n = $('#album-filtering li[data-value="' + t + '"]');
  n.length && n.addClass("selected");
  var a = $(".album-filtering-menu .selected-option");
  a.data("value", t);
  a.html(n.text());
  if (t == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW) {
   photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
   i[photoOrg.constants.PAGE] = photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW;
   s = photoOrg.photoLib.accessType.share2;
   photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
  } else if (t == photoOrg.constants.MY_SHARED_ALBUM_VIEW) {
   photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
   i[photoOrg.constants.PAGE] = photoOrg.constants.MY_SHARED_ALBUM_VIEW;
   s = photoOrg.photoLib.accessType.myshared;
  } else if (t == photoOrg.constants.ALBUMS_VIEW) {
   photoOrg.photoLib.showOrHideAlbumCopyMessage(!0);
   i[photoOrg.constants.PAGE] = photoOrg.constants.ALBUMS_VIEW;
   s = photoOrg.photoLib.accessType.owned;
  } else if (t == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
   i[photoOrg.constants.PAGE] = photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW;
   s = photoOrg.photoLib.accessType.favalbs;
  }
  if (this.albumsView) {
   this.albumsView.accessType = s;
   this.albumsView.skip = 0;
   this.albumsView.totalCount = 0;
   if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) {
    photoOrg.preloadAlbums = !1;
    photoOrg.makePreMonthIndexCall = !1;
    photoOrg.photoLib.isTotalAlbumsLoaded = !1;
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, this.albumsView.enableAlbumScroll, this.albumsView);
    eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.albumsView.reload, this.albumsView);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.albumsView.reload, this.albumsView);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, this.albumsView.close, this.albumsView);
    $(".photo-Org ul.ablumsContainer").empty();
   } else this.albumsView.reRender();
  } else this.albumsView = new photoOrg.AlbumsView({
   el:".albumsGridList",
   accessType:s
  });
  photoOrg.albumView = this.albumsView;
  photoOrg.photoLib.current_state != photoOrg.photoLib.navType.albums || photoOrg.photoLib.isTotalAlbumsLoaded || photoOrg.preloadAlbums ? photoOrg.photoLib.current_state == photoOrg.photoLib.navType.albums && $("#loadingBar").hide() :$("#loadingBar").show();
  photoOrg.photoLib.Util.componentView ? photoOrg.photoLib.Util.componentView.hide() :photoOrg.photoLib.showClusterView && photoOrg.photoLib.Util.clustersViewController && photoOrg.photoLib.Util.clustersViewController.hide();
  photoOrg.photoLib.showAlbumClusterView && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW ? photoOrg.photoLib.Util.albumsViewController.show() :photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.CLUSTER_VIEW && photoOrg.photoLib.Util.albumsViewController.hide();
  if (i.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW) try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Albums:Shared With Me"
   });
  } catch (l) {} else if (i.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW) try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Albums:My Shared"
   });
  } catch (l) {} else if (i.pg && -1 !== i.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW)) try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Albums:Favorite Album"
   });
  } catch (l) {} else try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Albums"
   });
  } catch (l) {}
 },
 handleSingleAlbumView:function() {
  console.log("MakeActionView - handleSingleAlbumView start... ");
  $(".date-sorting").hide();
  $(".album-filtering-menu").hide();
  $(".albumsGridList").hide();
  $("#album_assets").show();
  var t = photoOrg.photoLib.Util.historyState, e = "";
  $("#sub_header_container .photo_videos").removeClass("selected");
  if (t.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) {
   t[photoOrg.constants.PAGE] = photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   $("#sub_header_container .albums").removeClass("selected");
   e = "SHARED_WITH_ME";
  } else if (t.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) {
   t[photoOrg.constants.PAGE] = photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW;
   $("#sub_header_container .albums").removeClass("selected");
   e = photoOrg.photoLib.accessType.share2;
  } else if (-1 !== t.pgvw.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW)) {
   t[photoOrg.constants.PAGE] = photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW;
   $("#sub_header_container .albums").removeClass("selected");
   e = photoOrg.photoLib.accessType.owned;
  } else {
   t[photoOrg.constants.PAGE] = photoOrg.constants.SINGLE_ALBUM_VIEW;
   $("#sub_header_container .albums").addClass("selected");
   e = photoOrg.photoLib.accessType.owned;
  }
  var o = photoOrg.photoLib.current_state === photoOrg.photoLib.navType.singleAlbum;
  photoOrg.photoLib.current_state = photoOrg.photoLib.navType.singleAlbum;
  if (photoOrg.photoLib.Util.componentView) photoOrg.photoLib.Util.componentView.hide(); else if (photoOrg.photoLib.showClusterView) {
   photoOrg.photoLib.Util.clustersViewController || (photoOrg.photoLib.Util.clustersViewController = new photoOrg.clustersViewController());
   photoOrg.photoLib.Util.clustersViewController.hide();
  }
  t.so = void 0 !== t.so && "" !== t.so ? t.so :"dateTaken";
  if (!o) {
   delete photoOrg.savPage;
   photoOrg.savPage = new photoOrg.AlbumPageView({
    el:$("#album_assets"),
    accessType:e
   });
  }
  photoOrg.savPage.updateSingleAlbumView(e);
  if (photoOrg.photoLib.Util.historyState.pf != photoOrg.constants.PAGE_FROM_PUBLIC_SHARE) try {
   photoOrg.Util.delayTrackOmnitureForPage({
    pageName:"My Photos:Album"
   });
  } catch (i) {}
 }
});

var photoOrg = photoOrg || {};

photoOrg.MobileActionsMenu = Backbone.View.extend({
 initialize:function() {
  try {
   if (0 == $("#mobile-actions-menu").length) {
    var t = JST["templates/common/library/common/mobile_actions_menu"]();
    $("#library").append(t);
   }
   this.$el = $("#mobile-actions-menu");
   this.el = "#mobile-actions-menu";
   $(window).on("resize", $.proxy(this.resize, this));
   if (photoOrg.Util.isIphone5()) {
    this.$el.find(".overlay").on("singletap", $.proxy(this.hide, this));
    this.$el.find(".delete-photo").on("singletap", $.proxy(this.onDelete, this));
    this.$el.find(".select-all-photos").on("singletap", $.proxy(this.onSelectAll, this));
    this.$el.find(".make-album-cover").on("singletap", $.proxy(this.onMakeAlbumCover, this));
    this.$el.find(".share-album").on("singletap", $.proxy(this.shareAlbum, this));
    this.$el.find(".move-photo").on("singletap", $.proxy(this.onAssetMove, this));
    this.$el.find(".copy-photo").on("singletap", $.proxy(this.onAssetCopy, this));
    this.$el.find(".edit-photo").on("singletap", $.proxy(this.onAssetEdit, this));
    this.$el.find(".rotate-photo-cw").on("singletap", $.proxy(this.onAssetRotate, this));
   } else {
    this.$el.find(".overlay").on("tap", $.proxy(this.hide, this));
    this.$el.find(".delete-photo").on("tap", $.proxy(this.onDelete, this));
    this.$el.find(".select-all-photos").on("tap", $.proxy(this.onSelectAll, this));
    this.$el.find(".make-album-cover").on("tap", $.proxy(this.onMakeAlbumCover, this));
    this.$el.find(".share-album").on("tap", $.proxy(this.shareAlbum, this));
    this.$el.find(".move-photo").on("tap", $.proxy(this.onAssetMove, this));
    this.$el.find(".copy-photo").on("tap", $.proxy(this.onAssetCopy, this));
    this.$el.find(".edit-photo").on("tap", $.proxy(this.onAssetEdit, this));
    this.$el.find(".rotate-photo-cw").on("singletap", $.proxy(this.onAssetRotate, this));
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 show:function(t) {
  this.options = t;
  var e = this.$el.find(".make-album-cover");
  photoOrg.photoLib.current_state != photoOrg.photoLib.navType.singleAlbum || this.options.isAlbumCover ? e.hide() :e.show();
  var o = this.$el.find(".delete-photo"), i = this.$el.find(".rotate-photo-cw");
  photoOrg.photoLib.isFavorite && o.hide();
  var s = this.$el.find(".edit-photo"), r = this.$el.find(".copy-photo"), n = this.$el.find(".move-photo");
  if (this.options.isShowCopyAndMove) {
   r.show();
   n.show();
   s.show();
  } else {
   r.hide();
   n.hide();
   s.hide();
  }
  (photoOrg.photoLib.isFavorite || this.options.isShowCopyAndMove) && i.show();
  if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.CLUSTER_VIEW) {
   s.show();
   i.show();
  }
  if ("VIDEO" == this.options.assetType) {
   s.hide();
   i.hide();
  }
  1 == gon.staticContent.share && "av" == photoOrg.photoLib.Util.historyState.pg ? $(".share-album").show() :$(".share-album").hide();
  var a = this.$el.find(".select-all-photos");
  this.options.type === photoOrg.ModalTypes.ALBUM ? a.show() :a.hide();
  this.$el.addClass("show");
  this.$el.show();
 },
 hide:function() {
  try {
   this.$el.removeClass("show");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:hide", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onDelete:function() {
  try {
   this.options.deleteCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onDelete", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onSelectAll:function() {
  try {
   this.options.selectAllCallback();
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onSelectAll", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onAssetMove:function() {
  try {
   this.options.assetMoveCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onAssetMove", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onAssetCopy:function() {
  try {
   this.options.assetCopyCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onAssetCopy", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onAssetEdit:function() {
  try {
   this.options.assetEditCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onAssetEdit", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onAssetRotate:function() {
  try {
   this.options.assetRotateCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onAssetEdit", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onMakeAlbumCover:function() {
  try {
   this.options.makeAlbumCoverCallback(this.options.event);
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:onMakeAlbumCover", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 resize:function() {
  try {
   photoOrg.Util.isMobileLayout() || this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:resize", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 shareAlbum:function() {
  try {
   this.options.shareCallback();
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_actions:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.MobileOverlay = Backbone.View.extend({
 initialize:function() {
  try {
   this.$el.on("click", $.proxy(this.clickOverlay, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_overlay:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 clickOverlay:function() {
  try {
   eventBus.trigger(eventBus.CUSTOM_EVENT_CLICK_MOBILE_OVERLAY, {});
   this.hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:mobile_overlay:clickOverlay", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 show:function() {
  this.$el.css({
   "z-index":9998
  });
  this.$el.fadeIn("fast");
 },
 hide:function() {
  this.$el.fadeOut("fast");
 },
 showFull:function() {
  this.$el.css({
   "z-index":9999
  });
  this.$el.fadeIn("fast");
 }
});

var photoOrg = photoOrg || {};

photoOrg.AlbumsView = Backbone.View.extend({
 skip:0,
 limit:25,
 totalCount:0,
 isAlbumsLoaded:!0,
 urlParam:"",
 totalEntitiesCount:0,
 responseReturned:!0,
 accessType:"",
 sortOrder:"descending",
 sortCriteria:"",
 assetsUrl:"",
 optionsIconClicked:!1,
 albumsArray:{},
 albumThumnailSize:photoOrg.Util.thumbnailAvailableSizes[0],
 initialize:function(t) {
  try {
   if (0 == $("#drop1").length) {
    var e = JST["templates/common/library/album_view/album_options"]();
    $("#library").prepend(e);
   }
   console.log("albums_view initialize...");
   photoOrg.forceReload = !1;
   photoOrg.totalMyAlbumCount = 0;
   photoOrg.photoLib.seletedAlbums = $.jStorage.get(gon.staticContent.account_id + "_selectedAlbums");
   this.albumsArray = {};
   $(".photo-Org ul.ablumsContainer").empty();
   $(".closelittext").click(function() {
    $("#libText").slideUp(500);
    $(".encourage_user_to_upload_text").css("margin-top", "0px");
    $.jStorage.set("show_library_message_" + gon.staticContent.account_id, !1);
   });
   photoOrg.photoLib.UserAssetsInfo.userAlbums.reset();
   photoOrg.photoLib.showAndHideUploadTextDiv("hide");
   photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide");
   photoOrg.photoLib.isTotalAlbumsLoaded = !1;
   this.albumThumnailSize = photoOrg.Util.getAlbumThumnailSize();
   this.isTouchDevice = photoOrg.Util.isTouchDevice();
   this.setElement(t.el);
   this.accessType = t.accessType;
   this.getSortOrderFromjStorage();
   this.prepareAssetsUrl();
   this.render();
   eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, this.enableAlbumScroll, this);
   eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.reload, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.reload, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, this.close, this);
   eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_UNSELECT);
   eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_UNSELECT, this.unSelectAlbum, this);
   if (this.isTouchDevice) {
    console.log("delegateEvents for touch devices");
    this.delegateEvents(_.extend(this.events, {
     "tap .libprintsic":"redirectTOPrints",
     "tap .libshareic":"shareAlbum",
     "tap .newdropdown":"newdropdown",
     "tap .photoOrgStory":"loadSingleAlbumView",
     "tap .storyDescription":"loadSingleAlbumView",
     "tap .storyCaption":"loadSingleAlbumView",
     "tap .story-caption-area":"loadSavWithCaptionArea",
     "tap .selectAlbum":"selectAlbum",
     "tap .deleteAlbum":"deleteAlbum"
    }));
    try {
     if (photoOrg.Util.isIphone5()) {
      console.log("delegateEvents for Iphone5");
      this.delegateEvents(_.extend(this.events, {
       "click .libprintsic":"redirectTOPrints",
       "click .libshareic":"shareAlbum",
       "click .newdropdown":"newdropdown",
       "click .photoOrgStory":"loadSingleAlbumView",
       "click .story-caption-area":"loadSavWithCaptionArea",
       "tap .selectAlbum":"selectAlbum",
       "tap .deleteAlbum":"deleteAlbum"
      }));
     }
    } catch (o) {}
   } else {
    console.log("delegateEvents for non touch devices");
    this.delegateEvents(_.extend(this.events, {
     "click .photoOrgStory":"loadSingleAlbumView",
     "click .storyDescription":"loadSingleAlbumView",
     "click .storyCaption":"loadSingleAlbumView",
     "click .story-caption-area":"loadSavWithCaptionArea",
     "click .selectAlbum":"selectAlbum",
     "click .deleteAlbum":"deleteAlbum"
    }));
   }
   $("#drop1").mouseleave(function() {
    $("#drop1").hide();
   });
   $(".libsettingsic").off("click");
   $(".libsettingsic").on("click", function() {
    console.log("Clicked on Albums Tool Icon");
    photoOrg.Util.trackLinksAndButtons("Albums_ToolIcon", "albumsPage");
   });
   $("#drop1").unbind("closed");
   $("#drop1").bind("closed", function() {
    console.log("closed event");
    $("#drop1").css("margin-top", "");
    $("#drop1").removeClass("drop-top");
   });
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 events:{
  "mouseenter .album-item":"showAlbumHoverSection",
  "mouseleave .album-item":"hideAlbumHoverSection",
  "click .libprintsic":"redirectTOPrints",
  "click .libshareic":"shareAlbum",
  "click .newdropdown":"newdropdown",
  "click .share-story":"shareAlbum",
  "click .expand":"editAlbum",
  "click .liblikeic":"likeOrUnlikeAlbum",
  "click .libcommentic":"commentAlbum"
 },
 turnOnAlbumsResize:function() {
  console.log("turnOnAlbumsResize start time :: " + new Date());
  photoOrg.onloadAlbumsResizeAV = this.onloadAlbumsResize;
  if (this.backUpAlbumsResize) {
   photoOrg.onloadAlbumsResizeAV = this.backUpAlbumsResize;
   this.backUpAlbumsResize = void 0;
  }
  photoOrg.onloadAlbumsResizeAV = photoOrg.onloadAlbumsResizeAV.bind(this);
  if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
   $(window).off("resize", photoOrg.onloadAlbumsResizeAV);
   $(window).on("resize", photoOrg.onloadAlbumsResizeAV);
  }
  console.log("turnOnAlbumsResize end time :: " + new Date());
 },
 turnOffAlbumsResize:function() {
  $(window).off("resize", photoOrg.onloadAlbumsResizeAV);
 },
 selectAlbum:function(t) {
  console.log("Album selection...");
  $("#loadingBar").show();
  var e = t.target.classList[0];
  e = parseInt(e);
  photoOrg.photoLib.albumModelList[e];
  photoOrg.photoLib.seletedAlbums = $.jStorage.get(gon.staticContent.account_id + "_selectedAlbums");
  null == photoOrg.photoLib.seletedAlbums && (photoOrg.photoLib.seletedAlbums = {});
  if ($("." + e).hasClass("alb_selected")) {
   $("." + e).removeClass("alb_selected");
   photoOrg.photoLib.albumSelected = !1;
  } else {
   $("." + e).addClass("alb_selected");
   photoOrg.photoLib.albumSelected = !0;
  }
  var o = new photoOrg.albumSelection({
   albumId:e
  });
  o.handleAlbumSelection();
 },
 getSortOrderFromjStorage:function() {
  photoOrg.makePreMonthIndexCall || (!$.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria") && $.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder") ? this.sortOrder = $.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder") :$.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria") ? this.sortCriteria = $.jStorage.get(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria") :this.sortOrder = "descending");
 },
 reload:function(t) {
  try {
   console.log("reload initated...");
   this.albumsArray = {};
   if (void 0 != photoOrg.reload && photoOrg.reload) {
    photoOrg.reload = !1;
    return;
   }
   $("#loadingBar").show();
   $("#bottomLoadingBar").hide();
   eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUM_CLOSE, {});
   photoOrg.photoLib.isTotalAlbumsLoaded = !1;
   $(".photo-Org ul.ablumsContainer").empty();
   void 0 != t.urlParam && (this.urlParam = "&sortCriteria=" + t.urlParam);
   if (t && t.sortOrder) {
    this.sortOrder = t.sortOrder;
    this.sortCriteria = "";
   }
   t && t.sortCriteria && (this.sortCriteria = t.sortCriteria);
   this.setSortOrderTojStorage();
   this.skip = 0;
   this.isAlbumsLoaded = !1;
   this.unbind();
   photoOrg.photoLib.UserAssetsInfo.userAlbums.reset();
   photoOrg.makePreMonthIndexCall = !1;
   photoOrg.preloadAlbums = !1;
   (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.ALBUMS_VIEW || photoOrg.reload) && this.render();
   if (photoOrg.forceReload && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) {
    photoOrg.forceReload = !1;
    photoOrg.photoLib.Util.albumsViewController.show();
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:reload", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 errorCallback:function() {},
 setSortOrderTojStorage:function() {
  if (this.sortCriteria) {
   $.jStorage.set(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria", this.sortCriteria);
   $.jStorage.deleteKey(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder");
   if (photoOrg.albumView) {
    photoOrg.albumView.sortCriteria = this.sortCriteria;
    photoOrg.albumView.sortOrder = "";
   }
  } else {
   $.jStorage.set(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortOrder", this.sortOrder);
   if (photoOrg.albumView) {
    photoOrg.albumView.sortOrder = this.sortOrder;
    photoOrg.albumView.sortCriteria = "";
   }
   $.jStorage.deleteKey(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria");
  }
 },
 loadAlbums:function(t, e, o, i) {
  function s() {
   console.log("showHideSpinningWheel about to compare heights of albumsGridList & window");
   var t = $(".albumsGridList").height(), e = $(window).height();
   console.log("albumsGridListHeight is :: " + t + ", windowHeight is " + e);
   if (t > e) {
    console.log("showing bottomLoading Bar");
    $("#bottomLoadingBar").show();
   } else {
    console.log("Hiding bottomLoading Bar");
    $("#bottomLoadingBar").hide();
   }
  }
  console.log("loadAlbums started..");
  var r = new Date();
  photoOrg.albumsInfo = null;
  (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW) && (t = e.getFormattedResponseDataForAlbumsView(t));
  $("#loadingBar").hide();
  $("#bottomLoadingBar").show();
  photoOrg.reBuiltMonthCalendar = !1;
  if (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   if (null != t && null != t.entityMap) {
    photoOrg.photoLib.selectedImages.length > 0 && $("#cls_empty_tray").hide();
    if (void 0 != t.errors && t.errors.length > 0) photoOrg.photoLib.showServerInternalErrorMsg("show"); else {
     photoOrg.photoLib.showServerInternalErrorMsg("hide");
     if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) {
      void 0 != t.resultCount && _.each(t.entityMap, function(t) {
       photoOrg.totalMyAlbumCount += parseInt(t.collectionCount);
      });
      if (photoOrg.AlbumFetcher && photoOrg.totalMyAlbumCount == photoOrg.AlbumFetcher.totalAlbumCount) {
       photoOrg.photoLib.isTotalAlbumsLoaded = !0;
       $("#bottomLoadingBar").hide();
      }
     } else if (void 0 != t.resultCount && (0 == t.resultCount || t.resultCount < e.limit)) {
      photoOrg.photoLib.isTotalAlbumsLoaded = !0;
      $("#bottomLoadingBar").hide();
     }
     $(".photo-Org .albumsGridList .albumViewDummyContent").remove();
     if (0 == t.resultCount && 0 == e.skip) if (e.accessType == photoOrg.photoLib.accessType.share1) photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("show"); else if (e.accessType == photoOrg.photoLib.accessType.share2 && photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.MY_SHARED_ALBUM_VIEW) {
      photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("show");
      photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
     } else if (e.accessType == photoOrg.photoLib.accessType.myshared && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW) {
      photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("show");
      photoOrg.photoLib.showOrHideAlbumCopyMessage(!1);
     } else {
      photoOrg.Util.newUser = !0;
      photoOrg.photoLib.showAndHideUploadTextDiv("show");
      photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide");
      photoOrg.photoLib.showOrHideAlbumCopyMessage(!0);
     } else if (t.resultCount > 0 && 0 == e.skip) {
      photoOrg.photoLib.showAndHideUploadTextDiv("hide");
      $(".photo-Org .albumViewDummyContent").remove();
      e.accessType == photoOrg.photoLib.accessType.share1 ? photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide") :$("#sub_header_container").show();
      photoOrg.photoLib.UserAssetsInfo.albumListLength = t.totalEntitiesCount;
      if (void 0 == gon.staticContent.dc && void 0 != t.entities) {
       t.entities[0] && t.entities[0].dataCenter ? gon.staticContent.dc = t.entities[0].dataCenter :t.entityMap && t.entityMap.length > 0 && (gon.staticContent.dc = Object.keys(t.entityMap)[0].dataCenter);
       photoOrg.photoLib.collectionStructure.dataCenter = gon.staticContent.dc;
      }
     }
     {
      var n, a = !0, l = photoOrg.photoLib.prepareMonthWiseAlbumList(t, a, i);
      l.length;
     }
     n = $($(e.el).children()[0]);
     var c = !0;
     photoOrg.foundAlbum = !1;
     var h = new Date();
     console.log("Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     $.each(l, function(t, o) {
      var s = t.split("_"), r = e.$el.find("li#" + t), a = r.attr("id") !== t;
      if (a) {
       var l = JST["templates/common/library/album_view/albums-grid-view"]({
        date:gon.staticContent.months[s[0]],
        year:s[1],
        key:t
       });
       console.log("shouldLoadprevious" + i);
       1 == i ? n.prepend(l) :n.append(l);
      }
      for (var h = 25, d = n.find("li#" + t + " > ul"), p = "", u = 0; u < o.length; u++) {
       var g = o[u], m = e.accessType, f = e.renderAlbum(g, m, t, e.albumThumnailSize);
       if (photoOrg.selectedAlbumId) if (o[u].id == photoOrg.selectedAlbumId) {
        c = !0;
        photoOrg.foundAlbum = !0;
       } else photoOrg.foundAlbum || (c = !1);
       p += f;
       if (u == h || u == o.length - 1) {
        d.append(p);
        $("#loadingBar").hide();
        h += u;
        p = "";
        {
         new Date();
        }
       }
      }
      photoOrg.Util.isAlbumMobileView() && $("li#" + t).find(".iconspallet").show();
      e.isTouchDevice && e.iconspallet_longPress(t);
     });
     var h = new Date();
     console.log("Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     console.log("project Tray Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     e.responseReturned = !0;
     0 == e.skip && photoOrg.projectTrayView && photoOrg.projectTrayView.render();
     $("#drop1").hide();
     photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.ALBUMS_VIEW && (e.skip += e.limit);
     var h = new Date();
     console.log("project Tray Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     var h = new Date();
     console.log("Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     if (photoOrg.selectedAlbumId && photoOrg.foundAlbum) {
      $("#right-well").animate({
       scrollTop:$("#section_" + photoOrg.selectedAlbumId).offset().top - 100
      }, 200);
      photoOrg.selectedAlbumId = "";
     }
     var h = new Date();
     console.log("Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     if (photoOrg.photoLib.config.loadAsPhotoPicker && photoOrg.albumIdForAlbumsView) {
      $("#section_" + photoOrg.albumIdForAlbumsView).find(".storyImage").click();
      photoOrg.albumIdForAlbumsView = "";
     }
     e.toggleSelectAlbumState();
     var h = new Date();
     console.log("Time difference in milliseconds.. " + (h.getTime() - r.getTime()));
     o && !this.renderCalled && setTimeout(function() {
      try {
       o.apply();
      } catch (t) {
       console.log("Issue with calling of callback :: " + t);
      }
     }, 200);
     this.renderCalled = !1;
     setTimeout(function() {
      if (photoOrg && !photoOrg.Util.isTouchDevice()) {
       console.log("start time invoking foundation..." + new Date());
       var t = $(".ablumsContainer");
       $(window).off("resize");
       t.foundation();
       console.log("end time invoked foundation..." + new Date());
      }
      console.log("invoking resize");
      e.turnOnAlbumsResize();
     }, 5);
     setTimeout(function() {
      if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
       $(".selectAlbum a").removeClass("alb_selected");
       $(".tray-thumbnail-wrapper").addClass("hide");
      }
      s();
     }, 500);
     console.log("enableAlbumScroll-off/on loadAlbums");
     eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
     eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, e.enableAlbumScroll, e);
    }
   }
  } else {
   this.loadFavSAV(t);
   $("#bottomLoadingBar").hide();
  }
 },
 onloadAlbumsResize:function() {
  console.log("in onloadAlbumsResize....");
  photoOrg.Util.adjustHeader();
  var t = photoOrg.Util.isAlbumMobileView();
  t ? $(".album-item").find(".iconspallet").show() :!t && self.isTouchDevice && this.iconspallet_longPress(key, ".album-item");
  $("#drop1").hide();
 },
 loadNextSet:function() {
  if ("updateDate" == this.sortCriteria) var t = this.assetsUrl + "&skip=" + this.skip + "&limit=" + this.limit + "&sortCriteria=" + this.sortCriteria; else var t = this.assetsUrl + "&skip=" + this.skip + "&limit=" + this.limit + "&sortOrder=" + this.sortOrder;
  this.albumsArray[this.skip] = {
   isRequestSent:!0,
   isResponseReceived:!1
  };
  this.getAssetFetcher().getAlbumsData(t, {}, $.proxy(this.upDateAlbumArray, this), this.errorCallback, this);
 },
 upDateAlbumArray:function(t) {
  if (t && t.errors && 0 == t.errors.length) {
   this.albumsArray[this.skip] = {
    isRequestSent:!0,
    isResponseReceived:!0,
    data:t
   };
   console.log("Hi this is test" + this.albumsArray[this.skip].userScrolled + this.skip);
   if (this.albumsArray[this.skip].userScrolled) {
    console.log("scrolled");
    this.loadAlbums(t, this);
   }
  } else this.albumsArray[this.skip] = {
   isRequestSent:!1,
   isResponseReceived:!1
  };
 },
 renderAlbum:function(t, e, o, i) {
  console.log("Rendering Album......");
  var s = photoOrg.photoLib.getThumbDataFromCollection(t, i), r = s.thumb;
  t.aId = s.aId;
  t.albumImgUrl = r;
  t.albumId = t.id;
  t.container_key = o;
  t.caption = photoOrg.photoLib.getValue(t.userTags, "caption");
  void 0 == t.caption && (t.caption = "");
  t.description = photoOrg.photoLib.getValue(t.userTags, "description");
  var n = !1, a = !1;
  _.each(t.systemTags, function(t) {
   "Share" == t.key && "Private" == t.value && (n = !0);
   "customOrder" == t.key && "true" == t.value && (a = !0);
  });
  t.isShared = n;
  t.customSortEnabled = a;
  var l = t.caption, c = t.description;
  t.caption.length > 25 && (t.caption = t.caption.substr(0, 25).replace(/ +/g, " ") + "...");
  t.o_caption = encodeURIComponent(l);
  t.o_description = encodeURIComponent(c);
  t.albumIconlongPress = !1;
  var h = "", d = window.translations.asset_text.photos, p = window.translations.asset_text.photo;
  if (t.assetIdList && t.assetIdList.length > 0) {
   h = t.assetIdList.length;
   h = h + " " + (h > 1 ? d :p);
  }
  var u = !1, g = gon.staticContent.someone, m = gon.staticContent.someone, f = "";
  t.ownerInfo && (g = t.ownerInfo.firstName);
  if (t.view && t.view.length) {
   for (var b = 0; b < t.view.length; b++) {
    f += t.view[b].firstName;
    t.view.length != b + 1 && (f += ",");
   }
   m = t.view[0].firstName;
  }
  ("" == gon.staticContent.account_id || void 0 == gon.staticContent.account_id) && photoOrg.jsWarningLogger('"Account Id is mandatory Filed" accountId="' + gon.staticContent.account_id + '"', this.url);
  if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW) {
   u = gon.staticContent.account_id == t.ownerAccountId;
   for (var b in t.view) {
    var v = t.view[b];
    u && v.accountId != gon.staticContent.account_id && (m = v.firstName);
   }
  }
  var O = "inline-block";
  (this.accessType == photoOrg.photoLib.accessType.share2 || this.accessType == photoOrg.photoLib.accessType.share1) && (O = "none");
  var A = !1;
  try {
   photoOrg.photoLib.seletedAlbums && !jQuery.isEmptyObject(photoOrg.photoLib.seletedAlbums) && (A = t.id in photoOrg.photoLib.seletedAlbums);
  } catch (w) {
   console.log("some error with photoorg.photolib.selectedalbums object");
  }
  var y = 0;
  photoOrg.photoLib.Util.albumsViewController && (y = photoOrg.photoLib.Util.albumsViewController.currentPage);
  var C = "";
  if ("" != this.sortCriteria && void 0 != this.sortCriteria) {
   var S = new Date(t.updateDate);
   C = S.getFullYear() + "-" + (S.getMonth() + 1);
  } else if (this.sortOrder) {
   var S = new Date(t.createDate);
   C = S.getFullYear() + "-" + (S.getMonth() + 1);
  }
  photoOrg.photoLib.albumModelList[t.id] = t;
  var L = {
   id:t.id,
   version:t.version,
   aId:t.aId,
   count:t.assetIdList.length,
   albumImgUrl:t.albumImgUrl,
   content:h,
   caption:t.caption,
   description:t.description,
   o_caption:t.o_caption,
   accessType:e,
   likesCount:t.likesCount,
   friendsCount:t.friendsCount,
   shared:t.friendsCount > 0,
   sharedByMe:u,
   ownerName:g,
   sharedWithName:m,
   shareIcon:O,
   sharedWithAllNames:f,
   albumSelected:A,
   pageNo:y,
   presentMonth:C
  };
  photoOrg.photoLib.albumModelList[t.albumId].systemTags && "true" == photoOrg.photoLib.getValue(t.systemTags, "isFavorite") && (L.caption = window.translations.sub_header.favorite_alb);
  var T = JST["templates/common/library/time_line_view/library-album"](L), I = $(T).find("#AlbumDetials");
  I.attr("id", t.id);
  I.attr("pageNo", y);
  I.addClass("album_" + t.id);
  I.attr("presentMonth", C);
  var k = photoOrg.photoLib.Util.historyState;
  if (k.pg && -1 !== k.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
   $(".delete-album").hide();
   $(".recently_modified").hide();
  } else if (k.pg && -1 !== k.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW)) {
   $(".delete-album").show();
   $(".recently_modified").hide();
  } else {
   $(".delete-album").show();
   $(".recently_modified").show();
  }
  return T;
 },
 iconspallet_longPress:function(t, e) {
  var o = photoOrg.Util.isMobileListView();
  if (!o) {
   var i = "li#" + t;
   e && (i = ".album-item");
   var s = $(i);
   s.find(".story-caption-area").off("taphold", $.proxy(this.longHold, this));
   s.find(".story-caption-area").off("holdtap", $.proxy(this.longHold, this));
   s.find(".story-caption-area").on("taphold", $.proxy(this.longHold, this));
   s.find(".story-caption-area").on("holdtap", $.proxy(this.longHold, this));
  }
 },
 longHold:function(t) {
  var e = photoOrg.Util.isMobileListView();
  if (!e) {
   var o = $($(t.target).closest(".item-sec-div")), i = $(o).attr("id").split("_")[1];
   $("#drop1").hide();
   photoOrg.photoLib.albumModelList[i].albumIconlongPress = !0;
   $(".iconspallet").hide();
   $(o).find(".iconspallet").show();
   $(o).find(".iconspallet").css("z-index", 10);
  }
 },
 loadSingleAlbumView:function(t) {
  try {
   photoOrg.photoLib.customSortEnabled = !1;
   console.log("Loading single album view.....");
   var e = $($(t.target).closest(".item-sec-div")), o = $(e).attr("id").split("_")[1], i = photoOrg.photoLib.albumModelList[o], s = $(e).attr("pageNo"), r = $(e).attr("presentMonth");
   if (s && photoOrg.photoLib.Util.albumsViewController) {
    photoOrg.photoLib.Util.albumsViewController.currentPage = s;
    photoOrg.currentMonth = r;
   }
   if ($(t.target).hasClass("newdropdown") || i.albumIconlongPress || $($(t.target)).parent().hasClass("libprintsic") || $(t.target).hasClass("libprintsic")) return;
   if ("selectAllAblum" == t.target.id) return;
   if ($(t.target).hasClass("delete-album")) {
    this.deleteAlbum(t);
    return;
   }
   $("#drop1").hide();
   photoOrg.photoLib.albumModelList[o].albumIconlongPress = !1;
   $(e).find("#album-filtering").removeClass("open highlight").css({
    left:"-99999px"
   });
   $("#loadingBar").show();
   $("#bottomLoadingBar").hide();
   {
    photoOrg.photoLib.Util.historyState;
   }
   photoOrg.selectedAlbumId = o;
   photoOrg.albumView.skip = 0;
   photoOrg.photoLib.isShared = i.isShared;
   photoOrg.photoLib.customSortEnabled = i.customSortEnabled;
   photoOrg.photoLib.loadSingleAlbumView(i);
   return !1;
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:loadSingleAlbumView", errorCode="LIBRARY:MYALBUMS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 loadSavWithCaptionArea:function(t) {
  try {
   var e = $($(t.target).closest(".item-sec-div")), o = $(e).attr("id").split("_")[1], i = photoOrg.photoLib.albumModelList[o];
   palletIcon = $(t.target);
   if (palletIcon.hasClass("newdropdown") || palletIcon.hasClass("libshareic") || palletIcon.hasClass("liblikeic") || palletIcon.hasClass("libcommentic") || palletIcon.hasClass("libsettingsic") || palletIcon.hasClass("iconspallet") || palletIcon.hasClass("libprintsic") || i.albumIconlongPress) {
    photoOrg.photoLib.albumModelList[o].albumIconlongPress = !1;
    return;
   }
   this.loadSingleAlbumView(t);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:loadSavWithCaptionArea", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 showAlbumHoverSection:function(t) {
  try {
   this.optionsIconClicked = !1;
   $(".iconspallet").hide();
   $("#drop1").hide();
   $(t.currentTarget).find(".iconspallet").show();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:showAlbumHoverSection", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 hideAlbumHoverSection:function(t) {
  try {
   if (!this.optionsIconClicked) {
    $("#drop1").hide();
    $($(t.target)).find(".iconspallet").hide();
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:hideAlbumHoverSection", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 orderPrints:function(t) {
  console.log("Otder Prints....");
  t.stopPropagation();
  var e = $($(t.target).closest(".item-sec-div")), o = $(e).attr("id").split("_")[1], i = photoOrg.photoLib.albumModelList[o];
  gon.staticContent.session_update = !1;
  var s = gon.staticContent.prints_builder_url + "?" + gon.staticContent.prints_sku_4x6 + "&albumId=" + o, r = photoOrg.photoLib.Util.historyState;
  if (r.pg && -1 !== r.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
   console.log("friends albums");
   s += "&accountId=" + i.ownerAccountId + "&albumType=friends&dc=" + i.dataCenter;
  } else r.pg && -1 !== r.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW) && (s += "&albumType=myshared&dc=" + i.dataCenter);
  window.location.href = s;
 },
 redirectTOPrints:function(t) {
  try {
   console.log("Redirecting to Prints builder...");
   photoOrg.Util.trackLinksAndButtons("Albums_OrderPrintsIcon", "albumsPage");
   var e = photoOrg.Util.getBrowserSessionCookie("GSID");
   !$.jStorage.get(gon.staticContent.account_id + "_" + e + "dont_show_conformation") && this.isTouchDevice && photoOrg.printsConfirmation ? photoOrg.printsConfirmation.init({
    orderPrints:$.proxy(this.orderPrints, this, t)
   }) :this.orderPrints(t);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:redirectTOPrints", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 shareAlbum:function(t) {
  try {
   console.log("Sharing Album...");
   t.stopPropagation();
   photoOrg.Util.trackLinksAndButtons("Albums_ShareIcon", "albumsPage");
   var e = $($(t.target).closest(".item-sec-div")), o = $(e).attr("id").split("_")[1], i = photoOrg.photoLib.albumModelList[o];
   eventBus.trigger(eventBus.CUSTOM_EVENT_SHARE, {
    shareType:"SINGLE_ALBUM_SHARE",
    shareData:{
     albumModel:i
    }
   });
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 newdropdown:function(t) {
  try {
   this.optionsIconClicked = !0;
   t.stopPropagation();
   var e = $(t.currentTarget).attr("id"), o = $(t.currentTarget).offset();
   o.top = o.top - $("#library").offset().top;
   o.top += 25;
   $("#drop1").hide().css("width", "auto");
   $("#drop1").show().css(o);
   $("#library #right-well").on("scroll", function() {
    $("#drop1").hide();
   });
   var i = $(t.currentTarget).offset().top + $("#drop1").innerHeight() + 20;
   $(".mobile-footer").is(":visible") && (i += $(".mobile-footer").innerHeight());
   var s = $(window).height();
   if (i > s) {
    $("#drop1").css("margin-top", -($("#drop1").innerHeight() + 20) + "px");
    $("#drop1").addClass("drop-top");
   } else {
    $("#drop1").css("margin-top", "");
    $("#drop1").removeClass("drop-top");
   }
   var r = e;
   r = r.split("_")[1];
   r = parseInt(r);
   var n = photoOrg.photoLib.Util.historyState;
   if (n.pg && -1 !== n.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
    $(".libshareic").hide();
    $(".delete-album").hide();
   } else if (n.pg && -1 !== n.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW)) {
    $(".libshareic").show();
    $(".delete-album").show();
   } else {
    $(".libshareic").show();
    var a = photoOrg.photoLib.albumModelList[r];
    a.systemTags && "true" == photoOrg.photoLib.getValue(a.systemTags, "isFavorite") ? $(".delete-album").hide() :$(".delete-album").show();
   }
   photoOrg.delAlbId = e;
   $(".delete-photo").attr("id", e);
   {
    $("#drop1").find(".delete-album");
   }
   $(".delete-photo").addClass("" + e);
   eventBus.off(eventBus.DELETE_ALBUM);
   eventBus.on(eventBus.DELETE_ALBUM, this.deleteAlbum, this);
   eventBus.off(eventBus.SLIDESHOW);
   eventBus.on(eventBus.SLIDESHOW, this.slideshow, this);
  } catch (l) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:newdropdown", errorCode="LIBRARY:MYALBUMS", err_desc="' + l + '" err_stack="' + l.stack + '"');
  }
 },
 deleteAlbum:function(t) {
  console.log("Deleting Album.......");
  var e;
  e = t.target ? t.target.id :t.id;
  console.log("album id is..." + e);
  e = photoOrg.delAlbId;
  e = e.split("_")[1];
  e = parseInt(e);
  this.albumId = this.id = e;
  var o = photoOrg.photoLib.albumModelList[e];
  photoOrg.photoLib.doCollectionAssetRequestAndShowConfirmation(e, o, this);
  photoOrg.Util.trackLinksAndButtons("Delete Album", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
 },
 deleteSuccessCallback:function(t, e) {
  $("#loadingBar").hide();
  photoOrg.AlbumFetcher.totalAlbumCount--;
  e.closeAlbum(e);
  photoOrg.photoLib.deselectImagesFromTrayAfterAlbumDelete();
 },
 deleteErrorCallback:function(t, e) {
  $("#loadingBar").hide();
  console.log("Error deleting album: ", e);
 },
 slideshow:function(t) {
  console.log("Album Slideshow...");
  var e = t.id, o = photoOrg.photoLib.albumModelList[e];
  new photoOrg.albumSlideShowController({
   albumId:e,
   albumModel:o
  });
  photoOrg.Util.trackLinksAndButtons("Slide Show", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
 },
 prepareAssetsUrl:function() {
  try {
   var t = photoOrg.photoLib.Util.historyState;
   $(".album-sorting").css("display", "inline-block");
   if (t.pg && -1 !== t.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
    $("#TopLoadingBar").hide();
    this.accessType = photoOrg.photoLib.accessType.share2;
    this.assetsUrl = gon.staticContent.pict_service + "social/feed/collection?type=received&friendsInfo=true";
   } else if (t.pg && -1 !== t.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW)) {
    $("#TopLoadingBar").hide();
    this.accessType = photoOrg.photoLib.accessType.myshared;
    this.assetsUrl = gon.staticContent.pict_service + "social/feed/collection?type=ownedShared&friendsInfo=true";
   } else if (t.pg && -1 !== t.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW)) {
    $("#TopLoadingBar").hide();
    this.assetsUrl = gon.staticContent.pict_service + "collection/favorite";
   } else this.assetsUrl = gon.staticContent.pict_service + "collection/monthIndex?minCollection=1000&projection=userTags,firstAssetId,systemTags,assetIdList" + this.urlParam;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:prepareAssetsUrl", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 render:function() {
  try {
   console.log("albums view render.....");
   photoOrg.reload = !1;
   var t = photoOrg.photoLib.Util.historyState;
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".lib-left-col").addClass("hidden");
    $("#right-well").addClass("full");
   } else {
    if (0 == photoOrg.photoLib.selectedImages.length) {
     console.log("No selected Images");
     $(".tray-thumbnail-wrapper").addClass("hide");
    }
    $(".lib-left-col").removeClass("hidden");
    $("#right-well").removeClass("full");
   }
   var e = this.getAssetFetcher();
   this.responseReturned = !1;
   $(".album-sorting").show();
   $(".favemptytxt").hide();
   var o, i;
   if (t.pg == photoOrg.constants.ALBUMS_VIEW && photoOrg.photoLib.Util.albumsViewController && photoOrg.photoLib.Util.albumsViewController.currentPage >= 0 && photoOrg.AlbumFetcher.pages && photoOrg.AlbumFetcher.pages.length > 0) {
    o = photoOrg.AlbumFetcher.pages[photoOrg.photoLib.Util.albumsViewController.currentPage].limit;
    i = photoOrg.AlbumFetcher.pages[photoOrg.photoLib.Util.albumsViewController.currentPage].skip;
   }
   this.getSortOrderFromjStorage();
   if (this.sortCriteria && void 0 != t.pg && t.pg == photoOrg.constants.ALBUMS_VIEW) {
    $(".album-sorting .selected-option").html(window.translations.sub_header.recentlyModified);
    $(".album_discending").removeClass("selected");
    $(".album_ascending").removeClass("selected");
    $(".recently_modified").addClass("selected");
   } else {
    var s = this.assetsUrl;
    t.pg && -1 == t.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) && (s = this.assetsUrl + "&skip=" + this.skip + "&limit=" + this.limit + "&sortOrder=" + this.sortOrder);
    if ("descending" == this.sortOrder) {
     $(".album-sorting .selected-option").html(window.translations.sub_header.newesttooldest);
     $(".album_discending").addClass("selected");
     $(".album_ascending").removeClass("selected");
     $(".recently_modified").removeClass("selected");
    } else if ("ascending" == this.sortOrder) {
     $(".album-sorting .selected-option").html(window.translations.sub_header.oldesttonewest);
     $(".album_ascending").addClass("selected");
     $(".album_discending").removeClass("selected");
     $(".recently_modified").removeClass("selected");
    }
   }
   this.setSortOrderTojStorage();
   if (photoOrg.preloadAlbums) {
    this.renderCalled = !0;
    if (photoOrg.albumsInfo) {
     this.loadAlbums(photoOrg.albumsInfo, this);
     photoOrg.albumsInfo = null;
    } else {
     photoOrg.albumCallbackHandler = this.loadAlbums;
     photoOrg.albumCallbackCurrentObject = this;
     document.dispatchEvent(photoOrg.loadAlbumEvent);
    }
   } else if (t.pg && -1 !== t.pg.indexOf(photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW)) {
    photoOrg.photoLib.isShared = !1;
    e.getAlbumsData(s, {}, this.loadFavSAV, this.errorCallback, this);
   } else t.pg != photoOrg.constants.ALBUMS_VIEW && e.getAlbumsData(s, {}, this.loadAlbums, this.errorCallback, this);
   if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
    $(".selectAlbum a").removeClass("alb_selected");
    $(".tray-thumbnail-wrapper").addClass("hide");
   }
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:render", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 toggleSelectAlbumState:function() {},
 allAlbumsFailureCallback:function() {
  console.log("Albums view-allAlbumsFailureCallback");
  var t = this.getAssetFetcher();
  this.responseReturned = !1;
  if (photoOrg.albumFetcherObj && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) {
   photoOrg.albumFetcherObj.sortOrder ? this.sortOrder = photoOrg.albumFetcherObj.sortOrder :photoOrg.albumFetcherObj.sortCriteria && (this.sortOrder = photoOrg.albumFetcherObj.sortCriteria);
   if (photoOrg.albumFetcherObj.pages.length > 0 && photoOrg.photoLib.Util.albumsViewController.currentPage >= 0) {
    var e = photoOrg.albumFetcherObj.pages[photoOrg.photoLib.Util.albumsViewController.currentPage];
    this.limit = e.limit;
    this.skip = e.skip;
   }
  }
  var o = this.assetsUrl + "&skip=" + this.skip + "&limit=" + this.limit + "&sortOrder=" + this.sortOrder;
  t.getAlbumsData(o, {}, this.loadAlbums, this.errorCallback, this);
 },
 getAssetFetcher:function() {
  this.fetcher = new AssetFetcher();
  return this.fetcher;
 },
 enableAlbumScroll:function() {
  try {
   console.log("Enabling Album scroll");
   $("#drop1").hide();
   var t = photoOrg.photoLib.rightWell, e = t.scrollTop() + t.innerHeight() >= t[0].scrollHeight;
   console.log("enableAlbumScroll bottomLoadingBar on screen : " + $("#bottomLoadingBar").isOnScreen());
   console.log("enableAlbumScroll TopLoadingBar on screen : " + $("#TopLoadingBar").isOnScreen());
   if (this.responseReturned && !photoOrg.photoLib.isTotalAlbumsLoaded) if (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.ALBUMS_VIEW) {
    console.log("hiding top loading bar..");
    $("#TopLoadingBar").hide();
    if (e) {
     photoOrg.preloadAlbums = !1;
     this.render();
    }
   } else {
    0 == t.scrollTop() && $("#TopLoadingBar").show();
    if ($("#bottomLoadingBar").is(":visible") && $("#bottomLoadingBar").isOnScreen()) {
     console.log("loading next page albums");
     console.log("enableAlbumScroll-off/on enableAlbumScroll next");
     eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
     photoOrg.photoLib.Util.albumsViewController.loadNextPage();
    } else if ($("#TopLoadingBar").is(":visible") && $("#TopLoadingBar").isOnScreen() && photoOrg.photoLib.Util.albumsViewController.hidingAndShowTopSpinningWheel()) {
     console.log("loading previous page albums");
     console.log("enableAlbumScroll-off/on enableAlbumScroll previous");
     eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
     photoOrg.photoLib.Util.albumsViewController.loadPreviousPage();
    }
   } else {
    console.log("Total Albums Loaded : " + photoOrg.photoLib.isTotalAlbumsLoaded + " so hiding bottom loading bar");
    photoOrg.photoLib.isTotalAlbumsLoaded && $("#bottomLoadingBar").hide();
   }
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:enableAlfbumScroll", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 close:function() {
  try {
   $(".albumsGridList .ablumsContainer").empty();
   eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, this.enableAlbumScroll, this);
   eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.reload, this);
   eventBus.off(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, this.close, this);
   this.turnOffAlbumsResize();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:close", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 closeAlbum:function(t) {
  var e = t.id;
  $($("#section_" + e).closest(".album-item")).remove();
  t.container_key = t.$el.find("li").attr("id");
  try {
   0 == $("#" + t.container_key + " ul.album-wrapper li").length && $("#" + t.container_key).remove();
  } catch (o) {}
  try {
   var i = photoOrg.photoLib.Util.historyState;
   if (void 0 != i.pg && i.pg == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
    var s = photoOrg.constants.ALBUMS_VIEW;
    $("#album-filtering a[data-value='" + s + "']").click();
   } else if (0 == $(".albumsGridList .ablumsContainer").children().length && i.pg != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
    $(".albumsGridList .ablumsContainer").empty();
    photoOrg.photoLib.showAndHideUploadTextDiv("show");
   }
  } catch (o) {}
 },
 getFormattedResponseDataForAlbumsView:function(t) {
  if (!(t && t.entities && t.entities.length > 0)) return t;
  t.resultCount = t.entities.length;
  for (var e = 0; e < t.entities.length; e++) {
   t.entities[e].createDate = t.entities[e].createDate;
   t.entities[e].accessLevel = "OWNER";
   t.entities[e].userTags = [ {
    value:t.entities[e].caption,
    key:"caption"
   } ];
   t.entities[e].assetIdList = [];
  }
  return t;
 },
 reRender:function() {
  console.log("reRender started..");
  this.sortCriteria = "";
  photoOrg.preloadAlbums = !1;
  this.albumsArray = {};
  $(".photo-Org ul.ablumsContainer").empty();
  photoOrg.photoLib.UserAssetsInfo.userAlbums.reset();
  photoOrg.photoLib.showAndHideUploadTextDiv("hide");
  photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide");
  photoOrg.photoLib.isTotalAlbumsLoaded = !1;
  this.setElement(this.el);
  this.prepareAssetsUrl();
  this.render();
  eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, this.enableAlbumScroll, this);
  eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.reload, this);
  eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_RELOAD, this.reload, this);
  eventBus.on(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, this.close, this);
 },
 clear:function() {
  this.$el.children().empty();
 },
 unSelectAlbum:function(t) {
  $("#selectAlbum_" + t + ">a." + t).hasClass("alb_selected") && $("#selectAlbum_" + t + ">a." + t).removeClass("alb_selected");
 },
 loadFavSAV:function(t) {
  if (t && t.entities.length <= 0) photoOrg.photoLib.showOrHideFavAlbumMessage("show"); else {
   var e = t.entities[0];
   _.each(e.systemTags, function(t) {
    if ("Share" == t.key && "Private" == t.value) {
     photoOrg.photoLib.isShared = !0;
     e.isShared = photoOrg.photoLib.isShared;
    }
   });
   photoOrg.photoLib.loadSingleAlbumView(e);
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.albumSlideShowController = Backbone.View.extend({
 albumId:null,
 albumModel:null,
 accessType:null,
 assetFetcher:null,
 isClassic:!1,
 likesCount:0,
 comments:[],
 friendsCount:0,
 sharedWithName:"",
 albumResponse:null,
 sharedWithMe:!1,
 slides:[],
 initialize:function(t) {
  try {
   console.log("album slide show initialize...");
   this.albumId = t.albumId;
   this.albumModel = t.albumModel;
   this.handleSlideShow();
   eventBus.on(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW_ALBUMS_PAGE, $.proxy(this.shareAlbum, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:album_slide_show_controller:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 handleSlideShow:function() {
  try {
   console.log("In handleSlideShow method");
   var t = this.getAssetFetcher();
   $("body").on("keydown", function(t) {
    t && 27 == t.keyCode && self.close();
   });
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var e = {
    urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
    albumId:this.albumId,
    assetType:"ALL",
    sortOrderParam:"sortOrder=ascending"
   }; else var e = {
    urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
    albumId:this.albumId,
    assetType:"PICTURE",
    sortOrderParam:"sortOrder=ascending"
   };
   var o = photoOrg.photoLib.Util.historyState;
   if (o.pg && -1 !== o.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
    $(".album-sorting").hide();
    this.accessType = photoOrg.photoLib.accessType.share2;
    e.ownerAccountId = this.albumModel.ownerAccountId;
    e.dataCenter = this.albumModel.dataCenter;
    t.getSharedSingleAlbumInfo("", e, this.sharedSuccRes, this.sharedFailRes, this);
   } else if (o.pg && -1 !== o.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW)) {
    _this = this;
    this.accessType = photoOrg.photoLib.accessType.myshared;
    e.ownerAccountId = this.albumModel.ownerAccountId;
    e.dataCenter = this.albumModel.dataCenter;
    t.getSingleAlbumInfo("", e, this.mySharedSlideShow, this.singleAlbumFailRes, this);
   } else if (this.albumModel.isShared) {
    _this = this;
    this.accessType = photoOrg.photoLib.accessType.myshared;
    e.ownerAccountId = this.albumModel.ownerAccountId;
    e.dataCenter = this.albumModel.dataCenter;
    t.getSingleAlbumInfo("", e, this.mySharedSlideShow, this.singleAlbumFailRes, this);
   } else t.getSingleAlbumInfo("", e, this.singleAlbumSuccRes, this.singleAlbumFailRes, this);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:album_slide_show_controller:handleSlideShow", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 mySharedSlideShow:function(t, e) {
  console.log("In mySharedSlideShow method");
  var o, i = _this.getAssetFetcher();
  o = "true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video ? {
   urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
   albumId:_this.albumId,
   assetType:"ALL",
   sortOrderParam:"sortOrder=ascending"
  } :{
   urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
   albumId:_this.albumId,
   assetType:"PICTURE",
   sortOrderParam:"sortOrder=ascending"
  };
  _this.accessType = photoOrg.photoLib.accessType.myshared;
  o.ownerAccountId = _this.albumModel.ownerAccountId;
  o.dataCenter = _this.albumModel.dataCenter;
  e.slides = new photoOrg.pictCollection();
  _.each(t.entities, function(t) {
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) ; else if ("VIDEO" == t.assetType) return;
   var o = new photoOrg.pict(t);
   e.slides.add(o);
  });
  i.getSharedSingleAlbumInfo("", o, _this.sharedSuccRes, _this.sharedFailRes, _this);
 },
 sharedSuccRes:function(t, e) {
  console.log("In sharedSuccRes method");
  if (t.entities && 0 == t.entities.length && t.errors.length > 0 && t.errors[0] && -1 != t.errors[0].description.indexOf("collection does not exist for the item id")) {
   $("#loadingBar").hide();
   $(".empty_shared_albums").show();
   $(".empty_shared_albums p").text(window.translations.empty_single_album_view);
   e.showSubheader();
   photoOrg.selectedAlbumId = "";
   $("#browseAlbums").hide();
   $("#library .albums").removeClass("selected");
  } else if (t && t.entities.length) {
   e.socialResponse = t.entities[0];
   e.albumResponse = t.entities[1];
   e.dataCenter = e.socialResponse.dataCenter;
   e.ownerAccountId = e.socialResponse.ownerAccountId;
   1 == e.photos_count && (e.photos_count = t.entities[1].assetIdList.length);
   e.isOwnedAndShared = !1;
   e.firstAssetInfo = t.entities[0].firstAssetId;
   e.albumDescription = photoOrg.photoLib.getValue(t.entities[1].userTags, "description");
   e.album_caption = photoOrg.photoLib.getValue(t.entities[1].userTags, "caption");
   e.userTags = t.entities[1].userTags;
   e.coverPhotoAsset = t.entities[1];
   e.coverImage = photoOrg.photoLib.getThumbDataFromCollection(e.coverPhotoAsset).thumb;
   e.likesCount = t.entities[0].likesCount;
   if (void 0 == t.entities[0].ownerInfo) {
    t.entities[0].ownerInfo = {};
    t.entities[0].ownerInfo.firstName = "";
    setTimeout(function() {
     $(".album-author").hide();
    }, 700);
   }
   e.ownerName = t.entities[0].ownerInfo.firstName;
   e.lastName = t.entities[0].ownerInfo.lastName;
   t.entities[0].view[0] && (e.sharedWithName = t.entities[0].view[0].firstName);
   e.likes = t.entities[0].likes;
   e.view = t.entities[0].view;
   e.firstAssetIdDate = t.entities[0].createDate;
   e.comments = t.entities[0].comments;
   if ("SHARED_WITH_ME" == e.accessType) {
    t = e.formatSharedAlbumResponsedata(t, e);
    e.processResponse(t, e);
   } else {
    ({
     albumId:e.album_id,
     urlparam:"&limit=" + photoOrg.photoLib.limit + "&skip=" + e.skip + e.uraparam
    });
   }
   var o = new photoOrg.pictCollection();
   _.each(t.entities[1].assetIdList, function(t) {
    if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) ; else if ("VIDEO" == t.assetType) return;
    var e = new photoOrg.pict(t);
    o.add(e);
   });
   photoOrg.photoLib.isShared = !0;
   {
    photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.ALBUMS_VIEW && photoOrg.photoLib.isShared || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && photoOrg.photoLib.isShared;
   }
   e.frnds_sav = photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW ? !0 :!1;
   try {
    slideShowAssets_json = e.slides.toJSON();
   } catch (i) {
    slideShowAssets_json = e.albumResponse.assetIdList;
   }
   if ("share2.O" == e.accessType) {
    e.dc = t.entities[0].dataCenter;
    t = photoOrg.photoLib.formatSharedAlbumResponsedata(t, e);
    slideShowAssets_json = t.entities;
   }
   e.albumModel.firstAssetId = e.albumResponse.assetIdList[0];
   e.albumModel && e.albumModel.firstAssetId && e.albumModel.firstAssetId.assetId && o.where({
    assetId:e.albumModel.firstAssetId.assetId
   })[0] && slideShowAssets_json.unshift(o.where({
    assetId:e.albumModel.firstAssetId.assetId
   })[0].toJSON());
   var s = slideShowAssets_json[slideShowAssets_json.length - 1];
   slideShowAssets_json.push(s);
   var r = $("#slideshow-container").empty();
   photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW ? e.sharedWithMe = !0 :photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_ALBUM_VIEW && (e.isOwnedAndShared = e.socialResponse.friendsCount > 0);
   eventBus.off(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW);
   eventBus.on(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW, e.shareIndividualAlbum, e);
   photoOrg.slideshowViewController = new photoOrg.SlideshowViewController({
    el:r,
    collection:slideShowAssets_json,
    albumData:{
     title:e.albumModel.caption || "",
     ownerName:e.ownerName,
     lastName:e.lastName,
     sharedWithMe:e.sharedWithMe,
     isOwnedAndShared:e.isOwnedAndShared,
     sharedWithName:e.sharedWithName,
     isClassic:e.isClassic,
     shared:photoOrg.photoLib.isShared,
     albumId:e.albumId,
     likesCount:e.likesCount,
     likes:e.likes,
     view:e.view || "",
     ownerAccountId:e.albumModel.ownerAccountId,
     dataCenter:e.albumModel.dataCenter,
     friendsCount:e.friendsCount,
     date:e.firstAssetIdDate ? moment(e.firstAssetIdDate).format("MMM, YYYY") :"",
     description:decodeURIComponent(e.albumDescription),
     frnds_sav:e.frnds_sav,
     comments:e.comments
    },
    singleAlbumObj:e
   });
  } else e.getAlbumFetcher().getUnsharedSingleAlbum("", {
   albumId:e.albumId
  }, $.proxy(e.requestFirstAssetInAlbum, e), e.errorCallBack, e);
 },
 sharedFailRes:function(t) {
  console.log("Error occured while getting albim information, errr:" + t);
 },
 singleAlbumFailRes:function(t) {
  console.log("Error occured while getting albim information, errr:" + t);
 },
 getAssetText:function(t) {
  return t > 1 ? window.translations.asset_text.photos :window.translations.asset_text.photo;
 },
 singleAlbumSuccRes:function(t, e) {
  console.log("singleAlbumSuccRes method start..");
  if (t.entities.length <= 0) console.log("got empty array from assets api"); else {
   photoOrg.photoLib.clickedOnAlbumSlideShow = !0;
   var o = "";
   o = photoOrg.photoLib.accessType.owned;
   slideShowAssets = new photoOrg.pictCollection();
   _.each(t.entities, function(t) {
    if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) ; else if ("VIDEO" == t.assetType) return;
    var e = new photoOrg.pict(t);
    slideShowAssets.add(e);
   });
   slideShowAssets_json = slideShowAssets.toJSON();
   e.frnds_sav = photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   e.firstAssetIdDate = t.entities[0].createDate;
   if ("undefined" != typeof t.firstAssetId) {
    {
     t.firstAssetId.assetId;
    }
    slideShowAssets_json.unshift(t.firstAssetId);
   }
   e.albumModel && e.albumModel.firstAssetId && e.albumModel.firstAssetId.assetId && slideShowAssets_json.unshift(slideShowAssets_json[0]);
   slideShowAssets = slideShowAssets_json;
   eventBus.off(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW);
   eventBus.on(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW, e.shareIndividualAlbum, e);
   var i = {
    albumId:e.albumId,
    sortCriteria:"dateTaken",
    sortOrderParam:"sortOrder=ascending"
   };
   new AssetFetcher().getUnsharedSingleAlbum("", i, $.proxy(e.requestFirstAssetInAlbum, this), this.errorCallBack, e);
   photoOrg.photoLib.clickedOnAlbumSlideShow = !1;
   console.log("singleAlbumSuccRes method end");
  }
 },
 requestFirstAssetInAlbum:function(t, e) {
  console.log("requestFirstAssetInAlbum method start......");
  if (t.entities.length > 0) {
   console.log("got album response from assets api");
   e.albumResponse = t.entities[0];
  } else {
   console.log("got empty array from assets api");
   e.albumResponse = {};
  }
  var o = slideShowAssets[slideShowAssets.length - 1];
  slideShowAssets.push(o);
  var i = $("#slideshow-container").empty();
  photoOrg.slideshowViewController = new photoOrg.SlideshowViewController({
   el:i,
   collection:slideShowAssets,
   albumData:{
    title:e.albumModel.caption || "",
    ownerName:e.ownerName,
    lastName:e.lastName,
    sharedWithMe:!1,
    isOwnedAndShared:e.isOwnedAndShared,
    sharedWithName:e.sharedWithName,
    isClassic:e.isClassic,
    shared:!1,
    albumId:e.albumId,
    likesCount:e.likesCount,
    likes:e.likes,
    view:e.view || "",
    ownerAccountId:e.albumModel.ownerAccountId,
    dataCenter:e.albumModel.dataCenter,
    friendsCount:e.friendsCount,
    date:e.firstAssetIdDate ? moment(e.firstAssetIdDate).format("MMM, YYYY") :"",
    description:decodeURIComponent(e.albumModel.o_description),
    frnds_sav:e.frnds_sav,
    comments:e.comments
   },
   singleAlbumObj:e
  });
 },
 shareAlbum:function() {
  try {
   console.log("In shareAlbum method");
   eventBus.trigger(eventBus.CUSTOM_EVENT_SHARE, {
    shareType:"SINGLE_ALBUM_SHARE",
    shareData:{
     albumModel:this.albumResponse
    }
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:album_slide_show_controller:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getAssetFetcher:function() {
  if (this.assetFetcher) return this.assetFetcher;
  this.assetFetcher = new AssetFetcher();
  return this.assetFetcher;
 }
});

var photoOrg = photoOrg || {};

photoOrg.albumSelection = Backbone.View.extend({
 albumSelected:!0,
 dc:"",
 initialize:function(t) {
  this.albumId = t.albumId;
 },
 handleAlbumSelection:function() {
  console.log("single album success res");
  var t, e = photoOrg.photoLib.Util.historyState;
  t = e.pg && -1 !== e.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW) ? photoOrg.photoLib.accessType.share2 :e.pg && -1 !== e.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW) ? photoOrg.photoLib.accessType.myshared :photoOrg.photoLib.accessType.owned;
  var o = photoOrg.photoLib.albumModelList[this.albumId];
  if (photoOrg.photoLib.albumSelected) {
   photoOrg.Util.trackLinksAndButtons("albumSelection", "albumsPage");
   photoOrg.photoLib.seletedAlbums[this.albumId] = o;
   $.jStorage.set(gon.staticContent.account_id + "_selectedAlbums", photoOrg.photoLib.seletedAlbums);
  } else {
   photoOrg.Util.trackLinksAndButtons("albumUnSelection", "albumsPage");
   photoOrg.Util.deleteAndUpdateAlbumInfoInLocalStorage(this.albumId);
  }
  this.getAlbumData(this.albumId, o);
 },
 getAlbumData:function(t, e) {
  try {
   var o = this.getAssetFetcher();
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var i = {
    urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
    albumId:this.albumId,
    assetType:"ALL",
    sortOrderParam:"sortOrder=ascending"
   }; else var i = {
    urlparam:"&sortCriteria=dateTaken&assetType=PICTURE&sortOrder=ascending",
    albumId:this.albumId,
    assetType:"PICTURE",
    sortOrderParam:"sortOrder=ascending"
   };
   var s = photoOrg.photoLib.Util.historyState;
   if (s.pg && -1 !== s.pg.indexOf(photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW)) {
    this.accessType = photoOrg.photoLib.accessType.share2;
    i.ownerAccountId = e.ownerAccountId;
    i.dataCenter = e.dataCenter;
    o.getSharedSingleAlbumInfo("", i, $.proxy(this.sharedSuccRes, this), this.sharedFailRes, this);
   } else if (s.pg && -1 !== s.pg.indexOf(photoOrg.constants.MY_SHARED_ALBUM_VIEW)) {
    _this = this;
    this.accessType = photoOrg.photoLib.accessType.myshared;
    i.ownerAccountId = e.ownerAccountId;
    i.dataCenter = e.dataCenter;
    o.getSingleAlbumInfo("", i, this.singleAlbumResponse, this.singleAlbumFailRes, this);
   } else if (e.isShared) {
    this.accessType = photoOrg.photoLib.accessType.myshared;
    i.ownerAccountId = e.ownerAccountId;
    i.dataCenter = e.dataCenter;
    this.dc = e.dataCenter;
    o.getSharedSingleAlbumInfo("", i, $.proxy(this.sharedSuccRes, this), this.sharedFailRes, this);
   } else o.getSingleAlbumInfo("", i, this.singleAlbumSuccRes, this.singleAlbumFailRes, this);
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:albumSelection:getAlbumData", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 sharedFailRes:function(t) {
  photoOrg.jsErrorLogger('"LIBRARY:albumSelection:sharedFailRes", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  $("#loadingBar").hide();
 },
 singleAlbumFailRes:function(t) {
  photoOrg.jsErrorLogger('"LIBRARY:albumSelection:singleAlbumFailRes", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  $("#loadingBar").hide();
 },
 sharedSuccRes:function(t, e) {
  (this.accessType = photoOrg.photoLib.accessType.share2) && (t = this.formatSharedAlbumResponsedata(t, this));
  e.addImagesToTray(t.entities);
  console.log("sharedsuccres");
  photoOrg.photoLib.albumSelected = !1;
  $("#loadingBar").hide();
 },
 formatSharedAlbumResponsedata:function(t) {
  var e = {};
  e.entities = [];
  this.assetIdList = t.entities[1].assetIdList;
  for (var o = 0; o < t.entities[1].assetIdList.length; o++) e.entities.push(photoOrg.shareModelResponseFormat.prepareMockAssetObject(t.entities, this, o));
  e.resultCount = t.entities[1].assetIdList.length;
  e.totalEntitiesCount = t.entities[1].assetIdList.length;
  return e;
 },
 singleAlbumResponse:function(t, e) {
  e.addImagesToTray(t.entities);
  console.log("single alubm res");
  photoOrg.photoLib.albumSelected = !1;
  $("#loadingBar").hide();
 },
 singleAlbumSuccRes:function(t, e) {
  console.log("single alb succres");
  e.addImagesToTray(t.entities);
  photoOrg.photoLib.albumSelected = !1;
  $("#loadingBar").hide();
 },
 getAssetFetcher:function() {
  if (this.assetFetcher) return this.assetFetcher;
  this.assetFetcher = new AssetFetcher();
  return this.assetFetcher;
 },
 addImagesToTray:function(t) {
  console.log("In addImagesToTray method");
  for (var e = [], o = new photoOrg.pictCollection(), i = 0; i < t.length; i++) {
   void 0 == t[i].id && (t[i].id = t[i].assetId);
   e.push(t[i].id);
   o.add(t[i]);
  }
  _.each(e, function(t) {
   var e = o.get(t), i = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(t), !1);
   if (-1 == i) {
    if (photoOrg.photoLib.albumSelected) {
     $("#" + t + "po_sav").addClass("selected");
     photoOrg.photoLib.SelectedAsset.selectedAssets.add(e);
     photoOrg.photoLib.selectedImages.push(t);
     photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
     photoOrg.projectTrayView && photoOrg.projectTrayView.addAssetToTray({
      model:e
     });
     photoOrg.photoLib.seletedAlbums;
     void 0 != this.albumId && (void 0 == photoOrg.photoLib.selectedPicsFromAlb[e.id] ? photoOrg.photoLib.selectedPicsFromAlb[e.id] = this.albumId + "" :(photoOrg.photoLib.selectedPicsFromAlb[e.id] = photoOrg.photoLib.selectedPicsFromAlb[e.id] + "_" + this.albumId, 
     0));
     photoOrg.Util.updateSettingSelectedPics();
    } else {
     $("#" + t + "po_sav").removeClass("selected");
     photoOrg.photoLib.SelectedAsset.selectedAssets.remove(e);
     photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(t);
     photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, e.id);
     gon.staticContent.pict_ids = _.without(gon.staticContent.pict_ids, e.id);
     if (void 0 != this.albumId && photoOrg.photoLib.selectedPicsFromAlb[e.id]) {
      keys = photoOrg.photoLib.selectedPicsFromAlb[e.id].split("_");
      var s = keys.indexOf(this.albId + "");
      keys.splice(s, 1);
      keys = keys.join("_");
      photoOrg.photoLib.selectedPicsFromAlb[e.id] = keys;
      "" == keys && delete photoOrg.photoLib.selectedPicsFromAlb[e.id];
     }
     photoOrg.Util.updateSettingSelectedPics();
    }
    eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, e);
   }
  }, this);
 }
});

var photoOrg = photoOrg || {};

photoOrg.albumsViewController = Backbone.View.extend({
 albumsView:null,
 albumsCalendar:null,
 scrollContainer:null,
 enableScrollTimeout:0,
 af:null,
 currentPage:0,
 expanded:!1,
 expandedCluster:{},
 photoDetailClusterId:-1,
 expandableCluster:!1,
 clusterList:null,
 scrollDisabled:!0,
 scrollPadding:10,
 triggerResize:!0,
 updatedModel:void 0,
 pagesToLoad:2,
 firstCall:!0,
 initialize:function() {
  try {
   this.albumsCalendar = new photoOrg.albumsCalendarView({
    el:$("#jumpToMonth.ib-dropdown-menu")
   });
   photoOrg.albumsCalendar = this.albumsCalendar;
   this.albumsCalendar.$el.on("jumpToAlbumsMonth", $.proxy(this.goToJumpToMonth, this));
   this.scrollContainer = $("#right-well");
   this.af = photoOrg.AlbumFetcher;
   photoOrg.albumFetcherObj = this.af;
   $("#albumsort li a").on("click", $.proxy(this.changeSorting, this));
   if ((void 0 == photoOrg.photoLib.hideEmptyTray || 0 == photoOrg.photoLib.hideEmptyTray) && 0 == photoOrg.photoLib.selectedImages.length && !photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".lib-left-col").removeClass("hidden");
    this.scrollContainer.removeClass("full");
    $(".sub-header-wrapper").removeClass("full");
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 reset:function() {
  photoOrg.albumView.clear();
  this.expanded = !1;
  this.expandedCluster = {};
  this.currentPage = 0;
 },
 show:function() {
  this.firstCall = !1;
  this.albumsCalendar.$el.empty();
  this.setupPages();
 },
 hide:function() {
  this.disableScroll();
  this.albumsCalendar.$el.hide();
  this.reset();
  this.albumsCalendar.hide();
 },
 setupPages:function() {
  try {
   this.af.setupPages($.proxy(this.loadInitialPage, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:setupPages", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 loadInitialPage:function(t) {
  try {
   console.log("Loading album page initially...");
   this.albumsCalendar.createCalendar(t);
   if (!this.albumsCalendar.hasDates) {
    photoOrg.photoLib.showAndHideUploadTextDiv("show");
    this.hidePreloader();
    return;
   }
   photoOrg.photoLib.showAndHideUploadTextDiv("hide");
   photoOrg.preloadAlbums || this.getClusterPage($.proxy(function(t) {
    this.createClusters(t, null, !1);
    console.log("Loaded......albums page cluster wise : loadInitialPage");
   }, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:loadInitialPage", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 hidePreloader:function() {
  try {
   setTimeout(function() {
    this.enableScroll();
    this.triggerResize && !photoOrg.photoLib.config.loadAsPhotoPicker && $(window).trigger("resize");
    this.triggerResize = !0;
    $("#loadingBar").hide();
   }.bind(this), 2e3);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:hidePreloader", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 changeSorting:function(t) {
  console.log("Changing sort...");
  if (photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.ALBUMS_VIEW) try {
   var e = $(t.currentTarget);
   if (e.parent().hasClass("selected")) {
    photoOrg.reload = !0;
    return;
   }
   this.reset();
   var o = e.parent().attr("sortOrder"), i = e.parent().attr("sortCriteria");
   this.af.changeSortCriteria(o, i);
   photoOrg.Util.trackLinksAndButtons(this.sortOrder, "photosPage");
   $("#albumSorting").removeClass("open").css({
    left:"-99999px"
   });
   $(".album-sorting").removeClass("highlight");
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:changeToString", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 createClusters:function(t, e, o) {
  try {
   photoOrg.albumView.loadAlbums(t, photoOrg.albumView, e, o);
   var i = this.scrollContainer.scrollTop();
   this.updateScrollPosition(i);
   $("#loadingbar").hide();
   this.hidingAndShowTopSpinningWheel();
  } catch (s) {
   photoOrg.jsErrorLogger('"library:albums_view_controller:createclusters", errorcode="library:myalbums", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 loadPreviousPage:function() {
  try {
   photoOrg.loadPrevious = !0;
   var t = !1;
   try {
    t = this.isMonthAvailable(photoOrg.AlbumFetcher.pages[this.currentPage].clusters[0].date);
   } catch (e) {
    console.log("error in loadprevious album" + e);
    $("#bottomLoadingBar").hide();
    eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, photoOrg.albumView.enableAlbumScroll, photoOrg.albumView);
    this.currentPage = 0;
    return;
   }
   if (t) {
    this.currentPage--;
    eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, photoOrg.albumView.enableAlbumScroll, photoOrg.albumView);
    this.loadPreviousPage();
    return;
   }
   $("#loadingBar").show();
   this.hidingAndShowTopSpinningWheel();
   console.log("Calling getClusterPage in loadPreviousPage");
   this.getClusterPage(function(t) {
    this.createClusters(t, function() {
     console.log("Called..........getClusterPage in loadPreviousPage");
    }, !0);
   }.bind(this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:loadPreviousPage", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 loadNextPage:function() {
  try {
   photoOrg.loadPrevious = !1;
   var t = !1;
   try {
    t = this.isMonthAvailable(photoOrg.AlbumFetcher.pages[this.currentPage].clusters[0].date);
   } catch (e) {
    eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, photoOrg.albumView.enableAlbumScroll, photoOrg.albumView);
    $("#bottomLoadingBar").hide();
    return;
   }
   if (t) {
    this.currentPage + 1 != photoOrg.AlbumFetcher.pages.length && this.currentPage++;
    eventBus.off(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING);
    eventBus.on(eventBus.CUSTOM_EVENT_ALBUM_SCROLLING, photoOrg.albumView.enableAlbumScroll, photoOrg.albumView);
    this.loadNextPage();
    return;
   }
   console.log("Calling getClusterPage in loadNextPage");
   this.getClusterPage(function(t) {
    this.createClusters(t, function() {
     $("#bottomLoadingBar").show();
     console.log("Called..........getClusterPage in loadNextPage");
    });
   }.bind(this));
   return "";
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:loadNextPage", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 goToJumpToMonth:function(t, e, o) {
  try {
   console.log("JumpTo particular month...");
   this.isMonthAvailable(o) ? this.scrollToMonth(o, !0) :this.jumpToMonth(e, o);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:goToJumpToMonth", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 jumpToMonth:function(t, e) {
  try {
   console.log("JumpTo.....");
   var o = function(t) {
    $("#loadingBar").hide();
    console.log("Calling createClusters in jumpToMonth");
    this.createClusters(t, $.proxy(function() {
     console.log("Called........createClusters in jumpToMonth");
     var t = $("#" + photoOrg.photoLib.getKeyFromDate(e)), o = this.scrollContainer.scrollTop() + t.position().top;
     this.updateScrollPosition(o, !0);
    }, this));
   };
   this.expanded = !1;
   this.expandedCluster = {};
   var i = Math.abs(t - this.currentPage), s = this.currentPage;
   $("#loadingBar").show();
   if (this.currentPage > t || i > this.pagesToLoad) {
    photoOrg.albumView.clear();
    $("#loadingBar").show();
    this.currentPage = t;
    this.getClusterPage($.proxy(o, this));
   } else if (this.currentPage < t && i <= this.pagesToLoad) for (var r = s; t > r; r++) {
    this.currentPage = r + 1;
    this.getClusterPage($.proxy(o, this));
   }
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:jumpToMonth", errorCode="LIBRARY:MYALBUMS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 hidingAndShowTopSpinningWheel:function() {
  var t = photoOrg.AlbumFetcher.pages[0].clusters[0].date;
  if (this.isMonthAvailable(t)) {
   $("#TopLoadingBar").hide();
   return !1;
  }
  $("#TopLoadingBar").show();
  return !0;
 },
 scrollToMonth:function(t, e) {
  try {
   console.log("Scrolling JumpTo...");
   var o = $("#" + photoOrg.photoLib.getKeyFromDate(t)), i = this.scrollContainer.scrollTop() + o.position().top;
   this.updateScrollPosition(i, e);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:scrollToMonth", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 updateScrollPosition:function(t, e) {
  try {
   console.log("Updating scroll position based on JumpTo...");
   this.disableScroll();
   console.log(e);
   $("#TopLoadingBar").isOnScreen() && this.currentPage > 0 && !e && photoOrg.loadPrevious && (t = $("#TopLoadingBar").outerHeight());
   this.currentPage > 0 && 0 >= t ? t = this.scrollPadding :t >= this.getScrollBottom() && (t = this.getScrollBottom() - this.scrollPadding);
   this.scrollContainer.scrollTop(t);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:updateScrollPosition", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
  this.enableScroll();
 },
 isMonthAvailable:function(t) {
  var e = $("#" + photoOrg.photoLib.getKeyFromDate(t));
  return e.position() ? !0 :!1;
 },
 getScrollBottom:function() {
  return this.scrollContainer[0].scrollHeight - this.scrollContainer.height() - parseInt(photoOrg.albumView.$el.css("padding-bottom"), 10);
 },
 disableScroll:function() {
  this.scrollContainer.off("scrollstop");
 },
 enableScroll:function() {
  this.disableScroll();
  window.clearTimeout(this.timeoutID);
  this.timeoutID = window.setTimeout(function() {
   this.scrollContainer.on("scrollstop", {
    latency:500
   }, function() {
    photoOrg.photoLib.onScrollLoadPics();
   });
  }.bind(this), 800);
 },
 getClusterPage:function(t) {
  try {
   this.af.getClusterPage(this.currentPage, t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view_controller:getClusterPage", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.albumsCalendarView = Backbone.View.extend({
 label:null,
 dropdown:null,
 button:null,
 yearTemplate:null,
 monthTemplate:null,
 hasDates:!1,
 events:{
  "click .month-cluster":"loadClusterPage",
  "click .JumpTo":"loadClusterPage"
 },
 initialize:function() {
  this.button = $('[data-dropdown="jumpToMonth"]');
  this.label = this.button.find(".sort-option");
  this.dropdown = $("#jumpToMonth.f-dropdown");
  this.yearTemplate = JST["templates/common/library/album_view/album-calendar-year"];
  this.monthTemplate = JST["templates/common/library/cluster_view/cluster-calendar-month"];
 },
 show:function() {
  console.log("showing album JumpTo dropdown");
  this.button.css("display", "inline-block");
  this.button.hasClass("album-jumpto") || this.button.addClass("album-jumpto");
 },
 hide:function() {
  console.log("Hiding JumpTo dropdown");
  this.button.hide();
 },
 createCalendar:function(t) {
  try {
   console.log("Creating calendar...");
   this.$el.empty();
   if (!(this.hasDates = t.length > 0)) {
    this.hide();
    return;
   }
   for (var e = {}, o = 0; o < t.length; o++) for (var i = t[o], s = 0; s < i.clusters.length; s++) {
    var r, n, a = i.clusters[s], l = a.pageNo, c = a.date;
    if ("undefined" == c) {
     r = window.translations.unknown;
     n = window.translations.no_date;
    } else {
     r = moment(c, "YYYY-M-D").format("YYYY");
     n = moment(c, "YYYY-M-D").format("MMM");
    }
    if (!_.has(e, r)) {
     e[r] = [];
     this.$el.append(this.yearTemplate({
      year:r,
      page:l,
      date:c
     }));
    }
    if (!_.contains(e[r], n)) {
     e[r].push(n);
     $("#" + r + "-cluster").find("ul").append(this.monthTemplate({
      month:n,
      page:l,
      date:c
     }));
    }
   }
   this.hasDates && this.show();
   this.updateLabel(t[0].clusters[0].date);
  } catch (h) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_calendar_view:createCalendar", errorCode="LIBRARY:MYALBUMS", err_desc="' + h + '" err_stack="' + h.stack + '"');
  }
 },
 updateLabel:function(t) {
  console.log("Updating jumpTo label");
  var e = window.translations.no_date;
  "undefined" != t && (e = moment(t, "YYYY-M-D").format("MMM YYYY"));
  this.label.html(e);
 },
 loadClusterPage:function(t) {
  try {
   console.log("Loading Album page calendar");
   if (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.CLUSTER_VIEW) {
    var e = $(t.currentTarget), o = e.data("index"), i = e.data("date");
    this.$el.trigger("jumpToAlbumsMonth", [ o, i ]);
    this.updateLabel(i);
    this.dropdown.removeClass("open").addClass("close").css("left", "-99999px");
    this.button.removeClass("highlight");
   }
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_calendar_view:loadClusterPage", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.assetGridView = Backbone.View.extend({
 skip:5,
 limit:50,
 clusterAssets:0,
 reloadGridTimeout:0,
 clusterObj:null,
 favAssetsCount:0,
 initialize:function(t) {
  console.log("asset grid initialize...");
  this.collection = new photoOrg.pictCollection();
  eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE, this.close, this);
  eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.reloadGrid, this);
  eventBus.on(eventBus.CUSTOM_EVENT_ASSET_DELETED, $.proxy(this.onAssetDeleted, this));
  this.pict_ids = [];
  this.gridNotation = t.gridNotation;
  this.isAllPicsSelected = !1;
  this.clusterAssets = t.cluserAssets;
  this.clusterObj = t.clusterObj;
 },
 events:{},
 viewMore:function(t) {
  try {
   console.log("View More.....");
   $("#loadingBar").show();
   var e = t.currentTarget.id;
   e = e.split("_")[1];
   var o = e.replace("pg", "");
   if (photoOrg.Util.isMobileLayout()) {
    photoOrg.photoLib.current_state = photoOrg.photoLib.navType.singleAlbum;
    {
     this.createSingleClusterView(o);
    }
   } else {
    var i = "date=dateTaken&limit=" + this.limit + "&skip=" + this.skip, s = new AssetFetcher(), r = "";
    s.getMoreClusters(r, i, o, this.processResponse, this.errorCallBack, this);
    this.skip = this.skip + this.limit;
   }
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:viewMore", errorCode="LIBRARY:MYPHOTOS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 createSingleClusterView:function(t) {
  return new photoOrg.single_cluster_view({
   el:$("#single_cluster"),
   cluster_id:t,
   clusterAssets:this.clusterAssets
  });
 },
 processResponse:function(t, e) {
  e.addPictToPictCollection(t.entities);
 },
 errorCallBack:function() {},
 onAssetDeleted:function(t) {
  try {
   console.log("On Asset Deleted...");
   for (var e = t.length, o = this.pict_ids.length; o--; ) {
    var i = this.pict_ids[o];
    if (0 >= e) break;
    var s = photoOrg.photoLib.SelectedAsset.selectedAssets.get(i);
    void 0 != s && ("true" == photoOrg.photoLib.getValue(s.get("systemTags"), "isFavorite") || s.systemTags && "true" == photoOrg.photoLib.getValue(s.systemTags, "isFavorite")) && this.favAssetsCount++;
    for (var r = 0; r < t.length; r++) {
     var n = parseInt(t[r], 10);
     if (n === i) {
      this.pict_ids.splice(o, 1);
      e--;
     }
    }
   }
   var a = photoOrg.photoLib.Util.historyState;
   if (a.pg && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
    $("[data-btabname='av']").click();
    $("#loadingBar").hide();
    return;
   }
   if (this.pict_ids.length <= 0) {
    this.close();
    eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_GRID);
   }
  } catch (l) {
   console.log("Error removing asset from grid: ", l);
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:onAssetDeleted", errorCode="LIBRARY:MYPHOTOS", err_desc="' + l + '" err_stack="' + l.stack + '"');
  }
 },
 deletedAssetMatches:function(t) {
  try {
   console.log("Deleted Asset Matches...");
   for (var e = [], o = t.length, i = 0; i < this.pict_ids.length && !(0 >= o); i++) for (var s = 0; s < t.length; s++) {
    var r = parseInt(t[s], 10);
    if (r === this.pict_ids[i]) {
     e.push(r);
     o--;
    }
   }
   return e;
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:deleteAssetMatched", errorCode="LIBRARY:MYPHOTOS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 reloadGrid:function() {
  try {
   console.log("Reloading grid...");
   this.reloadGridTimeout && clearTimeout(this.reloadGridTimeout);
   this.reloadGridTimeout = setTimeout($.proxy(function() {
    $("#" + this.el.id).stop().collagePlus();
    console.log("stopped collagePlus");
   }, this), 200);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:reloadGrid", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 addPictToPictCollection:function(t) {
  try {
   console.log("Adding Pict to Pict collection...");
   this.isAllPicsSelected = !0;
   _.each(t, function(t) {
    var e = new photoOrg.pict(t);
    this.collection.add(e);
    photoOrg.photoLib.UserAssetsInfo.assetList.add(e);
    var o = this.getPictureView(e);
    if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) ; else if ("VIDEO" == o.model.attributes.assetType) return;
    photoOrg.photoLib.UserAssetsInfo.assetViewsMap[e.id] = o;
    var i = "";
    o && (i = o.render().el);
    $(this.el).append(i);
    -1 != _.indexOf(gon.staticContent.pict_ids, e.id, !1) && photoOrg.photoLib.config.loadAsPhotoPicker && o.clickOnAssetUnSelectIcon();
    this.pict_ids.push(e.id);
    photoOrg.photoLib.selectedImages.indexOf(e.id) < 0 && (photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.photoLib.defaultSelected.indexOf(e.id) < 0 && (this.isAllPicsSelected = !1) :this.isAllPicsSelected = !1);
   }, this);
   $("#" + this.el.id).stop().collagePlus();
   $("img.lazy").lazyload({
    effect:"fadeIn"
   });
   this.updateSelectAllWrapper();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:addPicttoPictcollection", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 updateSelectAllWrapper:function(t, e) {
  try {
   console.log("Updating SelectAll Wrapper...");
   if (photoOrg.photoLib.current_state != photoOrg.photoLib.navType.singleAlbum) {
    var o = $.jStorage.get(gon.staticContent.account_id + "_" + this.clusterObj.gridId) || 0;
    if (t) {
     o += e;
     $.jStorage.set(gon.staticContent.account_id + "_" + this.clusterObj.gridId, o);
    }
    o = parseInt(o) == this.clusterAssets;
    o ? $(".select-all" + this.gridNotation).closest(".select-all-wrapper").addClass("selected") :$(".select-all" + this.gridNotation).closest(".select-all-wrapper").removeClass("selected");
   }
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:updateSelectAllWrapper", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 getPictureView:function(t) {
  console.log("Getting Asset...");
  var e = new photoOrg.assetView({
   model:t,
   gridId:this.el.id,
   parentGridView:this,
   clusterObj:this.clusterObj
  });
  return e;
 },
 addToSelectedPictsFromAlb:function(t) {
  console.log("Adding to selected picts");
  if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
   photoOrg.photoLib.selectedPicsFromAlb[t.id] = photoOrg.photoLib.selectedPicsFromAlb[t.id] ? photoOrg.photoLib.selectedPicsFromAlb[t.id] + "_" + t.attributes.parentCollectionReferences[0].collectionId :t.attributes.parentCollectionReferences[0].collectionId + "";
   photoOrg.Util.updateSettingSelectedPics();
  }
 },
 deleteFromSelectedPictsFromAlb:function(t) {
  console.log("In deleteFromSelectedPictsFromAlb method");
  if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
   if (photoOrg.photoLib.selectedPicsFromAlb[t.id]) {
    keys = photoOrg.photoLib.selectedPicsFromAlb[t.id].split("_");
    var e = keys.indexOf(t.attributes.parentCollectionReferences[0].collectionId + "");
    keys.splice(e, 1);
    keys = keys.join("_");
    photoOrg.photoLib.selectedPicsFromAlb[t.id] = keys;
    "" == keys && delete photoOrg.photoLib.selectedPicsFromAlb[t.id];
   }
   photoOrg.Util.updateSettingSelectedPics();
  }
 },
 toggleGridSelection:function(t, e, o) {
  try {
   console.log("Toggling... Grid selection");
   if (e || !t) {
    this.selectAllClusterAssets(t, o);
    return;
   }
   _.each(this.pict_ids, function(e) {
    var o = this.collection.get(e), i = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(e), !1);
    if (-1 == i) {
     if (t) {
      if ("VIDEO" == o.attributes.assetType && photoOrg.photoLib.config.loadAsPhotoPicker) return;
      $("#" + e + "po_av").addClass("selected");
      photoOrg.photoLib.SelectedAsset.selectedAssets.add(o);
      photoOrg.photoLib.selectedImages.push(e);
      photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
      photoOrg.projectTrayView && photoOrg.projectTrayView.addAssetToTray({
       model:o
      });
      this.addToSelectedPictsFromAlb(o);
     } else {
      photoOrg.photoLib.hideEmptyTray = !0;
      $("#" + e + "po_av").removeClass("selected");
      photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(e);
      photoOrg.photoLib.SelectedAsset.selectedAssets.remove(o);
      photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, o.id);
      this.deleteFromSelectedPictsFromAlb(o);
     }
     eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, o);
    }
   }, this);
   t && !photoOrg.photoLib.config.loadAsPhotoPicker && (t ? $.jStorage.set(gon.staticContent.account_id + "_" + o.gridId, this.pict_ids.length) :$.jStorage.set(gon.staticContent.account_id + "_" + o.gridId, 0));
   this.showTotalSelectedAssets();
   gon.staticContent.pict_ids = photoOrg.photoLib.selectedImages;
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:toggleGridSelection", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 showTotalSelectedAssets:function() {
  try {
   console.log("In showTotalSelectedAssets method");
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    var t = window.translations.picker.photos_selected;
    $(".actionContainer .select_count .selectedImageCount").text(t.replace("{0}", photoOrg.photoLib.SelectedAsset.selectedAssets.length));
    if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
     $(".actionContainer .select_count .select_count_sec").hide();
     $(".photo-Org .picker-done-button").addClass("disable-greybtn");
    } else {
     $(".actionContainer .select_count .select_count_sec").show();
     $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
    }
   } else $("#po_photo_txt").text(photoOrg.photoLib.selectedImages.length > 1 ? window.translations.photos :window.translations.photo);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:showTotalSelectedAssets", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 redirectToOrderPrints:function(t) {
  console.log("Redirecting to prints builder");
  gon.staticContent.session_update = !1;
  var e = gon.staticContent.prints_builder_url + "?" + gon.staticContent.prints_sku_4x6 + "&clusterId=" + t.date;
  try {
   var o = $("#dateSorting .selected a").attr("data-value");
   void 0 != o && (e += "&date=" + o);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_grid_view:redirectToOrderPrints", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
  window.location.href = e;
 },
 selectAllClusterAssets:function(t, e) {
  console.log("SelectAll cluster......");
  var o = this;
  $("#loadingBar").show();
  photoOrg.ClusterFetcher.getCluster(0, e.entity.assetCount, e.date, $.proxy(function(i) {
   if (i) {
    for (var s = i.entities, r = s.length, n = 0; r > n; n++) {
     var a = s[n], l = new photoOrg.pict(a);
     if (t) {
      this.collection.add(l);
      this.pict_ids.push(l.id);
      photoOrg.photoLib.UserAssetsInfo.assetList.add(l);
      var c = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(l.id), !1);
      if (-1 == c) {
       $("#" + l.id + "po_av").addClass("selected");
       photoOrg.photoLib.SelectedAsset.selectedAssets.add(l);
       photoOrg.photoLib.selectedImages.push(l.id);
       photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
       photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.projectTrayView.addAssetToTray({
        model:l
       });
       eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, l);
      }
      this.pict_ids = _.uniq(this.pict_ids);
      o.addToSelectedPictsFromAlb(l);
      o.showTotalSelectedAssets();
     } else {
      var c = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(l.id), !1);
      if (-1 == c) {
       $("#" + l.id + "po_av").removeClass("selected");
       photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(l.id);
       photoOrg.photoLib.SelectedAsset.selectedAssets.remove(l);
       photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, l.id);
       eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, l);
      }
      o.deleteFromSelectedPictsFromAlb(l);
      o.showTotalSelectedAssets();
     }
    }
    t && !photoOrg.photoLib.config.loadAsPhotoPicker ? $.jStorage.set(gon.staticContent.account_id + "_" + e.gridId, this.pict_ids.length) :$.jStorage.set(gon.staticContent.account_id + "_" + e.gridId, 0);
   }
  }, this));
  $("#loadingBar").hide();
 },
 deSelectAllPictsInGrid:function() {},
 close:function() {
  eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.reloadGrid, this);
  eventBus.off(eventBus.CUSTOM_EVENT_ASSET_DELETED);
  $(window).off("resize", this.reloadGrid);
  this.unbind();
  this.remove();
 }
});

var photoOrg = photoOrg || {};

photoOrg.clusterView = Backbone.View.extend({
 selectAllButton:null,
 expandButtonTemplate:null,
 gridViews:{},
 pgv:null,
 date:"",
 entity:null,
 onNewPage:!1,
 updateExpandButton:!1,
 viewAllButtons:null,
 initialize:function(t) {
  _.bindAll(this, "render");
  console.log("cluster view initialize...");
  this.gridViews = {};
  this.gridId = "";
  this.gridNotation = "";
  this.date = t.date;
  this.entity = t.entity;
  this.onNewPage = t.onNewPage;
  this.updateExpandButton = t.updateExpandButton;
  this.expandButtonTemplate = JST["templates/common/library/cluster_view/cluster-expand-button"];
  eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_CLOSE, this.close, this);
  eventBus.on(eventBus.CUSTOM_EVENT_ASSET_DELETED, $.proxy(this.onAssetDeleted, this));
  photoOrg.photoLib.isFavorite = !1;
  this.createCluster();
 },
 events:{
  "click .select-all-wrapper":"selectAssets",
  "click .detail-view-trigger":"detailView",
  "click .th-video-ic":"detailView",
  "click .order-prints-btn":"redirectToPrints"
 },
 detailView:function(t) {
  console.log("Detail view triggered...");
  if (!photoOrg.photoLib.config.loadAsPhotoPicker) {
   var e = $(t.currentTarget).closest(".selectable-asset").attr("id").replace(/\D/g, "");
   e ? this.$el.trigger("clusterDetailView", [ this.date, this.entity, this, e ]) :photoOrg.jsWarningLogger('"Cluster_View : Unable to get ID for the selected asset : ID : ' + e + '"');
  }
 },
 updateEntity:function(t) {
  for (var e = t.get("id"), o = 0; o < this.entity.assetList.length; o++) if (this.entity.assetList[o].id == e) {
   $.extend(!0, this.entity.assetList[o], t.attributes);
   return;
  }
 },
 viewMore:function(t) {
  this.pgv.viewMore(t);
 },
 selectAssets:function() {
  try {
   console.log("Toggling Asset Selection");
   var t = this.toggleSelectAllButtonState();
   $("#cls_empty_tray").hide();
   $(".empty-tray-sec").hide();
   photoOrg.Util.trackLinksAndButtons("Select All", "photosPage");
   var e = this.gridViews[this.gridId], o = parseInt(this.entity.assetCount, 10) > photoOrg.ClusterFetcher.minAsset;
   e.toggleGridSelection(t, o, this);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:selectAssets", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 orderPrints:function() {
  try {
   console.log("Order prints...");
   {
    var t = this.gridViews[this.gridId];
    parseInt(this.entity.assetCount, 10) > photoOrg.ClusterFetcher.minAsset;
   }
   t.redirectToOrderPrints(this);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:OrderPrints", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 redirectToPrints:function() {
  try {
   console.log("Redirecting to Prints builder from cluster");
   var t = photoOrg.Util.getBrowserSessionCookie("GSID");
   if (!$.jStorage.get(gon.staticContent.account_id + "_" + t + "dont_show_conformation") && photoOrg.Util.isTouchDevice()) {
    photoOrg.printsConfirmation.init({
     orderPrints:$.proxy(this.orderPrints, this)
    });
    photoOrg.Util.trackLinksAndButtons("PhotosLibrary_ExpressPrints", "photosPage");
   } else {
    this.orderPrints();
    photoOrg.Util.trackLinksAndButtons("PhotosLibrary_ExpressPrints", "photosPage");
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:redirectToPrints", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 toggleSelectAllButtonState:function() {
  console.log("SelectAll toggling...");
  var t = this.selectAllButton, e = "selected", o = !1;
  if (t.hasClass(e)) t.removeClass(e); else {
   t.addClass(e);
   o = !0;
  }
  return o;
 },
 createCluster:function() {
  try {
   console.log("Creating cluster...");
   var t = this.date, e = this.entity, o = "cluster_" + t;
   this.gridNotation = "_" + t;
   if (void 0 == this.gridViews[o]) {
    var i, s;
    if ("undefined" === t) i = s = ""; else {
     var r = moment(t, "YYYY-M-D").format("Do").replace(/\d+|^\s+|\s+$/g, "");
     i = moment(t, "YYYY-M-D").format("dddd");
     var n = "MMM D[<sup>" + r + "</sup>,] YYYY";
     try {
      window.translations.clusterDateFormat && (n = window.translations.clusterDateFormat.replace("ordinal", r));
     } catch (a) {
      n = "MMM D[<sup>" + r + "</sup>,] YYYY";
     }
     s = moment(t, "YYYY-M-D").format(n);
    }
    var l = {
     date:t,
     day:i,
     full_date:s,
     assets:e.assetCount,
     gridNotation:this.gridNotation,
     onNewPage:this.onNewPage,
     show:!0
    };
    photoOrg.photoLib.config.loadAsPhotoPicker && (l.show = !1);
    var c = JST["templates/common/library/cluster_view/cluster-date-view"](l);
    this.$el.append(c);
    this.pgv = this.getPictureGridView("#pg" + t, parseInt(e.assetCount, 10));
    this.gridViews[o] = this.pgv;
   } else this.pgv = this.gridViews[o];
   this.gridId = o;
   this.pgv.addPictToPictCollection(e.assetList);
   this.selectAllButton = this.$el.find(".select-all-wrapper");
   this.$el.find(".selectable-asset:last-child").append(this.expandButtonTemplate({
    disabled:this.entity.assetCount <= photoOrg.ClusterFetcher.minAsset
   }));
   this.viewAllButtons = this.$el.find(".view-all-button");
   this.viewAllButtons.on("click", $.proxy(this.onExpandButtonClick, this));
   this.updateViewAllButtons();
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:createCluster", errorCode="LIBRARY:MYPHOTOS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 updateViewAllButtons:function() {
  console.log("Updating ViewAll button...");
  if (this.updateExpandButton) {
   this.viewAllButtons.addClass("selected");
   this.viewAllButtons.filter(".view-more-small").find("span").text(window.translations.albumManagement.view_less);
   photoOrg.photoLib.config.loadAsPhotoPicker && this.viewAllButtons.filter(".view-more").find("span").text(window.translations.albumManagement.view_less);
   for (var t = 0; t < this.entity.assetList.length; t++) {
    var e = this.entity.assetList[t];
    e.isLastAsset && this.viewAllButtons.filter(".view-more-small").removeClass("disable-button");
   }
  } else this.viewAllButtons.filter(".view-more-small").removeClass("disable-button");
  this.entity.assetCount > photoOrg.ClusterFetcher.minAsset && this.viewAllButtons.filter(".view-more").removeClass("disable-button");
 },
 onExpandButtonClick:function() {
  try {
   console.log("Expanding cluster ViewAll...");
   $("#assetGrid").trigger("expandClusters", [ this ]);
   photoOrg.Util.trackLinksAndButtons("View All", "photosPage");
   if (this.viewAllButtons.hasClass("selected")) {
    this.viewAllButtons.removeClass("selected");
    this.viewAllButtons.filter(".view-more-small").find("span").text(window.translations.albumManagement.view_all);
   } else {
    this.viewAllButtons.addClass("selected");
    this.viewAllButtons.filter(".view-more-small").find("span").text(window.translations.albumManagement.view_less);
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:onExpandButtonClick", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getPictureGridView:function(t, e) {
  return new photoOrg.assetGridView({
   el:t,
   gridNotation:this.gridNotation,
   cluserAssets:e,
   clusterObj:this
  });
 },
 onAssetDeleted:function(t) {
  try {
   console.log("In onAssetDeleted method");
   var o = this.gridViews[this.gridId], i = o.deletedAssetMatches(t);
   if (i.length > 0) {
    var s = this.$el.find(".monthbar .photoscount"), r = s.text();
    if (!r) return;
    r = parseInt(r.split(" ")[0], 10);
    if (r === i.length) {
     this.close();
     return;
    }
    for (var n = 0; n < i.length; n++) {
     var a = r - 1 > 1 ? window.translations.asset_text.photos :window.translations.asset_text.photo;
     r > 0 ? s.text(r + " " + a) :this.close();
    }
   }
  } catch (l) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:onAssetsDeleted", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
   console.log("Error updating asset count", l);
  }
 },
 close:function() {
  eventBus.off(eventBus.CUSTOM_EVENT_ASSET_DELETED);
  this.unbind();
  this.remove();
  this.$el.empty();
 }
});

var photoOrg = photoOrg || {};

photoOrg.clustersView = Backbone.View.extend({
 clusterTemplate:null,
 callbackTimeout:0,
 initialize:function() {
  console.log("clusters view initialize...");
  this.clusterTemplate = JST["templates/common/library/cluster_view/cluster-template"];
  eventBus.on(eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE, this.updateAssetView, this);
 },
 createClusters:function(t, e) {
  try {
   console.log("Creating clusters...");
   {
    _.size(t);
   }
   photoOrg.photoLib.selectedImages.length > 0 && $("#cls_empty_tray").hide();
   _.each(t, function(t, e) {
    if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) this.$el.append(this.clusterTemplate({
     date:e
    })); else {
     var o = 0;
     _.each(t.assetList, function(t) {
      "VIDEO" == t.assetType && o++;
     });
     console.log(o);
     if (t.assetList.length == o) return;
     this.$el.append(this.clusterTemplate({
      date:e
     }));
    }
    var i = t.assetList[0];
    if (i) {
     var s = !1;
     i.inExpandedCluster && (s = !0);
     {
      new photoOrg.clusterView({
       el:$("#cluster_" + e),
       date:e,
       entity:t,
       onNewPage:i.onNewPage || !1,
       updateExpandButton:s
      });
     }
    } else console.log("continue the loop when assetList for that cluster is empty : for date : " + e + ", accountId : " + gon.staticContent.account_id);
   }, this);
   $("img.lazy").lazyload({
    effect:"fadeIn",
    container:$("#right-well")
   });
   this.callbackTimeout && clearTimeout(this.callbackTimeout);
   e && (this.callbackTimeout = setTimeout(e, 200));
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view:createClusters", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 updateAssetView:function(t) {
  console.log("Updating Asset View for any operation performed on asset");
  var e = photoOrg.photoLib.UserAssetsInfo.assetViewsMap[t.model.get("id")];
  e && e.updateAssetView(t.model);
 },
 clear:function() {
  this.$el.empty();
 }
});

var photoOrg = photoOrg || {};

photoOrg.single_cluster_view = Backbone.View.extend({
 el:"#single_cluster",
 cluster_id:null,
 skip:0,
 limit:15,
 collection:null,
 viewMap:null,
 coverImage:"",
 clusterAssets:0,
 initialize:function(t) {
  console.log("single_cluster view");
  this.collection = new photoOrg.pictCollection();
  this.viewMap = {};
  this.cluster_id = t.cluster_id;
  this.clusterAssets = t.clusterAssets;
  $("#single_cluster").empty();
  this.render();
  eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
 },
 events:{
  "click #savAssetOperationsArea .close":"backT0AllClusters",
  "click #single_album_grid .view-more":"getClusterInfo"
 },
 render:function() {
  this.hideSubheader();
  this.getClusterInfo();
 },
 resize:function() {
  $("#single_album_grid").collagePlus();
 },
 getClusterInfo:function() {
  console.log("Getting cluster Info...");
  var t = "date=" + photoOrg.photoLib.Util.clusterView.sortEntry + "&limit=" + this.limit + "&skip=" + this.skip, e = new AssetFetcher(), o = "";
  if (0 == this.skip) e.getMoreClusters(o, t, this.cluster_id, this.processResponse, this.errorCallBack, this); else {
   $("#loadingBar").show();
   e.getMoreClusters(o, t, this.cluster_id, this.addAssetsToView, this.errorCallBack, this);
  }
  this.skip = this.skip + this.limit;
 },
 processResponse:function(t, e) {
  console.log("single_cluster_view--processResponse:" + t);
  if (void 0 != t) {
   $("#assetGrid").hide();
   $("#single_cluster").show();
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.reset();
   var o = e.clusterAssets + " photos";
   e.coverImage = photoOrg.Util.getTnlURLFromArray(photoOrg.photoLib.getLowORHires(t.entities[0].files).url, t.entities[0].id);
   var i = {
    assets:o,
    cover_photo_url:e.coverImage,
    caption:e.cluster_id
   }, s = JST["templates/common/library/cluster_view/single-cluster-head"](i);
   $(e.el).append(s);
   e.selectAllButton = $(e.el).find(".select-all-wrapper");
   e.selectAllButton.off("click", $.proxy(e.selectAssets, e));
   e.selectAllButton.on("click", $.proxy(e.selectAssets, e));
   e.addAssetsToView(t, e);
  }
 },
 addAssetsToView:function(t, e) {
  console.log("single_cluster_view--addAssetsToView");
  _.each(t.entities, function(t) {
   var o = new photoOrg.pict(t);
   e.collection.add(o);
   var i = e.getPictureView(o);
   e.viewMap[o.id] = i;
   $("#single_album_grid").append(i.render().el);
   photoOrg.photoLib.selectPicts(o.id, i);
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.add(o);
  }, e);
  $("#single_album_grid").find(".view-more") && $("#single_album_grid .view-more").remove();
  $("#single_album_grid").collagePlus();
  $("#loadingBar").hide();
  !photoOrg.photoLib.showClusterView || t.entities.length < e.limit || $("#single_album_grid").append("<button class='view-more'> <span>" + (e.clusterAssets - e.skip) + "</span><span>more</span></button>");
  try {
   $("img.lazy").lazyload({
    effect:"fadeIn",
    container:$(e.el).find(".scroll_sav_grid")
   });
  } catch (o) {}
 },
 getPictureView:function(t) {
  var e = new photoOrg.assetView({
   model:t,
   type:"sav",
   accessType:"owned"
  });
  return e;
 },
 errorCallBack:function() {
  console.log("single_cluster_view--errorCallBack");
 },
 hideSubheader:function() {
  $("#sub_header_container").hide();
  $("#library").addClass("subheader-hidden");
 },
 backT0AllClusters:function() {
  console.log("single_cluster_view--backT0AllClusters");
  $("#single_cluster").hide();
  $("#assetGrid").show();
  $("#sub_header_container").show();
  $("#library").removeClass("subheader-hidden");
  photoOrg.photoLib.current_state = photoOrg.photoLib.navType.photosAndVideos;
  eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, {});
 },
 selectAssets:function(t) {
  console.log("single_cluster_view--selectAssets");
  var e = $(t.currentTarget).find(".ib-checkmark"), o = this.toggleSelectAllButtonState(e);
  if (o) {
   this.selectAllVisibleAssets();
   e.addClass("checkmark-blue");
  } else {
   this.deSelectAllVisibleAssets();
   e.removeClass("checkmark-blue");
  }
 },
 toggleSelectAllButtonState:function(t) {
  console.log("single_cluster_view--toggleSelectAllButtonState");
  var e = "checkmark-blue", o = !1;
  if (t.hasClass("checkmark-blue")) t.removeClass(e); else {
   t.addClass(e);
   o = !0;
  }
  return o;
 },
 deSelectAllVisibleAssets:function() {
  console.log("single_cluster_view--deSelectAllVisibleAssets");
  photoOrg.photoLib.deSelectAllVisibleImagesClicked = !0;
  if (void 0 != this.viewMap && Object.keys(this.viewMap).length > 0) for (var t = 0; t < Object.keys(this.viewMap).length; t++) {
   var e = Object.keys(this.viewMap)[t], o = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(e), !1), i = _.indexOf(photoOrg.photoLib.selectedImages, parseInt(e), !1);
   -1 == o && -1 != i && $("#" + e + "po_sav").hasClass("selected") && this.viewMap[e].clickOnAssetSelectIcon();
  }
  photoOrg.photoLib.Util.isTouchDevice() || $("#album_assets img").prev().removeClass("unselectAsset");
  photoOrg.photoLib.deSelectAllVisibleImagesClicked = !1;
 },
 selectAllVisibleAssets:function() {
  console.log("single_cluster_view--selectAllVisibleAssets");
  photoOrg.photoLib.isSelectAllVisibleImagesClicked = !0;
  if (void 0 != this.viewMap && Object.keys(this.viewMap).length > 0) for (var t in this.viewMap) if (!$("#" + t + "po_sav").hasClass("selected")) {
   var e = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(t), !1);
   -1 == e && this.viewMap[t].clickOnAssetUnSelectIcon();
  }
  photoOrg.photoLib.isSelectAllVisibleImagesClicked = !1;
 }
});

var photoOrg = photoOrg || {};

photoOrg.clustersCalendarView = Backbone.View.extend({
 label:null,
 dropdown:null,
 button:null,
 yearTemplate:null,
 monthTemplate:null,
 hasDates:!1,
 events:{
  "click .month-cluster":"loadClusterPage"
 },
 initialize:function() {
  console.log("clusters calendar view initialize...");
  this.button = $('[data-dropdown="jumpToMonth"]');
  this.label = this.button.find(".sort-option");
  this.dropdown = $("#jumpToMonth.f-dropdown");
  this.yearTemplate = JST["templates/common/library/cluster_view/cluster-calendar-year"];
  this.monthTemplate = JST["templates/common/library/cluster_view/cluster-calendar-month"];
 },
 show:function() {
  console.log("In show method");
  this.button.hasClass("album-jumpto") && this.button.removeClass("album-jumpto");
  this.button.css("display", "inline-block");
 },
 hide:function() {
  console.log("In hide method");
  this.button.hide();
 },
 createCalendar:function(t) {
  try {
   console.log("Creating Calendar......");
   if (!(this.hasDates = t.length > 0)) {
    this.hide();
    return;
   }
   this.hasDates && this.show();
   this.$el.empty();
   this.updateLabel(t[0].clusters[0].date);
   for (var e = {}, o = 0; o < t.length; o++) for (var i = t[o], s = 0; s < i.clusters.length; s++) {
    var r, n, a = i.clusters[s], l = a.pageNo, c = a.date;
    if ("undefined" == c) {
     r = window.translations.unknown;
     n = window.translations.no_date;
    } else {
     r = moment(c, "YYYY-M-D").format("YYYY");
     n = moment(c, "YYYY-M-D").format("MMM");
    }
    if (!_.has(e, r)) {
     e[r] = [];
     this.$el.append(this.yearTemplate({
      year:r
     }));
    }
    if (!_.contains(e[r], n)) {
     e[r].push(n);
     $("#" + r + "-cluster").find("ul").prepend(this.monthTemplate({
      month:n,
      page:l,
      date:c
     }));
    }
   }
  } catch (h) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_view:createCalendar", errorCode="LIBRARY:MYPHOTOS", err_desc="' + h + '" err_stack="' + h.stack + '"');
  }
 },
 updateLabel:function(t) {
  var e = window.translations.no_date;
  "undefined" != t && (e = moment(t, "YYYY-M-D").format("MMMM YYYY"));
  this.label.html(e);
  console.log("updatedLabel=" + e);
 },
 loadClusterPage:function(t) {
  try {
   console.log("loading... cluster page...");
   var e = $(t.currentTarget), o = e.data("index"), i = e.data("date");
   this.$el.trigger("jumpToMonth", [ o, i ]);
   this.updateLabel(i);
   this.dropdown.removeClass("open").addClass("close").css("left", "-99999px");
   this.button.removeClass("highlight");
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:cluster_calendar_view:loadClusterPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.clustersViewController = Backbone.View.extend({
 clustersView:null,
 clustersCalendar:null,
 scrollContainer:null,
 enableScrollTimeout:0,
 cf:null,
 currentPage:0,
 expanded:!1,
 expandedCluster:{},
 photoDetailClusterId:-1,
 hidePreloaderTimeout:0,
 expandableCluster:!1,
 clusterList:null,
 scrollDisabled:!0,
 scrollPadding:10,
 triggerResize:!0,
 updatedModel:void 0,
 initialize:function() {
  try {
   console.log("clusters view controller initialize...");
   var t = $("#assetGrid");
   this.clustersView = new photoOrg.clustersView({
    el:t
   });
   t.on("expandClusters", $.proxy(this.handleExpandClusters, this));
   t.on("clusterDetailView", $.proxy(this.detailView, this));
   this.clustersCalendar = new photoOrg.clustersCalendarView({
    el:$("#jumpToMonth.ib-dropdown-menu")
   });
   photoOrg.clusterCalendar = this.clustersCalendar;
   this.clustersCalendar.$el.on("jumpToMonth", $.proxy(this.handleJumpToMonth, this));
   this.scrollContainer = $("#right-well");
   this.cf = photoOrg.ClusterFetcher;
   photoOrg.clusterFetcherObj = this.cf;
   this.clusterList = photoOrg.photoLib.UserAssetsInfo.clusterList;
   $("#dateSorting li a").on("click", $.proxy(this.changeSorting, this));
   eventBus.on(eventBus.CUSTOM_EVENT_ASSET_UNSELECTED, this.assetUnselected, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_ASSETS, this.removeSelectedAssets, this);
   eventBus.on(eventBus.CUSTOM_EVENT_FILTER_RESET, this.getAssetsByUserInput, this);
   eventBus.on(eventBus.CUSTOM_EVENT_UPDATE_GRID, this.updateGrid, this);
   eventBus.on(eventBus.CUSTOM_EVENT_DETAILED_ASSET_SELECT_ICON_CLICKED, this.detailsViewAssetSelectIconClicked, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE, this.updateAssetView, this);
   if ((void 0 == photoOrg.photoLib.hideEmptyTray || 0 == photoOrg.photoLib.hideEmptyTray) && 0 == photoOrg.photoLib.selectedImages.length && !photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".lib-left-col").removeClass("hidden");
    $("#right-well").removeClass("full");
    $(".sub-header-wrapper").removeClass("full");
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:initialize", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 updateAssetView:function(t) {
  try {
   console.log("updated");
   this.clusterList.set(t.model, {
    merge:!0,
    remove:!1
   });
   this.updatedModel = t.model;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:updateAssetView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 detailView:function(t, e, o, i, s) {
  try {
   photoOrg.photoLib.current_state = photoOrg.photoLib.navType.photosAndVideos;
   this.showPreloader();
   this.photoDetailClusterId = parseInt(s);
   photoOrg.photoLib.totalAssetCount = parseInt(o.assetCount);
   if (o.assetCount > this.cf.minAsset) {
    this.expandedCluster.date !== e && this.expandCluster(i);
    this.expandableCluster = !0;
    var r = this.cf.expandedPages[e].pageNo;
    this.cf.getClusterDetailView(e, r, $.proxy(this.createClusterList, this));
   } else {
    this.expandableCluster = !1;
    var n = parseInt(o.assetCount);
    this.cf.getDetailedViewInfo(n, e, $.proxy(this.createClusterList, this));
   }
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:detailView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 createClusterList:function(t) {
  try {
   this.clusterList.reset();
   var e = [];
   e = t.entities;
   _.each(e, function(t) {
    this.addToClusterList(t, e.length);
   }, this);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:createClusterList", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 addToClusterList:function(t, e) {
  try {
   var o = new photoOrg.pict(t);
   this.clusterList.add(o);
   if (e !== this.clusterList.length) return;
   var i = this.clusterList.get(this.photoDetailClusterId);
   if (!i) {
    photoOrg.jsWarningLogger("Getting null model for selected picture id : " + this.photoDetailClusterId);
    return;
   }
   this.openDetailView(i);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:updateAssetView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 openDetailView:function(t) {
  try {
   console.log("Opening Detail View...");
   this.updatedModel && this.updatedModel.id == t.id && t.set(this.updatedModel.toJSON());
   this.triggerResize = !1;
   this.hidePreloader();
   $("#detailedViewContainer").empty();
   var e = photoOrg.photoLib.accessType.owned, o = .7 * $(window).height(), i = {
    modelId:t.id,
    detailedViewHeight:o,
    accessType:e
   }, s = JST["templates/common/library/detail_view/detailed-view-container"](i);
   $("#detailedViewContainer").html(s);
   photoOrg.detailedView = new photoOrg.DetailedView({
    el:"#detailedView_" + t.id,
    model:t,
    accessType:e
   });
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:openDetailView", errorCode="LIBRARY:MYPHOTOS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 show:function() {
  this.clustersView.$el.show();
  this.setupPages();
  this.clustersCalendar.hasDates && this.clustersCalendar.show();
 },
 setSortOrderTojStorage:function() {
  $.jStorage.set(gon.staticContent.account_id + "_" + photoOrg.photoLib.Util.historyState.pg + "_sortCriteria", this.cf.sortCriteria);
 },
 hide:function() {
  this.disableScroll();
  this.clustersView.$el.hide();
  this.reset();
  this.clustersCalendar.hide();
 },
 setupPages:function() {
  try {
   this.cf.setupPages($.proxy(this.loadInitialPage, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:setupPages", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 reset:function() {
  this.clustersView.clear();
  this.expanded = !1;
  this.expandedCluster = {};
  this.currentPage = 0;
 },
 loadInitialPage:function(t) {
  try {
   this.clustersCalendar.createCalendar(t);
   if (!this.clustersCalendar.hasDates) {
    photoOrg.photoLib.showAndHideUploadTextDiv("show");
    this.hidePreloader();
    return;
   }
   $("#sub_header_container").show();
   photoOrg.photoLib.showAndHideUploadTextDiv("hide");
   this.getClusterPage($.proxy(function(t) {
    this.createClusters(t, null, !0);
   }, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:loadInitialPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 changeSorting:function(t) {
  try {
   console.log("In changeSorting method");
   var e = $(t.currentTarget);
   if (!e.parent().hasClass("selected")) {
    var o = e.data("value");
    this.hide();
    this.cf.sortCriteria = o;
    this.setSortOrderTojStorage();
    this.cf.changeSortCriteria(o);
    console.log("Changed sort option = " + o);
    photoOrg.Util.trackLinksAndButtons(o, "photosPage");
   }
   $("#dateSorting").removeClass("open").css({
    left:"-99999px"
   });
   $(".date-sorting").removeClass("highlight");
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:changeToString", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 getClusterPage:function(t) {
  try {
   this.showPreloader();
   photoOrg.photoLib.isBulkDelete && !this.cf.expandedPages[this.expandedCluster.date] && (this.expanded = !1);
   this.expanded ? this.cf.getClusterExpandedPage(this.expandedCluster.date, this.currentPage, t) :this.cf.getClusterPage(this.currentPage, t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:getClusterPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 createClusters:function(t, e, o) {
  try {
   this.clustersView.clear();
   this.clustersView.createClusters(t, e);
   this.hidePreloader();
   o && this.enableScroll();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:createClusters", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 onScroll:function() {
  try {
   if (this.scrollDisabled || this.cf.totalAssetCount < this.cf.assetsPerPage) return;
   if (this.scrolledToTop()) {
    this.loadPreviousPage();
    console.log("Previous Page loaded.....");
   } else if (this.scrolledToBottom()) {
    this.loadNextPage();
    console.log("Next Page loaded.....");
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:onScroll", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getClusters:function() {
  return this.clustersView.$el.children();
 },
 getScrollBottom:function() {
  return this.scrollContainer[0].scrollHeight - $("#right-well").height() - parseInt(this.clustersView.$el.css("padding-bottom"), 10);
 },
 lastClusterIsExpanded:function() {
  return this.expanded && this.expandedCluster && this.getClusters().last().attr("id").indexOf(this.expandedCluster.date) >= 0;
 },
 firstClusterIsExpanded:function() {
  return this.expanded && this.expandedCluster && this.getClusters().first().attr("id").indexOf(this.expandedCluster.date) >= 0;
 },
 loadPreviousPage:function() {
  try {
   if (this.currentPage <= 0) {
    this.currentPage = 0;
    return;
   }
   this.currentPage--;
   this.getClusterPage($.proxy(function(t) {
    this.createClusters(t, $.proxy(function() {
     this.lastClusterIsExpanded() ? this.scrollToLastExpandedCluster() :this.scrollToPreviousPage();
    }, this));
   }, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:loadPreviousPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 loadNextPage:function() {
  try {
   if (this.expanded && this.currentPage >= this.cf.expandedPages[this.expandedCluster.date].pages.length - 1) this.currentPage = this.cf.expandedPages[this.expandedCluster.date].pages.length - 1; else if (!this.expanded && this.currentPage >= this.cf.pages.length - 1) this.currentPage = this.cf.pages.length - 1; else {
    this.currentPage++;
    this.getClusterPage($.proxy(function(t) {
     this.createClusters(t, $.proxy(function() {
      this.firstClusterIsExpanded() ? this.scrollToFirstExpandedCluster() :this.scrollToNextPage();
     }, this));
    }, this));
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clustesr_view_controller:loadNextPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 disableScroll:function() {
  if (!this.scrollDisabled) {
   this.scrollDisabled = !0;
   this.scrollContainer.off("scroll", $.proxy(this.onScroll, this));
  }
 },
 enableScroll:function() {
  if (this.scrollDisabled) {
   this.scrollDisabled = !1;
   this.enableScrollTimeout && clearTimeout(this.enableScrollTimeout);
   this.enableScrollTimeout = setTimeout($.proxy(function() {
    this.scrollContainer.on("scroll", $.proxy(this.onScroll, this));
   }, this), 200);
  }
 },
 handleExpandClusters:function(t, e) {
  try {
   this.expandedCluster.date === e.date ? this.collapseCluster(e) :this.expandCluster(e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:handleExpandClusters", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 expandCluster:function(t) {
  try {
   this.expanded = !0;
   this.expandedCluster = t;
   this.currentPage = this.cf.expandedPages[this.expandedCluster.date].pageNo;
   {
    this.clustersView.$el.children();
   }
   this.getClusterPage($.proxy(function(e) {
    var o = this.scrollContainer.scrollTop();
    this.createClusters(e, $.proxy(function() {
     var e = $("#cluster_" + t.date);
     e.length && (o = this.scrollContainer.scrollTop() + e.position().top);
     this.updateScrollPosition(o);
    }, this));
   }, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:ExpandCluster", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 collapseCluster:function(t) {
  try {
   this.expanded = !1;
   this.expandedCluster = {};
   this.currentPage = this.cf.expandedPages[t.date].pageNo;
   this.getClusterPage($.proxy(function(e) {
    this.createClusters(e, $.proxy(function() {
     var e = $("#cluster_" + t.date), o = 0;
     e.length && (o = this.scrollContainer.scrollTop() + e.position().top);
     this.updateScrollPosition(o);
    }, this));
   }, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:collapseClusters", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 handleJumpToMonth:function(t, e, o) {
  if (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.ALBUMS_VIEW) try {
   this.currentPage === e ? this.scrollToMonth(o) :this.jumpToMonth(e, o);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:handleJumpTOMonth", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 jumpToMonth:function(t, e) {
  try {
   this.expanded = !1;
   this.expandedCluster = {};
   this.currentPage = t;
   this.getClusterPage($.proxy(function(t) {
    this.createClusters(t, $.proxy(function() {
     var t = $("#cluster_" + e), o = this.scrollContainer.scrollTop() + t.position().top;
     this.updateScrollPosition(o);
    }, this));
   }, this));
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:jumpToMonth", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 scrollToMonth:function(t) {
  try {
   this.disableScroll();
   var e = $("#cluster_" + t), o = this.scrollContainer.scrollTop() + e.position().top;
   this.updateScrollPosition(o);
   this.enableScroll();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:scrollToMonth", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 showPreloader:function() {
  try {
   this.disableScroll();
   $("#loadingBar").show();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:showPreLoader", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 hidePreloader:function() {
  try {
   this.hidePreloaderTimeout && clearTimeout(this.hidePreloader);
   this.hidePreloaderTimeout = setTimeout($.proxy(function() {
    this.enableScroll();
    this.triggerResize && !photoOrg.photoLib.config.loadAsPhotoPicker && $(window).trigger("resize");
    this.triggerResize = !0;
    $("#loadingBar").hide();
   }, this), 2e3);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:hidePreloader", errorCode="LIBRARY:MYPHOTOS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 scrolledToTop:function() {
  return 0 === this.scrollContainer.scrollTop();
 },
 scrolledToBottom:function() {
  return this.scrollContainer[0].scrollHeight - this.scrollContainer.scrollTop() - this.scrollContainer.outerHeight() <= 3 ? !0 :!1;
 },
 scrollToLastExpandedCluster:function() {
  try {
   var t = this.getScrollBottom(), e = $("#cluster_" + this.expandedCluster.date), o = e.find(".timeline-grid"), i = o.children(), s = Math.max(0, i.length - 1 - this.cf.expandedClusterPadding), r = i.eq(s), n = e.outerHeight(!0) - r.position().top;
   t -= n;
   this.updateScrollPosition(t);
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:scrollToLastExpandedCluster", errorCode="LIBRARY:MYPHOTOS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 scrollToFirstExpandedCluster:function() {
  try {
   var t = 0, e = $("#cluster_" + this.expandedCluster.date), o = e.find(".timeline-grid"), i = o.children(), s = Math.min(this.cf.expandedClusterPadding - 1, i.length - 1), r = i.eq(s);
   t += r.position().top;
   this.updateScrollPosition(t);
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:scrollToFirstExpandedCluster", errorCode="LIBRARY:MYPHOTOS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 scrollToPreviousPage:function() {
  try {
   for (var t = this.getScrollBottom(), e = this.cf.clusterPadding; e--; ) {
    var o = this.getClusters(), i = o.eq(o.length - 1 - e);
    i && (t -= i.outerHeight(!0));
   }
   this.updateScrollPosition(t);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:scrollToPreviousPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 scrollToNextPage:function() {
  try {
   for (var t = 0, e = this.getClusters(), o = this.cf.clusterPadding; o--; ) {
    var i = e.eq(o);
    i && (t += i.outerHeight(!0));
   }
   this.updateScrollPosition(t);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:scrollToNextPage", errorCode="LIBRARY:MYPHOTOS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 updateScrollPosition:function(t) {
  try {
   this.currentPage > 0 && 0 >= t ? t = this.scrollPadding :t >= this.getScrollBottom() && (t = this.getScrollBottom() - this.scrollPadding);
   this.scrollContainer.scrollTop(t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:updateScrollPosition", errorCode="LIBRARY:MYPHOTOS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 assetUnselected:function(t) {
  try {
   console.log("Asset Unselected...");
   var e = photoOrg.photoLib.UserAssetsInfo.assetViewsMap[t], o = null;
   photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, parseInt(t));
   gon.staticContent.pict_ids = _.without(gon.staticContent.pict_ids, parseInt(t));
   if (e) if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
    $("#" + t + "po_sav").removeClass("selected");
    o = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(t);
   } else if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.photosAndVideos) {
    e.unSelectAsset();
    o = e.model;
   }
   o || (o = photoOrg.photoLib.SelectedAsset.selectedAssets.get(t));
   photoOrg.photoLib.SelectedAsset.selectedAssets.remove(o);
   eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, o);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:assetUnselected", errorCode="LIBRARY:MYPHOTOS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 removeSelectedAssets:function() {
  $(".selectable-asset").removeClass("selected");
 },
 getAssetsByUserInput:function(t) {
  photoOrg.photoLib.cache = {};
  this.cf.sortCriteria = t.urlParam;
  this.setSortOrderTojStorage();
  this.reset();
  this.setupPages();
 },
 detailsViewAssetSelectIconClicked:function(t) {
  try {
   var e = photoOrg.photoLib.UserAssetsInfo.assetViewsMap[t.model.id];
   t.isSelected && void 0 != e ? e.clickOnAssetUnSelectIcon() :t.isSelected || void 0 == e || e.clickOnAssetSelectIcon();
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:clusters_view_controller:detailsViewAssetSelectIconClicked", errorCode="LIBRARY:MYPHOTOS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 updateGrid:function() {
  this.showPreloader();
  this.setupPages();
 }
});

var photoOrg = photoOrg || {};

photoOrg.ShareHandlerView = Backbone.View.extend({
 el:"#shareLayerView",
 fromTray:!1,
 initialize:function() {
  try {
   console.log("Share Handler view initialize...");
   this.listenTo(eventBus, eventBus.CUSTOM_EVENT_SHARE, this.handleShare, this);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:share_handler_view:initialize", errorCode="LIBRARY:SHARE", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 handleShare:function(t) {
  console.log("Share Handler view - handleShare method");
  try {
   this.shareInfo = t;
   this.fromTray = void 0 == t.fromTray ? !1 :t.fromTray;
   var e = this, o = {
    shareType:e.shareInfo.shareType,
    friendsAssetCount:e.shareInfo.friendsAssetCount,
    shareData:e.shareInfo.shareData,
    divId:"shareLayerView",
    account_id:gon.staticContent.account_id,
    fromTray:this.fromTray
   };
   $("#loadingBar").show();
   $(".slide-loader").show();
   this.loadShareLayer(o);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:share_handler_view:handleShare", errorCode="LIBRARY:SHARE", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 render:function(t) {
  try {
   console.log("Share Handler view - render method");
   if (this.shareHtmlLoaded && this.shareScriptLoaded && this.shareCSSLoaded) {
    this.shareLayerView = new photoOrg.ShareLayerView({
     el:this.el
    });
    this.shareLayerView.handleShare(t);
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:share_handler_view:render", errorCode="LIBRARY:SHARE", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 loadShareLayer:function(t) {
  console.log("Share Handler view - loadShareLayer method");
  var e = this;
  if (this.shareLayerView) return this.shareLayerView.handleShare(t);
  $(this.el).load(gon.staticContent.end_point_share + "/sharing" + window.location.search, function(o, i) {
   if ("error" != i) {
    console.log("Share Layer: HTML file loaded");
    e.shareHtmlLoaded = !0;
    e.render(t);
   } else {
    $("#loadingBar").hide();
    console.error("Error while loading Share Layer script file");
   }
  });
  if (shareCssPath) {
   console.log("Share Layer: CSS file loaded");
   $("body").append('<link rel="stylesheet" id="share_api_id" type="text/css" href="' + shareCssPath + '"/>');
   e.shareCSSLoaded = !0;
  }
  if (shareCssPath2) {
   console.log("shareCssPath2Share Layer: shareCssPath2 file loaded");
   $("body").append('<link rel="stylesheet" id="share_api_id" type="text/css" href="' + shareCssPath2 + '"/>');
   e.shareCSSLoaded = !0;
  }
  e.shareCSSLoaded && e.render(t);
  this.getShareJs(t);
 },
 getShareJs:function(t) {
  _this = this;
  $.ajax({
   url:shareJsPath,
   dataType:"script",
   cache:!0
  }).done(function() {
   console.log("Share Layer: Script file loaded");
   _this.shareScriptLoaded = !0;
   _this.render(t);
  }).fail(function() {
   $("#loadingBar").hide();
   console.error("Error while loading Share Layer script file...");
  });
 }
});

var photoOrg = photoOrg || {};

photoOrg.AssetOptionsMenu = Backbone.View.extend({
 el:"#single_album_grid",
 context:null,
 visible:!1,
 options:{},
 holdThreshold:1e3,
 holdTimer:null,
 accessType:"",
 assetType:"",
 initialize:function(t) {
  try {
   this.options = t;
   this.accessType = t.accessType;
   this.assetType = t.assetType;
   this.render();
   1 == gon.staticContent.share && this.$el.find(".share-album").show();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 render:function(t) {
  try {
   console.log("rendering options template in cluster view");
   var e = JST["templates/common/library/time_line_view/asset-options-menu"]({
    singleAlbum:photoOrg.photoLib.current_state === photoOrg.photoLib.navType.singleAlbum,
    albumsList:photoOrg.photoLib.current_state === photoOrg.photoLib.navType.albums,
    upward:this.options.upward,
    isAlbumCover:this.options.isAlbumCover || this.isAlbumCover(this.options.isAlbumCover, t),
    isDetailView:this.options.isDetailView || !1,
    isShowCopyAndMove:!1,
    isFavorite:photoOrg.photoLib.isFavorite,
    assetType:this.assetType
   });
   this.context = $(e);
   $(this.el).append(this.context);
   this.longPressOnResize();
   $(window).on("resize.cvLongPressOnResize", $.proxy(this.longPressOnResize, this));
   return this.context;
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:render", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 longPressOnResize:function() {
  !photoOrg.Util.isTouchDevice() || photoOrg.photoLib.current_state != photoOrg.photoLib.navType.singleAlbum && photoOrg.photoLib.current_state != photoOrg.photoLib.navType.photosAndVideos || this.accessType == photoOrg.photoLib.accessType.share1 || this.accessType == photoOrg.photoLib.accessType.share2 || this.longPress();
 },
 events:{
  click:"onClick",
  "click .delete-photo":"onDelete",
  "click .select-all-photos":"onSelectAll",
  "click .make-album-cover":"onMakeAlbumCover",
  "click .share-album":"shareAlbum",
  "click .edit_photo_cv":"editPhotoCv",
  "click .rotate_cw":"rotatePhotoCw"
 },
 editPhotoCv:function(t) {
  console.log("Performing Edit Photo operation from Cluster View");
  photoOrg.Util.trackLinksAndButtons("Edit Photo", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  var e = $(t.currentTarget).closest(".selectable-asset");
  if ($("#detailedViewContainer").is(":visible")) {
   e = $(t.currentTarget);
   $("#detailedViewContainer").hide();
   photoOrg.detailedView.openProjectTray();
  }
  var o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = photoOrg.photoLib.UserAssetsInfo.assetList.get(o);
  photoOrg.clusterView.model = i;
  var s = {
   el:"#edit-Overlay",
   assetRef:photoOrg.photoLib.getLOWorTHUMBNAIL(i.get("files")).url,
   model:i
  };
  photoOrg.photoLib.editOperationsInit(s);
 },
 longPress:function() {
  console.log("longPress action happened");
  if ($(".album-item-wrapper .options").is(":visible")) {
   this.options.context.off("taphold", $.proxy(this.onHold, this));
   this.options.context.off("holdtap", $.proxy(this.onHold, this));
  } else {
   this.options.context.on("taphold", $.proxy(this.onHold, this));
   this.options.context.on("holdtap", $.proxy(this.onHold, this));
  }
 },
 onClick:function() {
  try {
   this.visible ? this.hide() :this.show();
   return !1;
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:onClick", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 show:function() {
  this.visible = !0;
  this.context.parent().addClass("gear-highlight");
  var t = this.context.parent().offset().top + this.context.innerHeight() + 10;
  $(".mobile-footer").is(":visible") && (t += $(".mobile-footer").innerHeight());
  var e = $(window).height();
  t > e ? this.context.addClass("pos-change") :this.context.removeClass("pos-change");
  this.context.addClass("show");
 },
 onDelete:function(t) {
  try {
   console.log("Deleting Photo from cluster view");
   var e = $(t.currentTarget).closest(".selectable-asset");
   photoOrg.Util.trackLinksAndButtons("Delete Photo", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   this.options.deleteCallback(e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:onDelete", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 onSelectAll:function() {
  try {
   console.log("Select All action performed");
   this.options.selectAllCallback();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:onSelectAll", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onMakeAlbumCover:function() {
  try {
   console.log("Make album cover event triggered");
   var t = this.options.model;
   photoOrg.Util.trackLinksAndButtons("MakeAlbumCover", "singleAlbumDetail");
   eventBus.trigger(eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER, t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:onMakeAlbumCover", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 onHold:function(t) {
  console.log("onHold action performed");
  if (!$(t.target).hasClass("left-nav") && !$(t.target).hasClass("right-nav")) {
   void 0 == photoOrg.mobileActionsMenu && (photoOrg.mobileActionsMenu = new photoOrg.MobileActionsMenu({
    el:$("#mobile-actions-menu")
   }));
   photoOrg.mobileActionsMenu.show({
    makeAlbumCoverCallback:$.proxy(this.onMakeAlbumCover, this),
    deleteCallback:$.proxy(this.onDelete, this),
    selectAllCallback:$.proxy(this.onSelectAll, this),
    assetEditCallback:$.proxy(this.editPhotoCv, this),
    assetRotateCallback:$.proxy(this.rotatePhotoCw, this),
    type:this.options.type,
    shareCallback:$.proxy(this.shareAlbum, this),
    isAlbumCover:this.options.isAlbumCover || this.isAlbumCover(this.options.isAlbumCover),
    assetType:this.assetType,
    event:t
   });
  }
 },
 isAlbumCover:function(t, e) {
  console.log("checking whether the current photo is album cover or not");
  if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && photoOrg.albumCoverModel) {
   var e = "" + e;
   e = e.replace(/[^0-9]+/gi, "");
   console.log("inside album cover" + (e == photoOrg.albumCoverModel.id));
   return e == photoOrg.albumCoverModel.id ? !0 :!1;
  }
  return t;
 },
 hide:function() {
  this.visible = !1;
  this.context.parent().removeClass("gear-highlight");
  this.context.removeClass("show");
 },
 destroy:function() {
  this.options.context.off();
  this.unbind();
  this.remove();
 },
 shareAlbum:function() {
  try {
   this.options.shareCallback();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:asset_options_menu:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 rotatePhotoCw:function(t) {
  try {
   console.log("Rotating photo from cluster view");
   $("#loadingBar").show();
   photoOrg.Util.trackLinksAndButtons("Asset Rotate", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   var e = $(t.currentTarget).closest(".selectable-asset");
   $("#detailedViewContainer").is(":visible") && (e = $(t.currentTarget));
   var o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = (photoOrg.photoLib.UserAssetsInfo.assetList.get(o), 
   {
    journals:"/rf=ccw/",
    defaultSizes:"960,200"
   }), s = "append";
   new AssetFetcher().imageEdit(s, o, i, $.proxy(this.successCallBack, this), $.proxy(this.errorCallback, this), this);
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:rotatePhotoCw", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 successCallBack:function(t) {
  photoOrg.Util.updateResponseWithExistingModel(t);
  $("#detailedViewContainer").is(":visible") && photoOrg.detailedView.render();
 },
 errorCallback:function() {
  console.log("Rotate CV ImageEdit call failure");
 }
});

var photoOrg = photoOrg || {};

photoOrg.SavAssetOptionsMenu = Backbone.View.extend({
 context:null,
 visible:!1,
 options:{},
 holdThreshold:1e3,
 holdTimer:null,
 accessType:"",
 initialize:function(t) {
  try {
   this.options = t;
   this.accessType = t.accessType;
   1 == gon.staticContent.share && this.$el.find(".share-album").show();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 render:function(t, e) {
  console.log("rendering options template in SAV");
  var o = photoOrg.photoLib.albumModelList[this.options.albumId], i = !1;
  photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && (i = !0);
  o && photoOrg.photoLib.getValue(o.systemTags, "isFavorite") && "true" == photoOrg.photoLib.getValue(o.systemTags, "isFavorite") && (i = !1);
  try {
   var s = JST["templates/common/library/time_line_view/asset-options-menu"]({
    singleAlbum:photoOrg.photoLib.current_state === photoOrg.photoLib.navType.singleAlbum,
    albumsList:photoOrg.photoLib.current_state === photoOrg.photoLib.navType.albums,
    upward:this.options.upward,
    isAlbumCover:t,
    isDetailView:!1,
    assetType:e,
    isShowCopyAndMove:i,
    isFavorite:photoOrg.photoLib.isFavorite
   });
   this.context = $(s);
   return s;
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:render", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 events:{
  "click .options":"onClick",
  "click .delete-photo":"onDelete",
  "click .select-all-photos":"onSelectAll",
  "click .make-album-cover":"onMakeAlbumCover",
  "click .share-album":"shareAlbum",
  "click .asset_move":"assetMove",
  "click .asset_copy":"assetCopy",
  "click .edit_photo_sav":"editPhotoSav",
  "click .rotate_cw":"rotatePhotoCw"
 },
 editPhotoSav:function(t) {
  console.log("Performing Edit Photo operation from SAV");
  photoOrg.Util.trackLinksAndButtons("Edit Photo", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  var e = $(t.currentTarget).closest(".selectable-asset"), o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o), s = {
   el:"#edit-Overlay",
   assetRef:photoOrg.photoLib.getLOWorTHUMBNAIL(i.get("files")).url,
   model:i
  };
  photoOrg.photoLib.editOperationsInit(s);
 },
 assetCopy:function(t) {
  console.log("Performing Copy Photo operation from SAV");
  var e = $(t.currentTarget).closest(".selectable-asset");
  photoOrg.Util.trackLinksAndButtons("Asset Copy", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  var o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o);
  if (0 == $(".move_copy_overlay").find("#albumManagement").length) {
   var s = JST["templates/common/library/add_to_album/move_copy_overlay"]();
   $(".move_copy_overlay").append(s);
  }
  if (void 0 != i) {
   photoOrg.albumManagement || (photoOrg.albumManagement = new photoOrg.AlbumManagement({
    el:$("#albumManagement")
   }));
   photoOrg.albumManagement.show(!1, !0, i, this.options.albumId);
  }
 },
 assetMove:function(t) {
  console.log("Performing Move Photo operation from SAV");
  var e = $(t.currentTarget).closest(".selectable-asset");
  photoOrg.Util.trackLinksAndButtons("Asset Move", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  var o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o), s = JST["templates/common/library/add_to_album/move_copy_overlay"]();
  0 == $(".move_copy_overlay").find("#albumManagement").length && $(".move_copy_overlay").append(s);
  if (void 0 != i) {
   photoOrg.albumManagement || (photoOrg.albumManagement = new photoOrg.AlbumManagement({
    el:$("#albumManagement")
   }));
   photoOrg.albumManagement.show(!0, !0, i, this.options.albumId);
  }
 },
 longPress:function() {
  console.log("longPress action happened from SAV");
  var t = this, e = "";
  try {
   e = t.options.context;
  } catch (o) {
   photoOrg.jsWarningLogger('"LIBRARY:sav_asset_options_menu:onClick", errorCode="LIBRARY:MYALBUMS", err_desc="In resize issue with options: ' + this.options + ", and context: " + (this.options ? this.options.context :"-") + '"');
  }
  e || (e = $(".selectable-asset"));
  if ($(".album-item-wrapper .options").is(":visible")) {
   e.off("taphold", $.proxy(t.onHold, this));
   e.off("holdtap", $.proxy(t.onHold, this));
  } else {
   e.on("taphold", $.proxy(t.onHold, this));
   e.on("holdtap", $.proxy(t.onHold, this));
  }
 },
 onClick:function(t) {
  try {
   this.visible ? this.hide(t) :this.show(t);
   return !1;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:onClick", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 show:function(t) {
  try {
   this.visible = !0;
   $(t.currentTarget).addClass("gear-highlight");
   var e = $(t.currentTarget).offset().top + $(t.currentTarget).innerHeight() + $(t.currentTarget).find(".asset-options-menu").innerHeight();
   $(".mobile-footer").is(":visible") && (e += $(".mobile-footer").innerHeight());
   var o = $(window).height();
   e > o ? $(t.currentTarget).find(".asset-options-menu").addClass("pos-change") :$(t.currentTarget).find(".asset-options-menu").removeClass("pos-change");
   $(t.currentTarget).find(".asset-options-menu").addClass("show");
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:show", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 onDelete:function(t) {
  try {
   console.log("Deleting Photo from SAV");
   var e = $(t.currentTarget).closest(".selectable-asset");
   photoOrg.Util.trackLinksAndButtons("Delete Photo", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   this.options.deleteCallback(e, photoOrg.commonAssetView);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:onDelete", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 onSelectAll:function() {
  try {
   console.log("Select All in album");
   this.options.selectAllCallback();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:onSelectAll", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onMakeAlbumCover:function(t) {
  try {
   console.log("Make album cover event triggered from SAV");
   var e = this.options.model;
   if (photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum) {
    var o = $(t.currentTarget).closest(".selectable-asset").attr("id").replace(/[^0-9]+/gi, "");
    e = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o);
   }
   photoOrg.Util.trackLinksAndButtons("MakeAlbumCover", "singleAlbumDetail");
   eventBus.trigger(eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER, e);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:onMakeAlbumCover", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 onHold:function(t) {
  console.log("onHold action performed");
  if (!(photoOrg.rearrange_assets_view.reArrangeMode || photoOrg.photoLib.isFavorite && this.isAlbumCover(this.options.isAlbumCover, $(t.currentTarget).attr("id")) || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW || $(t.target).hasClass("left-nav") || $(t.target).hasClass("right-nav"))) {
   void 0 == photoOrg.mobileActionsMenu && (photoOrg.mobileActionsMenu = new photoOrg.MobileActionsMenu({
    el:$("#mobile-actions-menu")
   }));
   var e = !1, o = photoOrg.photoLib.albumModelList[this.options.albumId];
   photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && (e = !0);
   o && photoOrg.photoLib.getValue(o.systemTags, "isFavorite") && "true" == photoOrg.photoLib.getValue(o.systemTags, "isFavorite") && (e = !1);
   var i = $(t.currentTarget).closest(".selectable-asset"), s = $(i).attr("id").replace(/[^0-9]+/gi, ""), r = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(s), n = r.get("assetType");
   photoOrg.mobileActionsMenu.show({
    makeAlbumCoverCallback:$.proxy(this.onMakeAlbumCover, this),
    deleteCallback:$.proxy(this.onDelete, this),
    selectAllCallback:$.proxy(this.onSelectAll, this),
    assetMoveCallback:$.proxy(this.assetMove, this),
    assetCopyCallback:$.proxy(this.assetCopy, this),
    assetEditCallback:$.proxy(this.editPhotoSav, this),
    assetRotateCallback:$.proxy(this.rotatePhotoCw, this),
    type:this.options.type,
    shareCallback:$.proxy(this.shareAlbum, this),
    isAlbumCover:this.isAlbumCover(this.options.isAlbumCover, $(t.currentTarget).attr("id")),
    isShowCopyAndMove:e,
    assetType:n,
    event:t
   });
  }
 },
 isAlbumCover:function(t, e) {
  console.log("checking whether the current photo is album cover or not");
  var e = "" + e;
  e = e.replace(/[^0-9]+/gi, "");
  return photoOrg.albumCoverModel && e == photoOrg.albumCoverModel.id ? !0 :t;
 },
 hide:function(t) {
  this.visible = !1;
  $(t.currentTarget).removeClass("gear-highlight");
  $(t.currentTarget).find(".asset-options-menu").removeClass("show");
 },
 destroy:function() {
  this.options.context.off();
  this.unbind();
  this.remove();
 },
 shareAlbum:function() {
  try {
   this.options.shareCallback();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 rotatePhotoCw:function(t) {
  try {
   console.log("Rotating Photo from SAV");
   $("#loadingBar").show();
   photoOrg.Util.trackLinksAndButtons("Asset Rotate", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   var e = $(t.currentTarget).closest(".selectable-asset"), o = $(e).attr("id").replace(/[^0-9]+/gi, ""), i = (photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(o), 
   {
    journals:"/rf=ccw/",
    defaultSizes:"960,200"
   }), s = "append";
   new AssetFetcher().imageEdit(s, o, i, $.proxy(this.successCallBack, this), $.proxy(this.errorCallback, this), this);
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:sav_asset_options_menu:rotatePhotoCw", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 successCallBack:function(t) {
  photoOrg.Util.updateResponseWithExistingModel(t);
 },
 errorCallback:function() {
  $("#loadingBar").hide();
  console.log("Rotate SAV ImageEdit call failure");
 }
});

var photoOrg = photoOrg || {};

photoOrg.AlbumPageView = Backbone.View.extend({
 browseAlbumsView:null,
 singleAlbumView:null,
 loadingBar:null,
 accessType:"",
 initialize:function(t) {
  try {
   console.log("album page view initialize...");
   var e = JST["templates/common/library/single_album_view/album-page-view"]();
   this.$el.html(e);
   this.$el.find(".album-pagination").hide();
   eventBus.on(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_CLOSE, $.proxy(this.close, this));
   this.$el.on("click", "#savAssetOperationsArea .close", $.proxy(this.backToAlbums, this));
   this.$el.on("click", ".stickyicons .scroll-back-btn", $.proxy(this.backToAlbums, this));
   this.$el.off("click", "#savAssetOperationsArea .browse-albums", $.proxy(this.toggleBrowseView, this));
   this.$el.on("click", "#savAssetOperationsArea .browse-albums", $.proxy(this.toggleBrowseView, this));
   this.loadingBar = $("#loadingBar");
   this.accessType = t.accessType;
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:album_page_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 updateSingleAlbumView:function(t) {
  console.log("Updating Single album view.....");
  if ("undefined" != typeof gon.staticContent.account_id) {
   this.loadingBar.show();
   if (this.singleAlbumView) {
    this.singleAlbumView.close();
    this.singleAlbumView = null;
   }
   (void 0 == photoOrg.selectedAlbumId || "" == photoOrg.selectedAlbumId) && (photoOrg.selectedAlbumId = photoOrg.photoLib.Util.historyState.aid);
   this.singleAlbumView = new photoOrg.single_album_view({
    el:$(".sav-wrap", this.$el),
    albumId:photoOrg.photoLib.Util.historyState.aid,
    caption:decodeURIComponent(photoOrg.photoLib.Util.historyState.cn),
    urlParam:photoOrg.photoLib.Util.historyState.so,
    accessType:t,
    ownerAccountId:photoOrg.photoLib.Util.historyState.oid,
    dataCenter:photoOrg.photoLib.Util.historyState.dc
   });
   if (photoOrg.photoLib.clickedOnAlbumSlideShow) return this.singleAlbumView;
   this.singleAlbumView.$el.on("LOADED", $.proxy(this.onSingleAlbumViewLoaded, this));
   return void 0;
  }
  $(window).one("USER_INFO_LOADED", this.updateSingleAlbumView.bind(this));
 },
 onSingleAlbumViewLoaded:function() {
  console.log("album page view-onSingleAlbumViewLoaded method");
  eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
  eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
  $(window).off("resize", $.proxy(this.resize, this));
  $(window).on("resize", $.proxy(this.resize, this));
  this.resize();
  this.loadingBar.hide();
 },
 resize:function() {
  try {
   if (this.singleAlbumView && this.browseAlbumsView) {
    var t = $("#savAssetOperationsArea .browse-albums", this.$el);
    if (this.browseAlbumsView.open) {
     t.addClass("selected");
     this.browseAlbumsView.resize();
    } else t.removeClass("selected");
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:album_page_view:resize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 toggleBrowseView:function() {
  try {
   console.log("Toggling... browse albums...");
   void 0 == this.browseAlbumsView && (this.browseAlbumsView = new photoOrg.BrowseAlbums({
    el:$("#browseAlbums"),
    albumId:photoOrg.photoLib.Util.historyState.aid,
    container:$("#right-well"),
    grid:$(".scroll_sav_grid")
   }));
   this.browseAlbumsView.toggleAlbums();
   var t = $("#savAssetOperationsArea .browse-albums", this.$el);
   if (this.browseAlbumsView.open) {
    t.addClass("selected");
    photoOrg.Util.trackLinksAndButtons("Browse Albums Open", "singleAlbumDetail");
   } else {
    t.removeClass("selected");
    photoOrg.Util.trackLinksAndButtons("Browse Albums Close", "singleAlbumDetail");
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_page_view:toggleBrowseView", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 backToAlbums:function() {
  try {
   console.log("Redirecting Back to Albums page");
   this.close();
   photoOrg.photoLib.selectedAlbumAssets = [];
   var t = photoOrg.constants.ALBUMS_VIEW;
   photoOrg.photoLib.Util.historyState && (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW ? t = photoOrg.constants.ALBUMS_VIEW :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW ? t = photoOrg.constants.MY_SHARED_ALBUM_VIEW :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW ? t = photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && (t = photoOrg.constants.ALBUMS_VIEW));
   $("#album-filtering a[data-value='" + t + "']").click();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:backToAlbums", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 close:function() {
  try {
   eventBus.off(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_CLOSE, $.proxy(this.close, this));
   this.$el.off("click", "#savAssetOperationsArea .close", $.proxy(this.backToAlbums, this));
   this.singleAlbumView.close();
   this.nullifyingSAVObjects();
   void 0 != this.browseAlbumsView && this.browseAlbumsView.destroy();
   this.$el.empty();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:albums_view:close", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 nullifyingSAVObjects:function() {
  photoOrg.likesAndCommentsView = null;
  photoOrg.savPage = null;
  photoOrg.commonAssetView = null;
  photoOrg.rearrange_assets_view = null;
 }
});

var photoOrg = photoOrg || {};

photoOrg.single_album_view = Backbone.View.extend({
 el:"#album_assets",
 albumCaption:"",
 photosCount:0,
 albumId:null,
 collection:null,
 firstAssetId:0,
 firstAssetInfo:{},
 firstAssetRef:"",
 coverPhotoAsset:null,
 coverImage:"",
 skip:0,
 loadCollection:!1,
 triggerDetailViewNextAsset:!1,
 isAssetsLoaded:!0,
 obj:null,
 uraparam:"",
 albumDescription:"",
 selectAllButton:null,
 caption:null,
 assetIdList:[],
 userTags:[],
 shouldReload:!1,
 albumResponse:null,
 forceDelete:!1,
 assetsLength:0,
 socialResponse:null,
 albumType:"",
 accessType:"",
 isClassic:!1,
 hideUploadButton:!0,
 friendsCount:0,
 shared:!1,
 isShared:!1,
 sharedByMe:!1,
 sharedWithMe:!1,
 ownerName:"",
 sharedWithName:"",
 isOwnedAndShared:!1,
 firstAssetIdDate:"",
 frndsSav:!1,
 sharebymeflowalbumResponse:void 0,
 force:!1,
 coverImageHeight:$(window).height(),
 activatedSticky:!1,
 sortCodeUpdated:!1,
 sortCode:"DAS",
 favAssetsCount:0,
 initialize:function(t) {
  try {
   console.log("Single Album View - initialize...");
   if (0 == $(".uploadImagesTextDiv").length) {
    var e = JST["templates/common/library/single_album_view/album_error"]();
    $("#album_assets").after(e);
   }
   this.pict_ids = [];
   $("#loadingBar").show();
   $("#libText").hide();
   $(".photo-album-toggle .albums").addClass("selected");
   photoOrg.Util.settingSelectedPics();
   photoOrg.photoLib.allImagesSelected = !1;
   $(".photo-Org .assetsSelection").hide();
   this.obj = t;
   $(this.el).empty();
   this.isAssetsLoaded = !0;
   this.triggerDetailViewNextAsset = !1;
   photoOrg.photoLib.showAndHideUploadTextDiv("hide");
   photoOrg.photoLib.showAndHideSharedEmptyMsgDiv("hide");
   photoOrg.photoLib.isSingleAlbumAssetsLoaded = !1;
   $(".photo-Org #album_assets .singleAlbumDummyContent").remove();
   this.photosCount = t.photosCount;
   this.albumId = t.albumId;
   this.ownerAccountId = t.ownerAccountId;
   this.dataCenter = t.dataCenter;
   this.albumDescription = t.albumDescription;
   this.firstAssetId = t.firstAssetId;
   this.assetIdList = t.assetIdList;
   photoOrg.photoLib.currentAlbumId = this.albumId;
   this.collection = new photoOrg.pictCollection();
   this.accessType = t.accessType;
   this.accessType == photoOrg.photoLib.accessType.share1 && (this.isClassic = !0);
   1 == photoOrg.photoLib.Util.historyState.isShared && (this.isShared = !0);
   eventBus.trigger(eventBus.CUSTOM_EVENT_ALBUMS_CLOSE, {});
   void 0 != t.urlParam && "" != t.urlParam && (this.uraparam = "&sortCriteria=" + t.urlParam);
   var o = this.sortOrderAfterUpload || this.sortOrder;
   "customOrder" != o || photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW && photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || (o = "ascending");
   "customOrder" == o ? this.uraparam = "&sortCriteria=customOrder" :void 0 != o && (this.uraparam += "&sortOrder=" + o);
   this.sortOrder = o;
   this.sortOrderAfterUpload = "";
   if ((void 0 == photoOrg.photoLib.hideEmptyTray || 0 == photoOrg.photoLib.hideEmptyTray) && 0 == photoOrg.photoLib.selectedImages.length) {
    $(".lib-left-col").removeClass("hidden");
    $("#right-well").removeClass("full");
   }
   if (photoOrg.photoLib.config.loadAsPhotoPicker) {
    $(".lib-left-col").addClass("hidden");
    $("#right-well").addClass("full");
   }
   eventBus.on(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_SCROLLING, this.processScroll, this);
   eventBus.on(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, this.removeSelectedAssets, this);
   eventBus.on(eventBus.CUSTOM_EVENT_EMPTY_SINGLE_ALBUM_VIEWW, this.closeGrid, this);
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_SAV, this.showNextAssetInDetailView, this);
   eventBus.on(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, this.reload, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ASSET_VIEW_UPDATE, this.updateAssetView, this);
   eventBus.on(eventBus.CUSTOM_EVENT_DETAILED_ASSET_SELECT_ICON_CLICKED, this.detailsViewAssetSelectIconClicked, this);
   eventBus.on(eventBus.CUSTOM_EVENT_NEXT_SET_SAV, this.requestNextAssetSetInSAV, this);
   eventBus.on(eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER, this.updateAlbumCover, this);
   eventBus.on(eventBus.CUSTOM_EVENT_ASSET_DELETED, $.proxy(this.onAssetDeleted, this));
   eventBus.on(eventBus.CUSTOM_EVENT_UPDATE_SINGLE_ALBUM_COUNT, $.proxy(this.updateSingleAlbumCount, this));
   eventBus.on(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW, $.proxy(this.shareAlbum, this));
   eventBus.off(eventBus.CUSTOM_EVENT_SLIDESHOW_FROM_DETAILEDVIEW);
   eventBus.on(eventBus.CUSTOM_EVENT_SLIDESHOW_FROM_DETAILEDVIEW, this.slideShowPlay, this);
   eventBus.off(eventBus.CUSTOM_EVENT_TRIGGER_REARRANGE_MODE);
   eventBus.on(eventBus.CUSTOM_EVENT_TRIGGER_REARRANGE_MODE, this.reArrangeStart, this);
   eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE);
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.onCustomEventResizeGrid, this);
   eventBus.off(eventBus.CUSTOM_EVENT_WINDOW_RESIZE);
   $(".single_album_ascending").off("click");
   $(".single_album_descending").off("click");
   $(".reArrange").off("click");
   $(".single_album_ascending").on("click", $.proxy(this.singleAlbumSort, this));
   $(".single_album_descending").on("click", $.proxy(this.singleAlbumSort, this));
   $(".reArrange").on("click", $.proxy(this.singleAlbumSort, this));
   $(".hero-image-add-photos").off("click");
   photoOrg.rearrange_assets_view = new photoOrg.Rearrange_assets_view(this);
   photoOrg.likesAndCommentsView = new photoOrg.LikesAndCommentsView(this);
   photoOrg.photoLib.requestProcessing = !1;
   photoOrg.photoLib.config.loadAsPhotoPicker || gon.staticContent.isExpressFeatureOn && 0 == photoOrg.photoLib.expressProduct.skuIds.length && photoOrg.photoLib.showExpressProductAndBuildMap();
   this.render();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 events:{
  "click #savAssetOperationsArea .detail-delete":"deleteAlbum",
  "click .share-album-button":"shareAlbum",
  "click .manage-sharing-button":"manageSharing",
  "click .start-slideshow":"openSlideshowView",
  "mousedown #savAssetOperationsArea .detail-edit":"stopBlur",
  "click .orderPrints":"redirectToprints",
  "click #customSort":"reArrangeInitialise",
  "click #reArrangeCancel":"reArrangeCancel",
  "click #reArrangeDone":"reArrangeDone",
  "click .edit_hero_image":"editHeroImage"
 },
 selectDeselectSortOrder:function(t) {
  console.log("Sort order.....");
  if ("ascending" == t) {
   $(".single_album_descending").removeClass("selected");
   $(".reArrange").removeClass("selected");
   $(".single_album_ascending").addClass("selected");
   $(".sort_single_album_sec .single-album-sorting span.sort-option").html(window.translations.sub_header.oldesttonewest);
  } else if ("descending" == t) {
   $(".single_album_ascending").removeClass("selected");
   $(".reArrange").removeClass("selected");
   $(".single_album_descending").addClass("selected");
   $(".sort_single_album_sec .single-album-sorting span.sort-option").html(window.translations.sub_header.newesttooldest);
  } else if ("customOrder" == t) {
   $(".single_album_ascending").removeClass("selected");
   $(".single_album_descending").removeClass("selected");
   $(".reArrange").addClass("selected");
   $(".sort_single_album_sec .single-album-sorting span.sort-option").html(window.translations.sub_header.customSort);
  }
 },
 updateSingleAlbumCount:function() {
  try {
   var t = $(".selectable-asset.selected").length;
   this.obj.photosCount = this.photosCount - t;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:updateSingleAlbumCount", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 adjustScreenOnWindowResize:function() {
  try {
   console.log("adjustScreenOnWindowResize");
   this.isProcessResponseActivated && this.onProcessResponseResize();
   if (!photoOrg.Util.isTouchDevice()) {
    this.onCustomEventResizeGrid(!0);
    return;
   }
   this.widowWidth = $(window).width();
   this.windowHeight = $(window).height();
   if ("potrait" != this.orientationState && this.windowHeight > this.widowWidth) {
    this.orientationState = "potrait";
    console.log(" window resized : potrait, widowWidth: " + this.widowWidth);
    this.onCustomEventResizeGrid(!0);
   } else if ("landscape" != this.orientationState && this.windowHeight < this.widowWidth) {
    this.orientationState = "landscape";
    console.log(" window resized : landscape, widowWidth: " + this.widowWidth);
    this.onCustomEventResizeGrid(!0);
   }
   Foundation.libs.dropdown.close($("#expressprints"));
   setTimeout(function() {
    $(".reveal-modal-bg").remove();
    console.log("closed background...............");
   }, 5);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:adjustScreenOnWindowResize", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onCustomEventResizeGrid:function() {
  try {
   console.log("....inside onCustomEventResizeGrid.....");
   photoOrg.photoLib.init();
   if ($(window).width() <= 900) if (photoOrg.rearrange_assets_view.reArrangeMode) {
    $(".mobile-footer").removeClass("hide");
    $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
    $("#mobile-reArrange").show();
    $("#selection-productList").hide();
   } else if (photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0) photoOrg.projectTrayView && photoOrg.projectTrayView.showTray(); else {
    $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
    photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray();
   } else if (photoOrg.rearrange_assets_view.reArrangeMode) {
    photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray();
    $(".lib-left-col").removeClass("hidden");
    $("#right-well").addClass("full");
   } else photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0 && photoOrg.projectTrayView && photoOrg.projectTrayView.showTray();
   $(".stickyicons").css("maxWidth", $("#single_album_grid").outerWidth(!0));
   setTimeout(function() {
    $("#single_album_grid").collagePlus();
    console.log("***** Ran Collage Plus *******");
    $(".stickyicons").css("maxWidth", $("#single_album_grid").outerWidth(!0));
    photoOrg.rearrange_assets_view.reArrangeMode && $("#hovermore").css("left", "-99999px");
   }, 150);
   $("#datepicker").datepicker("hide");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:onCustomEventResizeGrid", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 singleAlbumSort:function(t) {
  try {
   console.log("Single Album View - singleAlbumSort method");
   $("#loadingBar").show();
   this.collection = new photoOrg.pictCollection();
   t.preventDefault();
   var e = $(t.currentTarget).attr("sortOrder");
   this.sortOrder = e;
   this.uraparam = "customOrder" != e ? "&sortCriteria=dateTaken&sortOrder=" + e :"&sortCriteria=customOrder";
   this.selectDeselectSortOrder(e);
   $("#singleAlbumsort").removeClass("open").css("left", "-9999px");
   this.applySortCriteria(e);
   photoOrg.Util.trackLinksAndButtons(e, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:singleAlbumSort", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 applySortCriteria:function(t) {
  console.log("Single Album View - applySortCriteria method");
  photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.reset();
  var e = "dateTaken", o = "sortCriteria=" + e + "&sortOrder=" + t;
  if ("customOrder" == t) {
   e = "customOrder";
   o = "&sortCriteria=" + e;
  }
  var i = {
   albumId:this.albumId,
   urlparam:"&assetType=PICTURE&limit=" + photoOrg.photoLib.limit + "&skip=0&" + o,
   sortOrderParam:"sortOrder=" + t,
   sortCriteria:"dateTaken"
  };
  ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) && (i.urlparam = "&assetType=ALL&limit=" + photoOrg.photoLib.limit + "&skip=0&" + o);
  this.skip = 0;
  this.sortCode = "";
  this.getAlbumFetcher().getSingleAlbumInfo("", i, this.processResponse, this.errorCallBack, this);
  var s = this.getSortCode(e, t);
  this.sortCode = s;
  _.each(this.albumResponse.systemTags, function(t) {
   "sortCode" == t.key && (t.value = s);
  });
  var r = {
   systemTags:[ {
    key:"sortCode",
    value:s,
    override:!0
   } ]
  };
  this.getAlbumFetcher().updateCollectionTag(this.albumId, r, this.addTagSuccessCallback, this.addTagErrorCallback, this);
  console.log("sort code is = " + s);
 },
 slideShowPlay:function() {
  try {
   this.openSlideshowView();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:slideShowPlay", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 redirectToprints:function(t) {
  try {
   console.log("Redirecting to prints builder...");
   var e = "AlbumDetail_OrderPrints";
   t && 1 == t && (e = "AlbumDetail_ExpressPrints");
   photoOrg.Util.trackLinksAndButtons(e, "singleAlbumDetail");
   var o = photoOrg.Util.getBrowserSessionCookie("GSID");
   $.jStorage.get(gon.staticContent.account_id + "_" + o + "dont_show_conformation") || !photoOrg.Util.isTouchDevice() || photoOrg.photoLib.expressProduct.isShowExpressProduct ? this.orderPrints() :photoOrg.printsConfirmation.init({
    orderPrints:$.proxy(this.orderPrints, this)
   });
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:redirectToprints", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 orderPrints:function() {
  try {
   console.log("Order Prints.....");
   var t = !1;
   gon.staticContent.session_update = !1;
   var e = gon.staticContent.prints_builder_url + "?" + gon.staticContent.prints_sku_4x6 + "&albumId=" + this.albumId;
   if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) e += "&albumType=myshared&dc=" + this.dataCenter; else if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) {
    t = !0;
    e += "&accountId=" + this.ownerAccountId + "&albumType=friends&dc=" + this.dataCenter;
    for (var o = "", i = "", s = 0; s < this.assetIdList.length; s++) {
     o += this.assetIdList[s].assetId + "_" + this.assetIdList[s].thumbnailEncryption;
     i += this.assetIdList[s].assetId;
     if (this.assetIdList.length > s + 1) {
      o += ",";
      i += ",";
     }
    }
    var r = gon.staticContent.library_url + "/updateSession";
    console.log("friends albums");
    var n = photoOrg.Util.getBrowserSessionCookie("GSID"), a = photoOrg.Util.getBrowserSessionCookie("oa2");
    e += "&albumType=friends";
    var l = {
     entity:{
      fieldList:{
       field:[ {
        name:"GSID",
        value:n
       }, {
        name:"selected_pict_ids",
        value:i
       }, {
        name:"selected_pict_asset_refs",
        value:o
       } ]
      },
      indexkeyList:[ "GSID" ],
      uuid:n
     }
    }, c = {
     oa2:a,
     gsid:n
    };
    c.data = $.toJSON(l);
    var h = {
     data:c
    }, d = function() {
     window.location.href = e;
    }, p = function(t) {
     photoOrg.jsErrorLogger('"Updateglobalsession in single album view failed"', e, t);
     window.location.href = e;
    }, u = new AssetFetcher();
    u.makeGlobalSessionCallForPrints(r, h.data, d, p, this);
   }
   t || (window.location.href = e);
  } catch (g) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:orderPrints", errorCode="LIBRARY:MYALBUMS", err_desc="' + g + '" err_stack="' + g.stack + '"');
  }
 },
 openSlideshowView:function() {
  try {
   console.log("Opening slideshow.....");
   var t = $("#slideshow-container").empty(), e = this.collection.toJSON();
   if (this.coverPhotoAsset && "undefined" != typeof this.coverPhotoAsset.firstAssetId) {
    var o = this.coverPhotoAsset.firstAssetId.assetId;
    e.unshift(this.collection.get(o));
   } else e.unshift(this.coverPhotoAsset);
   var i = e[e.length - 1];
   e.push(i);
   var s = photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && this.isShared || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && this.isShared;
   photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && (this.sharedWithMe = !0);
   this.frndsSav = photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   $("#hovermore").css("left", "-99999px");
   (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) && this.albumResponse.systemTags && "true" == photoOrg.photoLib.getValue(this.albumResponse.systemTags, "isFavorite") && (this.albumCaption = window.translations.sub_header.favorite_alb);
   photoOrg.slideshowViewController = new photoOrg.SlideshowViewController({
    el:t,
    collection:e,
    albumData:{
     title:this.albumCaption || "",
     ownerName:this.ownerName,
     lastName:this.lastName,
     sharedWithMe:this.sharedWithMe,
     isOwnedAndShared:this.isOwnedAndShared,
     sharedWithName:this.sharedWithName,
     isClassic:this.isClassic,
     shared:s,
     albumId:this.albumId,
     likesCount:photoOrg.likesAndCommentsView.likesCount,
     likes:photoOrg.likesAndCommentsView.likes,
     view:photoOrg.likesAndCommentsView.view,
     ownerAccountId:this.ownerAccountId,
     dataCenter:this.dataCenter,
     friendsCount:this.friendsCount,
     date:this.firstAssetIdDate ? moment(this.firstAssetIdDate).format("MMM, YYYY") :"",
     description:this.albumDescription || "",
     frndsSav:this.frndsSav,
     comments:photoOrg.likesAndCommentsView.comments
    },
    singleAlbumObj:this,
    likesAndCommentsViewObj:photoOrg.likesAndCommentsView
   });
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:openSlideshowView", errorCode="LIBRARY:MYALBUMS", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 backToAlbums:function() {
  try {
   this.close();
   photoOrg.photoLib.config.loadAsPhotoPicker && this.showSubheader();
   var t = photoOrg.constants.ALBUMS_VIEW;
   photoOrg.photoLib.Util.historyState && (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW ? t = photoOrg.constants.ALBUMS_VIEW :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW ? t = photoOrg.constants.MY_SHARED_ALBUM_VIEW :photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && (t = photoOrg.constants.SHARED_WITH_ME_ALBUM_VIEW));
   $("#album-filtering a[data-value='" + t + "']").click();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:backToAlbums", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 updateAlbumCover:function(t) {
  try {
   console.log("Updating Album Cover...");
   $("#loadingBar").show();
   this.setCurrentMonth();
   if (this.firstAssetId === t.id) return;
   this.firstAssetId = t.id;
   this.firstAssetInfo = this.assetIdList[t.id];
   for (var e = this.assetIdList.length; e--; ) {
    var o = this.assetIdList[e].assetId;
    o == t.id && (this.firstAssetInfo = this.assetIdList[e]);
   }
   this.shouldReload = !0;
   this.save(!0);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:updateAlbumCover", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 onAssetDeleted:function(t) {
  try {
   console.log("Asset deleted.....");
   this.setCurrentMonth();
   for (var e = !1, o = t.length, i = this.assetIdList.length; i--; ) {
    var s = this.assetIdList[i].assetId;
    if (0 >= o) break;
    var r = photoOrg.photoLib.SelectedAsset.selectedAssets.get(s);
    void 0 != r && ("true" == photoOrg.photoLib.getValue(r.get("systemTags"), "isFavorite") || r.systemTags && "true" == photoOrg.photoLib.getValue(r.systemTags, "isFavorite")) && this.favAssetsCount++;
    for (var n = 0; n < t.length; n++) {
     var a = parseInt(t[n], 10);
     if (a === s) {
      a === this.firstAssetId && (e = !0);
      this.assetIdList.splice(i, 1);
      o--;
      this.collection.remove(a);
     }
    }
   }
   this.obj.assetIdList = this.assetIdList;
   if (this.assetIdList.length <= 0 || this.favAssetsCount == this.assetIdList.length) {
    this.backToAlbums();
    photoOrg.selectedAlbumId = "";
   } else if (e || photoOrg.Util.deletefromProjectTray) {
    photoOrg.Util.deletefromProjectTray = !1;
    this.reload();
   } else {
    this.updatePhotoCount();
    $("#single_album_grid").collagePlus();
    var l = {
     albumId:this.albumId
    };
    this.pict_ids && (this.pict_ids = _.difference(this.pict_ids, t));
    this.getAlbumFetcher().getUnsharedSingleAlbum("", l, $.proxy(this.updateCollection, this), this.errorCallBack, this);
   }
  } catch (c) {
   console.log("Error deleting asset: ", c);
  }
 },
 updateCollection:function(t) {
  console.log("Single Album View - UpdateCollection method");
  if (t.entities.length > 0) {
   console.log(t);
   if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) this.sharebymeflowalbumResponse = t.entities[0]; else {
    this.albumResponse = t.entities[0];
    photoOrg.photoLib.albumModelList[this.album_id] = this.albumResponse;
    this.setCurrentMonth();
    this.dataCenter = this.albumResponse.dataCenter;
    photoOrg.photoLib.collectionStructure.dataCenter = this.dataCenter;
    gon.staticContent.dc = this.dataCenter;
    this.ownerAccountId = this.albumResponse.ownerAccountId;
    this.firstAssetId = this.albumResponse.firstAssetId.assetId;
    this.firstAssetInfo = this.albumResponse.firstAssetId;
    this.firstAssetId || (this.firstAssetId = this.albumResponse.assetIdList[0].assetId);
    this.albumDescription = photoOrg.photoLib.getValue(this.albumResponse.userTags, "description");
    this.albumCaption = photoOrg.photoLib.getValue(this.albumResponse.userTags, "caption");
    this.userTags = this.albumResponse.userTags;
    this.assetIdList = this.albumResponse.assetIdList;
   }
  }
 },
 shareAlbum:function() {
  try {
   console.log("Single Album View - shareAlbum method");
   photoOrg.Util.trackLinksAndButtons("AlbumDetail_Share", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   eventBus.trigger(eventBus.CUSTOM_EVENT_SHARE, {
    shareType:"SINGLE_ALBUM_SHARE",
    shareData:{
     albumModel:this.albumResponse
    }
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:shareAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 manageSharing:function() {
  try {
   alert("TODO: single_album_view.js - manageSharing()");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:manageSharing", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 stopBlur:function() {
  try {
   return !1;
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:stopBlur", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 save:function(t) {
  this.force = t;
  var e = {
   albumId:this.albumId
  };
  this.getAlbumFetcher().getUnsharedSingleAlbum("", e, $.proxy(this.postCollectionData, this), this.errorCallBack, this);
 },
 postCollectionData:function(t) {
  if (t.entities.length > 0) {
   console.log(t);
   if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) this.sharebymeflowalbumResponse = t.entities[0]; else {
    this.albumResponse = t.entities[0];
    photoOrg.photoLib.albumModelList[this.album_id] = this.albumResponse;
    this.dataCenter = this.albumResponse.dataCenter;
    photoOrg.photoLib.collectionStructure.dataCenter = this.dataCenter;
    gon.staticContent.dc = this.dataCenter;
    this.ownerAccountId = this.albumResponse.ownerAccountId;
    this.albumDescription = photoOrg.photoLib.getValue(this.albumResponse.userTags, "description");
    this.albumCaption = photoOrg.photoLib.getValue(this.albumResponse.userTags, "caption");
    this.userTags = this.albumResponse.userTags;
    this.assetIdList = this.albumResponse.assetIdList;
   }
  }
  this.saveAlbum(this.force);
 },
 saveAlbum:function(t) {
  console.log("Single Album View - saveAlbum method");
  var e = photoOrg.photoLib.getValue(this.userTags, "caption"), o = photoOrg.photoLib.getValue(this.userTags, "description"), i = this.caption.val(), s = $.trim(this.description.val().replace(/^\s*[\r\n]/gm, ""));
  this.description.val(s);
  i || (i = this.caption.val(e).val());
  if (e !== i || o !== s || 1 == t) {
   this.albumCaption = i;
   this.albumDescription = s;
   var r = new AssetFetcher(), n = this.albumResponse;
   photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW && (n = this.sharebymeflowalbumResponse);
   for (var a = !0, l = !0, c = 0; c < this.userTags.length; c++) {
    var h = this.userTags[c];
    if ("caption" === h.key) {
     this.userTags[c].value = i;
     a = !1;
    }
    if ("description" === h.key) {
     this.userTags[c].value = s;
     l = !1;
    }
   }
   a && this.userTags.push({
    key:"caption",
    value:i
   });
   l && this.userTags.push({
    key:"description",
    value:s
   });
   n.userTags = this.userTags;
   n.firstAssetId = this.firstAssetInfo;
   this.forceDelete && (n.markedForDelete = !0);
   console.log(n);
   r.updateAlbum("", {
    data:n
   }, $.proxy(this.saveSuccessCallback, this), $.proxy(this.saveErrorCallback, this), {});
  } else console.log("No new changes");
 },
 saveSuccessCallback:function(t) {
  this.setCurrentMonth();
  this.albumResponse = t.entities[0];
  photoOrg.photoLib.albumModelList[this.albumResponse.id] = this.albumResponse;
  photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW && (this.sharebymeflowalbumResponse = t.entities[0]);
  if (this.forceDelete) this.backToAlbums(); else {
   if (this.shouldReload) {
    this.shouldReload = !1;
    this.reload();
   }
   $("#loadingBar").hide();
  }
 },
 saveErrorCallback:function() {
  this.shouldReload = !1;
 },
 selectAssets:function(t) {
  try {
   console.log("Single Album View - selectAssets ");
   var e = $(t.currentTarget).find(".ib-checkmark");
   photoOrg.Util.trackLinksAndButtons("Select All", "singleAlbumDetail");
   $("#cls_empty_tray").hide();
   $(".empty-tray-sec").hide();
   var o = this.toggleSelectAllButtonState(e), i = photoOrg.noOfPages > 1;
   this.toggleSelection(o, i, this);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:selectAssets", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 toggleSelectAllButtonState:function(t) {
  console.log("Single Album View - toggle selectAll");
  var e = "checkmark-blue", o = !1;
  if (t.hasClass("checkmark-blue")) {
   t.removeClass(e);
   $(".select-all-wrapper").removeClass("selected");
   null == photoOrg.photoLib.seletedAlbums && (photoOrg.photoLib.seletedAlbums = {});
   photoOrg.Util.deleteAndUpdateAlbumInfoInLocalStorage(photoOrg.photoLib.currentAlbumId);
   photoOrg.photoLib.hideEmptyTray = !0;
   photoOrg.photoLib.selectedAlbumAssets = [];
  } else {
   t.addClass(e);
   $(".select-all-wrapper").addClass("selected");
   photoOrg.Util.getSelectedAlbums();
   this.force = "";
   photoOrg.photoLib.seletedAlbums[photoOrg.photoLib.currentAlbumId] = this.albumResponse;
   $.jStorage.set(gon.staticContent.account_id + "_selectedAlbums", photoOrg.photoLib.seletedAlbums);
   o = !0;
   this.addAllPictIds();
  }
  return o;
 },
 addAllPictIds:function() {
  _.each(this.albumResponse.assetIdList, function(t) {
   photoOrg.photoLib.selectedAlbumAssets.push(t.assetId);
  });
 },
 toggleSelection:function(t, e, o) {
  console.log("single album view - toggle selection...");
  if (!t || !e || this.classicAlbum || this.frndsAlbum) {
   _.each(this.pict_ids, function(e) {
    var o = this.collection.get(e), i = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(e), !1);
    if (-1 == i) {
     if (t) {
      if ("VIDEO" == o.attributes.assetType && photoOrg.photoLib.config.loadAsPhotoPicker) return;
      $("#" + e + "po_sav").addClass("selected");
      photoOrg.photoLib.SelectedAsset.selectedAssets.add(o);
      photoOrg.photoLib.selectedImages.push(e);
      photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
      photoOrg.projectTrayView && photoOrg.projectTrayView.addAssetToTray({
       model:o
      });
      void 0 != this.albumId && (photoOrg.photoLib.selectedPicsFromAlb[o.id] = void 0 == photoOrg.photoLib.selectedPicsFromAlb[o.id] ? this.albumId + "" :photoOrg.photoLib.selectedPicsFromAlb[o.id] + "_" + this.albumId);
     } else {
      $("#" + e + "po_sav").removeClass("selected");
      photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(e);
      photoOrg.photoLib.SelectedAsset.selectedAssets.remove(o);
      photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, o.id);
      if (void 0 != this.albumId && photoOrg.photoLib.selectedPicsFromAlb[o.id]) {
       keys = photoOrg.photoLib.selectedPicsFromAlb[o.id].split("_");
       var s = keys.indexOf(this.albId + "");
       keys.splice(s, 1);
       keys = keys.join("_");
       photoOrg.photoLib.selectedPicsFromAlb[o.id] = keys;
       "" == keys && delete photoOrg.photoLib.selectedPicsFromAlb[o.id];
      }
     }
     eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, o);
    }
   }, this);
   this.showTotalSelectedAssets();
   gon.staticContent.pict_ids = photoOrg.photoLib.selectedImages;
  } else {
   try {
    if ($(window).width() <= 900) {
     console.log("mobile view from process response");
     if (photoOrg.rearrange_assets_view.reArrangeMode) {
      $(".mobile-footer").removeClass("hide");
      $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
      $("#mobile-reArrange").show();
      $("#selection-productList").hide();
     } else if (photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0) photoOrg.projectTrayView && photoOrg.projectTrayView.showTray(); else {
      $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
      photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray();
     }
    } else {
     console.log("desktop view");
     photoOrg.rearrange_assets_view.reArrangeMode ? photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray() :photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0 && photoOrg.projectTrayView && photoOrg.projectTrayView.showTray();
    }
   } catch (i) {
    photoOrg.jsErrorLogger('"LIBRARY:single_album_view:some error", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
   }
   this.selectAllAssets(t, o);
  }
 },
 selectAllAssets:function(t) {
  console.log("Single Album View - selectAllAssets ");
  var e = this;
  if (t) {
   $("#loadingBar").show();
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var o = {
    albumId:this.albumId,
    urlparam:"&assetType=ALL&limit=" + this.photosCount + "&skip=0" + this.uraparam
   }; else var o = {
    albumId:this.albumId,
    urlparam:"&limit=" + this.photosCount + "&skip=0" + this.uraparam
   };
   this.getAlbumFetcher().getSingleAlbumInfo("", o, $.proxy(function(t) {
    if (t) {
     for (var o = t.entities, i = o.length, s = 0; i > s; s++) {
      var r = o[s], n = new photoOrg.pict(r);
      this.collection.add(n);
      this.pict_ids.push(n.id);
      photoOrg.photoLib.UserAssetsInfo.assetList = photoOrg.photoLib.UserAssetsInfo.assetList || new userAssets();
      photoOrg.photoLib.UserAssetsInfo.assetList.add(n);
      var a = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(n.id), !1);
      if (-1 == a) {
       $("#" + n.id + "po_sav").addClass("selected");
       photoOrg.photoLib.SelectedAsset.selectedAssets.add(n);
       photoOrg.photoLib.selectedImages.push(n.id);
       photoOrg.photoLib.selectedImages = _.uniq(photoOrg.photoLib.selectedImages);
       photoOrg.photoLib.config.loadAsPhotoPicker || photoOrg.projectTrayView && photoOrg.projectTrayView.addAssetToTray({
        model:n
       });
       eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, n);
      }
     }
     this.pict_ids = _.uniq(this.pict_ids);
     $("#loadingBar").hide();
     e.showTotalSelectedAssets();
    }
   }, this));
  } else this.collection.each(function(t) {
   var e = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(t.id), !1);
   if (-1 == e) {
    $("#" + t.id + "po_sav").removeClass("selected");
    photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(t.id);
    photoOrg.photoLib.SelectedAsset.selectedAssets.remove(t);
    photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, t.id);
    eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, t);
   }
  });
  e.showTotalSelectedAssets();
 },
 showTotalSelectedAssets:function() {
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   var t = window.translations.picker.photos_selected;
   $(".actionContainer .select_count .selectedImageCount").text(t.replace("{0}", photoOrg.photoLib.SelectedAsset.selectedAssets.length));
   if (photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0) {
    $(".actionContainer .select_count .select_count_sec").hide();
    $(".photo-Org .picker-done-button").addClass("disable-greybtn");
   } else {
    $(".actionContainer .select_count .select_count_sec").show();
    $(".photo-Org .picker-done-button").removeClass("disable-greybtn");
   }
  } else $("#po_photo_txt").text(photoOrg.photoLib.selectedImages.length > 1 ? window.translations.photos :window.translations.photo);
 },
 updateAssetView:function(t) {
  try {
   console.log("Updating Asset view.....");
   var e = photoOrg.photoLib.getLOWorTHUMBNAIL(t.model.get("files")).url, o = photoOrg.photoLib.getHAndWForImage(t.model), i = t.model.get("id"), s = $("#img_" + i + "po_sav");
   s.one("load", function() {
    console.log("Image onload function triggered");
    $("#loadingBar").hide();
   });
   s.one("error", function() {
    console.log("Image onerror function triggered");
    $("#loadingBar").hide();
   });
   s.attr("data-original", photoOrg.Util.getTnlURLFromArray(e + "?height=200", t.model.get("id")));
   s.attr("src", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC");
   s.attr("src", photoOrg.Util.getTnlURLFromArray(e + "?height=200", t.model.get("id")));
   if (0 != o.width && 0 != o.height) {
    s.data("width", o.width);
    s.data("height", o.height);
    s.width(o.width);
    s.height(o.height);
    $("#" + t.model.get("id") + "po_sav").width(o.width);
    $("#" + t.model.get("id") + "po_sav").height(o.height);
   }
   setTimeout(function() {
    $("#loadingBar").hide();
   }, 1e4);
   $("#single_album_grid").collagePlus();
   this.assetIdList && this.assetIdList.length > 0 && _.each(this.assetIdList, function(t) {
    if (t.assetId != i) ; else {
     console.log("update url" + e);
     t.thumbnailEncryption = e;
     this.albumResponse.assetIdList = this.assetIdList;
    }
   }, this);
   if (this.firstAssetId == t.model.get("id")) {
    this.coverImage = photoOrg.Util.getTnlURLFromArray(e, this.firstAssetId);
    var r = $(".hero-image").attr("calculatedHeight");
    this.coverImage += -1 == this.coverImage.indexOf("?") ? "?height=" + r :"&height=" + r;
    $(".hero-image").css("background-image", "url(" + this.coverImage + ")");
    this.albumResponse && this.albumResponse.firstAssetId && this.albumResponse.firstAssetId.thumbnailEncryption && (this.albumResponse.firstAssetId.thumbnailEncryption = e);
   }
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:updateAssetView", errorCode="LIBRARY:MYALBUMS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 reload:function(t) {
  try {
   console.log("reload start");
   photoOrg.photoLib.selectedAlbumAssets = [];
   if (void 0 != t) if (t.urlParam) this.obj.urlParam = t.urlParam; else if (t.sortCriteria) {
    this.obj.urlParam = t.sortCriteria;
    this.sortOrderAfterUpload = t.selectedSortOrder;
   }
   this.close();
   this.initialize(this.obj);
   this.delegateEvents(this.events);
   this.setCurrentMonth();
   console.log("reload end");
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:reload", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 removeSelectedAssets:function() {
  try {
   console.log("Single Album View - removeselectAssets method");
   var t = $("#" + this.el.id);
   if (photoOrg.photoLib.Util.isTouchDevice()) {
    t.removeClass("selected");
    t.addClass("selected");
   } else t.removeClass("selected");
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:removeSelectedAssets", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 processScroll:function(t) {
  try {
   var e = photoOrg.photoLib.getNoOfPagestoDisplay(this.skip);
   if (!photoOrg.photoLib.requestProcessing && ($("#savLoadingBar").isOnScreen() || t.isFromDetalView) && this.isAssetsLoaded && e <= photoOrg.noOfPages) {
    console.log("Request for Next Image Set started in processScroll");
    photoOrg.photoLib.requestProcessing = !0;
    e + 1 == photoOrg.noOfPages && $("#savLoadingBar").remove();
    if (t) {
     this.isFromDetalView = t.isFromDetalView;
     this.detailViewCurrentIndex = t.currentIndex;
    }
    this.skip += photoOrg.photoLib.limit;
    this.getNextOrPreviousAssets();
   }
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:processScroll", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 hideSubheader:function() {
  $("#sub_header_container").hide();
  $("#library").addClass("subheader-hidden");
 },
 showSubheader:function() {
  $("#sub_header_container").show();
  $("#library").removeClass("subheader-hidden");
 },
 render:function() {
  try {
   photoOrg.photoLib.selectedImages.length > 0 && $("#cls_empty_tray").hide();
   this.hideSubheader();
   this.getSingleAlbumInfo();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:render", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 makeUnSelect:function() {
  console.log("makeunselect");
  _.each(this.pict_ids, function(t) {
   var e = this.collection.get(t), o = _.indexOf(photoOrg.photoLib.defaultSelected, parseInt(t), !1);
   if (-1 == o) {
    $("#" + t + "po_sav").removeClass("selected");
    photoOrg.projectTrayView && photoOrg.projectTrayView.removeAssetFromTray(t);
    photoOrg.photoLib.SelectedAsset.selectedAssets.remove(e);
    photoOrg.photoLib.selectedImages = _.without(photoOrg.photoLib.selectedImages, e.id);
    eventBus.trigger(eventBus.CUSTOM_EVENT_UPDATE_ASSET_SELECTION_COUNT, e);
   }
  }, this);
 },
 showNextAssetInDetailView:function(t) {
  try {
   this.detailViewCurrentIndex = t.currentIndex;
   if (this.isAssetsLoaded) if (photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.length > this.detailViewCurrentIndex) {
    photoOrg.photoLib.isDetailedViewShowNextSet = !1;
    eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_SUCEESS, {
     currentIndex:this.detailViewCurrentIndex
    });
   } else {
    photoOrg.photoLib.isDetailedViewShowNextSet = !0;
    eventBus.trigger(eventBus.CUSTOM_EVENT_NEXT_SET_SAV, null);
   } else this.triggerDetailViewNextAsset = !0;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:showNextAssetInDetailView", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 getOwnedAlbumInfo:function() {
  var t = {
   albumId:this.albumId
  };
  this.getAlbumFetcher().getUnsharedSingleAlbum("", t, $.proxy(this.updateCollection, this), this.errorCallBack, this);
 },
 getSingleAlbumInfo:function() {
  console.log("getSingleAlbumInfo start");
  $(".single-album-sorting").show();
  $("#loadingBar").show();
  $("#browseAlbums").show();
  if (this.isAssetsLoaded) {
   this.isAssetsLoaded = !1;
   var t = {
    albumId:this.albumId,
    sortCriteria:"dateTaken",
    assetType:"PICTURE"
   };
   ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) && (t.assetType = "ALL");
   if ("SHARED_WITH_ME" == this.accessType) {
    this.frndsAlbum = !0;
    t.ownerAccountId = this.ownerAccountId;
    t.dataCenter = this.dataCenter;
    this.getAlbumFetcher().getSharedSingleAlbumInfo("", t, this.processSocialDetailResponse, this.errorCallBack, this);
   } else if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && this.isShared || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && this.isShared) {
    photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && this.isShared && (this.hideUploadButton = !1);
    this.myShareAlbum = !0;
    ("" == gon.staticContent.account_id || void 0 == gon.staticContent.account_id) && photoOrg.jsWarningLogger('"Account Id is mandatory Filed" accountId="' + gon.staticContent.account_id + '"', this.url);
    t.ownerAccountId = gon.staticContent.account_id;
    t.dataCenter = this.dataCenter || gon.staticContent.dc;
    this.params = t;
    this.getAlbumFetcher().getSharedSingleAlbumInfo("", t, this.processSocialDetailResponse, this.socialErrorCallBack, this);
    if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && this.isShared && this.albumId && photoOrg.photoLib.albumModelList[this.albumId]) {
     var e = {
      entities:[ photoOrg.photoLib.albumModelList[this.albumId] ]
     };
     this.updateCollection(e);
    } else this.getOwnedAlbumInfo();
   } else {
    this.hideUploadButton = !1;
    if (photoOrg.editUtils && !photoOrg.editUtils.isAssetEdited && !this.loadCollection && this.albumId && photoOrg.photoLib.albumModelList[this.albumId]) {
     var e = {
      entities:[ photoOrg.photoLib.albumModelList[this.albumId] ]
     };
     this.requestFirstAssetInAlbum(e, this);
     this.loadCollection = !0;
    } else {
     this.loadCollection = !0;
     this.getAlbumFetcher().getUnsharedSingleAlbum("", t, $.proxy(this.requestFirstAssetInAlbum, this), this.errorCallBack, this);
    }
    photoOrg.editUtils && (photoOrg.editUtils.isAssetEdited = !1);
   }
   var o = photoOrg.photoLib.albumModelList[this.albumId];
   o && "true" == photoOrg.photoLib.getValue(o.systemTags, "isFavorite") && (this.hideUploadButton = !0);
  }
  console.log("getSingleAlbumInfo end");
 },
 requestFirstAssetInAlbum:function(t) {
  console.log("requestFirstAssetInAlbum start");
  if (t.entities.length > 0) {
   this.albumResponse = t.entities[0];
   photoOrg.photoLib.albumModelList[this.albumId] = this.albumResponse;
   console.log(this.albumResponse);
   this.dataCenter = this.albumResponse.dataCenter;
   photoOrg.photoLib.collectionStructure.dataCenter = this.dataCenter;
   gon.staticContent.dc = this.dataCenter;
   this.ownerAccountId = this.albumResponse.ownerAccountId;
   this.firstAssetId = this.albumResponse.firstAssetId.assetId;
   this.firstAssetInfo = this.albumResponse.firstAssetId;
   this.firstAssetRef = this.firstAssetInfo.thumbnailEncryption;
   if (this.albumResponse.systemTags) {
    photoOrg.photoLib.isFavorite = "true" == photoOrg.photoLib.getValue(this.albumResponse.systemTags, "isFavorite") ? !0 :!1;
    this.sortCode = photoOrg.photoLib.getValue(this.albumResponse.systemTags, "sortCode") || "DAS";
    var e = this.getSortOrderFromSortCode(this.sortCode);
    this.uraparam && e && -1 == this.uraparam.indexOf(e) && (this.uraparam = this.uraparam + "&sortOrder=" + e);
    "customOrder" == e && (this.uraparam = "&sortCriteria=customOrder");
   } else photoOrg.photoLib.isFavorite = !1;
   this.firstAssetId || (this.firstAssetId = this.albumResponse.assetIdList[0].assetId);
   this.albumDescription = photoOrg.photoLib.getValue(this.albumResponse.userTags, "description");
   this.albumCaption = photoOrg.photoLib.getValue(this.albumResponse.userTags, "caption");
   this.userTags = this.albumResponse.userTags;
   this.assetIdList = this.albumResponse.assetIdList;
   var o = {
    id:this.firstAssetId
   };
   gon.staticContent.account_id != this.firstAssetInfo.ownerId && (o.arefId = this.firstAssetRef);
   var i = photoOrg.photoLib.Util.historyState;
   i.pg != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && this.setCurrentMonth();
   if (this.albumResponse && this.albumResponse.firstAssetId) {
    var s = {
     firstAssetId:this.albumResponse.firstAssetId
    };
    s.isFromAlbumResponse = !0;
    this.requestAlbumAssets(s, !0);
   } else this.getAlbumFetcher().getAssetInfo("", o, $.proxy(this.requestAlbumAssets, this), $.proxy(this.errorCallBack, this), this);
  }
  console.log("requestFirstAssetInAlbum end");
 },
 requestAlbumAssets:function(t) {
  console.log("requestAlbumAssets start");
  this.coverPhotoAsset = null;
  this.coverImage = "";
  var e = null, o = 0, i = $(window).width(), s = $(window).height();
  if (i >= s) {
   e = "height=";
   o = Math.round(i);
  } else {
   e = "height=";
   o = Math.round(s);
  }
  o = photoOrg.Util.getThumbnailDimension(o);
  if (t && t.entities && t.entities.length && "undefined" != typeof t.entities[0].files) {
   this.coverPhotoAsset = t.entities[0];
   this.coverImage = photoOrg.Util.getTnlURLFromArray(photoOrg.photoLib.getLowORHires(this.coverPhotoAsset.files).url, this.coverPhotoAsset.id);
   this.coverImage += -1 == this.coverImage.indexOf("?") ? "?" + e + o :"&" + e + o;
   this.coverImageHeight = o;
  } else if (t.isFromAlbumResponse) {
   this.coverPhotoAsset = t;
   this.coverImage = photoOrg.Util.getTnlURLFromArray(t.firstAssetId.thumbnailEncryption, t.firstAssetId.assetId);
   this.coverImage += -1 == this.coverImage.indexOf("?") ? "?" + e + o :"&" + e + o;
   this.coverImageHeight = o;
  }
  if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var r = {
   albumId:this.albumId,
   urlparam:"&assetType=ALL&limit=" + photoOrg.photoLib.limit + "&skip=" + this.skip
  }; else var r = {
   albumId:this.albumId,
   urlparam:"&limit=" + photoOrg.photoLib.limit + "&skip=" + this.skip
  };
  this.uraparam && (r.urlparam += "&" + this.uraparam);
  this.getAlbumFetcher().getSingleAlbumInfo("", r, this.processResponse, this.errorCallBack, this);
  console.log("requestAlbumAssets end");
 },
 triggerSingleResponseEvent:function(t) {
  eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RESPONSE, {
   response:t
  });
 },
 processResponse:function(t, e) {
  if (void 0 != t) {
   console.log("processResponse start : " + new Date());
   e.collection || (e.collection = new photoOrg.pictCollection());
   var o = !1;
   if (e.accessType == photoOrg.photoLib.accessType.share2 || "SHARED_WITH_ME" == e.accessType) {
    o = "SHARED_WITH_ME" == e.accessType;
    e.accessType = photoOrg.photoLib.accessType.share1;
   }
   e.isAssetsLoaded = !0;
   if (0 == e.skip) {
    $(".photo-Org .singleAlbumDummyContent").remove();
    $("#single_album_grid").empty();
    photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.reset();
    photoOrg.noOfPages = photoOrg.photoLib.getNoOfPagestoDisplay(t.totalEntitiesCount);
   }
   t = photoOrg.photoLib.isValidateAssets(t);
   if (void 0 != t.errors && t.errors.length > 0) photoOrg.photoLib.showServerInternalErrorMsg("show"); else {
    photoOrg.photoLib.showServerInternalErrorMsg("hide");
    t.resultCount <= photoOrg.photoLib.limit && $("#loadingBar").hide();
    e.assetsLength = t.entities.length;
    var i = e.getAssetText(e.assetsLength), s = 0, r = void 0;
    e.trackOmnitureForPublicShareFlow(e);
    if (e.assetsLength > 0 && photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW == photoOrg.photoLib.Util.historyState.pgvw) {
     s = t.totalEntitiesCount;
     e.photosCount = t.totalEntitiesCount;
     r = s + " " + i;
    } else if (e.assetsLength > 0 && photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.SINGLE_ALBUM_VIEW) {
     s = e.assetsLength;
     r = s + " " + i;
    } else if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) {
     s = e.albumResponse.assetIdList.length;
     r = s + " " + i;
    } else {
     s = t.totalEntitiesCount;
     e.photosCount = t.totalEntitiesCount;
     r = s + " " + i;
    }
    photoOrg.photoLib.totalAssetCount = s;
    var n = {
     caption:e.albumCaption,
     photosCount:s,
     assets:r,
     cover_photo_url:e.coverImage,
     imageHeight:e.coverImageHeight,
     album_description:$.trim(e.albumDescription),
     accessType:e.accessType
    }, a = "";
    a = moment(e.albumResponse.createDate).format(gon.staticContent.date_format);
    n.createDate = a;
    if (e.socialResponse) {
     e.sharedByMe = !1;
     e.ownerName = "Someone";
     e.sharedWithName = "Someone";
     e.lastName = "";
     e.isOwnedAndShared = !1;
     if (e.socialResponse.ownerInfo && void 0 != e.socialResponse.ownerInfo.firstName) {
      e.ownerName = e.socialResponse.ownerInfo.firstName;
      e.lastName = e.socialResponse.ownerInfo.lastName;
     }
     if (void 0 != photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && e.isShared) {
      e.sharedByMe = gon.staticContent.account_id == e.socialResponse.ownerAccountId;
      e.sharedWithMe = !e.sharedByMe;
      e.isOwnedAndShared = e.socialResponse.friendsCount > 0;
      for (var l in e.socialResponse.view) {
       var c = e.socialResponse.view[l];
       if (e.sharedByMe) {
        e.sharedWithName = c.firstName || "";
        break;
       }
      }
     } else void 0 != photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW ? e.sharedWithMe = !0 :e.isOwnedAndShared = !1;
     photoOrg.likesAndCommentsView.likesCount = 0 == e.socialResponse.likesCount ? "" :e.socialResponse.likesCount;
     photoOrg.likesAndCommentsView.comments = e.socialResponse.comments;
     photoOrg.likesAndCommentsView.commentsCount = 0 == e.socialResponse.comments.length ? "" :e.socialResponse.comments.length;
     photoOrg.likesAndCommentsView.likes = e.socialResponse.likes;
     photoOrg.likesAndCommentsView.view = e.socialResponse.view;
     $.extend(n, {
      likesCount:photoOrg.likesAndCommentsView.likesCount,
      likesText:photoOrg.photoLib.getLikesText(photoOrg.likesAndCommentsView.likesCount),
      commentsCount:photoOrg.likesAndCommentsView.commentsCount,
      commentsText:photoOrg.photoLib.getCommentsText(photoOrg.likesAndCommentsView.commentsCount),
      friendsCount:e.socialResponse.friendsCount,
      shared:!0,
      sharedByMe:e.sharedByMe,
      ownerName:e.ownerName,
      sharedWithName:e.sharedWithName,
      isPicker:photoOrg.photoLib.config.loadAsPhotoPicker,
      hideUploadButton:e.hideUploadButton,
      hideLikeButton:!1
     });
    } else $.extend(n, {
     likesCount:0,
     likesText:"",
     friendsCount:0,
     shared:!1,
     sharedByMe:!1,
     ownerName:"",
     sharedWithName:"",
     isPicker:photoOrg.photoLib.config.loadAsPhotoPicker,
     hideUploadButton:e.hideUploadButton,
     hideLikeButton:!0
    });
    photoOrg.photoLib.config.loadAsPhotoPicker && $("#sub_header_container").hide();
    n.ownedAlbumView = void 0 == photoOrg.photoLib.Util.historyState.pgvw || photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.SINGLE_ALBUM_VIEW && photoOrg.photoLib.Util.historyState.pgvw != photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW ? !1 :!0;
    n.favAlbumView = void 0 != photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW ? !0 :!1;
    n.isFavoriteAlbum = photoOrg.photoLib.isFavorite;
    n.hideSortOrder = !1;
    var h = "none";
    try {
     photoOrg.Util.getURLParameter("editHeroImage") && (h = "block");
    } catch (d) {}
    n.editHeroImage = h;
    if ($("#single_album_grid").length <= 0) {
     !jQuery.isEmptyObject(photoOrg.photoLib.albumModelList) && photoOrg.photoLib.albumModelList[e.albumId] && photoOrg.photoLib.albumModelList[e.albumId].systemTags && "true" == photoOrg.photoLib.getValue(photoOrg.photoLib.albumModelList[e.albumId].systemTags, "isFavorite") && (n.caption = window.translations.sub_header.favorite_alb);
     var p = JST["templates/common/library/single_album_view/single-album-caption"](n);
     $(e.el).append(p);
     $(".expressprints").unbind("opened");
     $(".expressprints").unbind("closed");
     $(".expressprints").bind("opened", function() {
      photoOrg.expressProduct = new photoOrg.ExpressProductView();
      if (photoOrg.expressProduct) {
       $(photoOrg.expressProduct.id + " .dynamic-express-info").empty();
       photoOrg.expressProduct.render();
       photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAVButtonClicks", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
      }
     });
     $(".expressprints").bind("closed", function() {
      photoOrg.expressProduct && photoOrg.expressProduct.close();
     });
     n.sharedByMe ? $(".sav_delAlb").show() :$(".sav_delAlb").hide();
     n.photosCount >= 3 ? $(".sav_slideshow").show() :$(".sav_slideshow").hide();
     void 0 != photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW && photoOrg.photoLib.getValue(e.albumResponse.systemTags, "isFavorite") && $("#datepicker_textArea").hide();
     if (void 0 != photoOrg.photoLib.Util.historyState.pgvw && photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW || (n.accessType == photoOrg.photoLib.accessType.owned || n.sharedByMe) && photoOrg.photoLib.getValue(e.albumResponse.systemTags, "isFavorite")) {
      $(".caption").prop("disabled", !0);
      $("#datepicker_textArea").hide();
      $(".caption").removeClass("caphover");
     } else if (n.accessType == photoOrg.photoLib.accessType.owned || n.sharedByMe) {
      $(".caption").addClass("caphover");
      $(".caption").prop("disabled", !1);
      $("#datepicker_textArea").prop("disabled", !1);
      $(".sav_delAlb").show();
     }
     photoOrg.commonAssetView = new photoOrg.CommonAssetView({
      el:"#single_album_grid",
      obj:this,
      savObj:e
     });
     var u = photoOrg.photoLib.albumModelList[e.albumId];
     u && "true" == photoOrg.photoLib.getValue(u.systemTags, "isFavorite") && $("#sav-delete-album-button").hide();
     if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
      $(".browse-albums").hide();
      $("#sav-delete-album-button").hide();
      $(".hero-image-add-photos").hide();
      $(window).width() <= 480 && $("#moreicons").show();
      $(".sav_delAlb").hide();
     }
     photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && n.photosCount < 3 && $("#moreicons").hide();
     $(".hero-image-add-photos").off("click");
     $(".hero-image-add-photos").on("click", function() {
      try {
       $("#hover10").hasClass("savupload") || $("#hover10").addClass("savupload");
      } catch (t) {
       photoOrg.jsErrorLogger('"LIBRARY:single_album_view:on click hero-image-add-photos", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
      }
     });
     var g = $(".album-detail-hero");
     g.find(".caption").off("click");
     g.find(".caption").on("click", function() {
      try {
       photoOrg.Util.trackLinksAndButtons("Album Name", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
      } catch (t) {
       photoOrg.jsErrorLogger('"LIBRARY:single_album_view:on click caption omniture call", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
      }
     });
     g.find(".description").off("click");
     g.find(".description").on("click", function() {
      try {
       photoOrg.Util.trackLinksAndButtons("Album Description", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
      } catch (t) {
       photoOrg.jsErrorLogger('"LIBRARY:single_album_view:on click description omniture call", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
      }
     });
     e.initialbuttonsOffset = $(".album-left-buttons").offset();
     e.softHeaderHeight = $(".global-header").height();
     photoOrg.Util.isGlobalHeaderMobileLayout() && (e.softHeaderHeight = $(".device-global-header .tab-bar").height());
     e.activateDatePicker(e, n);
    }
    if (gon.staticContent.customsort || photoOrg.photoLib.customSortEnabled || "true" == photoOrg.Util.getURLParameter("customsort")) if (n.ownedAlbumView && n.photosCount >= 2) {
     $(".reArrange").show();
     $(window).width() <= 900 ? $(".sav_customSort").show() :$("#customSort").show();
    } else {
     $(".reArrange").hide();
     $(window).width() <= 900 ? $(".sav_customSort").hide() :$("#customSort").hide();
    }
    if (n.ownedAlbumView && n.photosCount >= 2) {
     var m = "CUP" == photoOrg.photoLib.getValue(e.albumResponse.systemTags, "sortCode") || "CUP" == e.sortCode;
     if (m || "true" == photoOrg.photoLib.getValue(e.albumResponse.systemTags, "customOrder")) {
      $(".reArrange").show();
      m && (e.sortOrder = "customOrder");
     } else $(".reArrange").hide();
    }
    $("#library #right-well .scroll_sav_grid").off("scrollstop");
    $("#library #right-well .scroll_sav_grid").on("scrollstop", {
     latency:500
    }, function(t) {
     try {
      photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && $(".addphotos-dropdown").isOnScreen() && $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
     } catch (t) {
      photoOrg.jsErrorLogger('"LIBRARY:single_album_view:scrollstop", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
     }
    });
    $(".album-left-buttons #addPhotosSection").off("click");
    $(".album-left-buttons #addPhotosSection").on("click", function() {
     try {
      photoOrg.Util.trackLinksAndButtons("AlbumDetail_AddPhotos", "singleAlbumDetail");
     } catch (t) {
      photoOrg.jsErrorLogger('"LIBRARY:single_album_view:album-left-buttons addPhotosSection", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
     }
    });
    o && $(".single-album-sorting").hide();
    !e.sortOrder && e.sortCode && (e.sortOrder = e.getSortOrderFromSortCode(e.sortCode));
    e.selectDeselectSortOrder(e.sortOrder);
    if (e.socialResponse) {
     photoOrg.likesAndCommentsView.successLikesCallBack(t, photoOrg.likesAndCommentsView, !1);
     photoOrg.likesAndCommentsView.successCommentCallBackFromPanel(t, photoOrg.likesAndCommentsView, !1);
    }
    1 == gon.staticContent.share && $(".share-album-button").show();
    e.selectAllButton = $(e.el).find(".select-all-wrapper");
    e.deleteAlbumButton = $(e.el).find(".sav-delete-album-button");
    e.selectAllButton.off("click", $.proxy(e.selectAssets, e));
    e.selectAllButton.on("click", $.proxy(e.selectAssets, e));
    e.deleteAlbumButton.off("click");
    e.deleteAlbumButton.on("click", $.proxy(e.deleteAlbumInSAV, e));
    e.coverPhotoAsset = t.entities[0];
    if (t.entities && 0 == t.entities.length) return !0;
    e.firstAssetIdDate = t.entities[0].createDate || "";
    photoOrg.photoLib.openedCollectionId = e.albumId;
    e.generatePictView(t.entities, e);
    photoOrg.commonAssetView.optionsMenu.context = $(".selectable-asset").find(".asset-options-menu");
    photoOrg.commonAssetView.optionsMenu.options.context = $(".selectable-asset");
    e.isProcessResponseActivated = !0;
    $("#single_album_grid").find(".selected").length == $("#single_album_grid .assetImg").length ? e.selectAllButton.addClass("selected") :e.selectAllButton.removeClass("selected");
    if (e.triggerDetailViewNextAsset) {
     e.triggerDetailViewNextAsset = !1;
     eventBus.trigger(eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET_IN_DETAIL_VIEW_SUCEESS, {
      currentIndex:e.detailViewCurrentIndex
     });
    }
    0 == e.collection.length && photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && (photoOrg.photoLib.config.loadAsPhotoPicker ? photoOrg.photoLib.showAndHideUploadTextDiv("show") :$(".photo-Org .singleAlbumUploadImagesTextDiv").show());
    if (e.isFromDetalView) {
     e.isFromDetalView = !1;
     photoOrg.detailedView.model = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.at(e.detailViewCurrentIndex);
     photoOrg.detailedView.render();
    }
    photoOrg.detailedView && $(window).off("resize", $.proxy(photoOrg.detailedView.render, photoOrg.detailedView));
    $(document).foundation();
    photoOrg.detailedView && $(window).on("resize", $.proxy(photoOrg.detailedView.render, photoOrg.detailedView));
    photoOrg.photoLib.init();
    e.isAssetsLoaded = t.resultCount < photoOrg.photoLib.limit ? !1 :!0;
    if (0 != e.skip || photoOrg.photoLib.config.loadAsPhotoPicker) {
     if (0 == e.skip && photoOrg.photoLib.config.loadAsPhotoPicker) {
      $("#single_album_grid").find(".selected").length != photoOrg.photoLib.selectedAlbumAssets.length && e.selectAllButton.removeClass("selected");
      photoOrg.projectTrayView && photoOrg.projectTrayView.render();
     }
    } else {
     photoOrg.projectTrayView && photoOrg.projectTrayView.render();
     var f = ($("#sub_header_container").innerHeight(), $("#right-well").width());
     $(window).width() <= 321 && (f += 10);
    }
    e.listenScrollEvent(e);
    if (!e.isAssetsLoaded) {
     $("#savLoadingBar").remove();
     photoOrg.photoLib.isSingleAlbumAssetsLoaded = !0;
    }
    photoOrg.rearrange_assets_view.reArrangeMode || e.listenToEvents(e);
    $("#loadingBar").hide();
    $("#sub_header_container").hide();
    $("#single_album_grid").collagePlus();
    setTimeout(function() {
     e.$el.trigger("LOADED");
     setTimeout(function() {
      try {
       $("#single_album_grid").collagePlus();
       $("img.lazy").lazyload({
        effect:"fadeIn",
        container:$(e.el).find(".scroll_sav_grid")
       });
       console.log("now listening for adjust Window resize");
       eventBus.on(eventBus.CUSTOM_EVENT_WINDOW_RESIZE, e.adjustScreenOnWindowResize, e);
      } catch (t) {}
     }, 100);
    }, 100);
    if (photoOrg.rearrange_assets_view.reArrangeMode) {
     $(".scroll_sav_grid").off("scroll");
     $(".selectable-asset .selection-toggle-trigger").hide();
     photoOrg.rearrange_assets_view.reArrangeStart();
    }
    photoOrg.photoLib.requestProcessing = !1;
    console.log("processResponse end : " + new Date());
    if (photoOrg.detailedView && photoOrg.detailedView.selectedAsset || photoOrg.editOperationsView && photoOrg.editOperationsView.selectedAsset) {
     var _;
     photoOrg.detailedView && $("#" + photoOrg.detailedView.selectedAsset + "po_sav").length > 0 ? _ = photoOrg.detailedView.selectedAsset :photoOrg.editOperationsView && $("#" + photoOrg.editOperationsView.selectedAsset + "po_sav").length > 0 && (_ = photoOrg.editOperationsView.selectedAsset);
     if ($("#" + _ + "po_sav").length > 0) {
      $("#savLoadingBar").remove();
      $(".scroll_sav_grid").animate({
       scrollTop:$("#" + _ + "po_sav").offset().top - 2 * $(".stickyicons").height()
      }, 200);
     } else {
      e.skip += photoOrg.photoLib.limit;
      e.getNextOrPreviousAssets();
     }
    }
    photoOrg.photoLib.selectedImages.length >= 0 && $(".imageCount").text(photoOrg.photoLib.selectedImages.length);
   }
  }
 },
 onProcessResponseResize:function() {
  try {
   if ($(window).width() <= 900) {
    console.log("mobile view from process response");
    $("#expressprints").removeClass("open").css("left", "-9999px");
    $(".savback .close").html(window.translations.detail_view.back_sav_mobile);
    $(".back-on-scroll").html(window.translations.detail_view.back_sav_mobile);
    if (photoOrg.rearrange_assets_view.reArrangeMode) {
     $(".mobile-footer").removeClass("hide");
     $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
     $("#mobile-reArrange").show();
     $("#selection-productList").hide();
    } else if (photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0) photoOrg.projectTrayView && photoOrg.projectTrayView.showTray(); else {
     $(".mobile-selection-tray .selection-thumbnail-wrapper").addClass("hide");
     photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray();
    }
   } else {
    console.log("desktop view");
    $(".savback .close").html(window.translations.detail_view.back_sav);
    $(".back-on-scroll").html(window.translations.detail_view.back_sav);
    photoOrg.rearrange_assets_view.reArrangeMode ? photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray() :photoOrg.photoLib.SelectedAsset.selectedAssets.length > 0 && photoOrg.projectTrayView && photoOrg.projectTrayView.showTray();
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:on window resize", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 generatePictView:function(t, e, o) {
  var i = $("#single_album_grid");
  console.log("generatePictView _.each start" + new Date());
  _.each(t, function(t) {
   if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) ; else if ("VIDEO" == t.assetType) return;
   var s = new photoOrg.pict(t);
   o && (s = t);
   e.collection.add(s);
   var r = photoOrg.commonAssetView.buildImageDiv(s, e.coverImage, e.accessType, "sav", e.firstAssetId);
   i.append(r);
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(s.id);
   -1 != _.indexOf(gon.staticContent.pict_ids, s.id, !1) && photoOrg.photoLib.config.loadAsPhotoPicker && photoOrg.commonAssetView.clickOnAssetUnSelectIcon($(r), s);
   e.pict_ids.push(s.id);
   photoOrg.photoLib.selectPicts(s.id, photoOrg.commonAssetView, r);
   photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.add(s);
  }, e);
  console.log("generatePictView _.each end" + new Date());
 },
 trackOmnitureForPublicShareFlow:function(t) {
  if (photoOrg.photoLib.Util.historyState.pf == photoOrg.constants.PAGE_FROM_PUBLIC_SHARE) {
   var e = "";
   photoOrg.Util.getURLParameter("shareType") && (e = photoOrg.Util.getURLParameter("shareType") || "");
   var o = {};
   if (photoOrg.omniture) {
    o.numPhotosShared = t.assetsLength;
    o.shareType = "Link";
    o.pageName = "MY Photos :Albums: " + e + " Public Share";
    setTimeout(function() {
     photoOrg.omniture ? photoOrg.omniture.trackPublicShareOmnitureEvent(o, !0) :console.log("Ominture tracking failed because it was undefined");
    }, 5e3);
   } else console.log("Share Type : " + e + " public share- logged-in - Ominture tracking failed because it was undefined");
  }
 },
 activateDatePicker:function(t, e) {
  console.log("activateDatePicker start");
  $("#datepicker_textArea").off("click");
  $("#datepicker_textArea").off("mouseover");
  $("#datepicker_textArea").off("mouseout");
  $(".scroll_sav_grid, #savAssetOperationsArea,.mobile-selection-tray").off("touchstart");
  if (photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   $("#datepicker_textArea").on("mouseover", function() {
    try {
     photoOrg.photoLib.isFavorite || $("#datepicker_textArea").css("background-color", "rgba(255, 255, 255, 0.4)");
    } catch (t) {
     photoOrg.jsErrorLogger('"LIBRARY:single_album_view:datepicker_textArea mouseover="' + t + '"');
    }
   });
   $("#datepicker_textArea").on("mouseout", function() {
    try {
     $("#datepicker_textArea").css("background-color", "");
    } catch (t) {
     photoOrg.jsErrorLogger('"LIBRARY:single_album_view:datepicker_textArea mouse out", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
    }
   });
   var o = new Date();
   $("#datepicker_textArea").on("click", function() {
    try {
     $("#datepicker_textArea").hide();
     $("#datepicker").show();
     $("#datepicker").datepicker("show");
    } catch (t) {
     photoOrg.jsErrorLogger('"LIBRARY:single_album_view:click on datepicker_textArea", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
    }
   });
   var i = gon.staticContent.monthNamesShort;
   window.translations && window.translations.monthNamesShort && (i = window.translations.monthNamesShort);
   photoOrg.Util.isTouchDevice() && photoOrg.Util.isIos() && $(".scroll_sav_grid, #savAssetOperationsArea,.mobile-selection-tray").on("touchstart", function(t) {
    try {
     $(t.target).closest("#datepicker_textArea").length || $(t.target).closest("#datepicker").length || $("#datepicker").datepicker("widget").is(":visible") && $("#datepicker").datepicker("hide");
    } catch (e) {}
   });
   $("#datepicker").datepicker({
    dateFormat:gon.staticContent.picker_date_format,
    defaultDate:e.createDate,
    onClose:$.proxy(t.updateAlbumDate, t),
    maxDate:new Date(o.getFullYear(), o.getMonth() + 1, 0, 23, 59, 59),
    monthNamesShort:i.split(","),
    monthNames:window.translations.monthNames.split(","),
    dayNames:window.translations.dayNames.split(","),
    dayNamesMin:window.translations.dayNamesMin.split(",")
   });
  }
  console.log("activateDatePicker end");
 },
 longPressOnResize:function() {
  photoOrg.Util.isTouchDevice() && photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && self.accessType != photoOrg.photoLib.accessType.share1 && self.accessType != photoOrg.photoLib.accessType.share2 && photoOrg.commonAssetView.optionsMenu.longPress(!0);
 },
 listenToEvents:function(t) {
  console.log("listenToEvents start");
  photoOrg.Util.isTouchDevice() && photoOrg.photoLib.current_state == photoOrg.photoLib.navType.singleAlbum && t.accessType != photoOrg.photoLib.accessType.share1 && t.accessType != photoOrg.photoLib.accessType.share2 && photoOrg.commonAssetView.optionsMenu.longPress();
  $(window).on("resize.longPressOnResize", $.proxy(this.longPressOnResize, this));
  $(".selectable-asset").mouseenter(function(e) {
   t.checkFavAlbumCover(t, e);
   photoOrg.commonAssetView.optionsMenu.visible = !1;
   $(e.currentTarget).find(".options").removeClass("gear-highlight");
   $(e.currentTarget).find(".asset-options-menu").removeClass("show");
  }).mouseleave(function(e) {
   t.checkFavAlbumCover(t, e);
   photoOrg.commonAssetView.optionsMenu.visible = !1;
   $(e.currentTarget).find(".options").removeClass("gear-highlight");
   $(e.currentTarget).find(".asset-options-menu").removeClass("show");
  });
  t.caption = $(t.el).find(".album-info .caption");
  t.description = $(t.el).find(".album-info .description");
  if (photoOrg.photoLib.config.loadAsPhotoPicker) {
   t.caption.attr("disabled", "disabled");
   t.description.attr("disabled", "disabled");
  } else t.listenCaptionChangeEvent(t);
  photoOrg.rearrange_assets_view.reArrangeMode || t.enableStickyScrolling(t);
  console.log("listenToEvents end");
 },
 checkFavAlbumCover:function(t, e) {
  photoOrg.photoLib.isFavorite && null != e.currentTarget.id && (-1 != e.currentTarget.id.indexOf(t.albumResponse.firstAssetId.assetId) ? $(e.currentTarget).find(".options").hide() :-1 != e.target.parentElement.id.indexOf(t.albumResponse.firstAssetId.assetId) && $(e.target.parentElement).find(".options").hide());
 },
 listenCaptionChangeEvent:function(t) {
  console.log("listenCaptionChangeEvent start");
  t.caption.off("keypress");
  t.caption.on("keypress", function(e) {
   t.updateSingleAlbumCount();
   var o = t.caption.val().length;
   if (o >= 30 && (e.which >= 48 && e.which <= 90 || e.which >= 186)) {
    e.preventDefault();
    return !1;
   }
   if (13 == e.which) {
    e.preventDefault();
    t.caption.blur();
    return !1;
   }
  });
  t.caption.off("keyup");
  t.caption.on("keyup", function() {
   t.resizeTextArea(this);
  });
  t.caption.add(t.description).off("blur", $.proxy(t.save, t));
  t.caption.add(t.description).on("blur", $.proxy(t.save, t));
  console.log("listenCaptionChangeEvent end");
 },
 enableStickyScrolling:function(t) {
  console.log("enableStickyScrolling");
  $(".scroll_sav_grid").off("scroll");
  $(".scroll_sav_grid").on("scroll", function() {
   t.listenStickyScroll();
  });
 },
 listenStickyScroll:function() {
  $(".addphotos-dropdown").removeClass("open").css("left", "-9999px");
  $("#singleAlbumsort").removeClass("open").css("left", "-9999px");
  var t = $(".stickyicons");
  t.css("maxWidth", $("#single_album_grid").outerWidth(!0));
  var e = $(".album-left-buttons"), o = this.softHeaderHeight + Math.abs(parseInt(t.css("margin-top"))), i = !1;
  ($("#savAssetOperationsArea").offset().top > o || photoOrg.photoLib.config.loadAsPhotoPicker) && (i = !0);
  if (!i && !this.activatedSticky && e.offset().top <= this.softHeaderHeight) {
   this.activatedSticky = !0;
   t.find(".hero-image").show();
   t.find(".overlay").show();
   t.css({
    position:"fixed",
    "z-index":"100",
    top:o + "px"
   });
   $("#savAssetOperationsArea").hide();
   $(".scroll-back-btn").show();
  } else if (!i && this.activatedSticky && $(".scroll_sav_grid").scrollTop() <= t.height() + t.offset().top) {
   t.find(".overlay").hide();
   this.deActivateStickyBar();
  }
  photoOrg.rearrange_assets_view.reArrangeMode ? eventBus.trigger(eventBus.CUSTOM_EVENT_REARRANGE_MODE_SCROLLING, {}) :eventBus.trigger(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_SCROLLING, {});
 },
 deActivateStickyBar:function() {
  var t = $(".stickyicons");
  this.activatedSticky = !1;
  $("#savAssetOperationsArea").show();
  $(".scroll-back-btn").hide();
  t.find(".hero-image").hide();
  t.css({
   position:"relative",
   "z-index":"100",
   top:"0px"
  });
 },
 listenScrollEvent:function(t) {
  if (photoOrg.noOfPages > 1 && t.isAssetsLoaded && 0 == $("#savLoadingBar").length && !photoOrg.rearrange_assets_view.reArrangeMode && !t.frndsAlbum && !t.classicAlbum) {
   var e = "<div class='text-center'><span id='savLoadingBar' class='icon-po-spin5 animate-spin savLoadingBar' width='30' height='12'></span></div>";
   $("#single_album_grid").parent().append(e);
  }
 },
 resizeTextArea:function(t) {
  var e = $(t), o = parseInt(e.css("min-height"), 10);
  $(t).height(o);
  var i = e.prop("scrollHeight"), s = i % o, r = i - s;
  $(t).height(r);
 },
 getAssetText:function(t) {
  return t > 1 ? window.translations.asset_text.photos :window.translations.asset_text.photo;
 },
 updatePhotoCount:function() {
  var t = $(this.el).find(".album-info .count .cols .left");
  this.photosCount = this.photosCount - 1;
  this.photosCount && t.text(this.photosCount + " " + this.getAssetText(this.photosCount));
 },
 getAlbumFetcher:function() {
  return new AssetFetcher();
 },
 errorCallBack:function() {
  try {
   $("#loadingBar").hide();
   photoOrg.photoLib.requestProcessing = !1;
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:errorCallBack", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 socialErrorCallBack:function(t, e) {
  try {
   photoOrg.jsWarningLogger('"social api call failed with following error:"' + t.responseText);
   $("#loadingBar").hide();
   photoOrg.photoLib.requestProcessing = !1;
   e.getAlbumFetcher().getUnsharedSingleAlbum("", e.params, $.proxy(e.requestFirstAssetInAlbum, e), e.errorCallBack, e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:socialErrorCallBack", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 detailsViewAssetSelectIconClicked:function(t) {
  try {
   var e = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(t.model.id), o = $("#" + t.model.id + "po_sav");
   t.isSelected && void 0 != o ? photoOrg.commonAssetView.clickOnAssetUnSelectIcon(o, e) :t.isSelected || void 0 == o || photoOrg.commonAssetView.clickOnAssetSelectIcon(o, e);
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:detailsViewAssetSelectIconClicked", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 getNextOrPreviousAssets:function() {
  var t = this.sortOrder;
  "customOrder" == t && (this.uraparam = "&sortCriteria=customOrder");
  if ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) var e = {
   albumId:this.albumId,
   urlparam:"&assetType=ALL&limit=" + photoOrg.photoLib.limit + "&skip=" + this.skip + this.uraparam
  }; else var e = {
   albumId:this.albumId,
   urlparam:"&limit=" + photoOrg.photoLib.limit + "&skip=" + this.skip + this.uraparam
  };
  this.getAlbumFetcher().getSingleAlbumInfo("", e, this.processResponse, this.errorCallBack, this);
 },
 requestNextAssetSetInSAV:function(t) {
  try {
   this.isAssetsLoaded = !0;
   if (!(this.skip >= 0 && (this.skip + photoOrg.photoLib.limit < this.photosCount || null != t))) {
    this.isAssetsLoaded = !1;
    return;
   }
   $(this.el).empty();
   this.skip = void 0 != t && null != t ? photoOrg.photoLib.limit * (t - 1) :this.skip + photoOrg.photoLib.limit;
   this.totalCount = this.skip;
   this.getNextOrPreviousAssets();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:requestNextAssetSetInSAV", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 closeGrid:function() {
  try {
   this.unbind();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:closeGrid", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 processSocialDetailResponse:function(t, e) {
  console.log("processSocialDetailResponse start");
  if (t.entities && 0 == t.entities.length && t.errors.length > 0 && t.errors[0] && -1 != t.errors[0].description.indexOf("collection does not exist for the item id")) {
   $("#loadingBar").hide();
   $(".empty_shared_albums").show();
   $(".empty_shared_albums p").text(window.translations.empty_single_album_view);
   e.showSubheader();
   photoOrg.selectedAlbumId = "";
   $("#browseAlbums").hide();
   $("#library .albums").removeClass("selected");
  } else if (t && t.entities.length) {
   e.socialResponse = t.entities[0];
   e.albumResponse = t.entities[1];
   e.dataCenter = e.socialResponse.dataCenter;
   e.ownerAccountId = e.socialResponse.ownerAccountId;
   (1 == e.photosCount || void 0 == e.photosCount) && (e.photosCount = t.entities[1].assetIdList.length);
   e.firstAssetInfo = t.entities[0].firstAssetId;
   e.albumDescription = photoOrg.photoLib.getValue(t.entities[1].userTags, "description");
   e.albumCaption = photoOrg.photoLib.getValue(t.entities[1].userTags, "caption");
   e.userTags = t.entities[1].userTags;
   e.coverPhotoAsset = t.entities[1];
   photoOrg.photoLib.isFavorite = e.albumResponse.systemTags && "true" == photoOrg.photoLib.getValue(e.albumResponse.systemTags, "isFavorite") ? !0 :!1;
   var o = 0, i = $(window).width(), s = $(window).height();
   o = Math.round(i >= s ? i :s);
   o = photoOrg.Util.getThumbnailDimension(o);
   e.coverImage = photoOrg.photoLib.getThumbDataFromCollection(e.coverPhotoAsset, o).thumb;
   if ("SHARED_WITH_ME" == e.accessType) {
    t = e.formatSharedAlbumResponsedata(t, e);
    e.processResponse(t, e);
   } else {
    var r = "ascending";
    if (e.albumResponse && e.albumResponse.systemTags) {
     e.sortCode = photoOrg.photoLib.getValue(e.albumResponse.systemTags, "sortCode") || "DAS";
     r = e.getSortOrderFromSortCode(e.sortCode);
    }
    "customOrder" == r && (e.uraparam = "&sortCriteria=customOrder");
    var n = {
     albumId:e.albumId,
     urlparam:"&limit=" + photoOrg.photoLib.limit + "&skip=" + e.skip + e.uraparam
    };
    ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) && (n.urlparam += "&assetType=ALL");
    "customOrder" != r && -1 == n.urlparam.indexOf("sortOrder") && (n.urlparam += "&sortOrder=" + r);
    e.getAlbumFetcher().getSingleAlbumInfo("", n, e.processResponse, e.errorCallBack, e);
   }
   console.log("processSocialDetailResponse end");
  } else e.getAlbumFetcher().getUnsharedSingleAlbum("", {
   albumId:e.albumId
  }, $.proxy(e.requestFirstAssetInAlbum, e), e.errorCallBack, e);
 },
 formatSharedAlbumResponsedata:function(t, e) {
  var o = {};
  o.entities = [];
  e.assetIdList = t.entities[1].assetIdList;
  for (var i = 0; i < t.entities[1].assetIdList.length; i++) o.entities.push(photoOrg.shareModelResponseFormat.prepareMockAssetObject(t.entities, e, i));
  o.resultCount = t.entities[1].assetIdList.length;
  o.totalEntitiesCount = t.entities[1].assetIdList.length;
  return o;
 },
 deleteAlbumInSAV:function() {
  try {
   $("#loadingBar").show();
   var t = {
    caption:this.albumCaption
   };
   photoOrg.photoLib.doCollectionAssetRequestAndShowConfirmation(this.albumId, t, this, this.uraparam);
   $("#hovermore").css("left", "-99999px");
   photoOrg.Util.trackLinksAndButtons("Delete Album", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:single_album_view:deleteAlbumInSAV", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 deleteSuccessCallback:function(t, e) {
  photoOrg.photoLib.selectedAlbumAssets = [];
  photoOrg.currentMonth = "";
  photoOrg.photoLib.Util.albumsViewController.currentPage = 0;
  $("#loadingBar").hide();
  photoOrg.photoLib.deselectImagesFromTrayAfterAlbumDelete();
  photoOrg.selectedAlbumId = "";
  e.backToAlbums();
 },
 deleteErrorCallback:function(t, e) {
  $("#loadingBar").hide();
  console.log("Error deleting album from single album view: ", e);
 },
 updateAlbumDate:function() {
  try {
   var t = $("#datepicker").datepicker("getDate"), e = new Date(this.albumResponse.createDate);
   $("#datepicker").hide();
   $("#datepicker_textArea").css("background-color", "");
   $("#datepicker_textArea").show();
   if (t.getDate() != e.getDate() || t.getMonth() + 1 != e.getMonth() + 1 || t.getYear() != e.getYear()) {
    $("#datepicker_textArea").val($("#datepicker").val());
    $("#loadingBar").show();
    var o = new AssetFetcher();
    o.updateAlbumDate("", {
     abumId:photoOrg.photoLib.currentAlbumId,
     newDate:t.getTime()
    }, $.proxy(this.successUpdateDateCallBack, this), $.proxy(this.saveErrorCallback, this), this);
    photoOrg.Util.trackLinksAndButtons("ChangeAlbumDate", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   }
  } catch (i) {
   $("#loadingBar").hide();
   console.log("Got an error while updating date of an album");
  }
 },
 successUpdateDateCallBack:function(t) {
  this.albumResponse = t;
  $("#loadingBar").hide();
  $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder"), $.jStorage.get(gon.staticContent.account_id + "_av_sortCriteria");
  this.setCurrentMonth();
 },
 close:function() {
  photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.reset();
  photoOrg.photoLib.isSingleAlbumAssetsLoaded = !1;
  this.skip = 0, eventBus.off(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_SCROLLING, this.processScroll, this);
  eventBus.off(eventBus.CUSTOM_EVENT_CANCEL_SELECTED_SINGLE_ALBUM_ASSETS, this.removeSelectedAssets, this);
  eventBus.off(eventBus.CUSTOM_EVENT_LOAD_SINGLE_ALBUM_USER_ASSETS, this.getSingleAlbumInfo, this);
  eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_SHOW_NEXT_ASSET, this.showNextAssetInDetailView, this);
  eventBus.off(eventBus.CUSTOM_EVENT_SINGLE_ALBUM_RELOAD, this.reload, this);
  eventBus.off(eventBus.CUSTOM_EVENT_NEXT_SET_SAV, this.requestNextAssetSetInSAV, this);
  eventBus.off(eventBus.CUSTOM_EVENT_DETAILED_ASSET_SELECT_ICON_CLICKED, this.detailsViewAssetSelectIconClicked, this);
  eventBus.off(eventBus.CUSTOM_EVENT_WINDOW_RESIZE);
  eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
  $(this.el).off();
  this.unbind();
  this.caption && this.caption.off();
  this.description && this.caption.off();
  this.showSubheader();
  eventBus.off(eventBus.CUSTOM_EVENT_MAKE_ALBUM_COVER, this.updateAlbumCover, this);
  eventBus.off(eventBus.CUSTOM_EVENT_ASSET_DELETED);
  eventBus.off(eventBus.CUSTOM_EVENT_SHARE_ALBUM_FROM_SLIDESHOW);
  $(window).off("resize.longPressOnResize");
 },
 setCurrentMonth:function(t) {
  if (photoOrg.photoLib.Util.historyState.pg != photoOrg.constants.FAVOURITE_SINGLE_ALBUM_VIEW) {
   var e = $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder"), o = $.jStorage.get(gon.staticContent.account_id + "_av_sortCriteria"), t = t || this.albumResponse;
   if (o && "updateDate" == o) {
    var i = new Date(t.updateDate), s = i.getMonth() + 1;
    photoOrg.currentMonth = i.getFullYear() + "-" + (10 > s ? "0" + s :s);
   } else if (e) {
    var i = new Date(t.createDate), s = i.getMonth() + 1;
    photoOrg.currentMonth = i.getFullYear() + "-" + (10 > s ? "0" + s :s);
   }
  }
 },
 getSortCode:function(t, e) {
  if ("dateTaken" == t) {
   if ("descending" == e) return photoOrg.constants.sortCodes.DTD;
   if ("ascending" == e) return photoOrg.constants.sortCodes.DAS;
  }
  if ("createDate" == t) {
   if ("descending" == e) return photoOrg.constants.sortCodes.CDS;
   if ("ascending" == e) return photoOrg.constants.sortCodes.CAS;
  }
  if ("updateDate" == t) {
   if ("descending" == e) return photoOrg.constants.sortCodes.UDS;
   if ("ascending" == e) return photoOrg.constants.sortCodes.UAS;
  }
  return "customOrder" == t ? photoOrg.constants.sortCodes.CUP :void 0;
 },
 addTagErrorCallback:function(t) {
  photoOrg.jsErrorLogger(t.error, url);
 },
 addTagSuccessCallback:function() {},
 getSortOrderFromSortCode:function(t) {
  return t ? photoOrg.constants.sortCodes.DTD == t ? "descending" :photoOrg.constants.sortCodes.DAS == t || photoOrg.constants.sortCodes.DDS == t ? "ascending" :photoOrg.constants.sortCodes.CUP == t ? "customOrder" :void 0 :"ascending";
 },
 editHeroImage:function() {
  $(".sav-hero-img figure").css("z-index", "99999999999");
  $(".sav-hero-img figure").css("background-position", "0px 0px");
  $(".sav-hero-img figure").backgroundDraggable();
 }
});

var photoOrg = photoOrg || {};

photoOrg.BrowseAlbums = Backbone.View.extend({
 TRAY_ANIMATION_DURATION:350,
 THUMNAIL_ANIMATION_DURATION:500,
 LIMIT:25,
 skip:0,
 albumId:null,
 container:null,
 albumsContainer:null,
 open:!1,
 grid:null,
 pagination:null,
 collagePlusTimer:null,
 initial:!0,
 lastThumbnail:null,
 relativePosition:0,
 albumsContainer:0,
 currentLastIndex:0,
 isLoading:!1,
 spinner:null,
 noFurtherAlbums:!1,
 initialize:function(t) {
  try {
   console.log("Browse albums initialize...");
   this.albumId = t.albumId;
   this.container = t.container;
   this.albumsContainer = this.$el.find(".albums-container");
   this.grid = t.grid;
   this.pagination = this.$el.find(".album-pagination");
   this.spinner = this.$el.find(".spinner");
   eventBus.on(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
   this.pagination.hide();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 toggleAlbums:function() {
  console.log("Toggling Browse albums ...");
  (this.open = !this.open) ? this.openTray() :this.closeTray();
  this.collagePlusTimer && clearTimeout(this.collagePlusTimer);
  this.collagePlusTimer = setTimeout(function() {
   $("#single_album_grid").collagePlus();
  }, this.TRAY_ANIMATION_DURATION);
 },
 openTray:function() {
  try {
   console.log("Opening Browse albums Tray...");
   this.initial && this.getAlbums();
   this.container.addClass("show-browse-view");
   $(".library-dropdown #hover10.addphotos-dropdown").addClass("lower");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:openTray", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 closeTray:function() {
  try {
   console.log("Closing Browse albums Tray...");
   this.container.removeClass("show-browse-view");
   $(".library-dropdown #hover10.addphotos-dropdown").removeClass("lower");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:closeTray", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getAlbums:function() {
  try {
   this.isLoading = !0;
   this.spinner.show();
   var t = this.getAssetFetcher(), e = this.getUrl();
   t.getAlbumsData(e, {}, $.proxy(this.onAlbumsLoaded, this), $.proxy(this.onError, this), this);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:getAlbums", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 getUrl:function() {
  var t = "", e = photoOrg.photoLib.Util.historyState;
  t = void 0 != e.pgvw && -1 !== e.pgvw.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) ? gon.staticContent.pict_service + "social/feed/collection?type=received&friendsInfo=false&skip=" + this.skip + "&limit=" + this.LIMIT :void 0 != e.pgvw && -1 !== e.pgvw.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW) ? gon.staticContent.pict_service + "social/feed/collection?type=ownedShared&friendsInfo=true&skip=" + this.skip + "&limit=" + this.LIMIT :gon.staticContent.pict_service + "collection/list?collectionShown=owned&skip=" + this.skip + "&limit=" + this.LIMIT;
  return t;
 },
 getAssetFetcher:function() {
  return new AssetFetcher();
 },
 onAlbumsLoaded:function(t) {
  console.log("at onAlbumsLoaded...");
  if (this.initial) {
   this.totalAlbumsCount = t.totalEntitiesCount;
   this.initial = !1;
  }
  var e = photoOrg.photoLib.Util.historyState, o = t.entities;
  if (0 != o) {
   for (var i = o.length, s = 0; i > s; s++) {
    var r = o[s], n = photoOrg.photoLib.getThumbDataFromCollection(r), a = n.thumb, l = "", c = "";
    if (e.pgvw && -1 !== e.pgvw.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW)) {
     c = window.translations.by + " ";
     l = r.caption;
     c += r.ownerInfo ? r.ownerInfo.firstName :window.translations.someone;
    } else if (e.pgvw && -1 !== e.pgvw.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW)) {
     c = window.translations["with"] + " ";
     l = r.caption;
     c += r.view.length > 0 ? r.view[0].firstName :window.translations.someone;
    } else l = photoOrg.photoLib.getValue(r.userTags, "caption");
    photoOrg.photoLib.getValue(r.systemTags, "isFavorite") && (l = window.translations.sub_header.favorite_alb);
    "undefined" == typeof c && (c = "");
    var h = r.id, d = 0;
    try {
     d = r.assetIdList.length;
    } catch (p) {}
    var u = {
     current:this.albumId === h,
     albumId:h,
     count:d,
     albumImgUrl:a,
     albumName:l,
     caption:c,
     dc:"",
     albumOwnerId:"",
     createDate:"",
     isShared:"false"
    };
    if (void 0 != e.pgvw && (-1 !== e.pgvw.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) || -1 !== e.pgvw.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW))) {
     u.albumOwnerId = r.ownerInfo ? r.ownerInfo.accountId :r.ownerAccountId;
     u.dc = r.ownerInfo ? r.ownerInfo.dc :r.dataCenter;
    }
    (void 0 == u.albumOwnerId || "" == u.albumOwnerId) && (u.albumOwnerId = r.ownerAccountId);
    (void 0 == u.dc || "" == u.dc) && (u.dc = r.dataCenter);
    "Private" == photoOrg.photoLib.getValue(r.systemTags, "Share") && (u.isShared = "true");
    var g = JST["templates/common/library/album_view/album-thumbnail"](u);
    this.albumsContainer.append(g);
    if (s === i - 1) {
     this.lastThumbnail = this.albumsContainer.find("[data-album-id=" + h + "]");
     this.currentLastIndex = s + this.skip;
    }
   }
   this.refreshThumbnailEvents();
  } else {
   this.pagination.filter(".next").hide();
   this.noFurtherAlbums = !0;
   this.spinner.hide();
   this.isLoading = !1;
  }
 },
 refreshThumbnailEvents:function() {
  this.$el.find(".album-thumbnail").off();
  this.$el.find(".album-thumbnail").on("click", $.proxy(this.onThumbnailClick, this));
  this.albumsContainerWidth = this.lastThumbnail.position().left + this.lastThumbnail.outerWidth(!0);
  this.pagination.on("click", $.proxy(this.onPaginationClick, this));
  this.isLoading = !1;
  this.spinner.hide();
  var t = this.albumsContainer.position().left;
  this.updatePagination(t);
 },
 onThumbnailClick:function(t) {
  try {
   console.log("Browse albums - onThumbnailClick method");
   var e = $(t.currentTarget);
   if (e.hasClass("current")) return;
   this.$el.find(".album-thumbnail").removeClass("current");
   e.addClass("current");
   {
    var o = e.data("album-id");
    e.data("photos-count");
   }
   photoOrg.selectedAlbumId = o;
   var i, s = photoOrg.photoLib.Util.historyState;
   if (void 0 == s.pgvw || -1 === s.pgvw.indexOf(photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) && -1 === s.pgvw.indexOf(photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW)) {
    i = {
     id:o
    };
    photoOrg.photoLib.isShared = "true" == e.attr("data-isShared") ? !0 :!1;
   } else {
    var r = e.attr("data-album-owner-id"), n = e.attr("data-dc");
    i = {
     id:o,
     ownerId:r,
     dc:n
    };
   }
   photoOrg.photoLib.loadSingleAlbumView(i);
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:onThumbnailClick", errorCode="LIBRARY:MYALBUMS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 onPaginationClick:function(t) {
  try {
   console.log("Browse albums - onPaginationClick method");
   if (this.isLoading) return;
   var e = this.$el.width(), o = 1;
   $(t.currentTarget).hasClass("previous") && (o = -1);
   var i = this.albumsContainer.position().left - e * o;
   i = Math.min(0, Math.max(i, -(this.albumsContainerWidth - e)));
   this.relativePosition = e / i;
   this.updateAlbumsContainer(i);
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:onPaginationClick", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 updateAlbumsContainer:function(t) {
  try {
   console.log("Browse albums - updateAlbumsContainer method");
   this.albumsContainer.stop().animate({
    left:t
   }, {
    step:$.proxy(function(t) {
     this.updatePagination(t);
    }, this),
    duration:this.THUMNAIL_ANIMATION_DURATION
   });
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:updateAlbumsContainer", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 updatePagination:function(t) {
  try {
   console.log("Browse albums - updatePagination method");
   if (!this.lastThumbnail) return;
   var e = this.$el.width(), o = this.lastThumbnail.offset().left + this.lastThumbnail.width();
   if (e >= o && t >= 0) this.pagination.hide(); else {
    this.pagination.filter(".next").show();
    t >= 0 ? this.pagination.filter(".previous").hide() :this.pagination.filter(".previous").show();
    var i = photoOrg.photoLib.Util.historyState;
    if (Math.abs(t) >= this.albumsContainerWidth - e) if (this.currentLastIndex < this.totalAlbumsCount && this.skip + this.LIMIT < this.totalAlbumsCount) {
     this.skip = this.skip + this.LIMIT;
     this.spinner.show();
     this.getAlbums();
    } else if (void 0 != i.pgvw && -1 == i.pgvw.indexOf(photoOrg.constants.SINGLE_ALBUM_VIEW)) {
     if (this.noFurtherAlbums) {
      this.pagination.filter(".next").hide();
      return;
     }
     this.skip = this.skip + this.LIMIT;
     this.spinner.show();
     this.getAlbums();
    } else this.pagination.filter(".next").hide();
   }
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:updatePagination", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 resize:function() {
  try {
   var t = this.albumsContainer.position().left;
   this.initial && (t = 0);
   this.updateAlbumsContainer(t);
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:resize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 onError:function() {},
 destroy:function() {
  try {
   this.albumsContainer.empty();
   this.pagination.hide();
   this.spinner.hide();
   this.closeTray();
   this.$el.off();
   eventBus.off(eventBus.CUSTOM_EVENT_LIBRARY_ASSETGRID_RESIZE, this.resize, this);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:browse_albums:destroy", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }
});

Backbone.Collection.prototype.move = function(t, e) {
 var o = this.indexOf(t);
 if (-1 == o) throw new Error("Can't move a model that's not in the collection");
 o !== e && this.models.splice(e, 0, this.models.splice(o, 1)[0]);
};

photoOrg.Rearrange_assets_view = Backbone.View.extend({
 el:"#album_assets",
 emptyGrid:!0,
 nextToTheAsset:!1,
 beforeToTheAsset:!1,
 reArrangeMode:!1,
 before_RA_collection:[],
 isReArranged:!1,
 finalCollection:[],
 nextAsset:"",
 prevAsset:"",
 tAseet:"",
 lastAsset:!0,
 initialize:function(t) {
  try {
   console.log("Rearrange assets view initialize...");
   eventBus.off(eventBus.CUSTOM_EVENT_REARRANGE_MODE_SCROLLING);
   eventBus.off(eventBus.CUSTOM_EVENT_REARRANGE_DONE);
   eventBus.off(eventBus.CUSTOM_EVENT_REARRANGE_CANCEL);
   eventBus.on(eventBus.CUSTOM_EVENT_REARRANGE_MODE_SCROLLING, this.reArrangeModeScroll, this);
   eventBus.on(eventBus.CUSTOM_EVENT_REARRANGE_DONE, this.reArrangeDone, this);
   eventBus.on(eventBus.CUSTOM_EVENT_REARRANGE_CANCEL, this.reArrangeCancel, this);
   $("#mobile-reArrange .reArrange-buttons .donebtn").off("click");
   $("#mobile-reArrange .reArrange-buttons .cancelbtn").off("click");
   $("#mobile-reArrange .reArrange-buttons .donebtn").on("click", $.proxy(this.reArrangeDone, this));
   $("#mobile-reArrange .reArrange-buttons .cancelbtn").on("click", $.proxy(this.reArrangeCancel, this));
   photoOrg.noOfPages = photoOrg.photoLib.getNoOfPagestoDisplay(t.photos_count);
   this.parentObj = t;
   this.before_RA_collection = new photoOrg.pictCollection();
   $("#library .scroll_sav_grid").on("scroll", function() {
    try {
     console.log("on scroll listned");
     $(".assetImg.lazy").show().lazyload();
    } catch (t) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:initialize:scroll", errorCode="LIBRARY:MYALBUMS",, errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
    }
   });
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 events:{
  "click #customSort":"reArrangeInitialise",
  "click .reArrange-buttons .donebtn":"reArrangeCancel",
  "click .reArrange-buttons .cancelbtn":"reArrangeDone"
 },
 reArrangeDone:function() {
  try {
   console.log("Rearrange done.......");
   $("#loadingBar").show();
   this.isReArranged = !0;
   var t = $("#single_album_grid").children(), e = [];
   photoOrg.rearrange_assets_view.reArrangeMode = !1;
   for (i = 0; i < t.length; i++) if (t[i].id) {
    t.length == i && (lastElement = id);
    var o = this.getAssetIDFromString(t[i].id);
    e.push(this.getAssetIDFromString(t[i].id));
    console.log("element for rearrage.." + o);
   }
   e = _.uniq(e);
   if (this.parentObj.collection.models.length != e.length) {
    var s = {};
    s.userAccountId = gon.staticContent.account_id;
    s.userAlbumId = this.parentObj.albumId;
    s.userPageView = photoOrg.photoLib.Util.historyState.pgvw;
    s.generatedDomCount = t.length;
    s.pictIdsFromCollection = this.parentObj.pict_ids;
    s.collectionModelCount = this.parentObj.collection.models.length;
    s.savAssetIds = e;
    s.savAssetIdsCount = e.length;
    s.noodle = "";
    photoOrg.reArrangeErrorInfo = s;
   }
   console.log("final savAssetids are.." + e);
   var r = {
    assetIdList:e
   }, n = {
    assetIds:r,
    albumId:this.parentObj.albumId
   };
   $("#single_album_grid").removeClass("right-rearrange-margin");
   new AssetFetcher().multiReArrangeAlbum("", n, $.proxy(this.multiRASuccessResponse, this), $.proxy(this.multiRAFailResponse, this), this);
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:reArrangeDone", errorCode="LIBRARY:MYALBUMS", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 multiRASuccessResponse:function(t, e) {
  console.log("success res");
  $(".drag-drop").draggable("disable");
  this.parentObj.sortCode = "CUP";
  this.parentObj.sortOrder = "customOrder";
  this.parentObj.albumResponse.systemTags = t.entities[0].systemTags;
  $(".reArrange").show();
  $(".assetImg.lazy").lazyload({
   effect:"fadeIn"
  });
  $("#single_album_grid").empty();
  var o = $.jStorage.get(gon.staticContent.account_id + "_av_sortOrder"), i = $.jStorage.get(gon.staticContent.account_id + "_av_sortCriteria");
  if (i && "updateDate" == i) {
   var s = new Date(t.entities[0].updateDate);
   photoOrg.currentMonth = s.getFullYear() + "-" + (s.getMonth() + 1);
  } else if (o) {
   var s = new Date(t.entities[0].updateDate);
   photoOrg.currentMonth = s.getFullYear() + "-" + (s.getMonth() + 1);
  }
  e.showHeroImageSection();
  this.handleTray();
  e.parentObj.deActivateStickyBar();
  e.parentObj.selectDeselectSortOrder("customOrder");
  $("#library .scroll_sav_grid").scroll(function() {
   $(".assetImg.lazy").show().lazyload();
  });
  $("#savLoadingBar").show();
  photoOrg.Util.trackLinksAndButtons("single_album_view_re-arrange", "singleAlbumDetail");
  e.reArrangeMode = !1;
  var r = !0;
  e.requestForNextAssetsSet(r);
 },
 handleTray:function() {
  console.log("Handling Tray...");
  $("#right-well").removeClass("full");
  if ($(window).width() > 900) $("#right-well").removeClass("full"); else if ($(window).width() <= 900) {
   photoOrg.photoLib.SelectedAsset.selectedAssets.length <= 0 && photoOrg.projectTrayView && photoOrg.projectTrayView.hideTray();
   $(".mobile-selection-tray").removeClass("hide");
   $("#mobile-reArrange").hide();
   $("#selection-productList").show();
  }
 },
 multiRAFailResponse:function(t, e, o, i, s) {
  var r = '"Error in reArrange:' + o + '", errorCode="LIBRARY:ReArrange", errorThrown="' + i + '"';
  if (photoOrg.reArrangeErrorInfo) {
   photoOrg.reArrangeErrorInfo.noodle = s;
   r = "ReArrange - generated assetIds and collection models count mismatched : " + JSON.stringify(photoOrg.reArrangeErrorInfo);
  }
  console.log(r);
  photoOrg.jsErrorLogger(r);
 },
 reArrangeModeScroll:function() {
  try {
   console.log("Rearrange assets view scroll.....");
   $("#library .scroll_sav_grid").scroll(function() {
    $(".assetImg.lazy").show().lazyload();
   });
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:reArrangeModeScroll", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 requestForNextAssetsSet:function(t) {
  console.log("Rearrange assets view - requestForNextAssetsSet method");
  var e = this.parentObj.sortOrder, o = "dateTaken";
  if (null == e) {
   e = "ascending";
   "createDate" == photoOrg.photoLib.Util.historyState.so && (o = "createDate");
  }
  var i = "&sortCriteria=" + o + "&sortOrder=" + e;
  "customOrder" == e && (i = "&sortCriteria=customOrder");
  var s = {
   albumId:this.parentObj.albumId,
   urlparam:"&assetType=PICTURE" + i
  };
  ("true" == photoOrg.Util.getURLParameter("video") || gon.staticContent.video) && (s.urlparam = "&assetType=ALL" + i);
  t && (s.urlparam += "&skip=0&limit=" + photoOrg.photoLib.limit);
  this.parentObj.collection.reset();
  this.parentObj.pict_ids.length = 0;
  new AssetFetcher().getSingleAlbumInfo("", s, this.parentObj.processResponse, this.parentObj.errorCallBack, this.parentObj);
 },
 reArrangeInitialise:function() {
  try {
   console.log("Rearrange assets view - reArrangeInitialise method");
   $("#hovermore").css("left", "-99999px");
   photoOrg.likesCommentsControllerView && photoOrg.likesCommentsControllerView.close();
   $("#single_album_grid").addClass("right-rearrange-margin");
   $("#loadingBar").show();
   $("#savLoadingBar").hide();
   this.parentObj.isAssetsLoaded = !1;
   this.parentObj.skip = 0;
   this.before_RA_collection = new Backbone.Collection(this.parentObj.collection.toJSON());
   if ($(window).width() <= 900) {
    photoOrg.projectTrayView && photoOrg.projectTrayView.showTray();
    $(".mobile-selection-tray").addClass("hide");
    $("#mobile-reArrange").show();
    $("#selection-productList").hide();
   } else $(window).width() > 900 && $("#right-well").addClass("full");
   this.reArrangeMode = !0;
   var t = !1;
   this.requestForNextAssetsSet(t);
   $("#reArrangeDone").prop("disabled", !0);
   var e = $("#mobile-reArrange").find("#reArrangeDone");
   e.prop("disabled", !0);
   e.addClass("ra-disable");
   $("#reArrangeDone").addClass("ra-disable");
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:reArrangeInitialise", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 reArrangeCancel:function() {
  try {
   console.log("Rearrange cancel.....");
   this.emptyGrid = !0;
   $("#single_album_grid").removeClass("right-rearrange-margin");
   $("#library .scroll_sav_grid").off("scrollstop");
   $("#savLoadingBar").show();
   $("#loadingBar").show();
   this.reArrangeMode = !1;
   $("#single_album_grid").empty();
   var t = this.parentObj.sortOrder;
   if ("customOrder" == t) {
    this.parentObj.uraparam = "&sortCriteria=customOrder";
    this.parentObj.sortOrder = t;
   } else this.parentObj.uraparam += "&sortOrder=" + t;
   this.parentObj.selectDeselectSortOrder(this.parentObj.sortOrder);
   this.parentObj.collection = this.before_RA_collection;
   var e = this.parentObj.collection.length > photoOrg.photoLib.limit ? photoOrg.photoLib.limit :this.parentObj.collection.length;
   this.parentObj.collection.length = e;
   this.parentObj.collection.models.length = e;
   this.handleTray();
   this.parentObj.deActivateStickyBar();
   setTimeout(function() {
    this.parentObj.generatePictView(this.parentObj.collection.models, this.parentObj, !0);
    this.parentObj.listenToEvents(this.parentObj);
    this.parentObj.listenScrollEvent(this.parentObj);
    this.showHeroImageSection();
    $("#library .scroll_sav_grid").scroll(function() {
     $(".assetImg.lazy").show().lazyload();
    });
    $("#single_album_grid").collagePlus();
    $("#loadingBar").hide();
   }.bind(this), 300);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:reArrangeCancel", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 showHeroImageSection:function() {
  console.log("Showing Hero image section after closing rearrange layer");
  photoOrg.rearrange_assets_view.reArrangeMode = !1;
  $(".album-detail-hero").show();
  $("#savAssetOperationsArea").show();
  $(".sort_single_album_sec").show();
  $(".context-menu-buttons").show();
  $(".magnifying-icon").show();
  $("#reArrange-sec").hide();
  $("#single_album_grid").collagePlus();
  $(".assetImg.lazy").lazyload({
   effect:"fadeIn"
  });
 },
 getAssetIDFromString:function(t) {
  var e = t;
  e.substring(0, e.length - 6);
  e = parseInt(e);
  return e;
 },
 reArrangeStart:function() {
  try {
   console.log("Rearrange layer opened...");
   $(".album-detail-hero").hide();
   $("#savAssetOperationsArea").hide();
   $(".sort_single_album_sec").hide();
   $(".context-menu-buttons").hide();
   $(".magnifying-icon").hide();
   $("#right-well").hasClass("show-browse-view") && $(".browse-albums").click();
   $("#reArrange-sec").show();
   var t = this;
   t.saveOffSetvals = [];
   var e = $("#single_album_grid").children();
   for (i = 0; i < e.length; i++) if ("" != e[i].id && void 0 != e[i].id) {
    var o = e[i].id;
    t.saveOffSetvals.push($("#" + o).offset());
   }
   this.listenAndProcessDragDrop(this);
   $(".selectable-asset").off("click");
   $(".assetImg.lazy").show().lazyload();
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:reArrangeStart", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 listenAndProcessDragDrop:function(t) {
  console.log("Rearrange assets view - listenAndProcessDragDrop method");
  $(".drag-drop").draggable({
   connectToSortable:".sortable",
   containment:$("#single_album_grid"),
   placeholder:"drag-drop",
   helper:"clone",
   opacity:1,
   cursorAt:{
    top:30,
    left:30
   },
   helper:function() {
    try {
     var t = {
      tnlUrl:$(this).find(".assetImg").attr("src"),
      id:this.getAttribute("id")
     }, e = $(this);
     e.css("background-color", "#c2c2c2");
     e.find(".assetImg").css("display", "none");
     e.parent().find(".sourceAsset").removeClass("sourceAsset");
     e.addClass("sourceAsset");
     var o = e.height() / 3;
     t.height = o;
     70 > o && (o = 70);
     var i = JST["templates/common/library/single_album_view/cloned-asset"](t);
     console.log("cloned element is .... " + i);
     return i;
    } catch (s) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop draggable clone", errorCode="LIBRARY:MYALBUMS", err_desc="' + s + '" err_stack="' + s.stack + '"');
    }
   },
   drag:function(e, o) {
    try {
     if (void 0 != t.clonedAssetOffSet) {
      var i = $("#" + t.targetAssetId);
      if (1 == t.lastAsset) {
       console.log(" draggable :: lastAsset so hiding ");
       return;
      }
      var s = i.height() + 6, r = '<div class="show-drag-color drag-drop" style="display:inline-block;height: ' + s + 'px;"></div>';
      $(".show-drag-color").remove();
      t.targetImage = void 0;
      if (o.offset.left < t.beforeAsset) {
       t.beforeToTheAsset = !0;
       t.nextToTheAsset = !1;
       console.log("Added before out draggable");
       i.before(r);
       if (photoOrg.Util.isIE || photoOrg.Util.isPad()) i.prev().css("margin-left", "-4px"); else {
        var n = i.offset();
        n.left -= 6;
        i.prev().offset(n);
       }
       console.log(" draggable :: before ");
      } else if (o.offset.left > t.beforeAsset) {
       t.beforeToTheAsset = !1;
       t.nextToTheAsset = !0;
       console.log("Added after out draggable");
       i.after(r);
       if (photoOrg.Util.isIE || photoOrg.Util.isPad()) i.next().css("margin-left", "-4px"); else {
        var n = i.offset();
        n.left += i.width() + 2;
        i.next().offset(n);
       }
       if (i.offset().left + i.outerWidth(!0) >= $("#single_album_grid").offset().left + $("#single_album_grid").width() || -1 !== i.next().attr("class").indexOf("show-drag-color") && "clonedAsset" == $(".show-drag-color").next().attr("id")) {
        console.log(" droppable :: adding back margin ");
        $(".show-drag-color").css("margin-left", "3px");
       }
       console.log(" draggable :: after ");
      }
      t.targetImage = {
       id:t.targetAssetId,
       ui:o
      };
     }
     var a = $("#" + e.target.id), l = $("#clonedAsset"), c = a.offset(), h = l.offset();
     c.top < h.top && c.top + a.height() > h.top + 35 && c.left < h.left && c.left + a.width() > h.left && $(".show-drag-color").remove();
    } catch (d) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop drag", errorCode="LIBRARY:MYALBUMS", err_desc="' + d + '" err_stack="' + d.stack + '"');
    }
   },
   cursor:"move"
  });
  $(".drag-drop").droppable({
   drop:function(e, o) {
    t.targetImage = null;
    t.onDrop(e, o);
   },
   over:function(e, o) {
    try {
     "" == e.target.nextSibling.id && console.log("this might be the last image");
     t.lastAsset = !1;
     {
      $("#" + e.target.id).width();
     }
     t.clonedAssetOffSet = o.helper.offset();
     t.targetAssetWidth = $(this).width();
     t.targetAssetOffSet = $(this).offset();
     t.distanceFrmLeft = t.targetAssetOffSet.left + t.targetAssetWidth;
     t.beforeAsset = $(this).offset().left + t.targetAssetWidth / 2 - 35;
     t.targetAssetId = e.target.id;
    } catch (i) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop droppable over", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
    }
   },
   out:function(e, o) {
    try {
     t.tAsset = $(this)[0];
     t.lastAsset = !0;
     var i = $("#" + t.tAsset.id), s = $(t.tAsset).height() + 6, r = '<div class="show-drag-color drag-drop" style="display:inline-block;height: ' + s + 'px;"></div>';
     console.log("event.target.nextSibling : " + e.target.nextSibling.id + " , event.target.nextSibling.id : " + e.target.nextSibling.id);
     $(".show-drag-color").remove();
     if (e.target.nextSibling.id) {
      if (t.beforeToTheAsset) {
       console.log("Added before  droppable");
       i.before(r);
       if (photoOrg.Util.isIE || photoOrg.Util.isPad()) i.prev().css("margin-left", "-4px"); else {
        var n = i.offset();
        n.left -= 6;
        i.prev().offset(n);
       }
      } else if (t.nextToTheAsset) {
       console.log("Added after  droppable");
       i.after(r);
       if (photoOrg.Util.isIE || photoOrg.Util.isPad()) i.next().css("margin-left", "-4px"); else {
        var n = i.offset();
        n.left += i.width() + 2;
        i.next().offset(n);
       }
       if (i.offset().left + i.outerWidth(!0) >= $("#single_album_grid").offset().left + $("#single_album_grid").width() || -1 !== i.next().attr("class").indexOf("show-drag-color") && "clonedAsset" == $(".show-drag-color").next().attr("id")) {
        console.log(" droppable :: adding back margin ");
        $(".show-drag-color").css("margin-left", "3px");
       }
      }
      t.targetImage = {
       id:t.tAsset.id,
       event:e,
       ui:o
      };
     } else console.log("this might be the last image");
    } catch (a) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop droppable out", errorCode="LIBRARY:MYALBUMS", err_desc="' + a + '" err_stack="' + a.stack + '"');
    }
   }
  });
  $("#single_album_grid").droppable({
   accept:".drag-drop",
   drop:function(e, o) {
    try {
     console.log("event.target.nextSibling in global div-grid: " + t.targetImage);
     if (t.targetImage && $(".sourceAsset").offset()) {
      var i = $(".sourceAsset").offset().left, s = $(".sourceAsset").offset().left + $(".sourceAsset").width(), r = $(".sourceAsset").offset().top, n = $(".sourceAsset").offset().top + $(".sourceAsset").height(), a = $(o.helper).offset().top, l = $(o.helper).offset().left, c = l >= i && s >= l && a >= r && n >= a;
      if (!c) {
       t.onDrop(t.targetImage.event, t.targetImage.ui, t.targetImage);
       t.tAsset = void 0;
      }
      $(".show-drag-color").remove();
      t.targetImage = void 0;
     }
     console.log("dropping after last image");
     $("#reArrangeDone").prop("disabled", !1);
     var h = $("#mobile-reArrange").find("#reArrangeDone");
     h.prop("disabled", !1);
     $("#reArrangeDone").removeClass("ra-disable");
     h.removeClass("ra-disable");
     var d = ($("#single_album_grid").children().length, o.draggable[0]), p = t.tAsset;
     $(".show-drag-color").length > 0 && (p = t.beforeToTheAsset ? $(".show-drag-color").prev() :$(".show-drag-color").next());
     if (void 0 == p) {
      $("#clonedAsset").hide();
      console.log("targetElement : " + p);
      $("#" + d.id).find(".assetImg").css("display", "inline-block");
      return;
     }
     $("#library .scroll_sav_grid").scroll(function() {
      $(".assetImg.lazy").show().lazyload();
     });
     t.clonedAssetOffSet = void 0;
     if ($("#clonedAsset").offset().left == o.offset.left && $("#clonedAsset").offset().top == o.offset.top && 0 == $(".show-drag-color").length) {
      $("#" + d.id).find(".assetImg").css("display", "inline-block");
      return;
     }
     t.placeAndAdjustImage(t, $(d), $(p));
     $(".show-drag-color").remove();
    } catch (u) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop droppable drop", errorCode="LIBRARY:MYALBUMS", err_desc="' + u + '" err_stack="' + u.stack + '"');
    }
   },
   out:function() {
    try {
     console.log("out on single album grid area");
    } catch (t) {
     photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop droppable out", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
    }
   }
  });
 },
 onDrop:function(t, e, o) {
  try {
   if (0 == $(".show-drag-color").length) return;
   $("#loadingBar").show();
   $(".options").off("click");
   $("#reArrangeDone").prop("disabled", !1);
   var i = $("#mobile-reArrange").find("#reArrangeDone");
   i.prop("disabled", !1);
   $("#reArrangeDone").removeClass("ra-disable");
   i.removeClass("ra-disable");
   var s = $(".sourceAsset"), r = "";
   r = $(t ? t.target :"#" + o.id);
   s.offset().top + s.height() <= $("#clonedAsset").offset().top;
   this.clonedAssetOffSet = void 0;
   this.placeAndAdjustImage(this, s, r);
   $(".show-drag-color").remove();
   if (e.draggable && e.draggable.data("drag-drop")) return;
  } catch (n) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:listenAndProcessDragDrop droppable drop", errorCode="LIBRARY:MYALBUMS", err_desc="' + n + '" err_stack="' + n.stack + '"');
  }
 },
 placeAndAdjustImage:function(t, e, o) {
  try {
   e.removeClass("sourceAsset");
   if (t.beforeToTheAsset) {
    o.before(e);
    o.prev().css("background-color", "");
   } else if (t.nextToTheAsset) {
    o.after(e);
    o.next().css("background-color", "");
   }
   $(".sourceAsset").remove();
   $(".show-drag-color").remove();
   $("#" + e.id).find(".assetImg").css("display", "inline-block");
   setTimeout(function() {
    $("#single_album_grid").collagePlus();
    $("#single_album_grid").collagePlus();
    $("#loadingBar").hide();
   }, 150);
   t.listenAndProcessDragDrop(t);
   o.prev().find(".assetImg").show();
   o.next().find(".assetImg").show();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:placeAndAdjustImage", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 reArrangeSuccessCallback:function() {
  console.log("rearrange successcall back");
  this.parentObj.sortOrder = "customOrder";
  $("#single_album_grid").collagePlus();
  $(".assetImg.lazy").lazyload({
   effect:"fadeIn"
  });
  $("#loadingBar").hide();
 },
 reArrangeFailCallback:function() {
  console.log("rearrange failcall back");
 },
 reArrangeDropFail:function() {
  this.parentObj.isAssetsLoaded = !0;
  $("#rearrangeFail").foundation("reveal", "open");
 },
 handleDragStart:function() {
  console.log("handle Drag Start");
 },
 handleDragEnter:function() {
  console.log("drag enter..." + event.currentTarget.id);
  $("#" + event.currentTarget.id).css("border-radius", "25px");
  $("#" + event.currentTarget.id).css("border", "2px solid #73AD21");
 },
 handleDragOver:function() {
  console.log("handle drag over");
  $("#" + event.currentTarget.id).css("border-radius", "25px");
  $("#" + event.currentTarget.id).css("border", "2px solid #73AD21");
 },
 handleDragLeave:function() {
  console.log("handle drag leave");
  $("#" + event.currentTarget.id).css("border-radius", "0px");
  $("#" + event.currentTarget.id).css("border", "2px");
 },
 handleDrop:function() {
  console.log("handle drop");
 },
 handleDragEnd:function() {
  console.log("handle dragend");
 }
});

photoOrg.ReArrangeFailConfirmation = Backbone.View.extend({
 events:{},
 initialize:function() {
  var t = JST["templates/common/library/common/rearrange_assets_fail"]();
  $("#library").append(t);
  this.$el = $(".rearrangeConfirmation");
  this.delegateEvents(_.extend(this.events, {
   "click #close_rearrange":"closeLayer"
  }));
 },
 closeLayer:function() {
  try {
   $(".rearrangeConfirmation").foundation("reveal", "close");
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:rearrange_assets_view:closeLayer", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 }
});

photoOrg.LikesAndCommentsView = Backbone.View.extend({
 el:"#album_assets",
 likesCount:0,
 comments:[],
 likes:[],
 views:[],
 initialize:function(t) {
  try {
   console.log("LikesAndCommentsView - initialize method");
   this.parentObj = t;
   $(".sinalbum-likessec").hide();
   this.$el.on("click", ".likeic", $.proxy(this.likeOrunlike, this));
   this.$el.on("click", ".lkcounttext", $.proxy(this.likesAndComments, this));
   this.$el.on("click", ".album-comment-button", $.proxy(this.likesAndComments, this));
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 showOrhidePanel:function() {
  try {
   console.log("Showing or Hiding panel");
   if ($(".rt-container").hasClass("rt-container-shrink")) {
    $(".rt-container").removeClass("rt-container-shrink");
    $(".mobile-footer").removeClass("hide");
   } else {
    $(".rt-container").addClass("rt-container-shrink");
    $(".mobile-footer").addClass("hide");
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:showOrhidePanel", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onLike:function(t) {
  try {
   console.log("LikesAndCommentsView - onLike method");
   console.log({
    itemId:this.parentObj.albumId,
    itemOnerId:this.parentObj.ownerAccountId,
    itemDC:this.parentObj.dataCenter
   });
   photoOrg.photoLib.like({
    itemId:this.parentObj.albumId,
    itemOwnerId:this.parentObj.ownerAccountId,
    itemDC:this.parentObj.dataCenter
   }, $.proxy(this.successLikesCallBack, this), $.proxy(this.errorLikeCallBack, this), this);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:onLike", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 likesAndComments:function(t) {
  try {
   console.log("LikesAndCommentsView - likesAndComments method");
   if (photoOrg.slideshowViewController) {
    eventBus.off(eventBus.CUSTOM_EVENT_INVOKE_SHOWORHIDEPANEL);
    delete photoOrg.slideshowViewController;
   }
   var e = $(t.currentTarget).attr("class"), o = photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SINGLE_ALBUM_VIEW && photoOrg.photoLib.isShared;
   photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW && (this.parentObj.sharedWithMe = !0);
   this.parentObj.frnds_sav = photoOrg.photoLib.Util.historyState.pgvw == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW;
   this.options = {
    el:this.$el,
    collection:this.parentObj.collection,
    albumData:{
     title:this.parentObj.albumCaption || "",
     ownerName:this.parentObj.ownerName,
     lastName:this.parentObj.lastName,
     sharedWithMe:this.parentObj.sharedWithMe,
     isOwnedAndShared:this.parentObj.isOwnedAndShared,
     sharedWithName:this.parentObj.sharedWithName,
     isClassic:this.parentObj.isClassic,
     shared:o,
     albumId:this.parentObj.albumId,
     ownerAccountId:this.parentObj.ownerAccountId,
     dataCenter:this.parentObj.dataCenter,
     friendsCount:this.parentObj.friendsCount,
     date:this.parentObj.firstAssetIdDate ? moment(this.parentObj.firstAssetIdDate).format("MMM, YYYY") :"",
     description:this.parentObj.albumDescription || "",
     frndsSav:this.parentObj.frndsSav,
     view:this.view,
     comments:this.comments,
     likesCount:this.likesCount,
     likes:this.likes
    },
    likesAndCommentsViewObj:this
   };
   this.options.commentsCountEl = $(".album-right-buttons .commentsCountText");
   this.options.likesCountEl = $(".album-hero-button .lkcounttext");
   this.options.isLiked = this.isLiked;
   this.options.hightlightSlideShowTabs = !1;
   photoOrg.likesCommentsControllerView = new photoOrg.LikesCommentsControllerView({
    options:this.options
   });
   -1 !== e.indexOf("album-comment-button") ? photoOrg.likesCommentsControllerView.prepareCommentsDom() :photoOrg.likesCommentsControllerView.prepareLikeDom();
   this.showOrhidePanel(e, this.clickedSameButton);
   $("#single_album_grid").collagePlus();
  } catch (i) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:likesAndComments", errorCode="LIBRARY:MYALBUMS", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
 },
 likeOrunlike:function(t) {
  try {
   photoOrg.Util.trackLinksAndButtons("Likes", "singleAlbumDetail");
   $(".album-like-button").hasClass("tab-active") ? this.onUnLike() :this.onLike();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:likeOrunlike", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 onUnLike:function(t) {
  try {
   console.log("LikesAndCommentsView - onUnLike method");
   photoOrg.photoLib.unlike({
    itemId:this.parentObj.albumId,
    itemOwnerId:this.parentObj.ownerAccountId,
    itemDC:this.parentObj.dataCenter
   }, $.proxy(this.successLikesCallBack, this), $.proxy(this.errorLikeCallBack, this), this);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_and_comments_view:onUnLike", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 isUserLiked:function(t, e) {
  console.log("Checked whether user liked or not");
  var o = !1;
  for (i = 0; i < t.socialResponse.likes.length > 0; i++) e == t.socialResponse.likes[i] && (o = !0);
  return o;
 },
 showHideLikes:function(t, e, o) {
  if (o) {
   e.socialResponse = t.entities[0];
   if (photoOrg.likesCommentsControllerView) {
    var i = photoOrg.likesCommentsControllerView.likesView;
    e.likesCount = i.options.albumData.likesCount = 0 == e.socialResponse.likesCount ? "" :e.socialResponse.likesCount;
    e.view = i.options.albumData.view = e.socialResponse.view;
    e.likes = i.options.albumData.likes = e.socialResponse.likes;
   } else {
    e.likesCount = 0 == e.socialResponse.likesCount ? "" :e.socialResponse.likesCount;
    e.view = e.socialResponse.view;
    e.likes = e.socialResponse.likes;
   }
  }
  $(".lkcount").text(e.likesCount);
  $(".lktext").text(photoOrg.photoLib.getLikesText(e.likesCount));
  $(".lkcounttext").css({
   display:"inline-block"
  });
  if (_.contains(e.likes, parseInt(gon.staticContent.account_id))) {
   $(".album-like-button").addClass("tab-active");
   photoOrg.likesCommentsControllerView && (photoOrg.likesCommentsControllerView.likesView.isLiked = !0);
   e.isLiked = !0;
  } else {
   e.isLiked = !1;
   e.likes.length <= 0 && $(".lkcounttext").css({
    display:"none"
   });
   $(".album-like-button").removeClass("tab-active");
   photoOrg.likesCommentsControllerView && (photoOrg.likesCommentsControllerView.likesView.isLiked = !1);
  }
  if (photoOrg.likesCommentsControllerView) {
   photoOrg.likesCommentsControllerView.likesView.prepareLikeScreen();
   photoOrg.likesCommentsControllerView.updateLikesText(e.likesCount);
  }
 },
 successLikesCallBack:function(t, e, o) {
  o = void 0 == o ? !0 :o;
  this.showHideLikes(t, e, o);
 },
 successLikeCallBackFromPanel:function(t, e, o) {
  o = void 0 == o ? !0 :o;
  e.showHideLikes(t, e, o);
 },
 successCommentCallBackFromPanel:function(t, e, o) {
  o = void 0 == o ? !0 :o;
  if (o) {
   e.socialResponse = t.entities[0];
   e.comments = e.socialResponse.comments;
   e.commentsCount = 0 == e.socialResponse.commentsCount ? "" :e.socialResponse.commentsCount;
  }
  $(".commentsCount").text(e.commentsCount);
  $(".commentsText").text(photoOrg.photoLib.getCommentsText(e.commentsCount));
  $(".commentsCountText").css({
   display:"inline-block"
  });
  for (var i = !1, s = 0; s < e.comments.length; s++) e.comments[s].ownerId == parseInt(gon.staticContent.account_id) && (i = !0);
  if (i) $(".album-comment-button").addClass("tab-active"); else {
   e.comments.length <= 0 && $(".commentsCountText").css({
    display:"none"
   });
   $(".album-comment-button").removeClass("tab-active");
  }
 },
 errorLikeCallBack:function() {
  alert("got an an error");
 },
 updateAlbumData:function(t) {
  console.log("Updating Album Data.....");
  this.socialResponse = t.entities[0];
  this.likesCount = 0 == this.socialResponse.likesCount ? "" :this.socialResponse.likesCount;
  this.view = this.socialResponse.view;
  this.likes = this.socialResponse.likes;
  this.comments = this.socialResponse.comments;
 }
});

var photoOrg = photoOrg || {};

photoOrg.CommentsView = Backbone.View.extend({
 parentObj:null,
 events:{
  "click .delete-comment":"deleteComment",
  "click .postComment":"postComment",
  "click .cancel-comment":"clearCommentArea",
  "click #commenttxt":"showTextArea",
  "tap #commenttxt":"showTextArea"
 },
 initialize:function(t) {
  try {
   console.log("Comments view initialize");
   this.parentObj = t.parentObj;
   this.$el = this.parentObj.$el.find(".rt-container");
   this.options = t.options;
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:comments_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 clearCommentArea:function() {
  try {
   console.log("Clearing comment Area");
   $("textarea.comment-area").val("");
   $("input#commenttxt").val("");
   $(".commentSingleline").show();
   $(".addcommentbox").hide();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:comments_view:clearCommentArea", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 showTextArea:function() {
  try {
   console.log("In showTextArea method");
   $("textarea.comment-area").val("");
   $("input#commenttxt").val("");
   $(".commentSingleline").hide();
   $(".addcommentbox").show();
   this.enalbleClickEvent();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:comments_view:showTextArea", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 deleteComment:function(t) {
  try {
   console.log("Deleting Comment...");
   $("#rt-loader").show();
   var e = $(t.currentTarget).attr("commentId");
   this.toBedeletedComment = $(t.currentTarget).parent();
   photoOrg.photoLib.deleteComment({
    itemId:this.options.albumData.albumId,
    itemOwnerId:this.options.albumData.ownerAccountId,
    itemDC:this.options.albumData.dataCenter
   }, $.proxy(this.successCommentsDeleteCallBack, this), $.proxy(this.errorCommentsDeleteCallBack, this), this, e);
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:comments_view:deleteComment", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 errorCommentsDeleteCallBack:function() {
  photoOrg.jsErrorLogger("Unable to Delete a comment");
  $("#rt-loader").hide();
 },
 successCommentsDeleteCallBack:function(t) {
  this.options.albumData.comments = t.entities[0].comments;
  this.updateCommentsCount();
  this.parentObj.updateCommentsText(this.options.albumData.comments.length);
  $(this.toBedeletedComment).remove();
  0 == this.options.albumData.comments.length && this.prepareCommentsScreen();
  $("#rt-loader").hide();
  this.options.likesAndCommentsViewObj.successCommentCallBackFromPanel && this.options.likesAndCommentsViewObj.successCommentCallBackFromPanel(t, this.options.likesAndCommentsViewObj);
 },
 updateCommentsCount:function() {
  console.log("Comments count Updated...");
  if (this.options.albumData.comments.length > 0) {
   this.options.commentsCountEl.show();
   this.options.commentsCountEl.find(".commentsCount").text(this.options.albumData.comments.length);
   this.options.commentsCountEl.find(".commentsText").text(photoOrg.photoLib.getCommentsText(this.options.albumData.comments.length));
  } else {
   this.options.commentsCountEl.hide();
   this.options.commentsCountEl.find(".commentsCount").text("");
   this.options.commentsCountEl.find(".commentsText").text("");
  }
 },
 postComment:function() {
  try {
   console.log("Posting... comment");
   if ($("textarea.comment-area").val().length <= 0) return;
   photoOrg.Util.trackLinksAndButtons("Comments", "singleAlbumDetail");
   $("#rt-loader").show();
   photoOrg.photoLib.comment({
    itemId:this.options.albumData.albumId,
    itemOwnerId:this.options.albumData.ownerAccountId,
    itemDC:this.options.albumData.dataCenter,
    Comment:photoOrg.photoLib.htmlEncode($("textarea.comment-area").val())
   }, $.proxy(this.successCommentsCreationCallBack, this), $.proxy(this.errorCommentsCallBack, this), this);
   this.disableClickEvent();
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:comments_view:postComment", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 disableClickEvent:function() {
  console.log("Posting comment Area disabled");
  $("textarea.comment-area").val("");
  $("input#commenttxt").val("");
  $(".postComment").off("click");
 },
 errorCommentsCallBack:function() {
  this.enalbleClickEvent();
  $("#rt-loader").hide();
 },
 enalbleClickEvent:function() {
  $(".postComment").on("click", $.proxy(this.postComment, this));
 },
 successCommentsCreationCallBack:function(t) {
  this.options.albumData.comments = t.entities[0].comments;
  this.clearCommentArea();
  this.prepareCommentsScreen();
  this.enalbleClickEvent();
  this.parentObj.updateCommentsText(this.options.albumData.comments.length);
  $("#rt-loader").hide();
  this.options.likesAndCommentsViewObj.successCommentCallBackFromPanel && this.options.likesAndCommentsViewObj.successCommentCallBackFromPanel(t, this.options.likesAndCommentsViewObj);
 },
 prepareCommentsScreen:function() {
  console.log("Comments Screen preparation...");
  this.updateCommentsCount();
  $(".commentslist").empty();
  if (this.options.albumData.comments.length <= 0) {
   $(".nocomments-sec").show();
   $(".commentsslist-sec .commentslist").hide();
  } else {
   $(".nocomments-sec").hide();
   $(".commentsslist-sec .commentslist").show();
   for (var t = this.options.albumData.comments.length - 1; t >= 0; t--) {
    var e = this.options.albumData.comments[t], o = this.parentObj.getLikerName(e.ownerId), i = o.name, s = o.colorClass;
    void 0 == s && (s = this.parentObj.colorsArray.A);
    var r = !1;
    (gon.staticContent.account_id == this.options.albumData.ownerAccountId || e.ownerId == gon.staticContent.account_id) && (r = !0);
    var n = JST["templates/common/library/common/comments-template"]({
     commentOwnerName:i,
     accountId:e.ownerId,
     likerClass:s,
     shortName:o.shortName,
     comment:e.comment,
     commentId:e.commentId,
     itemOwnerId:e.ownerId,
     itemDC:this.options.albumData.dataCenter,
     showDelete:r
    });
    $(".commentslist").append(n);
   }
  }
 }
});

var photoOrg = photoOrg || {};

photoOrg.LikesView = Backbone.View.extend({
 options:{},
 isLiked:!1,
 events:{
  "click .tobeLikedButton":"likeAlbum",
  "click .likedButton":"onUnLike"
 },
 initialize:function(t) {
  try {
   console.log("Likes view initialize");
   this.parentObj = t.parentObj;
   this.$el = this.parentObj.$el.find(".rt-container");
   this.options = t.options;
   this.isLiked = this.options.isLiked;
   this.hightLightLikeButton();
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 onUnLike:function(t) {
  try {
   console.log("Unliking.....");
   this.isLiked = !1;
   photoOrg.Util.trackLinksAndButtons("Likes", "singleAlbumDetail");
   photoOrg.photoLib.unlike({
    itemId:this.options.albumData.albumId,
    itemOwnerId:this.options.albumData.ownerAccountId,
    itemDC:this.options.albumData.dataCenter
   }, $.proxy(this.successLikeCallBack, this), $.proxy(this.errorLikeCallBack, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_view:onUnLike", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 likeAlbum:function() {
  try {
   console.log("Liking Album.....");
   this.isLiked = !0;
   photoOrg.Util.trackLinksAndButtons("Likes", "singleAlbumDetail");
   photoOrg.photoLib.like({
    itemId:this.options.albumData.albumId,
    itemOwnerId:this.options.albumData.ownerAccountId,
    itemDC:this.options.albumData.dataCenter
   }, $.proxy(this.successLikeCallBack, this), $.proxy(this.errorLikeCallBack, this));
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_view:likeAlbum", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 updateLikesCount:function() {
  console.log("Updating Likes count...");
  if (0 == this.options.albumData.likesCount) {
   this.options.likesCountEl.find(".lkcount").text("");
   this.options.likesCountEl.find(".lktext").text("");
   this.options.likesCountEl.hide();
  } else {
   this.options.likesCountEl.find(".lkcount").text(this.options.albumData.likesCount);
   this.options.likesCountEl.find(".lktext").text(photoOrg.photoLib.getLikesText(this.options.albumData.likesCount));
   this.options.likesCountEl.show();
  }
 },
 hightLightLikeButton:function() {
  try {
   console.log("Highlighting... like button");
   if (this.isLiked) {
    $(".likedButton").show();
    $(".tobeLikedButton").hide();
   } else {
    $(".likedButton").hide();
    $(".tobeLikedButton").show();
   }
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_view:hightLightLikeButton", errorCode="LIBRARY:MYALBUMS", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 successLikeCallBack:function(t) {
  this.hightLightLikeButton();
  this.options.albumData.likesCount = t.entities[0].likesCount;
  this.options.albumData.likes = t.entities[0].likes;
  this.options.albumData.view = t.entities[0].view;
  this.prepareLikeScreen();
  this.updateLikesCount();
  (void 0 != photoOrg.photoLib.Util.historyState.pg && photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.MY_SHARED_SINGLE_ALBUM_VIEW || photoOrg.photoLib.Util.historyState.pg == photoOrg.constants.SHARED_WITH_ME_SINGLE_ALBUM_VIEW) && this.options.likesAndCommentsViewObj.successLikeCallBackFromPanel(t, this.options.likesAndCommentsViewObj);
  this.parentObj.updateLikesText(this.options.albumData.likesCount);
 },
 errorLikeCallBack:function() {
  console.log("error in like");
 },
 prepareLikeScreen:function() {
  console.log("Preparing like screen...");
  this.hightLightLikeButton();
  if (0 == this.options.albumData.likes.length) {
   $(".likeslist-sec .likeslist").hide();
   $(".nolikes-sec").show();
  } else {
   if (void 0 == this.isLiked || "" == this.isLiked) {
    this.isUserLiked();
    this.hightLightLikeButton();
   }
   $(".nolikes-sec").hide();
   $(".likeslist-sec .likeslist").show();
   $(".likeslist").empty();
   for (var t = 0; t < this.options.albumData.likes.length; t++) {
    var e = this.options.albumData.likes[t];
    console.log(e);
    var o = this.parentObj.getLikerName(e), i = o.name, s = o.colorClass;
    void 0 == s && (s = this.parentObj.colorsArray.A);
    var r = JST["templates/common/library/common/likes-template"]({
     likerName:i,
     accountId:e,
     likerClass:s,
     shortName:o.shortName
    });
    $(".likeslist").append(r);
   }
  }
 },
 isUserLiked:function() {
  console.log("Check user liked or not");
  for (var t = 0; t < this.options.albumData.likes.length; t++) {
   var e = this.options.albumData.likes[t];
   e == gon.staticContent.account_id && (this.isLiked = !0);
  }
  return this.isLiked;
 }
});

var photoOrg = photoOrg || {};

photoOrg.LikesCommentsControllerView = Backbone.View.extend({
 likeStateText:"likes",
 commentsSateText:"comments",
 options:{},
 likesView:null,
 commentsView:null,
 colorsArray:{
  A:"iccolor1",
  B:"iccolor2",
  B:"iccolor3",
  C:"iccolor4",
  D:"iccolor5",
  E:"iccolor6",
  F:"iccolor7",
  G:"iccolor8",
  H:"iccolor9",
  I:"iccolor10",
  J:"iccolor1",
  K:"iccolor2",
  L:"iccolor3",
  M:"iccolor4",
  N:"iccolor5",
  P:"iccolor6",
  Q:"iccolor7",
  R:"iccolor8",
  S:"iccolor9",
  T:"iccolor10",
  U:"iccolor1",
  V:"iccolor2",
  W:"iccolor3",
  X:"iccolor4",
  Y:"iccolor5",
  Z:"iccolor6"
 },
 showPanel:!1,
 state:"",
 events:{
  "click .close-sec":"close",
  "click .commenttab":"invokeLikesCommentsPanel",
  "click .likestab":"invokeLikesCommentsPanel"
 },
 close:function() {
  try {
   this.state = "";
   if (this.options.hightlightSlideShowTabs) {
    var t = "";
    this.$el.find(".likes-tab").removeClass("tab-active");
    this.$el.find(".comment-tab").removeClass("tab-active");
    eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_SHOWORHIDEPANEL, {
     stateText:t,
     showPanel:!1
    });
   } else if ($(".rt-container").hasClass("rt-container-shrink")) {
    $(".rt-container").removeClass("rt-container-shrink");
    $(".mobile-footer").removeClass("hide");
   }
  } catch (e) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_comments_controller_view:close", errorCode="LIBRARY:MYALBUMS", err_desc="' + e + '" err_stack="' + e.stack + '"');
  }
 },
 initialize:function(t) {
  try {
   console.log("likes comments controller initialize...");
   var e = {
    likes_text:this.getLikesCountText(t.options.albumData.likesCount),
    comments_text:this.getCommentsText(t.options.albumData.comments.length)
   };
   this.likesCommentsTemplate = JST["templates/common/library/common/likes-comments-template"](e);
   this.$el = $(t.options.el);
   this.$el.find(".rt-container").remove();
   this.options = t.options;
   this.$el.append(this.likesCommentsTemplate);
   this.likesView = new photoOrg.LikesView({
    parentObj:this,
    options:t.options
   });
   this.commentsView = new photoOrg.CommentsView({
    parentObj:this,
    options:t.options
   });
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_comments_controller_view:initialize", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 getLikesCountText:function(t) {
  try {
   console.log("Getting Likes Count text...");
   var e = window.translations.social_network.likes_text;
   t > 0 && (e += " (" + t + ")");
   return e;
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_comments_controller_view:getLikesCountText", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 getCommentsText:function(t) {
  try {
   console.log("Getting comments text...");
   var e = window.translations.social_network.comments_text;
   t > 0 && (e += " (" + t + ")");
   return e;
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_comments_controller_view:getCommentsText", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 updateLikesText:function(t) {
  $(".tab-rt-buttons .likestab .likes_text").text(this.getLikesCountText(t));
 },
 updateCommentsText:function(t) {
  $(".tab-rt-buttons .commenttab .comment_text").text(this.getCommentsText(t));
 },
 invokeLikesCommentsPanel:function(t) {
  try {
   var e = $(t.currentTarget).attr("class");
   -1 !== e.indexOf("commenttab") ? ("" == this.state || this.state == this.likeStateText) && this.prepareCommentsDom() :("" == this.state || this.state == this.commentsSateText) && this.prepareLikeDom();
  } catch (o) {
   photoOrg.jsErrorLogger('"LIBRARY:likes_comments_controller_view:invokeLikesCommentsPanel", errorCode="LIBRARY:MYALBUMS", err_desc="' + o + '" err_stack="' + o.stack + '"');
  }
 },
 hideComentsSection:function() {
  $(".commentsslist-sec").hide();
 },
 hideLikes:function() {
  $(".nolikes-se").hide();
  $(".likeslist-sec").hide();
 },
 highlightTabAndShowPanel:function(t, e, o, i) {
  className = "tab-active";
  if (i) {
   this.$el.find(".likes-tab").removeClass(className);
   this.$el.find(".comment-tab").removeClass(className);
  }
  this.$el.find(".likestab").removeClass(className);
  this.$el.find(".commenttab").removeClass(className);
  if ("" == this.state || this.state == t) {
   this.showPanel = !0;
   this.state = e;
   i && this.$el.find(o).addClass(className);
   this.$el.find(o.replace("-", "")).addClass("tab-active");
  } else {
   this.state = "";
   this.showPanel = !1;
   this.$el.find(o).removeClass(className);
   this.$el.find(o.replace("-", "")).removeClass("tab-active");
  }
  ("" == this.state || this.state == e) && eventBus.trigger(eventBus.CUSTOM_EVENT_INVOKE_SHOWORHIDEPANEL, {
   stateText:e,
   showPanel:this.showPanel
  });
 },
 prepareLikeDom:function() {
  console.log("Preparing Like Dom...");
  this.commentsView.clearCommentArea();
  hightlightSlideShowTabs = this.options.hightlightSlideShowTabs;
  this.hideComentsSection();
  $(".likeslist-sec").show();
  this.highlightTabAndShowPanel(this.commentsSateText, this.likeStateText, ".likes-tab", hightlightSlideShowTabs);
  this.likesView.prepareLikeScreen();
 },
 prepareCommentsDom:function() {
  console.log("Preparing Comments Dom...");
  this.hideLikes();
  hightlightSlideShowTabs = this.options.hightlightSlideShowTabs;
  $(".commentsslist-sec").show();
  photoOrg.Util.trackLinksAndButtons("Comments", "singleAlbumDetail");
  this.highlightTabAndShowPanel(this.likeStateText, this.commentsSateText, ".comment-tab", hightlightSlideShowTabs);
  this.commentsView.prepareCommentsScreen();
 },
 getLikerName:function(t) {
  console.log("Getting Liker Name.....");
  for (var e = "A", o = 0; o < this.options.albumData.view.length; o++) {
   var i = this.options.albumData.view[o];
   if (i.accountId == t) {
    console.log(" liker accountid" + i.accountId + " " + i);
    i.firstName && i.firstName.length > 0 && (e = i.firstName.charAt(0).toUpperCase());
    return {
     name:i.firstName + " " + i.lastName,
     colorClass:this.colorsArray[e],
     shortName:i.firstName.charAt(0).toUpperCase() + " " + i.lastName.charAt(0).toUpperCase()
    };
   }
  }
  if (t == this.options.albumData.ownerAccountId) {
   var s = void 0 == this.options.albumData.ownerName ? "" :this.options.albumData.ownerName, r = void 0 == this.options.albumData.lastName ? "" :this.options.albumData.lastName;
   s.length > 0 && (e = s.charAt(0).toUpperCase());
   return {
    name:s + " " + r,
    colorClass:this.colorsArray[e],
    shortName:s.charAt(0).toUpperCase() + " " + r.charAt(0).toUpperCase()
   };
  }
  return "";
 }
});

var photoOrg = photoOrg || {};

photoOrg.ExpressProductView = Backbone.View.extend({
 el:".expressprints",
 id:".expressprints",
 currentAlbumResponse:{},
 currentActiveSkuId:"",
 activeClass:"active",
 entireAlbum:!1,
 isAddToCartRequestSent:!1,
 videosArray:[],
 requestPaylod:{
  locale:"",
  sku:"",
  assetRefList:[]
 },
 events:{
  "click .customize-order-express-prints":"goToOrderPrints",
  "click .paper-select>li":"selectedFinishType",
  "click .addtocart-btn":"showingSpinningWheelThenAddToCart",
  "click .headbar":"hideExpressDropDown",
  "click .hide-bar":"hideExpressDropDown"
 },
 initialize:function() {},
 goToOrderPrints:function() {
  console.log("Express Products view - goToOrderPrints method");
  if (this.videosArray.length > 0) {
   photoOrg.productConfirmationModal.callBack = $.proxy(this.redirecTPrints, this);
   $(".productCreationConfirmation").foundation("reveal", "open");
   $("#close_btn").hide();
   $("#ok_btn").show();
  } else this.redirecTPrints();
 },
 redirecTPrints:function() {
  console.log("Redirected to prints builder");
  photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAV_CustomOrder", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  try {
   if (this.entireAlbum) {
    gon.staticContent.prints_sku_4x6 = "sku=" + this.currentActiveSkuId;
    photoOrg.savPage.singleAlbumView.redirectToprints(!0);
   } else {
    gon.staticContent.session_update = !1;
    var t = "", e = "", o = this.getTnlArray(photoOrg.photoLib.selectedAlbumAssets, t, e);
    t = o.pictAssetRefs;
    e = o.pictIdsString;
    photoOrg.photoLib.setPicsToLocalStorage(photoOrg.photoLib.selectedAlbumAssets, t, !0);
    var i = gon.staticContent.prints_builder_url + "?flowFrom=myphotos&sku=" + this.currentActiveSkuId, s = gon.staticContent.library_url + "/updateSession", r = photoOrg.Util.getBrowserSessionCookie("GSID"), n = photoOrg.Util.getBrowserSessionCookie("oa2"), a = {
     entity:{
      fieldList:{
       field:[ {
        name:"GSID",
        value:r
       }, {
        name:"selected_pict_ids",
        value:e
       }, {
        name:"selected_pict_asset_refs",
        value:t
       } ]
      },
      indexkeyList:[ "GSID" ],
      uuid:r
     }
    }, l = {
     oa2:n,
     gsid:r
    };
    l.data = $.toJSON(a);
    var c = !1, h = function() {
     this.redirect(i);
    }, d = function() {
     photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:goToOrderPrints",errorCode="LIBRARY:EXP", err_desc=" Got error while updating globalsession" ');
     this.redirect(i);
    };
    $.ajax({
     url:s,
     dataType:"json",
     type:"POST",
     async:c,
     data:l,
     success:$.proxy(h, this),
     error:$.proxy(d, this)
    });
   }
  } catch (p) {
   photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:goToOrderPrints",errorCode="LIBRARY:EXP", err_desc="' + p + '" err_stack="' + p.stack + '"');
  }
 },
 getTnlArray:function(t, e, o, i) {
  console.log("Getting Tnl.....");
  _.each(t, function(t, s) {
   var r = photoOrg.photoLib.UserAssetsInfo.singleAlbumsAssets.get(t);
   try {
    if (!r) {
     photoOrg.jsWarningLogger('"LIBRARY:express_products_view:getTnlArray", errorCode="LIBRARY:MYPHOTOS", err_desc="no model object found"');
     return;
    }
    r.attributes || photoOrg.jsWarningLogger('"LIBRARY:express_products_view:getTnlArray", errorCode="LIBRARY:MYPHOTOS", err_desc="no attributes, issue with model object"');
   } catch (n) {}
   var a = r.attributes.files || r.attributes.thumbnailEncryption, l = photoOrg.photoLib.getThumbnailUrlFromFiles(a) || r.attributes.thumbnailEncryption;
   if (l && "PICTURE" == r.attributes.assetType) {
    if (void 0 != e && void 0 != o) {
     if (photoOrg.photoLib.selectedAlbumAssets.length > 1 && 0 != s) {
      e += ",";
      o += ",";
     }
     e += t + "_" + l;
     o += t;
    }
    void 0 != i && i.push(l);
   } else this.videosArray.push(l);
  }, this);
  return void 0 != i ? {
   pictAssetRefsArray:i
  } :{
   pictAssetRefs:e,
   pictIdsString:o
  };
 },
 render:function() {
  try {
   console.log("Express Products view - render method");
   this.videosArray = [];
   this.isAddToCartRequestSent = !1;
   photoOrg.photoLib.selectedAlbumAssets = _.uniq(photoOrg.photoLib.selectedAlbumAssets);
   this.currentAlbumResponse = photoOrg.savPage.singleAlbumView.albumResponse;
   this.entireAlbum = this.currentAlbumResponse.assetIdList.length == photoOrg.photoLib.selectedAlbumAssets.length || 0 == photoOrg.photoLib.selectedAlbumAssets.length ? !0 :!1;
   this.getPreparePaylod();
   if (this.videosArray.length > 0 && 0 == this.requestPaylod.assetRefList.length) {
    this.close();
    $(".productCreationConfirmation").foundation("reveal", "open");
    $("#close_btn").show();
    $("#ok_btn").hide();
    return;
   }
   var t = {}, e = photoOrg.photoLib.expressProduct.firstProduct || photoOrg.photoLib.expressProduct.skuIds[0], o = photoOrg.photoLib.expressProduct.productMap[e];
   this.buildExpressViewMap(o, e, t);
   var i = JST["templates/common/library/express_view/express_product"](t);
   $(this.id + " .dynamic-express-info").append(i);
   this.addPriceDom(t);
   _.each(photoOrg.photoLib.expressProduct.availabilityFinishType, function(t) {
    var e = photoOrg.photoLib.expressProduct.productMap[t], o = t, i = e.skuId;
    if (photoOrg.photoLib.expressProduct.firstProduct && photoOrg.photoLib.expressProduct.firstProduct == i || 1 == photoOrg.photoLib.expressProduct.availabilityFinishType.length) {
     o = t + " " + this.activeClass;
     this.currentActiveSkuId = i;
    }
    $(this.id + " .paper-select").append("<li skuId='" + i + "' class='" + o + "'>" + window.translations[t] + "</li>");
   }, this);
   this.trackOmniture();
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:render",errorCode="LIBRARY:EXP", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 buildExpressViewMap:function(t, e, o) {
  console.log("Express Products view - buildExpressViewMap method");
  o.finish = t.finishType;
  o.skuId = e;
  var i = 0;
  if (this.entireAlbum) {
   o.entireAlbum = !0;
   this.currentAlbumResponse && this.currentAlbumResponse.assetIdList ? i = this.currentAlbumResponse.assetIdList.length :photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:buildExpressViewMap", errorCode="LIBRARY:EXP", err_desc= Not find the whole albumresponse');
  } else {
   o.entireAlbum = !1;
   i = photoOrg.photoLib.selectedAlbumAssets.length;
  }
  this.getPrice(o, i, t);
  o.count = i;
  var s = t.availabilityMap.retailers, r = "";
  o.retailers = !1;
  if (s && s.length > 0 && !window.translations["default_" + t.finishType]) {
   o.retailers = !0;
   _.each(s, function(t, e) {
    s.length > 1 && 0 != e && (r += " " + window.translations.and + " ");
    r += void 0 != window.translations[t] ? window.translations[t] :t;
   });
   r = window.translations.finish_text.replace("{retailer}", r).replace("{type}", window.translations[t.finishType]);
  } else if (window.translations["default_" + t.finishType]) {
   o.retailers = !0;
   r = window.translations["default_" + t.finishType];
  }
  o.retailers_text = r + ".";
 },
 trackOmniture:function() {
  try {
   this.entireAlbum ? photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAV_EntireAlbum", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]) :photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAV_SelectedPhotos", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
  } catch (t) {
   photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:trackOmniture",errorCode="LIBRARY:EXP", err_desc="' + t + '" err_stack="' + t.stack + '"');
  }
 },
 getPrice:function(t, e, o) {
  try {
   console.log("Getting price of product...");
   var s = o.priceMap, r = 0;
   for (i = 0; i < s.length; i++) {
    var n = s[i];
    if (n.quantityHigh && e <= n.quantityHigh) {
     r = n.priceLevel[0] * e;
     break;
    }
    if (void 0 == n.quantityHigh) {
     r = n.priceLevel[0] * e;
     break;
    }
   }
   t.totalPrice = parseFloat(r).toFixed(2);
   t.totalPrice = t.totalPrice.replace(".", window.translations.seperator);
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:getPrice",errorCode="LIBRARY:EXP", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 selectedFinishType:function(t) {
  try {
   console.log("Selecting Finish type...");
   var e = $(t.currentTarget), o = e.attr("skuId");
   if (this.currentActiveSkuId != o) {
    this.currentActiveSkuId = o;
    $(".paper-select>li").removeClass(this.activeClass);
    e.addClass(this.activeClass);
    var i = {}, s = photoOrg.photoLib.expressProduct.productMap[o];
    this.buildExpressViewMap(s, o, i);
    this.addPriceDom(i);
    i.retailers ? $(this.id + " .paper-text-finish-type").html(i.retailers_text) :$(this.id + " .paper-text").hide();
    photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAV_" + i.finish, photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
   }
  } catch (r) {
   photoOrg.jsErrorLogger('"LIBRARY:ExpressProductView:selectedFinishType",errorCode="LIBRARY:EXP", err_desc="' + r + '" err_stack="' + r.stack + '"');
  }
 },
 addPriceDom:function(t) {
  var e = JST["templates/common/library/express_view/express_product_price"](t);
  $(this.id + " .printprice").html(e);
  $(".total-price").html(window.translations.currency_symbol.replace("{price}", t.totalPrice));
 },
 showingSpinningWheelThenAddToCart:function() {
  if (!this.isAddToCartRequestSent) {
   photoOrg.expressProduct.showSpinningWheel();
   setTimeout($.proxy(this.addToCart, this), 1);
  }
 },
 addToCart:function() {
  console.log("Adding to Cart.......");
  if (!this.isAddToCartRequestSent) {
   photoOrg.expressProduct.showSpinningWheel();
   this.isAddToCartRequestSent = !0;
   gon.staticContent.session_update = !1;
   if (this.videosArray.length > 0) {
    this.isAddToCartRequestSent = !1;
    photoOrg.expressProduct.hideSpinningWheel();
    photoOrg.productConfirmationModal.callBack = $.proxy(this.doAjaxCall, this);
    $(".productCreationConfirmation").foundation("reveal", "open");
    $("#close_btn").hide();
    $("#ok_btn").show();
   } else this.doAjaxCall();
  }
 },
 doAjaxCall:function() {
  var t = gon.staticContent.create_api + "/api/v1/expressprintsproject";
  this.requestPaylod.sku = this.currentActiveSkuId;
  var e = {};
  e.data = $.toJSON(this.requestPaylod);
  var o = {
   type:"POST",
   url:t,
   params:e,
   callback:$.proxy(this.successCallBack, this),
   errorCallback:$.proxy(this.failureCallBack, this),
   context:this,
   async:!1
  }, i = this.getAssetFetcher(o);
  i.doAjax();
  photoOrg.Util.trackLinksAndButtons("ExpressPrints_SAV_Addtocart", photoOrg.constants.pageNames[photoOrg.photoLib.Util.historyState.pg]);
 },
 getAssetFetcher:function(t) {
  return new AssetFetcher(t);
 },
 showSpinningWheel:function() {
  console.log("show spinnning wheel");
  $(".photo-org-blocking-bg").show();
  $("#photo-org-center-loadingBar").show();
 },
 hideSpinningWheel:function() {
  $("#photo-org-center-loadingBar").hide();
  $(".photo-org-blocking-bg").hide();
 },
 getPreparePaylod:function() {
  this.requestPaylod.locale = gon.staticContent.locale;
  this.requestPaylod.sku = this.currentActiveSkuId;
  var t = [];
  if (this.entireAlbum) this.currentAlbumResponse && this.currentAlbumResponse.assetIdList && _.each(this.currentAlbumResponse.assetIdList, function(e) {
   "VIDEO" == e.assetType ? this.videosArray.push(e.thumbnailEncryption) :t.push(e.thumbnailEncryption);
  }, this); else {
   var e = this.getTnlArray(photoOrg.photoLib.selectedAlbumAssets, void 0, void 0, t);
   t = e.pictAssetRefsArray;
  }
  this.requestPaylod.assetRefList = t;
 },
 hideExpressDropDown:function() {
  $(this.el).removeClass("open").css("left", "-999999999px");
 },
 successCallBack:function(t) {
  var e = "/addtocart";
  gon.staticContent.user_Type && "LTE" == gon.staticContent.user_Type && (e = "/shipping");
  if (gon.staticContent.cartUrl && t.projectId) {
   var o = gon.staticContent.cartUrl + e + "?projectId=" + t.projectId;
   this.redirect(o);
  }
 },
 redirect:function(t) {
  window.location.href = t;
 },
 failureCallBack:function(t) {
  this.hideSpinningWheel();
  photoOrg.jsWarningLogger('"LIBRARY:ExpressProductView:failureCallBack",errorCode="LIBRARY:EXP", err_desc="' + JSON.stringify(t) + '" err_stack=""');
 },
 close:function() {
  photoOrg.expressProduct.hideSpinningWheel();
  $(this.el).off("click", ".customize-order-express-prints");
  $(this.el).off("click", ".paper-select>li");
  $(this.el).off("click", ".addtocart-btn");
  $(this.el).off("click", ".headbar");
  $(this.el).off("click", ".hide-bar");
  $(this.id + " .dynamic-express-info").empty();
  this.unbind();
  delete photoOrg.expressProduct;
 },
 closeExpressPrintsOverlay:function() {
  $(".expressprints").foundation("reveal", "close");
 }
});

var photoOrg = photoOrg || {};

photoOrg.editUtils = {
 mobileVersionImageHeight:480,
 isAssetEdited:!1,
 prepareImageUrl:function(t, e) {
  var o = e.split("v2/")[1];
  t ? o = o.split("=")[0] + "=200" :photoOrg.Util.isMobileLayout() && (o = o.split("=")[0] + "=" + this.mobileVersionImageHeight);
  try {
   photoOrg.editOperationsView.withOutBrightnessContrastFiltersJournal && (o += "&journal=" + photoOrg.editOperationsView.withOutBrightnessContrastFiltersJournal);
  } catch (i) {}
  var s = "";
  try {
   var s = "//" + gon.staticContent.thumbnail_prefix_url_for_edit + o;
  } catch (i) {
   s = gon.staticContent.library_url + "/stream_image?ri=" + encodeURIComponent(o);
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:prepareImageUrl", errorCode="LIBRARY:EDIT", err_desc="' + i + '" err_stack="' + i.stack + '"');
  }
  return s;
 },
 generateCanvasObj:function(t, e, o, i, s, r, n) {
  var a = this, l = {}, c = "#" + t;
  n && (c = n);
  l = Caman(c, function() {
   photoOrg.enhanceOperationsView.insideEnhance = !1;
   console.log("loaded CANVAS successfully");
   a.busy = !1;
   try {
    photoOrg.enhanceOperationsView.calculateSliderValues();
    photoOrg.enhanceOperationsView.assignSliderBC();
   } catch (t) {}
   if (i) {
    var n = this;
    this.canvas.style.maxWidth = s ? "80px" :"110px";
   }
   var l = !1;
   a.updateCanvasWithPreview(e, o, n, l, r);
   a.filterRGBarr = "";
  });
  i || (a.caman = l);
 },
 populateImage:function(t, e, o, i, s, r, n) {
  try {
   try {
    if (photoOrg.editOperationsView && !photoOrg.editOperationsView.reloadCanvasData && photoOrg.enhanceOperationsView && !photoOrg.enhanceOperationsView.insideEnhance && 1 == $("canvas#caman-canvas").length) {
     console.log("populateImage :: skipping canvas generation with variable reloadCanvasData");
     return;
    }
   } catch (a) {
    console.log("populateImage :: issue with variable reloadCanvasData : " + a);
   }
   if (photoOrg.Util.isIE) {
    console.log("IE specific populate Canvas Image generation Method");
    this.populateImageForIE(t, e, o, i, s, r, n);
    return;
   }
   console.log("NON-IE browser");
   var l = new Image(), c = this, h = "caman-canvas";
   s && (h = s);
   console.log("camanCanvasId : " + h);
   var d = this.prepareImageUrl(s, t), p = this;
   l.onload = function() {
    $(this).hide();
    this.crossOrigin = "anonymous";
    var t = !0;
    c.canvasImage = this;
    try {
     var e = document.getElementById(h);
     if (e && -1 !== e.tagName.toLowerCase().indexOf("canvas") && c.previousUrl) {
      e.remove(c.previousUrl);
      console.log("old canvas object is removed");
     }
    } catch (a) {
     $("#" + h).remove();
    }
    this.style.display = "none";
    if (s) {
     $("#" + r).append(this);
     c.generateCanvasObj(s, o, i, t, n);
    } else {
     $("#sourceImage").append(this);
     var l = photoOrg.filterView.filterValue ? photoOrg.filterView.filterValue.replace("/", "") :"";
     if (l.length > 0) var d = photoOrg.filterView.getFilterRGBArr(l);
     t = !1;
     c.generateCanvasObj(h, l, d, t, n);
    }
   };
   l.onerror = function(t) {
    try {
     photoOrg.jsWarningLogger('"LIBRARY:edit_utils:populateImage:OnImageError", errorCode="LIBRARY:EDIT", thumbnailUrl="' + d + '", err_desc="' + t + '" err_stack="' + t.stack + '"', "", "", "", !0);
     var e = d.split("v2/")[1], o = gon.staticContent.library_url + "/stream_image?ri=" + e;
     o = o.replace("&journal", "/journal");
     console.log("populateImage -image.onerror-streamUrl :" + o);
     if (l.streamUrl == o) {
      $(".edit-Overlay-spinner").hide();
      $(".edit_image_default").show();
      $("#somethingWentWrongConfirmation").foundation("reveal", "open");
      console.log("Already retried and return back");
      return;
     }
     l.streamUrl = o;
     l.src = o;
     p.previousUrl = o;
    } catch (t) {
     photoOrg.jsWarningLogger('"LIBRARY:edit_utils:populateImage:OnImageError:reInitiate", errorCode="LIBRARY:EDIT", thumbnailUrl="' + d + '", err_desc="' + t + '" err_stack="' + t.stack + '"', "", "", "", !0);
    }
   };
   console.log("url used: " + d);
   l.crossOrigin = "anonymous";
   l.setAttribute("data-caman-hidpi-disabled", "true");
   l.id = h;
   l.src = d;
   this.previousUrl = d;
  } catch (a) {
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:populateImage", errorCode="LIBRARY:EDIT", err_desc="' + a + '" err_stack="' + a.stack + '"');
  }
 },
 populateImageForIE:function(t, e, o, i, s, r, n) {
  try {
   var a = this, l = "caman-canvas";
   s && (l = s);
   var c = this.prepareImageUrl(s, t);
   $(".cropper-container ").remove();
   $(".lowres-warningmsg").hide();
   $(".lowres-war-text").hide();
   $(".crop-zoom-btns").hide();
   var h = new Image();
   h.onload = function() {
    this.crossOrigin = "anonymous";
    var t = !0;
    $("#" + l).remove();
    a.canvasImage = this;
    s ? $("#" + r).append("<canvas data-caman-hidpi-disabled='true' id='" + l + "'></canvas>") :$("#sourceImage").append("<canvas data-caman-hidpi-disabled='true' id='" + l + "'></canvas>");
    console.log("loaded image successfully");
    a.canvas = document.getElementById(l);
    var e = a.canvas.getContext("2d");
    a.canvas.style.display = "none";
    {
     var c = $("#sourceImage").width();
     $("#sourceImage").height();
    }
    if (h.width > c) {
     var d = a.getNewHeight(c, h.width, h.height);
     a.canvas.height = d;
     a.canvas.width = c;
    } else {
     var p = a.getNewWidth(a.imageHeight, h.width, h.height);
     p > c && (p = $(".edit_image_default").width());
     a.canvas.height = h.height;
     a.canvas.width = h.width;
    }
    e.drawImage(h, 0, 0, h.width, h.height, 0, 0, a.canvas.width, a.canvas.height);
    var u = !1;
    if (s) a.generateCanvasObj(s, o, i, t, n, u, a.canvas); else {
     var g = photoOrg.filterView.filterValue ? photoOrg.filterView.filterValue.replace("/", "") :"";
     if (g.length > 0) var m = photoOrg.filterView.getFilterRGBArr(g);
     t = !1;
     a.generateCanvasObj(l, g, m, t, n, u, a.canvas);
    }
   };
   h.onerror = function(t) {
    try {
     photoOrg.jsWarningLogger('"LIBRARY:edit_utils:populateImageForIE:OnImageError", errorCode="LIBRARY:EDIT", thumbnailUrl="' + c + '", err_desc="' + t + '" err_stack="' + t.stack + '"', "", "", "", !0);
     var e = c.split("v2/")[1], o = gon.staticContent.library_url + "/stream_image?ri=" + e;
     o = o.replace("&journal", "/journal");
     console.log("populateImageForIE -image.onerror-streamUrl :" + o);
     if (h.streamUrl == o) {
      $(".edit-Overlay-spinner").hide();
      $(".edit_image_default").show();
      $("#somethingWentWrongConfirmation").foundation("reveal", "open");
      console.log("Already retried and return back");
      return;
     }
     h.streamUrl = o;
     h.src = o;
    } catch (t) {
     photoOrg.jsWarningLogger('"LIBRARY:edit_utils:populateImageForIE:OnImageError:reInitiate", errorCode="LIBRARY:EDIT", thumbnailUrl="' + c + '", err_desc="' + t + '" err_stack="' + t.stack + '"', "", "", "", !0);
    }
   };
   h.crossOrigin = "anonymous";
   h.id = l;
   h.src = c;
  } catch (d) {
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:populateImageForIE", errorCode="LIBRARY:EDIT", err_desc="' + d + '" err_stack="' + d.stack + '"');
  }
 },
 getNewHeight:function(t, e, o) {
  try {
   if (0 == e) return t;
   var i = o / e;
   return t * i;
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:getNewHeight", errorCode="LIBRARY:EDIT", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 getNewWidth:function(t, e, o) {
  try {
   if (0 == o) return t;
   var i = e / o;
   return t * i;
  } catch (s) {
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:getNewWidth", errorCode="LIBRARY:EDIT", err_desc="' + s + '" err_stack="' + s.stack + '"');
  }
 },
 updateCanvasWithPreview:function(t, e, o, i, s, r, n) {
  try {
   var a = this, l = this.caman;
   o && (l = o);
   if (t && "none" != t) {
    try {
     l.revert(!1);
    } catch (c) {}
    var h = e;
    e || (h = photoOrg.filterView.getFilterRGBArr(t));
    l.bc(photoOrg.enhanceOperationsView.sliderBrightnessValue || 0, photoOrg.enhanceOperationsView.sliderContrastValue || 0);
    l.customFilter(h[0], h[1], h[2]);
    console.log("filterKey : " + t + ", and its filterRGBValue : " + h);
   } else {
    try {
     l.revert(!1);
    } catch (c) {}
    l.bc(photoOrg.enhanceOperationsView.sliderBrightnessValue || 0, photoOrg.enhanceOperationsView.sliderContrastValue || 0);
   }
   if (i) return;
   l.rotateCanvas(photoOrg.rotationOperationsView.rotationValueBeforeTabSwitch);
   var d = l.canvas;
   void 0 == n || n || (s = !0);
   void 0 == d && photoOrg.jsWarningLogger('"LIBRARY:edit_utils:updateCanvasWithPreview::canvasElement is undefined--this.canvas' + this.canvas + "filtercammonobj" + o + this.url + '"');
   l.render(function() {
    a.busy = !1;
    a.changed && (a.changed = !1);
    $(this.canvas).css("display", "block");
    $(".edit-Overlay-spinner").hide();
    t && console.log("Rendered image for filterKey : " + t);
    o || $("#sourceImage").append(this);
   }, s, d.width, d.height, r);
  } catch (c) {
   photoOrg.jsErrorLogger('"LIBRARY:edit_utils:updateCanvasWithPreview", errorCode="LIBRARY:EDIT", err_desc="' + c + '" err_stack="' + c.stack + '"');
  }
 }
};

$(function() {
 $(document).foundation();
 libraryInitialization();
});